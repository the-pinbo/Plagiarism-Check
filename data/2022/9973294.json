{
    "abstract": "Counting single photons and measuring their arrival time is of crucial importance for imaging and quantum applications that use single photons to outperform classical techniques. The investigation of the coincidence, i.e. correlation, between photons can be used to enhance the resolution of optical imaging techniques or to transmit information using quantum cryptography. Time measurements at the s...",
    "articleNumber": "9973294",
    "articleTitle": "Assessment of the Bundle SNSPD Plus FPGA-Based TDC for High-Performance Time Measurements",
    "authors": [
        {
            "preferredName": "Fabio Garzetti",
            "normalizedName": "F. Garzetti",
            "firstName": "Fabio",
            "lastName": "Garzetti",
            "searchablePreferredName": "Fabio Garzetti"
        },
        {
            "preferredName": "Nicola Lusardi",
            "normalizedName": "N. Lusardi",
            "firstName": "Nicola",
            "lastName": "Lusardi",
            "searchablePreferredName": "Nicola Lusardi"
        },
        {
            "preferredName": "Enrico Ronconi",
            "normalizedName": "E. Ronconi",
            "firstName": "Enrico",
            "lastName": "Ronconi",
            "searchablePreferredName": "Enrico Ronconi"
        },
        {
            "preferredName": "Andrea Costa",
            "normalizedName": "A. Costa",
            "firstName": "Andrea",
            "lastName": "Costa",
            "searchablePreferredName": "Andrea Costa"
        },
        {
            "preferredName": "Santiago Tarrago Velez",
            "normalizedName": "S. T. Velez",
            "firstName": "Santiago Tarrago",
            "lastName": "Velez",
            "searchablePreferredName": "Santiago Tarrago Velez"
        },
        {
            "preferredName": "Christophe Galland",
            "normalizedName": "C. Galland",
            "firstName": "Christophe",
            "lastName": "Galland",
            "searchablePreferredName": "Christophe Galland"
        },
        {
            "preferredName": "Angelo Geraci",
            "normalizedName": "A. Geraci",
            "firstName": "Angelo",
            "lastName": "Geraci",
            "searchablePreferredName": "Angelo Geraci"
        }
    ],
    "doi": "10.1109/ACCESS.2022.3227462",
    "publicationTitle": "IEEE Access",
    "publicationYear": "2022",
    "publicationVolume": null,
    "publicationIssue": null,
    "volume": "10",
    "issue": null,
    "documentLink": "/document/9973294/",
    "xml": "<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<response><accessType>CCBY - IEEE is not the copyright holder of this material. Please follow the instructions via https://creativecommons.org/licenses/by/4.0/ to obtain full-text articles and stipulations in the API documentation.</accessType><div id=\"BodyWrapper\" class=\"ArticlePage\" xmlns:ieee=\"http://www.ieeexplore.ieee.org\"><div id=\"article\">\n<div class=\"section\" id=\"sec1\"><div class=\"header article-hdr\"><div class=\"kicker\">\n\t\t                        SECTION I.</div><h2>Introduction</h2></div><p>Photon absorption enables for very sensitive light detection by monitoring the transition of a segment of a current-biased superconducting nanowire from superconducting to conventional resistive state <a ref-type=\"bibr\" anchor=\"ref1\" id=\"context_ref_1_1\">[1]</a>. Superconducting Nanowire Single Photon Detectors (SNSPDs) are devices that use this working mode and are used in a variety of quantum information applications <a ref-type=\"bibr\" anchor=\"ref2\" id=\"context_ref_2_1\">[2]</a>, <a ref-type=\"bibr\" anchor=\"ref3\" id=\"context_ref_3_1\">[3]</a>, quantum computing <a ref-type=\"bibr\" anchor=\"ref4\" id=\"context_ref_4_1\">[4]</a>, and quantum optic <a ref-type=\"bibr\" anchor=\"ref5\" id=\"context_ref_5_1\">[5]</a>, <a ref-type=\"bibr\" anchor=\"ref6\" id=\"context_ref_6_1\">[6]</a>, <a ref-type=\"bibr\" anchor=\"ref7\" id=\"context_ref_7_1\">[7]</a>, due to the fact that they are extremely suitable to detect solitary photons <a ref-type=\"bibr\" anchor=\"ref8\" id=\"context_ref_8_1\">[8]</a> with very high probability in a wide spectrum window from UV to infrared <a ref-type=\"bibr\" anchor=\"ref9\" id=\"context_ref_9_1\">[9]</a>, <a ref-type=\"bibr\" anchor=\"ref10\" id=\"context_ref_10_1\">[10]</a>. SNSPDs have been used to monitor the emission of single photons from a variety of light sources, including carbon nanotube dopants <a ref-type=\"bibr\" anchor=\"ref11\" id=\"context_ref_11_1\">[11]</a>, color centers of silicon carbide <a ref-type=\"bibr\" anchor=\"ref12\" id=\"context_ref_12_1\">[12]</a>, and semiconductor quantum dots <a ref-type=\"bibr\" anchor=\"ref13\" id=\"context_ref_13_1\">[13]</a>. Thanks to the absence of a PN-junction, SNSPDs have several advantages over conventional devices that are sensitive to single photons like Single-Photon Avalanche Diode (SPAD), including no afterpulsing (i.e., the triggering of a PN-junction-based detector after the main avalanche effect due to the presence of trap levels that receive extra energy during the first avalanche), extremely low timing jitter, and a low Dark Count Rate (DCR) (i.e., the detection of thermal photons due to the thermal noise in a PN-junction-based detector induced by the generation-recombination processes within the semiconductor), according to <a ref-type=\"bibr\" anchor=\"ref14\" id=\"context_ref_14_1\">[14]</a>. They are the best detector for applications that require great time precision and excellent weak signal detection. High-resolution light detection and ranging, photon correlations (LIDAR) <a ref-type=\"bibr\" anchor=\"ref15\" id=\"context_ref_15_1\">[15]</a>, <a ref-type=\"bibr\" anchor=\"ref16\" id=\"context_ref_16_1\">[16]</a>, <a ref-type=\"bibr\" anchor=\"ref17\" id=\"context_ref_17_1\">[17]</a>, <a ref-type=\"bibr\" anchor=\"ref18\" id=\"context_ref_18_1\">[18]</a> oxygen singlet detection <a ref-type=\"bibr\" anchor=\"ref19\" id=\"context_ref_19_1\">[19]</a>, optical reflectometry in the time domain for telecommunication networks <a ref-type=\"bibr\" anchor=\"ref20\" id=\"context_ref_20_1\">[20]</a>, This type of technology was also demonstrated valid in deep-space optical communication by <a ref-type=\"bibr\" anchor=\"ref21\" id=\"context_ref_21_1\">[21]</a>, <a ref-type=\"bibr\" anchor=\"ref22\" id=\"context_ref_22_1\">[22]</a>. Furthermore, determining the coincidence (i.e., correlation) between them is required in the calculation of photon arrival time at high-resolution <a ref-type=\"bibr\" anchor=\"ref23\" id=\"context_ref_23_1\">[23]</a>. In particular, the Coincidence Time Resolution (CTR) is one of the most important metrics in this regard <a ref-type=\"bibr\" anchor=\"ref24\" id=\"context_ref_24_1\">[24]</a>.</p><p>To assign a timestamp to the photons, we can use either a classic Voltage-Mode (VM) <a ref-type=\"bibr\" anchor=\"ref25\" id=\"context_ref_25_1\">[25]</a>, <a ref-type=\"bibr\" anchor=\"ref26\" id=\"context_ref_26_1\">[26]</a> or a modern Time-Mode (TM) approach <a ref-type=\"bibr\" anchor=\"ref27\" id=\"context_ref_27_1\">[27]</a>, <a ref-type=\"bibr\" anchor=\"ref28\" id=\"context_ref_28_1\">[28]</a>. A Digital Oscilloscope (DO) or a digitizer <a ref-type=\"bibr\" anchor=\"ref29\" id=\"context_ref_29_1\">[29]</a> is used to amplify and digitize the signals from the detectors in a VM method. This permits the timestamp to be recovered using proper Digital Signal Processing (DSP) techniques including oversampling and interpolation, as described in <a ref-type=\"bibr\" anchor=\"ref30\" id=\"context_ref_30_1\">[30]</a>. Additional changes to the resulting waveforms also allow for compensating of non-ideality, such as pile-up. Instead, if a TM technique is used, the signals from the detectors\u2019 output are discriminated using a Threshold Comparator (TC) or a Constant Fraction Discriminator (CFD), and then transformed directly into a timestamp using a Time-to-Digital Converter (TDC) <a ref-type=\"bibr\" anchor=\"ref31\" id=\"context_ref_31_1\">[31]</a>, <a ref-type=\"bibr\" anchor=\"ref32\" id=\"context_ref_32_1\">[32]</a>, <a ref-type=\"bibr\" anchor=\"ref33\" id=\"context_ref_33_1\">[33]</a>.</p><p>As a result, TM acquisition chains use less hardware than VM acquisition chains and are therefore preferable in multi-channel applications. Due to the inability to run DSP algorithms to account for non-ideality, we usually receive less time precision in TM systems than in VM systems. However, by interposing appropriate filters between the detector and the discriminator, we can adjust for these non-idealities and increase timing precision. In this regard, the growing number of channels in modern applications mandates the employment of TM approaches rather than VM approaches, which are now only utilized for preliminary testing.</p><p>To implement a TDC, we can use a static Application Specific Integrated Circuit (ASIC) or a programmable logic device, specifically a Field Programmable Gate Array (FPGA) <a ref-type=\"bibr\" anchor=\"ref31\" id=\"context_ref_31_1\">[31]</a>. In this regard, we must keep in mind that an ASIC TDC surpasses an FPGA solution in terms of precision and resolution at the same technological node, but it loses flexibility. In actuality, using an FPGA-based approach allows you to fine-tune the TDC\u2019s parameters (resolution, hardware occupancy, number of channels, and so on) to guarantee that the TDC is well-suited to the application. Furthermore, all of the application\u2019s processing requirements (e.g., timestamp manipulation, correlation computation, etc.) may be fulfilled directly in the FPGA employing an efficient, high-speed, and flexible parallel computing architecture <a ref-type=\"bibr\" anchor=\"ref32\" id=\"context_ref_32_1\">[32]</a>, <a ref-type=\"bibr\" anchor=\"ref33\" id=\"context_ref_33_1\">[33]</a>. This is not achievable with ASIC architectures. In fact, in order to perform correct algorithms, the gathered timestamps must be moved to an appropriate processing unit, such as a Personal Computer (PC), increasing the system complexity in terms of hardware and/or throughput. In this paper, we show that timing measurements on SNSPD (the most time-resolved detector) may be done with precision referenced to single-shot operating mode less than <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$26\\,psr.m.s$\n</tex-math></inline-formula>. up to <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$1\\,MHz$\n</tex-math></inline-formula> rate of measure at the current state-of-the-art. Furthermore, we will show how to directly measure the CTR in FPGA while also determining whether two photons detected on two different SNSPDs are in coincidence or not; with this technique, a precision of less than <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$33.4\\,psr.m.s$\n</tex-math></inline-formula>. is guaranteed up to a <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$980\\,kHz$\n</tex-math></inline-formula> coincidence rate, implying <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$7\\,Mcps$\n</tex-math></inline-formula> per detector. As a result, all of the algorithms are parallelized and hosted in the FPGA, with the PC functioning only as a monitor. The organization of the paper is as follows: in <a ref-type=\"sec\" anchor=\"sec2\" class=\"fulltext-link\">Section II</a>, we will provide the current state-of-the-art of time measurement by SNSPD. In <a ref-type=\"sec\" anchor=\"sec3\" class=\"fulltext-link\">Section III</a>, the characteristics of the employed SNSPDs are discussed, and in <a ref-type=\"sec\" anchor=\"sec4\" class=\"fulltext-link\">Section IV</a>, measurements using a VM technique are carried out and used as a reference. Sections V, VI, and VII are where the paper\u2019s core and novelty are found, with simulation of temporal jitter (<a ref-type=\"sec\" anchor=\"sec6\" class=\"fulltext-link\">Section VI</a>) and real-time CTR measurement with an FPGA-based TDC (<a ref-type=\"sec\" anchor=\"sec5\" class=\"fulltext-link\">Sections V</a> and <a ref-type=\"sec\" anchor=\"sec6\" class=\"fulltext-link\"/><a ref-type=\"sec\" anchor=\"sec7\" class=\"fulltext-link\">VII</a>). <a ref-type=\"sec\" anchor=\"sec8\" class=\"fulltext-link\">Section VIII</a> examines the relationship between measures and possible future development.</p></div>\n<div class=\"section\" id=\"sec2\"><div class=\"header article-hdr\"><div class=\"kicker\">\n\t\t                        SECTION II.</div><h2>State-Of-The-Art</h2></div><p>The SNSPD is a grid of superconducting nanowires kept at a low temperature, with bias currents (<inline-formula id=\"\"><tex-math notation=\"LaTeX\">$I_{BIAS}$\n</tex-math></inline-formula>) in the <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\mu A$\n</tex-math></inline-formula> range provided by a \u201creal\u201d current generator with impedance <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$R_{BIAS}$\n</tex-math></inline-formula>. The low temperature ensures the presence of the so-called superconducting state, in which the material has an infinite conductance and there is no voltage drop across the array. When a photon strikes a nanowire, it warms the area of impact, breaking the superconducting state, according to <a ref-type=\"bibr\" anchor=\"ref1\" id=\"context_ref_1_2\">[1]</a>. As a result, a resistance greater than zero (<inline-formula id=\"\"><tex-math notation=\"LaTeX\">$R_{SNSPD}$\n</tex-math></inline-formula>) emerges for a few <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$ps$\n</tex-math></inline-formula>, generating a pulse of a few <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$mV$\n</tex-math></inline-formula>. The cooling device then restores superconductivity by extracting the heat produced by the detected photon. A graphical depiction of the detecting technique is shown in <a ref-type=\"fig\" anchor=\"fig1\" class=\"fulltext-link\">Figure 1</a>\n<div class=\"figure figure-full\" id=\"fig1\"><!--\n          Workaround for combined images.Eg.- 1000116 Fig. 5\n        --><div class=\"img-wrap\"><a href=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973294/lusar1-3227462-large.gif\" data-fig-id=\"fig1\"><img src=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973294/lusar1-3227462-small.gif\" alt=\"FIGURE 1. - An SNSPD\u2019s bias (top) and photon detection mechanism (bottom) are depicted graphically.\"/><div class=\"zoom\" title=\"View Larger Image\"/></a></div><div class=\"figcaption\"><b class=\"title\">FIGURE 1. </b><fig><p>An SNSPD\u2019s bias (top) and photon detection mechanism (bottom) are depicted graphically.</p></fig></div><p class=\"links\"><a href=\"/document/9973294/all-figures\" class=\"all\">Show All</a></p></div></p><p>Despite the low work temperature, some thermal photons can be caught inadvertently by the SNSPD, resulting in a DCR proportional to <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$I_{BIAS}$\n</tex-math></inline-formula> of a few hundreds of <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$cps$\n</tex-math></inline-formula>. Instead, we refer to the likelihood of correctly detecting an optical photon as System Detection Efficiency (SDE); the SDE is also proportional to <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$I_{BIAS}$\n</tex-math></inline-formula> with linear dependency in the so-called \u201clinear region,\u201d where the SDE value is between 15% and 85% <a ref-type=\"bibr\" anchor=\"ref10\" id=\"context_ref_10_2\">[10]</a>.</p><p>An amplification stage (<a ref-type=\"fig\" anchor=\"fig2\" class=\"fulltext-link\">Figure 2</a>) is required to amplify the small generated pulse while also shaping it with an exponential waveform of hundreds of <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$mV$\n</tex-math></inline-formula> as amplitude (<inline-formula id=\"\"><tex-math notation=\"LaTeX\">$A$\n</tex-math></inline-formula>), a decay time constant (<inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\tau $\n</tex-math></inline-formula>) of a few <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$ns$\n</tex-math></inline-formula>, and a rise time (<inline-formula id=\"\"><tex-math notation=\"LaTeX\">$t_{RISE}$\n</tex-math></inline-formula>) as fast as possible, according to <a ref-type=\"bibr\" anchor=\"ref34\" id=\"context_ref_34_2\">[34]</a>. Using an appropriate instrumentation time-interval-meter (TIM), such as an DO and/or a TDC, it is possible to assign a timestamp to the detected photon, measuring the time instant when the exponential curve rises (<a ref-type=\"fig\" anchor=\"fig3\" class=\"fulltext-link\">Figure 3</a>).\n<div class=\"figure figure-full\" id=\"fig2\"><!--\n          Workaround for combined images.Eg.- 1000116 Fig. 5\n        --><div class=\"img-wrap\"><a href=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973294/lusar2-3227462-large.gif\" data-fig-id=\"fig2\"><img src=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973294/lusar2-3227462-small.gif\" alt=\"FIGURE 2. - The &#10;$mV$&#10; input pulse (&#10;$V_{SNSPD}$&#10;) and the exponential form as output (&#10;$V_{PULSE}$&#10;) are reported during the amplification step.\"/><div class=\"zoom\" title=\"View Larger Image\"/></a></div><div class=\"figcaption\"><b class=\"title\">FIGURE 2. </b><fig><p>The <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$mV$\n</tex-math></inline-formula> input pulse (<inline-formula id=\"\"><tex-math notation=\"LaTeX\">$V_{SNSPD}$\n</tex-math></inline-formula>) and the exponential form as output (<inline-formula id=\"\"><tex-math notation=\"LaTeX\">$V_{PULSE}$\n</tex-math></inline-formula>) are reported during the amplification step.</p></fig></div><p class=\"links\"><a href=\"/document/9973294/all-figures\" class=\"all\">Show All</a></p></div>\n<div class=\"figure figure-full\" id=\"fig3\"><!--\n          Workaround for combined images.Eg.- 1000116 Fig. 5\n        --><div class=\"img-wrap\"><a href=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973294/lusar3-3227462-large.gif\" data-fig-id=\"fig3\"><img src=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973294/lusar3-3227462-small.gif\" alt=\"FIGURE 3. - Between the SNSPD output and the LASER trigger, a block diagram of a traditional timestamp measurement is shown.\"/><div class=\"zoom\" title=\"View Larger Image\"/></a></div><div class=\"figcaption\"><b class=\"title\">FIGURE 3. </b><fig><p>Between the SNSPD output and the LASER trigger, a block diagram of a traditional timestamp measurement is shown.</p></fig></div><p class=\"links\"><a href=\"/document/9973294/all-figures\" class=\"all\">Show All</a></p></div></p><p>The jitter associated with the exponential curve with regard to the instant of photon detection is attributable, in first approximation, to the inherent jitter that impacts the SNSPD (<inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\sigma _{SNSPD}$\n</tex-math></inline-formula>) <a ref-type=\"bibr\" anchor=\"ref35\" id=\"context_ref_35_2\">[35]</a> and the electronic jitter introduced by the amplifier noise (<inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\sigma _{AMPLI}$\n</tex-math></inline-formula>) <a ref-type=\"bibr\" anchor=\"ref36\" id=\"context_ref_36_2\">[36]</a>. However, the investigation in <a ref-type=\"bibr\" anchor=\"ref37\" id=\"context_ref_37_2\">[37]</a> suggests that a third jitter contribution, the jitter of the incident photon (<inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\sigma _{PHOTON}$\n</tex-math></inline-formula>), be addressed.In fact, from a pure metrological standpoint, it is impossible to determine the instant of creation of the observed photon with infinite precision. When evaluating the SNSPD\u2019s characterization experiment, incident photons are sometimes generated by a LASER; thus, <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\sigma _{PHOTON}$\n</tex-math></inline-formula> is the jitter in comparison to the ideal trigger. As a result, we may deduce that the measured timestamp is additionally influenced by a fourth component of jitter (<inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\sigma _{MEAS}$\n</tex-math></inline-formula>) caused by the measurement procedure. The overall jitter (<inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\sigma _{TOT}$\n</tex-math></inline-formula>), according to  <a ref-type=\"disp-formula\" anchor=\"deqn1\" href=\"#deqn1\" class=\"fulltext-link\">Equation (1)</a>, is:<disp-formula id=\"deqn1\" class=\"display-formula\"><tex-math notation=\"LaTeX\">\\begin{equation*} \\sigma _{TOT}^{2}=\\sigma _{SNSPD}^{2}+\\sigma _{AMPLI}^{2}+\\sigma _{MEAS}^{2}+\\sigma _{PHOTON}^{2} \\tag{1}\\end{equation*}\n</tex-math><span class=\"formula\"><span class=\"link\">View Source</span><img aria-describedby=\"qtip-0\" style=\"display:inline;\" title=\"Right-click on figure or equation for MathML and additional features.\" data-hasqtip=\"0\" class=\"qtooltip moreInfo\" alt=\"Right-click on figure for MathML and additional features.\" src=\"/assets/img/icon.support.gif\" border=\"0\" height=\"20\" width=\"24\"/><span class=\"tex tex2jax_ignore\" style=\"display:none;\">\\begin{equation*} \\sigma _{TOT}^{2}=\\sigma _{SNSPD}^{2}+\\sigma _{AMPLI}^{2}+\\sigma _{MEAS}^{2}+\\sigma _{PHOTON}^{2} \\tag{1}\\end{equation*}\n</span></span></disp-formula></p><p>The measurement of the temporal difference of photons in coincidence over two SNSPDs (<a ref-type=\"fig\" anchor=\"fig4\" class=\"fulltext-link\">Figure 4</a>) is another important application of SNSPDs <a ref-type=\"bibr\" anchor=\"ref37\" id=\"context_ref_37_2\">[37]</a>. A source generates photons at the same moment, which are detected by two distinct SNSPDs in this situation. The spatial position where the photons were generated can be determined by measuring the difference in time of the detected photons. The precision of this measure is the so called CTR and is the standard deviation of the distribution of coincidence measurements (<inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\sigma _{CTR}$\n</tex-math></inline-formula>). In the same way as <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\sigma _{TOT}$\n</tex-math></inline-formula>, the <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\sigma _{CTR}$\n</tex-math></inline-formula> depends on the measurement process (<inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\sigma _{MEAS}$\n</tex-math></inline-formula>) and on the intrinsic and electronic jitters of the two SNSPDs, that is <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\sigma _{SNSPD,1}$\n</tex-math></inline-formula>, <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\sigma _{AMPLI,1}$\n</tex-math></inline-formula>, <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\sigma _{SNSPD,2}$\n</tex-math></inline-formula>, and <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\sigma _{AMPLI,2}$\n</tex-math></inline-formula> respectively. Precisely, <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\sigma _{PHOTONS}$\n</tex-math></inline-formula> (photons not photon as in  <a ref-type=\"disp-formula\" anchor=\"deqn1\" href=\"#deqn1\" class=\"fulltext-link\">Equation (1)</a>) defines the possible jitter between the coincidence photons that is detected by the SNSPDs due to the nature of physical generation mechanism.\n<div class=\"figure figure-full\" id=\"fig4\"><!--\n          Workaround for combined images.Eg.- 1000116 Fig. 5\n        --><div class=\"img-wrap\"><a href=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973294/lusar4-3227462-large.gif\" data-fig-id=\"fig4\"><img src=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973294/lusar4-3227462-small.gif\" alt=\"FIGURE 4. - Block diagram of the CTR.\"/><div class=\"zoom\" title=\"View Larger Image\"/></a></div><div class=\"figcaption\"><b class=\"title\">FIGURE 4. </b><fig><p>Block diagram of the CTR.</p></fig></div><p class=\"links\"><a href=\"/document/9973294/all-figures\" class=\"all\">Show All</a></p></div></p><p>This is summarized in the following equation, <disp-formula id=\"deqn2\" class=\"display-formula\"><tex-math notation=\"LaTeX\">\\begin{align*} \\sigma _{CRT}^{2}=&amp;\\sigma _{SNSPD,1}^{2}+\\sigma _{AMPLI,1}^{2} \\\\&amp;+\\, \\sigma _{SNSPD,2}^{2}+\\sigma _{AMPLI,2}^{2} \\\\&amp;+ \\, \\sigma _{MEAS}^{2}+\\sigma _{PHOTONS}^{2}\\tag{2}\\end{align*}\n</tex-math><span class=\"formula\"><span class=\"link\">View Source</span><img aria-describedby=\"qtip-0\" style=\"display:inline;\" title=\"Right-click on figure or equation for MathML and additional features.\" data-hasqtip=\"0\" class=\"qtooltip moreInfo\" alt=\"Right-click on figure for MathML and additional features.\" src=\"/assets/img/icon.support.gif\" border=\"0\" height=\"20\" width=\"24\"/><span class=\"tex tex2jax_ignore\" style=\"display:none;\">\\begin{align*} \\sigma _{CRT}^{2}=&amp;\\sigma _{SNSPD,1}^{2}+\\sigma _{AMPLI,1}^{2} \\\\&amp;+\\, \\sigma _{SNSPD,2}^{2}+\\sigma _{AMPLI,2}^{2} \\\\&amp;+ \\, \\sigma _{MEAS}^{2}+\\sigma _{PHOTONS}^{2}\\tag{2}\\end{align*}\n</span></span></disp-formula></p><p>The symmetry between the two SNSPDs makes feasible to set <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\sigma _{SNSPD,1}=\\sigma _{SNSPD,2}=\\sigma _{SNSPD}$\n</tex-math></inline-formula> and <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\sigma _{AMPLI,1}=\\sigma _{AMPLI,2}=\\sigma _{AMPLI}$\n</tex-math></inline-formula>, reducing  <a ref-type=\"disp-formula\" anchor=\"deqn2\" href=\"#deqn2\" class=\"fulltext-link\">Equation (2)</a> to <disp-formula id=\"deqn3\" class=\"display-formula\"><tex-math notation=\"LaTeX\">\\begin{align*} \\sigma _{CRT}^{2}=&amp;2\\cdot (\\sigma _{SNSPD}^{2}+\\sigma _{AMPLI}^{2}) \\\\&amp;+ \\, \\sigma _{MEAS}^{2}+\\sigma _{PHOTONS}^{2} \\tag{3}\\end{align*}\n</tex-math><span class=\"formula\"><span class=\"link\">View Source</span><img aria-describedby=\"qtip-0\" style=\"display:inline;\" title=\"Right-click on figure or equation for MathML and additional features.\" data-hasqtip=\"0\" class=\"qtooltip moreInfo\" alt=\"Right-click on figure for MathML and additional features.\" src=\"/assets/img/icon.support.gif\" border=\"0\" height=\"20\" width=\"24\"/><span class=\"tex tex2jax_ignore\" style=\"display:none;\">\\begin{align*} \\sigma _{CRT}^{2}=&amp;2\\cdot (\\sigma _{SNSPD}^{2}+\\sigma _{AMPLI}^{2}) \\\\&amp;+ \\, \\sigma _{MEAS}^{2}+\\sigma _{PHOTONS}^{2} \\tag{3}\\end{align*}\n</span></span></disp-formula></p><div class=\"section_2\" id=\"sec2a\"><h3>A. Intrinsic Jitter</h3><p>The <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$I_{BIAS}$\n</tex-math></inline-formula> <a ref-type=\"bibr\" anchor=\"ref35\" id=\"context_ref_35_2a\">[35]</a>, <a ref-type=\"bibr\" anchor=\"ref36\" id=\"context_ref_36_2a\">[36]</a>, the cooling temperature (<inline-formula id=\"\"><tex-math notation=\"LaTeX\">$T_{K}$\n</tex-math></inline-formula>) <a ref-type=\"bibr\" anchor=\"ref38\" id=\"context_ref_38_2a\">[38]</a>, the active area, a.k.a. geometry of the grid array, (<inline-formula id=\"\"><tex-math notation=\"LaTeX\">$A$\n</tex-math></inline-formula>) <a ref-type=\"bibr\" anchor=\"ref36\" id=\"context_ref_36_2a\">[36]</a>, <a ref-type=\"bibr\" anchor=\"ref39\" id=\"context_ref_39_2a\">[39]</a>, and the wavelength (<inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\lambda $\n</tex-math></inline-formula>) of the detected photon all influence the <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\sigma _{SNSPD}$\n</tex-math></inline-formula>. From an intuitive standpoint, the shorter the <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\lambda $\n</tex-math></inline-formula> or the lower the <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$T_{K}$\n</tex-math></inline-formula>, the faster the state transition from superconducting to non-superconducting, lowering the <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\sigma _{SNSPD}$\n</tex-math></inline-formula>, i.e., <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\sigma _{SNSPD}\\propto \\lambda $\n</tex-math></inline-formula> and <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\sigma _{SNSPD}\\propto T_{K}$\n</tex-math></inline-formula>. Similarly, if <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$I_{BIAS}$\n</tex-math></inline-formula> is increased or the <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$A$\n</tex-math></inline-formula> is decreased, the voltage pulse has a faster response, which reduces the inherent jitter, i.e., <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\sigma _{SNSPD}\\propto 1/I_{BIAS}$\n</tex-math></inline-formula>, and <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\sigma _{SNSPD}\\propto 1/A$\n</tex-math></inline-formula>.</p><p>In practice, SNSPDs exhibit intrinsic jitter in the range of 6 ps to 20 ps as FWHM, taking these factors into account <a ref-type=\"bibr\" anchor=\"ref40\" id=\"context_ref_40_2a\">[40]</a>.</p></div><div class=\"section_2\" id=\"sec2b\"><h3>B. Electronic Jitter</h3><p>As can be seen, <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\sigma _{AMPLI}$\n</tex-math></inline-formula> is highly dependent on the amplifier\u2019s Noise Figure (<inline-formula id=\"\"><tex-math notation=\"LaTeX\">$NF$\n</tex-math></inline-formula>), Gain (<inline-formula id=\"\"><tex-math notation=\"LaTeX\">$G$\n</tex-math></inline-formula>), and Band Width (<inline-formula id=\"\"><tex-math notation=\"LaTeX\">$BW$\n</tex-math></inline-formula>). In fact, <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\sigma _{AMPLI}$\n</tex-math></inline-formula> results in a random dispersion of the exponential\u2019s rising edge in relation to the voltage pulse in input <a ref-type=\"bibr\" anchor=\"ref41\" id=\"context_ref_41_2b\">[41]</a>. As a result, the identical input voltage pulse creates very distinct exponential waveforms, increasing the detection event\u2019s uncertainty. To reduce this dispersion, we must ensure that the output exponential shape (<inline-formula id=\"\"><tex-math notation=\"LaTeX\">$t_{RISE}$\n</tex-math></inline-formula>) has a steep rising edge, so <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\sigma _{AMPLI}\\propto 1/t_{RISE}$\n</tex-math></inline-formula>, with the highest possible Signal-to-Noise Ration (SNR) <a ref-type=\"bibr\" anchor=\"ref35\" id=\"context_ref_35_2b\">[35]</a>, which is equivalent to minimizing <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$NF$\n</tex-math></inline-formula>,<inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\sigma _{AMPLI}\\propto NF$\n</tex-math></inline-formula>, and maximizing <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$G$\n</tex-math></inline-formula>, <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\sigma _{AMPLI}\\propto 1/G$\n</tex-math></inline-formula>.</p><p>In general, we need to ensure tens of <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$dB$\n</tex-math></inline-formula> as <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$G$\n</tex-math></inline-formula>. in order to achieve the goal output amplitude of hundreds of <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$mV$\n</tex-math></inline-formula>.</p><p>To prevent collecting noise, we must select an amplifier with a <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$BW$\n</tex-math></inline-formula> that is as close as feasible to the spectrum of the input voltage pulse contained between the boundary down (<inline-formula id=\"\"><tex-math notation=\"LaTeX\">$F_{L}$\n</tex-math></inline-formula>), imputable to the the 1/f noise corner frequency (<inline-formula id=\"\"><tex-math notation=\"LaTeX\">$F_{C}$\n</tex-math></inline-formula>), and up frequencies, (<inline-formula id=\"\"><tex-math notation=\"LaTeX\">$F_{H}$\n</tex-math></inline-formula>) (<a ref-type=\"fig\" anchor=\"fig5\" class=\"fulltext-link\">Figure 5</a>). We will get a <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$t_{RISE}$\n</tex-math></inline-formula> that is inversely proportional to <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$F_{H}$\n</tex-math></inline-formula>, i.e., <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$t_{RISE}\\sim 1/F_{H}$\n</tex-math></inline-formula> <a ref-type=\"bibr\" anchor=\"ref42\" id=\"context_ref_42_2b\">[42]</a>. Using ultra-fast RF amplifiers with <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$F_{H}$\n</tex-math></inline-formula> of several <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$GHz$\n</tex-math></inline-formula>, <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$t_{RISE}$\n</tex-math></inline-formula> of hundreds of <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$ps$\n</tex-math></inline-formula> is ensured. The presence of the 1/f noise with <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$F_{C}$\n</tex-math></inline-formula> of hundreds of <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$kHz$\n</tex-math></inline-formula> impose the <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$F_{L}$\n</tex-math></inline-formula> in the same order of magnitude. In addition, even in the presence of pile-up, a minimum recovery time into the superconducting state is necessary for linearity in the count rate. In <a ref-type=\"bibr\" anchor=\"ref34\" id=\"context_ref_34_2b\">[34]</a> an upper limit of tens of <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$ns$\n</tex-math></inline-formula> for the exponential decay time constant (<inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\tau $\n</tex-math></inline-formula>) is set. Given that <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\tau $\n</tex-math></inline-formula> is inversely proportional to <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$F_{L}$\n</tex-math></inline-formula> in the first approximation, i.e. <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\tau \\sim 1/F_{L}$\n</tex-math></inline-formula>. Considering this two contribution, <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\tau $\n</tex-math></inline-formula> has upper limit of tens of <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$ns$\n</tex-math></inline-formula>.\n<div class=\"figure figure-full\" id=\"fig5\"><!--\n          Workaround for combined images.Eg.- 1000116 Fig. 5\n        --><div class=\"img-wrap\"><a href=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973294/lusar5-3227462-large.gif\" data-fig-id=\"fig5\"><img src=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973294/lusar5-3227462-small.gif\" alt=\"FIGURE 5. - The spectrum of the pulse signal produced by photon detection of a generic SNSPD (green), amplifier &#10;$BW$&#10; (gray), noise (orange), and time-domain amplified signal (blue) in three different conditions. Obviously, there are just a few alternatives for tuning these four factors. First and foremost, an SNSPD\u2019s job is to detect photons with a &#10;$\\lambda $&#10; that cannot normally be modified and is determined by the nature of the processes being studied. Furthermore, for a certain application, a minimum &#10;$A$&#10; is desired, which determines the device\u2019s geometry (i.e., thickness, fill-factor, width, and length). A preset upper limit to the &#10;$I_{BIAS}$&#10; is also set to keep the DCR low. Furthermore, there is a technological restriction to the minimum &#10;$T_{K}$&#10;.\"/><div class=\"zoom\" title=\"View Larger Image\"/></a></div><div class=\"figcaption\"><b class=\"title\">FIGURE 5. </b><fig><p>The spectrum of the pulse signal produced by photon detection of a generic SNSPD (green), amplifier <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$BW$\n</tex-math></inline-formula> (gray), noise (orange), and time-domain amplified signal (blue) in three different conditions. Obviously, there are just a few alternatives for tuning these four factors. First and foremost, an SNSPD\u2019s job is to detect photons with a <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\lambda $\n</tex-math></inline-formula> that cannot normally be modified and is determined by the nature of the processes being studied. Furthermore, for a certain application, a minimum <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$A$\n</tex-math></inline-formula> is desired, which determines the device\u2019s geometry (i.e., thickness, fill-factor, width, and length). A preset upper limit to the <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$I_{BIAS}$\n</tex-math></inline-formula> is also set to keep the DCR low. Furthermore, there is a technological restriction to the minimum <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$T_{K}$\n</tex-math></inline-formula>.</p></fig></div><p class=\"links\"><a href=\"/document/9973294/all-figures\" class=\"all\">Show All</a></p></div></p><p><a ref-type=\"fig\" anchor=\"fig6\" class=\"fulltext-link\">Figure 6</a> shows a graphical equivalence between the amplifier\u2019s output exponential and its Bode diagram for completeness. <a ref-type=\"table\" anchor=\"table1\" class=\"fulltext-link\">Table 1</a> recaps all of the amplifier\u2019s parameters in relation to their restrictions.<div class=\"figure figure-full table\" id=\"table1\"><div class=\"figcaption\"><b class=\"title\">TABLE 1 </b>\nA list of the amplifier\u2019s parameters, together with their limitations and numerical values</div><div class=\"img-wrap\"><a href=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973294/lusar.t1-3227462-large.gif\"><img src=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973294/lusar.t1-3227462-small.gif\" alt=\"Table 1- &#10;A list of the amplifier\u2019s parameters, together with their limitations and numerical values\"/><div class=\"zoom\" title=\"View Larger Image\"/></a></div></div>\n<div class=\"figure figure-full\" id=\"fig6\"><!--\n          Workaround for combined images.Eg.- 1000116 Fig. 5\n        --><div class=\"img-wrap\"><a href=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973294/lusar6-3227462-large.gif\" data-fig-id=\"fig6\"><img src=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973294/lusar6-3227462-small.gif\" alt=\"FIGURE 6. - The amplifier\u2019s output exponential and its Bode diagram are compared.\"/><div class=\"zoom\" title=\"View Larger Image\"/></a></div><div class=\"figcaption\"><b class=\"title\">FIGURE 6. </b><fig><p>The amplifier\u2019s output exponential and its Bode diagram are compared.</p></fig></div><p class=\"links\"><a href=\"/document/9973294/all-figures\" class=\"all\">Show All</a></p></div></p><p>As a result, in real-world applications, we see electronic jitter ranging from 14 to <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$45 ps$\n</tex-math></inline-formula> as FWHM <a ref-type=\"bibr\" anchor=\"ref37\" id=\"context_ref_37_2b\">[37]</a>.</p></div><div class=\"section_2\" id=\"sec2c\"><h3>C. Measurement Jitter</h3><p>The contribution of <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\sigma _{MEAS}$\n</tex-math></inline-formula> relies on the device used for timestamping, i.e. the more precise the instrument, the lower the contribution of <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\sigma _{TOT}$\n</tex-math></inline-formula> and <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\sigma _{CTR}$\n</tex-math></inline-formula>. In this instance, the rule of thumb is to use a high-precision instrument (a.k.a. <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\sigma _{MEAS}$\n</tex-math></inline-formula>), which is sigma <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\sigma _{MEAS}^{2}\\ll \\sigma _{SNSPD}^{2}+\\sigma _{AMPLI}^{2}$\n</tex-math></inline-formula> in this example. This restricts the precision requested to some <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$ps$\n</tex-math></inline-formula> in real-world applications.</p><p>Oscilloscopes and time-interval-meters are the two types of equipment we can utilize, as expected. Due to the tremendous success of digital electronics and digital signal processing, we propose to use the DO as an oscilloscope and the TDC as a time-interval-meter.</p><div class=\"section_2\" id=\"sec2c1\"><h4>1) Digital Oscilloscope</h4><p>In the case of DO, the amplifier\u2019s exponential output form is sampled as a classical analog signal with a sampling frequency <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$F_{S}$\n</tex-math></inline-formula> according to Shannon theorem (i.e.,<inline-formula id=\"\"><tex-math notation=\"LaTeX\">$F_{S}\\geq 2\\cdot F_{H}$\n</tex-math></inline-formula>). This involves working with a sampling rate of tens of <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$Gsps$\n</tex-math></inline-formula>, which translates to a timestamp resolution of only hundreds of <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$ps$\n</tex-math></inline-formula> (<inline-formula id=\"\"><tex-math notation=\"LaTeX\">$LSB$\n</tex-math></inline-formula>). In fact, the accuracy provided by a DO (<inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\sigma _{DO}$\n</tex-math></inline-formula>) is proportional, in the ideal case, to the LSB (i.e., <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\sigma _{DO}=LSB/\\sqrt {12}$\n</tex-math></inline-formula>) and in the absence of interpolation techniques <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$LSB=1/F_{S}$\n</tex-math></inline-formula>. To lower <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\sigma _{DO}$\n</tex-math></inline-formula> to a few <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$ps$\n</tex-math></inline-formula>, a digital oversampling of the collected waveform and a subsequent interpolation technique (e.g., sinc) are required.</p><p>The DO method allows you to examine the exponential structure in greater detail, but it has several limitations. To begin, at least one byte every sample is required to make the interpolation technique successful; this translates to tens of <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$GByte$\n</tex-math></inline-formula> per second of data that must be stored during the acquisition, which is thus limited in duration. Furthermore, the DO technology has a strict limit on the number of parallel channels that may be used, making this approach practical solely for detector characterization. In this regard, the TDC technique is required for the majority of applications.</p></div><div class=\"section_2\" id=\"sec2c2\"><h4>2) Time-To-Digital Converter Approach</h4><p>The exponential output form is directly translated into a timestamp at 32 or 64 bits with a few <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$ps$\n</tex-math></inline-formula> of LSB using the TDC method. In this method, no post-processing for interpolation is required, and data storage is reduced, allowing the system to run in real-time. Obviously, the shape information is completely gone.</p><p>The TDC assigns a timestamp to the input signal referring to on an internal clock (time-tagger) <a ref-type=\"bibr\" anchor=\"ref43\" id=\"context_ref_43_2c2\">[43]</a> or an external event event (start-stop), as described in <a ref-type=\"bibr\" anchor=\"ref44\" id=\"context_ref_44_2c2\">[44]</a>. The start-stop approach and are commonly used in Time Correlated Single Photon Counting (TCSPC) applications; on the other hand, the time-tagging solutions can work in continuous mode. The concept of time measurement is defined as the time elapsed between an absolute time reference, taken as \u201czero\u201d on the time axis, and the occurrence of a certain event of interest. In this case, our measurement is a \u201cTimestamp\u201d; however, we are usually more interested to carry out a time measurement as the relative \u201cTime Distance\u201d between two events, the first one being the \u201cSTART\u201d signal, and the second being the \u201cSTOP\u201d signal. Anyhow, a \u201cTimestamp\u201d is nothing but a particular case of time distance between a chosen absolute time reference, and the event under study. On the other hand, the time distance between two events is the time difference between their timestamps, each one calculated referencing to a common absolute \u201czero\u201d time origin. <a ref-type=\"fig\" anchor=\"fig7\" class=\"fulltext-link\">Figure 7</a> shows the concept just explained.\n<div class=\"figure figure-full\" id=\"fig7\"><!--\n          Workaround for combined images.Eg.- 1000116 Fig. 5\n        --><div class=\"img-wrap\"><a href=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973294/lusar7-3227462-large.gif\" data-fig-id=\"fig7\"><img src=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973294/lusar7-3227462-small.gif\" alt=\"FIGURE 7. - Graphical representation of the concepts of \u201cTimestamp\u201d and \u201cTime Distance\u201d.\"/><div class=\"zoom\" title=\"View Larger Image\"/></a></div><div class=\"figcaption\"><b class=\"title\">FIGURE 7. </b><fig><p>Graphical representation of the concepts of \u201cTimestamp\u201d and \u201cTime Distance\u201d.</p></fig></div><p class=\"links\"><a href=\"/document/9973294/all-figures\" class=\"all\">Show All</a></p></div></p><p>The primary difference between TDCs, regardless of operating mode, is in the circuit architecture and technology employed for time-to-digital conversion. In reality, we have the option of using a mixed-signal or all-digital technique. The Time-to-Amplitude Converter (TAC) <a ref-type=\"bibr\" anchor=\"ref45\" id=\"context_ref_45_2c2\">[45]</a> is the most popular and widely used mixed-signal TDC, in which the time interval is transformed into a voltage level and monitored by an Analog-to-Digital Converter (ADC). Instead, the most widely used fully-digital TDCs are based on the Delay-Line (DL), in which the time interval is quantized using the propagation delay of the logic gate that composes the DL and specifies the LSB, regardless of the individual circuit <a ref-type=\"bibr\" anchor=\"ref46\" id=\"context_ref_46_2c2\">[46]</a>.</p><p>Mixed-signal and fully-digital TDCs can both be implemented as ASIC, while fully-digital TDCs can also be implemented in FPGA devices <a ref-type=\"bibr\" anchor=\"ref47\" id=\"context_ref_47_2c2\">[47]</a>.</p><p>The designer of an ASIC solution can fine-tune all of the circuit\u2019s settings with considerable freedom in order to obtain the best performance. Modern FPGA technologies now enable for equivalent performance in a considerably shorter time-to-market while also having a far reduced overhead than an ASIC approach. The extreme high flexibility of FPGA-based systems makes them increasingly more recommended at equal accuracy levels <a ref-type=\"bibr\" anchor=\"ref48\" id=\"context_ref_48_2c2\">[48]</a>.</p></div><div class=\"section_2\" id=\"sec2c3\"><h4>3) Comparison</h4><p>Table (II), which refers to Paragraphs II-C1 and II-C2, concentrates on the advantages and disadvantages of DO and TDC techniques. Table (III) shows the precision and maximum number of parallel channels based on the SNSPD literature <a ref-type=\"bibr\" anchor=\"ref49\" id=\"context_ref_49_2c3\">[49]</a>.</p></div></div></div>\n<div class=\"section\" id=\"sec3\"><div class=\"header article-hdr\"><div class=\"kicker\">\n\t\t                        SECTION III.</div><h2>SNSPD Overview</h2></div><p>We characterized a two channels detection system provided by Single Quantum B.V. <a ref-type=\"bibr\" anchor=\"ref58\" id=\"context_ref_58_3\">[58]</a> using a LeCroy WaveRunner HRZ640i (<a ref-type=\"bibr\" anchor=\"ref59\" id=\"context_ref_59_3\">[59]</a>) as the DO (<a ref-type=\"fig\" anchor=\"fig8\" class=\"fulltext-link\">Figure 8</a>), which is made up of two channels, each of which is made up of an SNSPD followed by an amplification stage made up of a cascade of two RF Low Noise Amplifiers (LNAs), a ZTL-1000 <a ref-type=\"bibr\" anchor=\"ref60\" id=\"context_ref_60_3\">[60]</a>, and an LNA-1000 <a ref-type=\"bibr\" anchor=\"ref61\" id=\"context_ref_61_3\">[61]</a>. It is possible to adjust the <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$I_{BIAS}$\n</tex-math></inline-formula> for each SNSPD in order to properly configure the DCR and SDE.\n<div class=\"figure figure-full\" id=\"fig8\"><!--\n          Workaround for combined images.Eg.- 1000116 Fig. 5\n        --><div class=\"img-wrap\"><a href=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973294/lusar8-3227462-large.gif\" data-fig-id=\"fig8\"><img src=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973294/lusar8-3227462-small.gif\" alt=\"FIGURE 8. - SNSPD detector bundle from Single Quantum B.V. The two SNSPDs are in the cryostater, which is the red box with the gray tower, the RF amplifiers are in the black box, and the PC is used to set the bias and monitor the DCR and SDE.\"/><div class=\"zoom\" title=\"View Larger Image\"/></a></div><div class=\"figcaption\"><b class=\"title\">FIGURE 8. </b><fig><p>SNSPD detector bundle from Single Quantum B.V. The two SNSPDs are in the cryostater, which is the red box with the gray tower, the RF amplifiers are in the black box, and the PC is used to set the bias and monitor the DCR and SDE.</p></fig></div><p class=\"links\"><a href=\"/document/9973294/all-figures\" class=\"all\">Show All</a></p></div></p><p>The detector is a shaped NbTiN nanowire with a width of <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$100\\,nm$\n</tex-math></inline-formula> and a fill factor of 50. (<a ref-type=\"fig\" anchor=\"fig9\" class=\"fulltext-link\">Figure 9</a>) <a ref-type=\"bibr\" anchor=\"ref62\" id=\"context_ref_62_3\">[62]</a>. The nanowire structure has a diameter of <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$16\\,\\mu m$\n</tex-math></inline-formula> and is optically coupled to a mono-modal optical fiber with a diameter of <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$12\\,\\mu m$\n</tex-math></inline-formula>. (<a ref-type=\"fig\" anchor=\"fig9\" class=\"fulltext-link\">Figure 9</a>). The superconductor is placed on top of a resonant cavity made of a <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$135\\,nm$\n</tex-math></inline-formula> silicon-oxide layer and gold to increase the likelihood of absorbing photons at about <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$800\\,nm$\n</tex-math></inline-formula>. Because photon down-conversion sources emit in this wavelength range, this wavelength range is highly valuable for quantum research. The detector is kept at a <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$T_{K}$\n</tex-math></inline-formula> of <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$2.5\\,K$\n</tex-math></inline-formula> using a Gifford-McMahon closed-cycle cryo-cooler.\n<div class=\"figure figure-full\" id=\"fig9\"><!--\n          Workaround for combined images.Eg.- 1000116 Fig. 5\n        --><div class=\"img-wrap\"><a href=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973294/lusar9-3227462-large.gif\" data-fig-id=\"fig9\"><img src=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973294/lusar9-3227462-small.gif\" alt=\"FIGURE 9. - Picture of SNSPD with optical coupling from SNSPD (diameter &#10;$16\\,\\mu m$&#10;) to the optical fiber (diameter &#10;$12\\,\\mu m$&#10;).\"/><div class=\"zoom\" title=\"View Larger Image\"/></a></div><div class=\"figcaption\"><b class=\"title\">FIGURE 9. </b><fig><p>Picture of SNSPD with optical coupling from SNSPD (diameter <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$16\\,\\mu m$\n</tex-math></inline-formula>) to the optical fiber (diameter <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$12\\,\\mu m$\n</tex-math></inline-formula>).</p></fig></div><p class=\"links\"><a href=\"/document/9973294/all-figures\" class=\"all\">Show All</a></p></div></p><p>The SNSPD, with its <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$I_{BIAS}$\n</tex-math></inline-formula> current generator, is at the input of the amplification stage. When photon detection occurs, the SNSPD\u2019s load impedance (i.e., <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$R_{BIAS}\\Vert R_{SNSPD}\\sim k\\Omega $\n</tex-math></inline-formula>) is greater than the amplifier\u2019s input impedance (<inline-formula id=\"\"><tex-math notation=\"LaTeX\">$Z_{IN}\\sim 50\\,\\Omega $\n</tex-math></inline-formula>); as a result, <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$I_{BIAS}$\n</tex-math></inline-formula> is deviated from the SNSPD to the amplifier, which generates the voltage pulse <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$Z_{IN}\\cdot I_{BIAS}$\n</tex-math></inline-formula>.</p><p>About the RF amplifiers; the ZTL-1000 features <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$G_{ZTL}^{dB}$\n</tex-math></inline-formula> of <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$17\\,dB$\n</tex-math></inline-formula>, <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$NF_{ZTL}^{dB}$\n</tex-math></inline-formula> of <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$6\\,dB$\n</tex-math></inline-formula>, <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$Z_{IN}$\n</tex-math></inline-formula> of <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$50\\,\\Omega $\n</tex-math></inline-formula>, an output impedance (<inline-formula id=\"\"><tex-math notation=\"LaTeX\">$Z_{OUT}$\n</tex-math></inline-formula>) of <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$50\\,\\Omega $\n</tex-math></inline-formula>, <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$F_{L}$\n</tex-math></inline-formula> of <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$0.1\\,MHz$\n</tex-math></inline-formula>, and <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$F_{H}$\n</tex-math></inline-formula> of <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$1\\,GHz$\n</tex-math></inline-formula>. Instead, the LNA-1000 has <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$G_{LNA}^{dB}$\n</tex-math></inline-formula> of <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$33\\,dB$\n</tex-math></inline-formula>, <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$NF_{LNA}^{dB}$\n</tex-math></inline-formula> of <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$2\\,dB$\n</tex-math></inline-formula>, <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$Z_{IN}$\n</tex-math></inline-formula> and <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$Z_{OUT}$\n</tex-math></inline-formula> of <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$50\\,\\Omega $\n</tex-math></inline-formula>, <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$F_{L}$\n</tex-math></inline-formula> of <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$10\\,MHz$\n</tex-math></inline-formula>, and <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$F_{H}$\n</tex-math></inline-formula> of <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$1\\,GHz$\n</tex-math></inline-formula>. As a result, overall <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$G$\n</tex-math></inline-formula> of <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$50\\,dB$\n</tex-math></inline-formula> (i.e., <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$G_{TOT}^{dB}=G_{ZTL}^{dB}+G_{LNA}^{dB}$\n</tex-math></inline-formula>) and <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$NF$\n</tex-math></inline-formula> of <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$5\\,dB$\n</tex-math></inline-formula> (i.e., <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$NF_{TOT}=NF_{ZTL}+NF_{LNA}/G_{ZTL}$\n</tex-math></inline-formula>) are obtained preserving a <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$Z_{IN}$\n</tex-math></inline-formula> and <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$Z_{OUT}$\n</tex-math></inline-formula> of <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$50\\,\\Omega $\n</tex-math></inline-formula>. The <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$BW$\n</tex-math></inline-formula> is limited between <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$10\\,MHz$\n</tex-math></inline-formula> and <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$1\\,GHz$\n</tex-math></inline-formula> as <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$F_{L}$\n</tex-math></inline-formula> and <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$F_{H}$\n</tex-math></inline-formula>, respectively; this is owing, to a first approximation, to the limiting element, the LNA-1000.</p><p>Finally, we have created a Simulink model of the SNSPD (Paragraph III-B).</p><div class=\"section_2\" id=\"sec3a\"><h3>A. SNSPD Description and Characterization</h3><p>The calibration curve, SDE vs <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$I_{BIAS}$\n</tex-math></inline-formula>, is measured (using photons with <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\lambda $\n</tex-math></inline-formula> of <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$750\\,ns$\n</tex-math></inline-formula>) to determine the SNSPD\u2019s working point.</p><p>With a <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$I_{BIAS}$\n</tex-math></inline-formula> of <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$17\\,\\mu A$\n</tex-math></inline-formula>, the SNSPD achieves the saturation with a SDE of 80.7%; so, a \u201clinear region\u201d operating point at <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$I_{BIAS}$\n</tex-math></inline-formula> of <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$14\\,\\mu A$\n</tex-math></inline-formula> with a SDE of 70% is choose. This SED consider the SPSPD\u2019s deception efficiency and all the optical losses.</p><p>A Ti:Sapphire LASER with a repetition rate (<inline-formula id=\"\"><tex-math notation=\"LaTeX\">$F_{LASER}$\n</tex-math></inline-formula>) of <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$76\\,MHz$\n</tex-math></inline-formula>, a pulse width of <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$6\\,ps$\n</tex-math></inline-formula>, and a <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\lambda $\n</tex-math></inline-formula> of <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$750\\,nm$\n</tex-math></inline-formula> was then used to illuminate the SNSPD. As a result, the waveform at the detection system\u2019s output is sampled (<a ref-type=\"fig\" anchor=\"fig10\" class=\"fulltext-link\">Figure 10</a>). An exponential shape with a <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\tau $\n</tex-math></inline-formula> of <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$14\\,ns$\n</tex-math></inline-formula> (i.e., <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\tau \\sim 1/F_{L}=1/10\\,MHz=10\\,ns$\n</tex-math></inline-formula>), rising time <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$t_{RISE}$\n</tex-math></inline-formula> of <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$2\\,ns$\n</tex-math></inline-formula> (i.e., <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\tau \\sim 1/F_{H}=1/1\\,GHz=1\\,ns$\n</tex-math></inline-formula>), and amplitude (<inline-formula id=\"\"><tex-math notation=\"LaTeX\">$A$\n</tex-math></inline-formula>) of <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\sim 500\\,mV$\n</tex-math></inline-formula> (i.e., <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$A\\sim (50\\Omega \\cdot I_{BIAS})\\,\\,G_{TOT}=(50\\Omega \\cdot 14\\mu A)\\,\\,10^{50/20}=221\\,mV$\n</tex-math></inline-formula>) is measured, as predicted by the theory.\n<div class=\"figure figure-full\" id=\"fig10\"><!--\n          Workaround for combined images.Eg.- 1000116 Fig. 5\n        --><div class=\"img-wrap\"><a href=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973294/lusar10-3227462-large.gif\" data-fig-id=\"fig10\"><img src=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973294/lusar10-3227462-small.gif\" alt=\"FIGURE 10. - Image of the signal at the SPSPD\u2019s amplification system\u2019s output.\"/><div class=\"zoom\" title=\"View Larger Image\"/></a></div><div class=\"figcaption\"><b class=\"title\">FIGURE 10. </b><fig><p>Image of the signal at the SPSPD\u2019s amplification system\u2019s output.</p></fig></div><p class=\"links\"><a href=\"/document/9973294/all-figures\" class=\"all\">Show All</a></p></div></p></div><div class=\"section_2\" id=\"sec3b\"><h3>B. SNSPD Simulink Simulation</h3><p>The SNSPD detection system is recreated in the Simulink environment using the information obtained in Paragraph III-A. To begin, the LASER is simulated using a delta-comb generator with a period <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$T_{LASER}=1/F_{LASER}$\n</tex-math></inline-formula> of <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$1/76\\,MHz\\cong 13.128\\,ns$\n</tex-math></inline-formula> and active time (<inline-formula id=\"\"><tex-math notation=\"LaTeX\">$T_{ON}$\n</tex-math></inline-formula>) of <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$6\\,ps$\n</tex-math></inline-formula>. The SNSPD\u2019s detection efficiency is replicated using a random generator that generates a number <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$n$\n</tex-math></inline-formula> between 0 and 100 and suppresses the delta-comb if <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$n$\n</tex-math></inline-formula> is greater than the SDE (<inline-formula id=\"\"><tex-math notation=\"LaTeX\">$n&gt;SDE$\n</tex-math></inline-formula>). The SNSPD is modeled using a first-order system with a thermal <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\tau $\n</tex-math></inline-formula> of <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$100\\,ps$\n</tex-math></inline-formula>, which reflects the time it takes to regain the superconducting state.</p><p>The S-parameter model given by Minicircuit (ZTL-100) and RF BAY Inc is used to simulate the two amplifiers (LNA-100). In this method, the LASER is represented by a digital trigger, and the SNSPD is represented by an exponential form.</p><p><a ref-type=\"fig\" anchor=\"fig11\" class=\"fulltext-link\">Figure 11</a> depicts the simulation model\u2019s block architecture, while <a ref-type=\"fig\" anchor=\"fig12\" class=\"fulltext-link\">Figure 12</a> depicts a comparison of the emulated exponential output with respect to the genuine one.\n<div class=\"figure figure-full\" id=\"fig11\"><!--\n          Workaround for combined images.Eg.- 1000116 Fig. 5\n        --><div class=\"img-wrap\"><a href=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973294/lusar11-3227462-large.gif\" data-fig-id=\"fig11\"><img src=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973294/lusar11-3227462-small.gif\" alt=\"FIGURE 11. - This Simulink simulation model shows photon detection emulation, two amplifiers, the TIM for timestamp measurement, and the scope for acquiring \u201canalog\u201d waveforms.\"/><div class=\"zoom\" title=\"View Larger Image\"/></a></div><div class=\"figcaption\"><b class=\"title\">FIGURE 11. </b><fig><p>This Simulink simulation model shows photon detection emulation, two amplifiers, the TIM for timestamp measurement, and the scope for acquiring \u201canalog\u201d waveforms.</p></fig></div><p class=\"links\"><a href=\"/document/9973294/all-figures\" class=\"all\">Show All</a></p></div>\n<div class=\"figure figure-full\" id=\"fig12\"><!--\n          Workaround for combined images.Eg.- 1000116 Fig. 5\n        --><div class=\"img-wrap\"><a href=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973294/lusar12-3227462-large.gif\" data-fig-id=\"fig12\"><img src=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973294/lusar12-3227462-small.gif\" alt=\"FIGURE 12. - In this comparison, the simulated exponential output is compared to the real one.\"/><div class=\"zoom\" title=\"View Larger Image\"/></a></div><div class=\"figcaption\"><b class=\"title\">FIGURE 12. </b><fig><p>In this comparison, the simulated exponential output is compared to the real one.</p></fig></div><p class=\"links\"><a href=\"/document/9973294/all-figures\" class=\"all\">Show All</a></p></div></p></div></div>\n<div class=\"section\" id=\"sec4\"><div class=\"header article-hdr\"><div class=\"kicker\">\n\t\t                        SECTION IV.</div><h2>SNSPD Timestamping with Oscilloscope</h2></div><p>A traditional timestamping with a LeCroy WaveRunner 640i as DO operating at 40 GSs and 8-bit, as a first step, before using the fully-digital solution described in <a ref-type=\"sec\" anchor=\"sec5\" class=\"fulltext-link\">Section V</a> is done. The SNSPD versus LASER characterization is shown in Paragraph (IV-A), and the CTR between two SNSPDs induced by the same LASER is evaluated in Paragraph V.</p><div class=\"section_2\" id=\"sec4a\"><h3>A. SNSPD VS Laser</h3><p>The jitter between the SNSPD and the LASER (<a ref-type=\"fig\" anchor=\"fig3\" class=\"fulltext-link\">Figure 3</a>, where TIM we used a LeCroy WaveRunner 640i scope) yields a Gaussian shape with a standard deviation of <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$19.84\\,ps\\,r.m.s$\n</tex-math></inline-formula>. (i.e., FWHM of <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$44.27\\,ps$\n</tex-math></inline-formula>) that represents <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\sigma _{TOT}$\n</tex-math></inline-formula> stated in  <a ref-type=\"disp-formula\" anchor=\"deqn1\" href=\"#deqn1\" class=\"fulltext-link\">Equation (1)</a>. To do this, the skew between the SNSPD\u2019s analog waveform and the LASER acquired with the DO was measured, and a sinc interpolation was used to provide the maximum possible precision. After that, a statistically significant amount of measurements was used to create a histogram. In this method, we were able to replicate the measurement result reported in <a ref-type=\"table\" anchor=\"table4\" class=\"fulltext-link\">Table 4</a> and in <a ref-type=\"bibr\" anchor=\"ref56\" id=\"context_ref_56_4a\">[56]</a>.<div class=\"figure figure-full table\" id=\"table2\"><div class=\"figcaption\"><b class=\"title\">TABLE 2 </b>\nIn SNSPD timestamp acquisition, the advantages and disadvantages of the DO and TDC approaches are compared</div><div class=\"img-wrap\"><a href=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973294/lusar.t2-3227462-large.gif\"><img src=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973294/lusar.t2-3227462-small.gif\" alt=\"Table 2- &#10;In SNSPD timestamp acquisition, the advantages and disadvantages of the DO and TDC approaches are compared\"/><div class=\"zoom\" title=\"View Larger Image\"/></a></div></div><div class=\"figure figure-full table\" id=\"table3\"><div class=\"figcaption\"><b class=\"title\">TABLE 3 </b>\nOn SNSPD-related literature, precision (\n$\\sigma_{MEAS}$\n) and maximum number of parallel acquisitions (\n$N_{CH}$\n) were done</div><div class=\"img-wrap\"><a href=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973294/lusar.t3-3227462-large.gif\"><img src=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973294/lusar.t3-3227462-small.gif\" alt=\"Table 3- &#10;On SNSPD-related literature, precision (&#10;$\\sigma_{MEAS}$&#10;) and maximum number of parallel acquisitions (&#10;$N_{CH}$&#10;) were done\"/><div class=\"zoom\" title=\"View Larger Image\"/></a></div></div><div class=\"figure figure-full table\" id=\"table4\"><div class=\"figcaption\"><b class=\"title\">TABLE 4 </b>\nIn [56] Equation (5) is used to reproduce the measurement results exposed by Single Quantum</div><div class=\"img-wrap\"><a href=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973294/lusar.t4-3227462-large.gif\"><img src=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973294/lusar.t4-3227462-small.gif\" alt=\"Table 4- &#10;In [56] Equation (5) is used to reproduce the measurement results exposed by Single Quantum\"/><div class=\"zoom\" title=\"View Larger Image\"/></a></div></div></p><p>Furthermore, as illustrated in <a ref-type=\"fig\" anchor=\"fig13\" class=\"fulltext-link\">Figure 13</a>, the pile-up of exponential pulses has caused a baseline fluctuation. In reality, there is superposition and consequently distortion of the <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$n-th$\n</tex-math></inline-formula> SNSPD\u2019s exponential curve starts before the tail of the (<inline-formula id=\"\"><tex-math notation=\"LaTeX\">$n-1)-th$\n</tex-math></inline-formula> curve terminates, which is around <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$5\\tau \\cong 5\\cdot 14\\,ns=70\\,ns$\n</tex-math></inline-formula> long. In this case, as shown in <a ref-type=\"fig\" anchor=\"fig14\" class=\"fulltext-link\">Figure 14</a>, generating a timestamp when the SNSPD waveform crosses a specified threshold causes a walk-error. Because the SNSPD randomly triggers on the LASER pulse, the baseline fluctuation is also a random variable with a standard deviation of <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\sigma _{BASE}$\n</tex-math></inline-formula>. As a result, the walk-error is random and is defined by the standard deviation <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\sigma _{WALK}$\n</tex-math></inline-formula>, which has an impact on the slope (<inline-formula id=\"\"><tex-math notation=\"LaTeX\">$Sl$\n</tex-math></inline-formula>) during the rising edge of the exponential shape of the SNSPD (i.e., <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$Sl=A/t_{RISE}$\n</tex-math></inline-formula>) and, obviously,on <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\sigma _{BASE}$\n</tex-math></inline-formula>,as shown by the relationship <disp-formula id=\"deqn4\" class=\"display-formula\"><tex-math notation=\"LaTeX\">\\begin{equation*} \\sigma _{WALK}=\\frac {\\sigma _{BASE}}{Sl} \\tag{4}\\end{equation*}\n</tex-math><span class=\"formula\"><span class=\"link\">View Source</span><img aria-describedby=\"qtip-0\" style=\"display:inline;\" title=\"Right-click on figure or equation for MathML and additional features.\" data-hasqtip=\"0\" class=\"qtooltip moreInfo\" alt=\"Right-click on figure for MathML and additional features.\" src=\"/assets/img/icon.support.gif\" border=\"0\" height=\"20\" width=\"24\"/><span class=\"tex tex2jax_ignore\" style=\"display:none;\">\\begin{equation*} \\sigma _{WALK}=\\frac {\\sigma _{BASE}}{Sl} \\tag{4}\\end{equation*}\n</span></span></disp-formula>\n<div class=\"figure figure-full\" id=\"fig13\"><!--\n          Workaround for combined images.Eg.- 1000116 Fig. 5\n        --><div class=\"img-wrap\"><a href=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973294/lusar13-3227462-large.gif\" data-fig-id=\"fig13\"><img src=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973294/lusar13-3227462-small.gif\" alt=\"FIGURE 13. - The pile-up effect of the SNSPD\u2019s exponential output causes baseline fluctuation.\"/><div class=\"zoom\" title=\"View Larger Image\"/></a></div><div class=\"figcaption\"><b class=\"title\">FIGURE 13. </b><fig><p>The pile-up effect of the SNSPD\u2019s exponential output causes baseline fluctuation.</p></fig></div><p class=\"links\"><a href=\"/document/9973294/all-figures\" class=\"all\">Show All</a></p></div>\n<div class=\"figure figure-full\" id=\"fig14\"><!--\n          Workaround for combined images.Eg.- 1000116 Fig. 5\n        --><div class=\"img-wrap\"><a href=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973294/lusar14-3227462-large.gif\" data-fig-id=\"fig14\"><img src=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973294/lusar14-3227462-small.gif\" alt=\"FIGURE 14. - The walk-error induced by the pile-up phenomenon is represented here.\"/><div class=\"zoom\" title=\"View Larger Image\"/></a></div><div class=\"figcaption\"><b class=\"title\">FIGURE 14. </b><fig><p>The walk-error induced by the pile-up phenomenon is represented here.</p></fig></div><p class=\"links\"><a href=\"/document/9973294/all-figures\" class=\"all\">Show All</a></p></div></p><p>In this sense, the oscilloscope\u2019s <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\sigma _{MEAS}$\n</tex-math></inline-formula> is made up of two parts: <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\sigma _{WALK}$\n</tex-math></inline-formula>, which is due to the baseline and is transformed to time by the discrimination algorithm, and <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\sigma _{DO}$\n</tex-math></inline-formula>, which is the quantization error of the DO; i.e., <disp-formula id=\"deqn5\" class=\"display-formula\"><tex-math notation=\"LaTeX\">\\begin{equation*} \\sigma _{MEAS}^{2}=\\sigma _{WALK}^{2}+\\sigma _{DO}^{2} \\tag{5}\\end{equation*}\n</tex-math><span class=\"formula\"><span class=\"link\">View Source</span><img aria-describedby=\"qtip-0\" style=\"display:inline;\" title=\"Right-click on figure or equation for MathML and additional features.\" data-hasqtip=\"0\" class=\"qtooltip moreInfo\" alt=\"Right-click on figure for MathML and additional features.\" src=\"/assets/img/icon.support.gif\" border=\"0\" height=\"20\" width=\"24\"/><span class=\"tex tex2jax_ignore\" style=\"display:none;\">\\begin{equation*} \\sigma _{MEAS}^{2}=\\sigma _{WALK}^{2}+\\sigma _{DO}^{2} \\tag{5}\\end{equation*}\n</span></span></disp-formula></p><p>Inserting <a ref-type=\"disp-formula\" anchor=\"deqn4\" href=\"#deqn4\" class=\"fulltext-link\">Equations (4)</a> and <a ref-type=\"disp-formula\" anchor=\"deqn5\" href=\"#deqn5\" class=\"fulltext-link\">(5)</a> in  <a ref-type=\"disp-formula\" anchor=\"deqn1\" href=\"#deqn1\" class=\"fulltext-link\">Equation (1)</a>, we get <disp-formula id=\"deqn6\" class=\"display-formula\"><tex-math notation=\"LaTeX\">\\begin{align*} \\sigma _{TOT}^{2}=&amp;\\sigma _{SNSPD}^{2}+\\sigma _{AMPLI}^{2} \\\\&amp;+ \\, \\left({\\frac {\\sigma _{BASE}}{Sl}}\\right)^{2}+\\sigma _{DO}^{2}+\\sigma _{PHOTON}^{2} \\tag{6}\\end{align*}\n</tex-math><span class=\"formula\"><span class=\"link\">View Source</span><img aria-describedby=\"qtip-0\" style=\"display:inline;\" title=\"Right-click on figure or equation for MathML and additional features.\" data-hasqtip=\"0\" class=\"qtooltip moreInfo\" alt=\"Right-click on figure for MathML and additional features.\" src=\"/assets/img/icon.support.gif\" border=\"0\" height=\"20\" width=\"24\"/><span class=\"tex tex2jax_ignore\" style=\"display:none;\">\\begin{align*} \\sigma _{TOT}^{2}=&amp;\\sigma _{SNSPD}^{2}+\\sigma _{AMPLI}^{2} \\\\&amp;+ \\, \\left({\\frac {\\sigma _{BASE}}{Sl}}\\right)^{2}+\\sigma _{DO}^{2}+\\sigma _{PHOTON}^{2} \\tag{6}\\end{align*}\n</span></span></disp-formula></p><p>In this method, the baseline fluctuation is suppressed using a digital baseline restoration algorithm that implements a correct discrimination to detect the timestamp compensating the <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\sigma _{BASE}$\n</tex-math></inline-formula> (i.e., <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\sigma _{WALK}\\longrightarrow 0\\,ps\\,r.m.s$\n</tex-math></inline-formula>.) to achieve the highest level of precision possible. Furthermore, because to a higher probability of pile-up, the size of the baseline is proportional to the count-rate on the SNSPD (<inline-formula id=\"\"><tex-math notation=\"LaTeX\">$R_{SNSPD}$\n</tex-math></inline-formula>), as you might expect. To confirm this, we measured <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\sigma _{BASE}$\n</tex-math></inline-formula> and <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$Sl$\n</tex-math></inline-formula> as function of <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$R_{SNSPD}$\n</tex-math></inline-formula> using the DO in a range of 18 to <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$200 kHz$\n</tex-math></inline-formula>, observing an increase in <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\sigma _{BASE}$\n</tex-math></inline-formula>; the results are shown in <a ref-type=\"table\" anchor=\"table5\" class=\"fulltext-link\">Table 5</a>.<div class=\"figure figure-full table\" id=\"table5\"><div class=\"figcaption\"><b class=\"title\">TABLE 5 </b>\nThe \n$\\sigma_{BASE}$\n and \n$Sl$\n measurements as function of the \n$R_{SNSPD}$\n, and \n$\\sigma_{WALK}$\n computation as represented in  Equation (4)</div><div class=\"img-wrap\"><a href=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973294/lusar.t5-3227462-large.gif\"><img src=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973294/lusar.t5-3227462-small.gif\" alt=\"Table 5- &#10;The &#10;$\\sigma_{BASE}$&#10; and &#10;$Sl$&#10; measurements as function of the &#10;$R_{SNSPD}$&#10;, and &#10;$\\sigma_{WALK}$&#10; computation as represented in  Equation (4)\"/><div class=\"zoom\" title=\"View Larger Image\"/></a></div></div></p><p>Due to some non-ideality in the estimation of <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\sigma _{SNSPD}$\n</tex-math></inline-formula>, <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\sigma _{AMPLI}$\n</tex-math></inline-formula>, <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\sigma _{DO}$\n</tex-math></inline-formula>, and the suppression of <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\sigma _{WALK}$\n</tex-math></inline-formula>, <a ref-type=\"table\" anchor=\"table4\" class=\"fulltext-link\">Table 4</a> reveals a non-perfect agreement between <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\sigma _{TOT}$\n</tex-math></inline-formula> (<inline-formula id=\"\"><tex-math notation=\"LaTeX\">$19.84\\,ps\\,r.m.s$\n</tex-math></inline-formula>.) and  <a ref-type=\"disp-formula\" anchor=\"deqn5\" href=\"#deqn5\" class=\"fulltext-link\">Equation (5)</a> (i.e., <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\sqrt {8^{2}+14^{2}+0+2^{2}+6^{2}}=17.3ps\\,r.m.s$\n</tex-math></inline-formula>.). The discrepancy between the predicted value <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$17.3ps\\,r.m.s$\n</tex-math></inline-formula>. and the actual value <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$19.84\\,ps\\,r.m.s$\n</tex-math></inline-formula>. yields a quadratic error of <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\sqrt {19.84^{2}-17.3^{2}}=7.46ps\\,r.m.s$\n</tex-math></inline-formula>.</p></div><div class=\"section_2\" id=\"sec4b\"><h3>B. SNSPD VS SNSPD</h3><p>We next measured the CTR between two SNSPDs triggered by the same LASER pulse using the LeCroy WaveRunner 640i as DO (<a ref-type=\"fig\" anchor=\"fig4\" class=\"fulltext-link\">Figure 4</a>) tuning on the baseline restore method. Unfortunately, because of the random nature of SNSPDs, real-time activation is difficult. In fact, in order to consider only the SNSPD numbers 1 and 2 in coincidence with the LASER, we must obtain all timestamps and execute post-processing elaboration as shown in <a ref-type=\"fig\" anchor=\"fig15\" class=\"fulltext-link\">Figure 15</a>. The result of the CTR count-rate (<inline-formula id=\"\"><tex-math notation=\"LaTeX\">$R_{CTR}$\n</tex-math></inline-formula>) in the range of <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$1.2\\,cps$\n</tex-math></inline-formula> to <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$720\\,cps$\n</tex-math></inline-formula> is reported in <a ref-type=\"table\" anchor=\"table6\" class=\"fulltext-link\">Table 6</a>. Count-rates in the range of <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$6.8\\,kcps$\n</tex-math></inline-formula> and <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$200\\,kcps$\n</tex-math></inline-formula> are sought over the two SNSPDs, number 1 and 2 (<inline-formula id=\"\"><tex-math notation=\"LaTeX\">$R_{SNSPD,1}$\n</tex-math></inline-formula> and <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$R_{SNSPD,2}$\n</tex-math></inline-formula> respectively) to guarantee this <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$R_{CTR}$\n</tex-math></inline-formula>.<div class=\"figure figure-full table\" id=\"table6\"><div class=\"figcaption\"><b class=\"title\">TABLE 6 </b>\nMeasured \n$\\sigma_{CTR}$\n corresponding to different \n$R_{SNSPD,1}$\n, \n$R_{SNSPD,2}$\n, and \n$R_{CTR}$\n performed in post-processing with the DO</div><div class=\"img-wrap\"><a href=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973294/lusar.t6-3227462-large.gif\"><img src=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973294/lusar.t6-3227462-small.gif\" alt=\"Table 6- &#10;Measured &#10;$\\sigma_{CTR}$&#10; corresponding to different &#10;$R_{SNSPD,1}$&#10;, &#10;$R_{SNSPD,2}$&#10;, and &#10;$R_{CTR}$&#10; performed in post-processing with the DO\"/><div class=\"zoom\" title=\"View Larger Image\"/></a></div></div>\n<div class=\"figure figure-full\" id=\"fig15\"><!--\n          Workaround for combined images.Eg.- 1000116 Fig. 5\n        --><div class=\"img-wrap\"><a href=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973294/lusar15-3227462-large.gif\" data-fig-id=\"fig15\"><img src=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973294/lusar15-3227462-small.gif\" alt=\"FIGURE 15. - The CTR measurement is graphically depicted.\"/><div class=\"zoom\" title=\"View Larger Image\"/></a></div><div class=\"figcaption\"><b class=\"title\">FIGURE 15. </b><fig><p>The CTR measurement is graphically depicted.</p></fig></div><p class=\"links\"><a href=\"/document/9973294/all-figures\" class=\"all\">Show All</a></p></div></p><p>To compute the CTR in practice, we must apply the statistic to a large number of skews computed between two detected coincidence events over the SNSPDs and extract the standard deviation (<inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\sigma $\n</tex-math></inline-formula>). To accomplish so, an acquisition time (<inline-formula id=\"\"><tex-math notation=\"LaTeX\">$T_{ACQ}$\n</tex-math></inline-formula>) of a few minutes was required in order to collect at least <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\sim 10^{4}$\n</tex-math></inline-formula> of coincidence events (<inline-formula id=\"\"><tex-math notation=\"LaTeX\">$N_{CRT}$\n</tex-math></inline-formula>) (i.e., <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$N_{CRT}=T_{ACQ}\\cdot R_{CRT}$\n</tex-math></inline-formula>). When we consider the <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$F_{S}$\n</tex-math></inline-formula>of <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$40\\,GHz$\n</tex-math></inline-formula> and the size of each single sample (<inline-formula id=\"\"><tex-math notation=\"LaTeX\">$1\\,Byte$\n</tex-math></inline-formula>), we can calculate that for SNSPD #1 and #2, we need to acquire a total of <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$N_{SNSPD,1}=F_{S}\\cdot T_{ACQ}$\n</tex-math></inline-formula> and <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$N_{SNSPD,2}=F_{S}\\cdot T_{ACQ}$\n</tex-math></inline-formula> samples, which corresponding to <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$4.68\\,TByte$\n</tex-math></inline-formula> for each minute of acquisition (i.e., <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$(N_{SNSPD,1}+N_{SNSPD,2})\\cdot (1\\,Byte)\\cdot (60\\,sec/minute)$\n</tex-math></inline-formula>). As a result, the proposed approach is incompatible with real-time applications. TDC timestamping was introduced to enable real-time measurement.</p><p>To change <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$R_{SNSPD,1}$\n</tex-math></inline-formula> and <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$R_{SNSPD,2}$\n</tex-math></inline-formula> while maintaining the <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$I_{BIAS}$\n</tex-math></inline-formula> of the SNSPDs constant, an appropriate optical programmable attenuator with a value of <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$A^{dB}$\n</tex-math></inline-formula> is placed between the LASER and the SNSPDs, reducing the quantity of photons and, as a result, the count-rates.</p><p>We may state that, using <a ref-type=\"disp-formula\" anchor=\"deqn3\" href=\"#deqn3\" class=\"fulltext-link\">Equations (3)</a>, <a ref-type=\"disp-formula\" anchor=\"deqn4\" href=\"#deqn4\" class=\"fulltext-link\">(4)</a>, <a ref-type=\"disp-formula\" anchor=\"deqn5\" href=\"#deqn5\" class=\"fulltext-link\">(5)</a>, and the same method used in Paragraph IV-A, <disp-formula id=\"deqn7\" class=\"display-formula\"><tex-math notation=\"LaTeX\">\\begin{align*} \\sigma _{CTR}^{2}=&amp;2\\cdot (\\sigma _{SNSPD}^{2}+\\sigma _{AMPLI}^{2}) \\\\&amp;+ \\, \\left({\\frac {\\sigma _{BASE}}{Sl}}\\right)^{2}+\\sigma _{DO}^{2}+\\sigma _{PHOTONS}^{2} \\tag{7}\\end{align*}\n</tex-math><span class=\"formula\"><span class=\"link\">View Source</span><img aria-describedby=\"qtip-0\" style=\"display:inline;\" title=\"Right-click on figure or equation for MathML and additional features.\" data-hasqtip=\"0\" class=\"qtooltip moreInfo\" alt=\"Right-click on figure for MathML and additional features.\" src=\"/assets/img/icon.support.gif\" border=\"0\" height=\"20\" width=\"24\"/><span class=\"tex tex2jax_ignore\" style=\"display:none;\">\\begin{align*} \\sigma _{CTR}^{2}=&amp;2\\cdot (\\sigma _{SNSPD}^{2}+\\sigma _{AMPLI}^{2}) \\\\&amp;+ \\, \\left({\\frac {\\sigma _{BASE}}{Sl}}\\right)^{2}+\\sigma _{DO}^{2}+\\sigma _{PHOTONS}^{2} \\tag{7}\\end{align*}\n</span></span></disp-formula> where <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\sigma _{PHOTONS}$\n</tex-math></inline-formula> is the jitter between the two correlated emitted photons (a.k.a., photons in coincidence) that will be detected by the SNPSDs for the CTR estimation, as opposed to <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\sigma _{PHOTON}$\n</tex-math></inline-formula>, which is the jitter between the LASER and its trigger (i.e., <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$6\\,ps\\,r.m.s.$\n</tex-math></inline-formula>). We can examine <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\sigma _{PHOTOS}\\rightarrow 0$\n</tex-math></inline-formula> in our experimental setup, where the correlated photons are created via a beam splitter.  <a ref-type=\"disp-formula\" anchor=\"deqn7\" href=\"#deqn7\" class=\"fulltext-link\">Equation (7)</a> becomes, in this case.<disp-formula id=\"deqn8\" class=\"display-formula\"><tex-math notation=\"LaTeX\">\\begin{align*} \\sigma _{CTR}^{2}=&amp;2\\cdot (\\sigma _{SNSPD}^{2}+\\sigma _{AMPLI}^{2}) \\\\&amp;+ \\, \\left({\\frac {\\sigma _{BASE}}{Sl}}\\right)^{2}+\\sigma _{DO}^{2} \\tag{8}\\end{align*}\n</tex-math><span class=\"formula\"><span class=\"link\">View Source</span><img aria-describedby=\"qtip-0\" style=\"display:inline;\" title=\"Right-click on figure or equation for MathML and additional features.\" data-hasqtip=\"0\" class=\"qtooltip moreInfo\" alt=\"Right-click on figure for MathML and additional features.\" src=\"/assets/img/icon.support.gif\" border=\"0\" height=\"20\" width=\"24\"/><span class=\"tex tex2jax_ignore\" style=\"display:none;\">\\begin{align*} \\sigma _{CTR}^{2}=&amp;2\\cdot (\\sigma _{SNSPD}^{2}+\\sigma _{AMPLI}^{2}) \\\\&amp;+ \\, \\left({\\frac {\\sigma _{BASE}}{Sl}}\\right)^{2}+\\sigma _{DO}^{2} \\tag{8}\\end{align*}\n</span></span></disp-formula></p><p>Moreover, if the baseline fluctuation is made negligible, <disp-formula id=\"deqn9\" class=\"display-formula\"><tex-math notation=\"LaTeX\">\\begin{equation*} \\sigma _{CTR}^{2}=2\\cdot (\\sigma _{SNSPD}^{2}+\\sigma _{AMPLI}^{2})+\\sigma _{DO}^{2} \\tag{9}\\end{equation*}\n</tex-math><span class=\"formula\"><span class=\"link\">View Source</span><img aria-describedby=\"qtip-0\" style=\"display:inline;\" title=\"Right-click on figure or equation for MathML and additional features.\" data-hasqtip=\"0\" class=\"qtooltip moreInfo\" alt=\"Right-click on figure for MathML and additional features.\" src=\"/assets/img/icon.support.gif\" border=\"0\" height=\"20\" width=\"24\"/><span class=\"tex tex2jax_ignore\" style=\"display:none;\">\\begin{equation*} \\sigma _{CTR}^{2}=2\\cdot (\\sigma _{SNSPD}^{2}+\\sigma _{AMPLI}^{2})+\\sigma _{DO}^{2} \\tag{9}\\end{equation*}\n</span></span></disp-formula> We would like to point out that the measured <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\sigma _{CTR}$\n</tex-math></inline-formula> values (<a ref-type=\"table\" anchor=\"table6\" class=\"fulltext-link\">Table 6</a>), in the range of <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$14.0\\,ps\\,r.m.s$\n</tex-math></inline-formula> to <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$17.6\\,ps\\,r.m.s$\n</tex-math></inline-formula>, and  <a ref-type=\"disp-formula\" anchor=\"deqn9\" href=\"#deqn9\" class=\"fulltext-link\">Equation (9)</a> (i.e., <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\sqrt {2(8^{2}+14^{2})+2^{2}}=22.8\\,ps\\,r.m.s$\n</tex-math></inline-formula>.) have a quadratic error ranges from <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$14.5\\,ps\\,r.m.s$\n</tex-math></inline-formula> (i.e., <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\sqrt {22.8^{2}-17.6^{2}}=14.5\\,ps\\,r.m.s$\n</tex-math></inline-formula>) to <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$17.6\\,ps\\,r.m.s$\n</tex-math></inline-formula> (i.e., <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\sqrt {22.8^{2}-14.0^{2}}=17.6\\,ps\\,r.m.s$\n</tex-math></inline-formula>) due to the estimation of <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\sigma _{SNSPD}$\n</tex-math></inline-formula>, <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\sigma _{AMPLI}$\n</tex-math></inline-formula>, <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\sigma _{DO}$\n</tex-math></inline-formula>.</p></div></div>\n<div class=\"section\" id=\"sec5\"><div class=\"header article-hdr\"><div class=\"kicker\">\n\t\t                        SECTION V.</div><h2>SNSPD TIMESTAMPING with TDC But No Baseline Compensation</h2></div><p>In this Section, we describe the real-time characterizations of LASER vs SNSPD and SNSPD vs SNSPD performed using a TDC introduced in <a ref-type=\"bibr\" anchor=\"ref33\" id=\"context_ref_33_5\">[33]</a> and applied in numerous scientific investigations <a ref-type=\"bibr\" anchor=\"ref63\" id=\"context_ref_63_5\">[63]</a>, <a ref-type=\"bibr\" anchor=\"ref64\" id=\"context_ref_64_5\">[64]</a>. We used the same configurations stated in <a ref-type=\"sec\" anchor=\"sec4\" class=\"fulltext-link\">Section IV</a>, replacing the DO with the TDC in these tests. There is no mechanism in place to filter out baseline fluctuation.</p><div class=\"section_2\" id=\"sec5a\"><h3>A. Instrument Used</h3><p><a ref-type=\"fig\" anchor=\"fig16\" class=\"fulltext-link\">Figure 16</a> shows the used configuration, which comprises of a multi-channel Tapped Delay-Line based TDC (TDL-TDC) that has been integrated into an FPGA device <a ref-type=\"bibr\" anchor=\"ref31\" id=\"context_ref_31_5a\">[31]</a>, <a ref-type=\"bibr\" anchor=\"ref46\" id=\"context_ref_46_5a\">[46]</a>. The FPGA is a Xilinx 28-nm 7-Series Artix-7 200T <a ref-type=\"bibr\" anchor=\"ref65\" id=\"context_ref_65_5a\">[65]</a>, which is mounted on a Trenz Electronics <a ref-type=\"bibr\" anchor=\"ref66\" id=\"context_ref_66_5a\">[66]</a> TE0712 System-on-Module (SoM) and connected to a custom carrier board through a large number of connectors. The configuration allows for better software and hardware re-configurability, allowing the user to easily change the FPGA device by simply replacing the TE0712 with SoMs from the same TE07xx family. In multi-channel mode, the TDC can run up to 16 parallel channels at high performance. As shown in <a ref-type=\"fig\" anchor=\"fig16\" class=\"fulltext-link\">Figure 16</a>, the input receives an analog signal ranging from 0 to 3.3 V, which is converted into an LVDS digital pulse by a programmable TC. Differential traces calibrated at <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$100\\,\\Omega $\n</tex-math></inline-formula> distribute signals to the connectors and to the device where the TDC is located. The power stage and communication resources are housed on the carrier board.\n<div class=\"figure figure-full\" id=\"fig16\"><!--\n          Workaround for combined images.Eg.- 1000116 Fig. 5\n        --><div class=\"img-wrap\"><a href=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973294/lusar16-3227462-large.gif\" data-fig-id=\"fig16\"><img src=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973294/lusar16-3227462-small.gif\" alt=\"FIGURE 16. - Setup overview.\"/><div class=\"zoom\" title=\"View Larger Image\"/></a></div><div class=\"figcaption\"><b class=\"title\">FIGURE 16. </b><fig><p>Setup overview.</p></fig></div><p class=\"links\"><a href=\"/document/9973294/all-figures\" class=\"all\">Show All</a></p></div></p><p><a ref-type=\"table\" anchor=\"table7\" class=\"fulltext-link\">Table 7</a> highlights the main characteristics of the instrument employed. In connection to the <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\sigma _{TDC}$\n</tex-math></inline-formula> mentioned in Sections above, we must understand that it is a combination of the two channel precision (i.e., <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\sigma _{CH}=12\\,ps\\,r.m.s$\n</tex-math></inline-formula>.), one for the START timestamps and one for the STOP timestamps used to define the time interval under measurement. In this sense, <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\sigma _{TDC}^{2}=\\sigma _{CH}^{2}+\\sigma _{CH}^{2}=2\\sigma _{CH}^{2}=(17\\,ps\\,r.m.s.)^{2}$\n</tex-math></inline-formula>.<div class=\"figure figure-full table\" id=\"table7\"><div class=\"figcaption\"><b class=\"title\">TABLE 7 </b>\nMain characteristics of the used TDC</div><div class=\"img-wrap\"><a href=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973294/lusar.t7-3227462-large.gif\"><img src=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973294/lusar.t7-3227462-small.gif\" alt=\"Table 7- &#10;Main characteristics of the used TDC\"/><div class=\"zoom\" title=\"View Larger Image\"/></a></div></div></p><p>The suggested instrument is totally based on FPGA; the TDC and processing are both located in this seance\u2019s programmable logic. User-defined real-time parallel methods can be developed, or the collected timestamps can be forwarded to a PC for post-processing manipulation, as with the DO in <a ref-type=\"sec\" anchor=\"sec4\" class=\"fulltext-link\">Section IV</a>. In this sense, a coincidence engine for the CTR has been implemented. Furthermore, a hardware histogrammer has been developed to retrieve the statistics of the SNSPD vs LASER (<inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\sigma _{TOT}$\n</tex-math></inline-formula>) and SNSPD vs SNSPD (<inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\sigma _{CTR}$\n</tex-math></inline-formula>) directly.</p></div><div class=\"section_2\" id=\"sec5b\"><h3>B. SNSPD VS Laser</h3><p>The identical measurement setup described in Paragraph IV-A and <a ref-type=\"fig\" anchor=\"fig3\" class=\"fulltext-link\">Figure 3</a>, replacing the DO with the TDC presented in Paragraph V-A, is used. The TDC calculates the statistics, such as the histogram, in real time by measuring the time interval between LASER and SNSPD. In this way, we set as references a voltage level that is exactly half of the amplitude of the LASER and SNSPD signals, respectively, to properly activate the timestamp acquisition with regard to the rising-edge of LASER and SNSPD.</p><p>Different acquisitions at different <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$R_{SNSPD}$\n</tex-math></inline-formula> values are reported in <a ref-type=\"table\" anchor=\"table8\" class=\"fulltext-link\">Table 8</a>. Obviously, there is no compensatory mechanism for baseline fluctuation. As a result, measurements with lesser precision than those obtained with DO are produced.<div class=\"figure figure-full table\" id=\"table8\"><div class=\"figcaption\"><b class=\"title\">TABLE 8 </b>\nMeasured \n$\\sigma_{TOT}$\n at different \n$R_{SNSPD}$\n values between LASER and SNSPD using the TDC</div><div class=\"img-wrap\"><a href=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973294/lusar.t8-3227462-large.gif\"><img src=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973294/lusar.t8-3227462-small.gif\" alt=\"Table 8- &#10;Measured &#10;$\\sigma_{TOT}$&#10; at different &#10;$R_{SNSPD}$&#10; values between LASER and SNSPD using the TDC\"/><div class=\"zoom\" title=\"View Larger Image\"/></a></div></div></p><p>By substituting <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\sigma _{DO}$\n</tex-math></inline-formula> with <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\sigma _{TDC}$\n</tex-math></inline-formula> in  <a ref-type=\"disp-formula\" anchor=\"deqn5\" href=\"#deqn5\" class=\"fulltext-link\">Equation (5)</a>, we can easily adapt it to the case of the TDC; i.e., <disp-formula id=\"deqn10\" class=\"display-formula\"><tex-math notation=\"LaTeX\">\\begin{align*} \\sigma _{TOT}^{2}=&amp;\\sigma _{SNSPD}^{2}+\\sigma _{AMPLI}^{2} \\\\&amp;+ \\, \\left({\\frac {\\sigma _{BASE}}{Sl}}\\right)^{2}+\\sigma _{TDC}^{2}+\\sigma _{PHOTON}^{2} \\tag{10}\\end{align*}\n</tex-math><span class=\"formula\"><span class=\"link\">View Source</span><img aria-describedby=\"qtip-0\" style=\"display:inline;\" title=\"Right-click on figure or equation for MathML and additional features.\" data-hasqtip=\"0\" class=\"qtooltip moreInfo\" alt=\"Right-click on figure for MathML and additional features.\" src=\"/assets/img/icon.support.gif\" border=\"0\" height=\"20\" width=\"24\"/><span class=\"tex tex2jax_ignore\" style=\"display:none;\">\\begin{align*} \\sigma _{TOT}^{2}=&amp;\\sigma _{SNSPD}^{2}+\\sigma _{AMPLI}^{2} \\\\&amp;+ \\, \\left({\\frac {\\sigma _{BASE}}{Sl}}\\right)^{2}+\\sigma _{TDC}^{2}+\\sigma _{PHOTON}^{2} \\tag{10}\\end{align*}\n</span></span></disp-formula></p><p>Considering the presence of walk-error distributed between <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$3.9\\,ps\\,r.m.s$\n</tex-math></inline-formula>. and <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$8.9\\,ps\\,r.m.s$\n</tex-math></inline-formula>., as <a ref-type=\"table\" anchor=\"table5\" class=\"fulltext-link\">Table 5</a> highlights, we can theoretically estimate <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\sigma _{TOT}$\n</tex-math></inline-formula> that is in the range between <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$29.5\\,ps\\,r.m.s$\n</tex-math></inline-formula>. (i.e., <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\sqrt {8^{2}+14^{2}+3.9^{2}+17^{2}+6^{2}}\\!=29.5\\,ps\\,r.m.s$\n</tex-math></inline-formula>.) and <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$29.5\\,ps\\,r.m.s$\n</tex-math></inline-formula>. (i.e., <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\sqrt {8^{2}+14^{2}+8.9^{2}+17^{2}+6^{2}}=30.5\\,ps\\,r.m.s$\n</tex-math></inline-formula>. The difference between expected and measured values corresponds to a quadratic error distributed in the range between <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$16.8\\,ps\\,r.m.s$\n</tex-math></inline-formula>. (i.e., <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\sqrt {34.8^{2}-30.5^{2}}=16.8\\,ps\\,r.m.s$\n</tex-math></inline-formula>.) and <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$15.7\\,ps\\,r.m.s$\n</tex-math></inline-formula>. (i.e., <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\sqrt {33.4^{2}-29.5^{2}}=15.7\\,ps\\,r.m.s$\n</tex-math></inline-formula>.).</p></div><div class=\"section_2\" id=\"sec5c\"><h3>C. SNSPD VS SNSPD</h3><p>We employed the identical setup of measurement utilizing the TDC instead of the DO and computing the CTR in real-time rather than post-processing mode, as shown in Paragraph IV-B and <a ref-type=\"fig\" anchor=\"fig4\" class=\"fulltext-link\">Figure 4</a>. In this method, we were able to compile statistics and determine the time gap between SNSPD and SNSPD using the TDC. As a result, we set as references a voltage level that is exactly half the amplitude of the SNSPD signal in order to properly initiate the timestamp acquisition with respect to SNSPD rising-edges.</p><p>For SNSPD #1 (<inline-formula id=\"\"><tex-math notation=\"LaTeX\">$R_{SNSPD,1}$\n</tex-math></inline-formula>) and #2 (<inline-formula id=\"\"><tex-math notation=\"LaTeX\">$R_{SNSPD,2}$\n</tex-math></inline-formula>), several acquisitions were carried out for different count-rates and summed up in <a ref-type=\"table\" anchor=\"table9\" class=\"fulltext-link\">Table 9</a>. In this situation as well, no baseline compensation method is used, resulting in a decrease in CTR precision when the rate is increased.<div class=\"figure figure-full table\" id=\"table9\"><div class=\"figcaption\"><b class=\"title\">TABLE 9 </b>\nMeasurements of \n$\\sigma_{CTR}$\n at different \n$R_{SNSPD,1}$\n, \n$R_{SNSPD,2}$\n, and \n$R_{CTR}$\n performed in real-time by the TDC</div><div class=\"img-wrap\"><a href=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973294/lusar.t9-3227462-large.gif\"><img src=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973294/lusar.t9-3227462-small.gif\" alt=\"Table 9- &#10;Measurements of &#10;$\\sigma_{CTR}$&#10; at different &#10;$R_{SNSPD,1}$&#10;, &#10;$R_{SNSPD,2}$&#10;, and &#10;$R_{CTR}$&#10; performed in real-time by the TDC\"/><div class=\"zoom\" title=\"View Larger Image\"/></a></div></div></p><p>Replacing <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\sigma _{TDC}$\n</tex-math></inline-formula> with <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\sigma _{DO}$\n</tex-math></inline-formula>,  <a ref-type=\"disp-formula\" anchor=\"deqn8\" href=\"#deqn8\" class=\"fulltext-link\">Equation (8)</a> becomes <disp-formula id=\"deqn11\" class=\"display-formula\"><tex-math notation=\"LaTeX\">\\begin{align*} \\sigma _{CRT}^{2}=&amp;2\\cdot (\\sigma _{SNSPD}^{2}+\\sigma _{AMPLI}^{2}) \\\\&amp;+ \\, \\left({\\frac {\\sigma _{BASE}}{Sl}}\\right)^{2}+\\sigma _{DO}^{2} \\tag{11}\\end{align*}\n</tex-math><span class=\"formula\"><span class=\"link\">View Source</span><img aria-describedby=\"qtip-0\" style=\"display:inline;\" title=\"Right-click on figure or equation for MathML and additional features.\" data-hasqtip=\"0\" class=\"qtooltip moreInfo\" alt=\"Right-click on figure for MathML and additional features.\" src=\"/assets/img/icon.support.gif\" border=\"0\" height=\"20\" width=\"24\"/><span class=\"tex tex2jax_ignore\" style=\"display:none;\">\\begin{align*} \\sigma _{CRT}^{2}=&amp;2\\cdot (\\sigma _{SNSPD}^{2}+\\sigma _{AMPLI}^{2}) \\\\&amp;+ \\, \\left({\\frac {\\sigma _{BASE}}{Sl}}\\right)^{2}+\\sigma _{DO}^{2} \\tag{11}\\end{align*}\n</span></span></disp-formula></p><p>So, we can estimate <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\sigma _{CTR}$\n</tex-math></inline-formula> considering a walk-error between <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$3.8\\,ps\\,r.m.s$\n</tex-math></inline-formula>. and <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$8.9\\,ps\\,r.m.s$\n</tex-math></inline-formula>. obtaining a theoretical value between <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$28.5\\,ps\\,r.m.s$\n</tex-math></inline-formula>. and <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$29.7\\,ps\\,r.m.s$\n</tex-math></inline-formula>., which means quadratic error with respect to the experimental value between <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$17\\,ps\\,r.m.s$\n</tex-math></inline-formula> (i.e., <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\sqrt {34.6^{2}-29.7^{2}}=17\\,ps\\,r.m.s$\n</tex-math></inline-formula>) and <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$18\\,ps\\,r.m.s$\n</tex-math></inline-formula> (i.e., <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\sqrt {28.5^{2}-18.5^{2}}=18\\,ps\\,r.m.s$\n</tex-math></inline-formula>).</p><p>Less data was obtained in comparison to the Paragraph IV-B. Data rate is, in reality, proportional to <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$R_{CRT}$\n</tex-math></inline-formula>, and each measure is 4 bytes long. This translates to a <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$4R_{CRT}\\,Byte/s$\n</tex-math></inline-formula> global data rate. The TDC generates the timestamps associated with the SNSPDs, the coincidence between timestamps is checked, and only the timestamps that pass the coincidence check (i.e., the difference between the timestamps coming from different SNSPDs below a maximum value <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$T$\n</tex-math></inline-formula>) are subtracted and put into the histogram using the proposed approach. The entire algorithm is conducted in real-time on the same FPGA that houses the TDC, with the PC serving solely as a read-out device. The pipeline for this elaboration process is shown in <a ref-type=\"fig\" anchor=\"fig17\" class=\"fulltext-link\">Figure 17</a>.\n<div class=\"figure figure-full\" id=\"fig17\"><!--\n          Workaround for combined images.Eg.- 1000116 Fig. 5\n        --><div class=\"img-wrap\"><a href=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973294/lusar17ab-3227462-large.gif\" data-fig-id=\"fig17\"><img src=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973294/lusar17ab-3227462-small.gif\" alt=\"FIGURE 17. - Elaboration process for the measure of the CTR. The coincidence checker set SW at \u20181\u2019 if a coincidence between timestamps is detected. In a) SW is at \u20180\u2019 because no SNSPD #2 event follows the SNSPD #1 ones; instead, in b) the distance between the timestamps is bigger than the maximum allowed (&#10;$T$&#10;).\"/><div class=\"zoom\" title=\"View Larger Image\"/></a></div><div class=\"figcaption\"><b class=\"title\">FIGURE 17. </b><fig><p>Elaboration process for the measure of the CTR. The coincidence checker set SW at \u20181\u2019 if a coincidence between timestamps is detected. In a) SW is at \u20180\u2019 because no SNSPD #2 event follows the SNSPD #1 ones; instead, in b) the distance between the timestamps is bigger than the maximum allowed (<inline-formula id=\"\"><tex-math notation=\"LaTeX\">$T$\n</tex-math></inline-formula>).</p></fig></div><p class=\"links\"><a href=\"/document/9973294/all-figures\" class=\"all\">Show All</a></p></div></p></div></div>\n<div class=\"section\" id=\"sec6\"><div class=\"header article-hdr\"><div class=\"kicker\">\n\t\t                        SECTION VI.</div><h2>Baseline Filtering</h2></div><p>In this section, we show how the precision was enhanced by filtering out the baseline fluctuation introduced in Paragraph VI-A for both LASER vs SNSPD and SNSPD vs SNSPD. In order to appropriately tune the proposed circuit, some simulations utilizing the SNSPD model found in Paragraph III-B were performed before designing the hardware.</p><div class=\"section_2\" id=\"sec6a\"><h3>A. Baseline Filtering Circuit</h3><p>To compensate for the baseline fluctuation, we assume that is low-frequency noise caused by the superposition effect created by exponential decay with a <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\tau $\n</tex-math></inline-formula> of a few tens of nanoseconds, i.e. <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$F_{L}=10\\,MHz$\n</tex-math></inline-formula>. In these terms, the easiest method is to employ a first-order High-Pass Filter (HPF) that reshapes the <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\tau $\n</tex-math></inline-formula> to ensure a shorter exponential decay (that is <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$5\\tau $\n</tex-math></inline-formula> long). As a result, we replaced the <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$50\\,\\Omega $\n</tex-math></inline-formula> DC termination with an AC one in the TDC board\u2019s input area, as shown in <a ref-type=\"fig\" anchor=\"fig18\" class=\"fulltext-link\">Figure 18</a>.\n<div class=\"figure figure-full\" id=\"fig18\"><!--\n          Workaround for combined images.Eg.- 1000116 Fig. 5\n        --><div class=\"img-wrap\"><a href=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973294/lusar18-3227462-large.gif\" data-fig-id=\"fig18\"><img src=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973294/lusar18-3227462-small.gif\" alt=\"FIGURE 18. - Modified input front-end of the TDC.\"/><div class=\"zoom\" title=\"View Larger Image\"/></a></div><div class=\"figcaption\"><b class=\"title\">FIGURE 18. </b><fig><p>Modified input front-end of the TDC.</p></fig></div><p class=\"links\"><a href=\"/document/9973294/all-figures\" class=\"all\">Show All</a></p></div></p><p>As you can see, the HPF attenuates each harmonic below the pole frequency <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$F_{P}=1/2\\pi RC$\n</tex-math></inline-formula>, by <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$20\\,dB/dec$\n</tex-math></inline-formula>, where <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$C$\n</tex-math></inline-formula> is the capacitance that creates the AC coupling and <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$R$\n</tex-math></inline-formula> is the equivalent resistance (<inline-formula id=\"\"><tex-math notation=\"LaTeX\">$100\\Omega \\Vert 100\\Omega $\n</tex-math></inline-formula>) that makes the <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$50\\,\\Omega $\n</tex-math></inline-formula> termination. Different simulations are performed in Paragraph VI-B in order to tune the best value of <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$C$\n</tex-math></inline-formula>.</p></div><div class=\"section_2\" id=\"sec6b\"><h3>B. Simulation</h3><p>To begin, the HPF, TC, and TDC models have been added to the SNSPD simulation model described in Paragraph III-B. The LASER\u2019s digital output is directly connected to the TDC\u2019s START, but the SNSPD exponential form of the output is filtered by the HPF to remove the baseline, as shown in <a ref-type=\"fig\" anchor=\"fig19\" class=\"fulltext-link\">Figure 19</a>. The output of the HPF is then transformed into a digital trigger by the TC and connected to the TDC\u2019s STOP, just like in the experimental set-up.The TDC freezes the simulation\u2019s timestamp when a trigger event occurs on the START, generating <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$T_{START}$\n</tex-math></inline-formula>, and on the STOP, generating <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$T_{STOP}$\n</tex-math></inline-formula>. The final measure <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\Delta T=T_{STOP}-T_{START}$\n</tex-math></inline-formula> is then calculated, and the target is legitimate only if the STOP event occurs after the START in a laser period (i.e., <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$T_{START}\\leq T_{STOP}&lt; T_{START}+T_{LASER}$\n</tex-math></inline-formula>). To set the value of C, the standard deviation of <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\Delta T$\n</tex-math></inline-formula> (<inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\sigma _{\\Delta T}$\n</tex-math></inline-formula>) is employed as a driving parameter.\n<div class=\"figure figure-full\" id=\"fig19\"><!--\n          Workaround for combined images.Eg.- 1000116 Fig. 5\n        --><div class=\"img-wrap\"><a href=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973294/lusar19-3227462-large.gif\" data-fig-id=\"fig19\"><img src=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973294/lusar19-3227462-small.gif\" alt=\"FIGURE 19. - Block diagram of the entire simulation environment with the photon detection emulation, the two amplifiers, the HPF, the TC, the TDC for timestamp measurement, and the scope to see\u201canalog\u201d waveforms.\"/><div class=\"zoom\" title=\"View Larger Image\"/></a></div><div class=\"figcaption\"><b class=\"title\">FIGURE 19. </b><fig><p>Block diagram of the entire simulation environment with the photon detection emulation, the two amplifiers, the HPF, the TC, the TDC for timestamp measurement, and the scope to see\u201canalog\u201d waveforms.</p></fig></div><p class=\"links\"><a href=\"/document/9973294/all-figures\" class=\"all\">Show All</a></p></div></p><p><a ref-type=\"table\" anchor=\"table10\" class=\"fulltext-link\">Table 10</a> shows several values of <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\sigma _{\\Delta T}$\n</tex-math></inline-formula> as functions of the simulated <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$R_{SNSPD}$\n</tex-math></inline-formula>, with various values of <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$C$\n</tex-math></inline-formula> and the DC value (no HPF) considered as reference. We can see how the HPF fails to filter out the baseline for <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$F_{P}\\leq F_{L}=10\\,MHz$\n</tex-math></inline-formula>, rendering the HPF worthless. As a result, we may argue that increasing <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$F_{P}$\n</tex-math></inline-formula> improves precision by filtering out walk-error. However, increasing <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$F_{P}$\n</tex-math></inline-formula> reduces the loudness of the output signal, making discrimination more difficult. <a ref-type=\"fig\" anchor=\"fig20\" class=\"fulltext-link\">Figure 20</a> illustrates this point. As a result, <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$C=32\\,ps$\n</tex-math></inline-formula> was chosen for the hardware tests.<div class=\"figure figure-full table\" id=\"table10\"><div class=\"figcaption\"><b class=\"title\">TABLE 10 </b>\nSimulated CTR for different values of \n$C$\n (\n$32\\,nF$\n, \n$3.2\\,nF$\n, \n$320\\,pF$\n, \n$32\\,pF$\n, \n$3.2\\,pF$\n) normalized with respect to the DC value (\n$\\sigma_{TOT}(F_{P})/\\sigma_{TOT}(0)$\n), i.e., \n$F_{P}=1/(2\\pi\\cdot50\\Omega\\cdot C)$\n, and considering different \n$R_{SNSPD}$\n values</div><div class=\"img-wrap\"><a href=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973294/lusar.t10-3227462-large.gif\"><img src=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973294/lusar.t10-3227462-small.gif\" alt=\"Table 10- &#10;Simulated CTR for different values of &#10;$C$&#10; (&#10;$32\\,nF$&#10;, &#10;$3.2\\,nF$&#10;, &#10;$320\\,pF$&#10;, &#10;$32\\,pF$&#10;, &#10;$3.2\\,pF$&#10;) normalized with respect to the DC value (&#10;$\\sigma_{TOT}(F_{P})/\\sigma_{TOT}(0)$&#10;), i.e., &#10;$F_{P}=1/(2\\pi\\cdot50\\Omega\\cdot C)$&#10;, and considering different &#10;$R_{SNSPD}$&#10; values\"/><div class=\"zoom\" title=\"View Larger Image\"/></a></div></div>\n<div class=\"figure figure-full\" id=\"fig20\"><!--\n          Workaround for combined images.Eg.- 1000116 Fig. 5\n        --><div class=\"img-wrap\"><a href=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973294/lusar20-3227462-large.gif\" data-fig-id=\"fig20\"><img src=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973294/lusar20-3227462-small.gif\" alt=\"FIGURE 20. - Simulated waveform at the output of the SNSPD (blue dots) and the relative HPF (continuous line) for different &#10;$F_{P}$&#10; values.\"/><div class=\"zoom\" title=\"View Larger Image\"/></a></div><div class=\"figcaption\"><b class=\"title\">FIGURE 20. </b><fig><p>Simulated waveform at the output of the SNSPD (blue dots) and the relative HPF (continuous line) for different <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$F_{P}$\n</tex-math></inline-formula> values.</p></fig></div><p class=\"links\"><a href=\"/document/9973294/all-figures\" class=\"all\">Show All</a></p></div></p></div></div>\n<div class=\"section\" id=\"sec7\"><div class=\"header article-hdr\"><div class=\"kicker\">\n\t\t                        SECTION VII.</div><h2>SNSPD Timestamping with TDC With Baseline Filtering</h2></div><p>We performed the experiment described in <a ref-type=\"sec\" anchor=\"sec4\" class=\"fulltext-link\">Section IV</a>, but modified the TDC\u2019s input front-end as shown in ParagraphVI-A, and used a value of <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$32\\,pF$\n</tex-math></inline-formula> for the <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$C$\n</tex-math></inline-formula> (<inline-formula id=\"\"><tex-math notation=\"LaTeX\">$F_{P}=100\\,MHz$\n</tex-math></inline-formula>) as calculated in Paragraph VI-B.</p><div class=\"section_2\" id=\"sec7a\"><h3>A. SNSPD VS Laser</h3><p><a ref-type=\"table\" anchor=\"table11\" class=\"fulltext-link\">Table 11</a> highlights the measurement precision of LASER vs SNSPD with (HPF present at <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$F_{P}=100\\,MHz$\n</tex-math></inline-formula>) and without (DC) baseline filtering used as reference. We can theoretically estimate <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\sigma _{TOT}$\n</tex-math></inline-formula> using  <a ref-type=\"disp-formula\" anchor=\"deqn10\" href=\"#deqn10\" class=\"fulltext-link\">Equation (10)</a>, given sigma <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\sigma _{BASE}\\rightarrow 0$\n</tex-math></inline-formula>, which is <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$24.2\\,ps\\,r.m.s$\n</tex-math></inline-formula>. (i.e., <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\sqrt {8^{2}+14^{2}+0+17^{2}+6^{2}}=24.2\\,ps\\,r.m.s$\n</tex-math></inline-formula>.). The discrepancy between expected and measured values corresponds to quadratic error in the range of <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$0\\,ps\\,r.m.s$\n</tex-math></inline-formula>. (i.e, <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\sqrt {22.4^{2}-24.2^{2}}=0\\,ps\\,r.m.s$\n</tex-math></inline-formula>.) to <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$9.5\\,ps\\,r.m.s$\n</tex-math></inline-formula>. (i.e, <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\sqrt {26^{2}-24.2^{2}}=9.5\\,ps\\,r.m.s$\n</tex-math></inline-formula>.).<div class=\"figure figure-full table\" id=\"table11\"><div class=\"figcaption\"><b class=\"title\">TABLE 11 </b>\nThe parameter \n$\\sigma_{TOT}$\n measured at different \n$R_{SNSPD}$\n values using TDC with the HPF at \n$F_{P}=100\\,MHz$\n (\n$\\sigma_{TOT}(HPF)$\n), in DC (\n$\\sigma_{TOT}(DC)$\n) and estimation of the corresponding \n$\\sigma_{WALK}$\n </div><div class=\"img-wrap\"><a href=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973294/lusar.t11-3227462-large.gif\"><img src=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973294/lusar.t11-3227462-small.gif\" alt=\"Table 11- &#10;The parameter &#10;$\\sigma_{TOT}$&#10; measured at different &#10;$R_{SNSPD}$&#10; values using TDC with the HPF at &#10;$F_{P}=100\\,MHz$&#10; (&#10;$\\sigma_{TOT}(HPF)$&#10;), in DC (&#10;$\\sigma_{TOT}(DC)$&#10;) and estimation of the corresponding &#10;$\\sigma_{WALK}$&#10; \"/><div class=\"zoom\" title=\"View Larger Image\"/></a></div></div></p><p>The last column of <a ref-type=\"table\" anchor=\"table11\" class=\"fulltext-link\">Table 11</a>, that use the quadratic difference between HPF and DC coupled values of <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\sigma _{TOT}$\n</tex-math></inline-formula>, shows the intensity of the rejected <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\sigma _{WALK}$\n</tex-math></inline-formula> in the range from 21.7 to <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$24.8\\,ps\\,r.m.s$\n</tex-math></inline-formula>.. This must be compared to Table (V) (Paragraph (IV-A)), which shows that the range is <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$3.9\\,ps\\,r.m.s$\n</tex-math></inline-formula>. to <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$8.9\\,ps\\,r.m.s$\n</tex-math></inline-formula>. This discrepancy is due solely to the fact that <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\sigma _{WALK}$\n</tex-math></inline-formula> is extracted by measuring <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\sigma _{BASE}$\n</tex-math></inline-formula>, and the <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$Sl$\n</tex-math></inline-formula> is impacted by a larger uncertainty than the direct measurement. In addition, we can see that when <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$R_{SNSPD}$\n</tex-math></inline-formula> rises, the chance of the pile-up effect rises with it worsing <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\sigma _{TOT}$\n</tex-math></inline-formula>. The histograms used to determine the <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\sigma _{TOT}$\n</tex-math></inline-formula> at <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$R_{SNSPD}=36\\,kHz$\n</tex-math></inline-formula> with a precision of <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$34.6\\,ps\\,r.m.s$\n</tex-math></inline-formula>. using the HPL of <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$F_{P}=10\\,MHz$\n</tex-math></inline-formula> and <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$26.0\\,ps\\,r.m.s$\n</tex-math></inline-formula>. using the HPL of <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$F_{P}=100\\,MHz$\n</tex-math></inline-formula> are shown in <a ref-type=\"fig\" anchor=\"fig21\" class=\"fulltext-link\">Figure 21</a>.\n<div class=\"figure figure-full\" id=\"fig21\"><!--\n          Workaround for combined images.Eg.- 1000116 Fig. 5\n        --><div class=\"img-wrap\"><a href=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973294/lusar21-3227462-large.gif\" data-fig-id=\"fig21\"><img src=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973294/lusar21-3227462-small.gif\" alt=\"FIGURE 21. - Histogram of the LASER vs SNSPD measurements at the rate of &#10;$35\\,kHz$&#10;.\"/><div class=\"zoom\" title=\"View Larger Image\"/></a></div><div class=\"figcaption\"><b class=\"title\">FIGURE 21. </b><fig><p>Histogram of the LASER vs SNSPD measurements at the rate of <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$35\\,kHz$\n</tex-math></inline-formula>.</p></fig></div><p class=\"links\"><a href=\"/document/9973294/all-figures\" class=\"all\">Show All</a></p></div></p></div><div class=\"section_2\" id=\"sec7b\"><h3>B. SNSPD vs SNSPD</h3><p>Measured the <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\sigma _{CTR}$\n</tex-math></inline-formula> using different <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$C$\n</tex-math></inline-formula> values (<inline-formula id=\"\"><tex-math notation=\"LaTeX\">$32\\,nF$\n</tex-math></inline-formula>, <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$3.2\\,nF$\n</tex-math></inline-formula>, <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$320\\,pF$\n</tex-math></inline-formula>, <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$32\\,pF$\n</tex-math></inline-formula>, <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$3.2\\,pF$\n</tex-math></inline-formula>) at different rates (<inline-formula id=\"\"><tex-math notation=\"LaTeX\">$R_{SNSPD,1}$\n</tex-math></inline-formula>, <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$R_{SNSPD,2}$\n</tex-math></inline-formula>, <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$R_{CTR}$\n</tex-math></inline-formula>) are reported in <a ref-type=\"table\" anchor=\"table12\" class=\"fulltext-link\">Table 12</a>. We can observe how the <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\sigma _{CTR}$\n</tex-math></inline-formula> becomes more precise as the <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$F_{P}$\n</tex-math></inline-formula> increases, implying that the baseline fluctuation is minimized. Unfortunately, if <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$F_{P}$\n</tex-math></inline-formula> is set too high, the HPF suppresses not only the baseline but also the harmonics that make up the SNSPD\u2019s short rising time, resulting in a reduction in signal amplitude (<inline-formula id=\"\"><tex-math notation=\"LaTeX\">$A$\n</tex-math></inline-formula>). In this way, we decrease not just <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\sigma _{BASE}$\n</tex-math></inline-formula> but also <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$Sl$\n</tex-math></inline-formula> while raising <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\sigma _{WALK}$\n</tex-math></inline-formula>. Furthermore, if <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$A$\n</tex-math></inline-formula> is too low, the exponential signal should be impossible to discern from the noise floor. We can observe that the possibility of the pile-up effect grows as the rates rise. In this way, a greater <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\sigma _{CTR}$\n</tex-math></inline-formula> can be obtained at a lower rate for the same <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$F_{P}$\n</tex-math></inline-formula>. <a ref-type=\"fig\" anchor=\"fig22\" class=\"fulltext-link\">Figure 22</a> shows the histogram used to determine the CTR of <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$38.8\\,ps\\,r.m.s$\n</tex-math></inline-formula> at <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$R_{CRT}=450\\,kHz$\n</tex-math></inline-formula> with an HPL characteristic of a <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$F_{P}=10\\,MHz$\n</tex-math></inline-formula>.<div class=\"figure figure-full table\" id=\"table12\"><div class=\"figcaption\"><b class=\"title\">TABLE 12 </b>\nMeasured \n$\\sigma_{CTR}$\n for different values of \n$C$\n (\n$32\\,nF$\n, \n$3.2\\,nF$\n, \n$320\\,pF$\n, \n$32\\,pF$\n, \n$3.2\\,pF$\n), i.e. \n$F_{P}=1/(2\\pi\\cdot50\\Omega\\cdot C)$\n, considering different count rates (\n$R_{SNSPD,1}=R_{SNSPD,2}=R_{SNSPD}$\n)and \n$R_{CRT}$\n </div><div class=\"img-wrap\"><a href=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973294/lusar.t12-3227462-large.gif\"><img src=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973294/lusar.t12-3227462-small.gif\" alt=\"Table 12- &#10;Measured &#10;$\\sigma_{CTR}$&#10; for different values of &#10;$C$&#10; (&#10;$32\\,nF$&#10;, &#10;$3.2\\,nF$&#10;, &#10;$320\\,pF$&#10;, &#10;$32\\,pF$&#10;, &#10;$3.2\\,pF$&#10;), i.e. &#10;$F_{P}=1/(2\\pi\\cdot50\\Omega\\cdot C)$&#10;, considering different count rates (&#10;$R_{SNSPD,1}=R_{SNSPD,2}=R_{SNSPD}$&#10;)and &#10;$R_{CRT}$&#10; \"/><div class=\"zoom\" title=\"View Larger Image\"/></a></div></div>\n<div class=\"figure figure-full\" id=\"fig22\"><!--\n          Workaround for combined images.Eg.- 1000116 Fig. 5\n        --><div class=\"img-wrap\"><a href=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973294/lusar22-3227462-large.gif\" data-fig-id=\"fig22\"><img src=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973294/lusar22-3227462-small.gif\" alt=\"FIGURE 22. - The CTR measurement between SNSPDs at 450 kcps using the HPF at &#10;$C=320\\,pF$&#10; (&#10;$F_{P}=10\\,MHz$&#10;) has a &#10;$\\sigma _{CRT}$&#10; of &#10;$38.8\\,ps\\,r.m.s$&#10;, according to the plotted histogram.\"/><div class=\"zoom\" title=\"View Larger Image\"/></a></div><div class=\"figcaption\"><b class=\"title\">FIGURE 22. </b><fig><p>The CTR measurement between SNSPDs at 450 kcps using the HPF at <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$C=320\\,pF$\n</tex-math></inline-formula> (<inline-formula id=\"\"><tex-math notation=\"LaTeX\">$F_{P}=10\\,MHz$\n</tex-math></inline-formula>) has a <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\sigma _{CRT}$\n</tex-math></inline-formula> of <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$38.8\\,ps\\,r.m.s$\n</tex-math></inline-formula>, according to the plotted histogram.</p></fig></div><p class=\"links\"><a href=\"/document/9973294/all-figures\" class=\"all\">Show All</a></p></div></p></div></div>\n<div class=\"section\" id=\"sec8\"><div class=\"header article-hdr\"><div class=\"kicker\">\n\t\t                        SECTION VIII.</div><h2>Comparison and Future Development</h2></div><p><a ref-type=\"fig\" anchor=\"fig23\" class=\"fulltext-link\">Figure 23</a> shows a comparison of CTRs as a function of <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$R_{CRT}$\n</tex-math></inline-formula>, taking into consideration the various ways discussed in <a ref-type=\"sec\" anchor=\"sec4\" class=\"fulltext-link\">Sections IV</a> <a ref-type=\"sec\" anchor=\"sec5\" class=\"fulltext-link\">V</a>and <a ref-type=\"sec\" anchor=\"sec7\" class=\"fulltext-link\">VII</a>. The blue line with \u201co\u201d markers represents the CTRs obtained with DO from <a ref-type=\"table\" anchor=\"table6\" class=\"fulltext-link\">Table 6</a>. The CTR is unaffected by the rate thanks to the DO\u2019s baseline filtering; nevertheless, the DO\u2019s memory and processing capabilities limit the maximum acquisition rate of <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$700Hz$\n</tex-math></inline-formula>. The orange line with \u201c+\u201d markers represents the CTRs acquired with the TDC without any filters as reported in <a ref-type=\"table\" anchor=\"table9\" class=\"fulltext-link\">Table 9</a>. We can observe a low resolution CTR because of the baseline fluctuation; the CTRs are computed directly in the FPGA.\n<div class=\"figure figure-full\" id=\"fig23\"><!--\n          Workaround for combined images.Eg.- 1000116 Fig. 5\n        --><div class=\"img-wrap\"><a href=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973294/lusar23-3227462-large.gif\" data-fig-id=\"fig23\"><img src=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973294/lusar23-3227462-small.gif\" alt=\"FIGURE 23. - Comparison of CTRs as a function of &#10;$R_{CRT}$&#10;, taking into account the different approaches presented in Sections IV V VII.\"/><div class=\"zoom\" title=\"View Larger Image\"/></a></div><div class=\"figcaption\"><b class=\"title\">FIGURE 23. </b><fig><p>Comparison of CTRs as a function of <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$R_{CRT}$\n</tex-math></inline-formula>, taking into account the different approaches presented in <a ref-type=\"sec\" anchor=\"sec4\" class=\"fulltext-link\">Sections IV</a> <a ref-type=\"sec\" anchor=\"sec5\" class=\"fulltext-link\">V</a> <a ref-type=\"sec\" anchor=\"sec7\" class=\"fulltext-link\">VII</a>.</p></fig></div><p class=\"links\"><a href=\"/document/9973294/all-figures\" class=\"all\">Show All</a></p></div>\n<div class=\"figure figure-full\" id=\"fig24\"><!--\n          Workaround for combined images.Eg.- 1000116 Fig. 5\n        --><div class=\"img-wrap\"><a href=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973294/lusar24-3227462-large.gif\" data-fig-id=\"fig24\"><img src=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973294/lusar24-3227462-small.gif\" alt=\"FIGURE 24. - Comparison of time-walk estimation as a function of &#10;$R_{SNSPD}$&#10; using the methods described in Sections IV V.\"/><div class=\"zoom\" title=\"View Larger Image\"/></a></div><div class=\"figcaption\"><b class=\"title\">FIGURE 24. </b><fig><p>Comparison of time-walk estimation as a function of <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$R_{SNSPD}$\n</tex-math></inline-formula> using the methods described in <a ref-type=\"sec\" anchor=\"sec4\" class=\"fulltext-link\">Sections IV</a> <a ref-type=\"sec\" anchor=\"sec5\" class=\"fulltext-link\">V</a>.</p></fig></div><p class=\"links\"><a href=\"/document/9973294/all-figures\" class=\"all\">Show All</a></p></div></p><p>The CTRs acquired with the TDC with HPFs at<inline-formula id=\"\"><tex-math notation=\"LaTeX\">$F_{P}=100\\,kHz$\n</tex-math></inline-formula>, <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$F_{P}=1\\,MHz$\n</tex-math></inline-formula>, <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$F_{P}=10\\,MHz$\n</tex-math></inline-formula>, <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$F_{P}=100\\,MHz$\n</tex-math></inline-formula>, and <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$F_{P}=1\\,GHz$\n</tex-math></inline-formula> are shown by the other four lines, yellow with \u201cx\u201d as markers, purple with \u201c\u201d as markers, green with \u201c<inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\diamondsuit $\n</tex-math></inline-formula>\u201d as markers, light blue with \u201cI\u201d as markers, and magenta with \u201cU\u201d as markers. <a ref-type=\"table\" anchor=\"table9\" class=\"fulltext-link\">Table 9</a> has all of the values computed in real-time directly in the FPGA. We can observe how the baseline fluctuations are filtered for <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$R_{CRT}$\n</tex-math></inline-formula> less than <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$F_{P}$\n</tex-math></inline-formula> by looking at these lines. In reality, the lower <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$F_{P}$\n</tex-math></inline-formula> of the yellow (<inline-formula id=\"\"><tex-math notation=\"LaTeX\">$F_{P}=100\\,kHz$\n</tex-math></inline-formula>), purple (<inline-formula id=\"\"><tex-math notation=\"LaTeX\">$F_{P}=1\\,MHz$\n</tex-math></inline-formula>), and green (<inline-formula id=\"\"><tex-math notation=\"LaTeX\">$F_{P}=10\\,MHz$\n</tex-math></inline-formula>) lines does not guarantee a proper reduction of baseline fluctuations.The light blue <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$F_{P}=100\\,MHz$\n</tex-math></inline-formula>), and the magenta (<inline-formula id=\"\"><tex-math notation=\"LaTeX\">$F_{P}=1\\,GHz$\n</tex-math></inline-formula>) lines are the exceptions. The baseline filtering is effective at rates up to <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$100\\,kHz$\n</tex-math></inline-formula> for the light blue line (<inline-formula id=\"\"><tex-math notation=\"LaTeX\">$F_{P}=100\\,MHz$\n</tex-math></inline-formula>). Instead, the magenta line (<inline-formula id=\"\"><tex-math notation=\"LaTeX\">$F_{P}=1\\,GHz$\n</tex-math></inline-formula>) has a lower precision than the light blue lines (<inline-formula id=\"\"><tex-math notation=\"LaTeX\">$F_{P}=100\\,MHz$\n</tex-math></inline-formula>), which is used to reduce the loudness of the filtered signal (see <a ref-type=\"fig\" anchor=\"fig20\" class=\"fulltext-link\">Figure 20</a>). <a ref-type=\"fig\" anchor=\"fig12\" class=\"fulltext-link\">Figure 12</a> shows a comparison of time-walk estimates using the DO (blue line with \u201co\u201d as markers) and TDC (orange line with \u201c+\u201d as markers) from TablesV and XI. The rate increases the time-walk in both cases, which is proportional to the baseline fluctuation. Various techniques and, without a doubt, inherent measurement faults are to blame for the numerical disparity between the DO and TDC results. In fact, we must keep in mind that the DO (blue line) time-walk estimation is achieved using a VM technique that extracts the baseline using the DSP algorithm and converts it to time-walk using <a ref-type=\"disp-formula\" anchor=\"deqn4\" href=\"#deqn4\" class=\"fulltext-link\">equations (4)</a>. Instead, for the TDC (orange line), the time-walk is determined as the difference between the precision achieved with the HPF at <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$F_{P}=100\\,MHz$\n</tex-math></inline-formula> (<inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\sigma _{TOT}(HPF)$\n</tex-math></inline-formula>) and without<inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\vphantom {_{\\int }}$\n</tex-math></inline-formula> it (<inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\sigma _{TOT}(DC)$\n</tex-math></inline-formula>), i.e., <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\sqrt {\\sigma _{TOT}^{2}(DC)-\\sigma _{TOT}^{2}(HPF)}$\n</tex-math></inline-formula>. The CTR measurement is done between two SNSPDs to keep the budget under control, but the hardware supports 16 independent channels; the performance is confirmed using an emulation unsigned function generator (rather than 16 SNSPDs). In the future, the experimental evaluation of 16 SNSPDs will be investigated, with the measurement set-up and firmware modified to manage 16 detectors in parallel. Issues of cross-talk will be given specific attention.</p></div>\n<div class=\"section\" id=\"sec9\"><div class=\"header article-hdr\"><div class=\"kicker\">\n\t\t                        SECTION IX.</div><h2>Conclusion</h2></div><p>We explain how, at the cutting edge of technology, a time mode approach architecture integrally based on FPGA can conduct timing measurement and CTR on SNSPD (the most time-resolved detector). Both the TDC and measuring techniques such as coincidence and histogramming are performed inside the FPGA due to the versatility of the programmable logic manner. In this situation, the PC is only used as a monitor. Precision of less than 26 ps r.m.s. is attained using this technology in single-shot mode up to 1 MHz measuring rate. Furthermore, thanks to firmware flexibility, we can directly measure the CTR in FPGA; this allows us to identify whether two photons detected by two distinct SNSPDs are in coincidence or not with a precision of always.To ensure this high precision by removing the intrinsic baseline fluctuation and decreasing the time-walk, a low-cost filtering on the SNSPD\u2019s output pulse is required. All processing takes place in parallel and effectively inside the FPGA, making this technology ideal for modern multi-channel applications; and the number of input channels may be easily extended from a firmware standpoint. Furthermore, we have specified that if cross-talk effects are present, particular attention would be paid.</p></div>\n<h3>ACKNOWLEDGMENT</h3><p>The authors would like to thank Single Quantum BV and Gabriele Bulgarini.</p><h3>NOTE</h3><p>Open Access provided by 'Politecnico di Milano' within the CRUI CARE Agreement</p></div></div></response>\n"
}