{
    "abstract": "The control strategies based on the methodology known as Model\u2013based Predictive Control (MPC) have been developed and widely adopted to control real plants. This is mainly due to their intrinsic ability to handle constrains and their capacity to predict and optimize the future behavior of the process using a dynamical model of the plant. On the other hand, the mathematical tool known as fractional...",
    "articleNumber": "9975294",
    "articleTitle": "Fractional Generalized Predictive Control Strategy With Fractional Constraints Handling",
    "authors": [
        {
            "preferredName": "Miguel Romero",
            "normalizedName": "M. Romero",
            "firstName": "Miguel",
            "lastName": "Romero",
            "searchablePreferredName": "Miguel Romero"
        },
        {
            "preferredName": "Carolina Ma\u00f1oso",
            "normalizedName": "C. Ma\u00f1oso",
            "firstName": "Carolina",
            "lastName": "Ma\u00f1oso",
            "searchablePreferredName": "Carolina Ma\u00f1oso"
        }
    ],
    "doi": "10.1109/ACCESS.2022.3227864",
    "publicationTitle": "IEEE Access",
    "publicationYear": "2022",
    "publicationVolume": null,
    "publicationIssue": null,
    "volume": "10",
    "issue": null,
    "documentLink": "/document/9975294/",
    "xml": "<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<response><accessType>CCBY - IEEE is not the copyright holder of this material. Please follow the instructions via https://creativecommons.org/licenses/by/4.0/ to obtain full-text articles and stipulations in the API documentation.</accessType><div id=\"BodyWrapper\" class=\"ArticlePage\" xmlns:ieee=\"http://www.ieeexplore.ieee.org\"><div id=\"article\">\n<div class=\"section\" id=\"sec1\"><div class=\"header article-hdr\"><div class=\"kicker\">\n\t\t                        SECTION I.</div><h2>Introduction</h2></div><p>The term MPC (Model Predictive Control) began to be used in the late of 1970s in works as <a ref-type=\"bibr\" anchor=\"ref1\" id=\"context_ref_1_1\">[1]</a> and <a ref-type=\"bibr\" anchor=\"ref2\" id=\"context_ref_2_1\">[2]</a> where this control strategy was used mainly within the petrochemical industry to meet its specialized control needs. These early works were followed by others both industrial and academic environments, covering a wide spectrum of applications as are described in <a ref-type=\"bibr\" anchor=\"ref3\" id=\"context_ref_3_1\">[3]</a>, <a ref-type=\"bibr\" anchor=\"ref4\" id=\"context_ref_4_1\">[4]</a>, and <a ref-type=\"bibr\" anchor=\"ref5\" id=\"context_ref_5_1\">[5]</a>.</p><p>Due to its success, nowadays, MPC has become a standard in these environments, where there exist many implementations: DMC (Dynamic Matrix Control), GPC (Generalized Predictive Control), etc. All of them share a common methodology, they rely on a dynamical model that represents the plant to predict its future behavior by means of the minimization of a costs function over a time interval <a ref-type=\"bibr\" anchor=\"ref6\" id=\"context_ref_6_1\">[6]</a>, <a ref-type=\"bibr\" anchor=\"ref7\" id=\"context_ref_7_1\">[7]</a>, <a ref-type=\"bibr\" anchor=\"ref8\" id=\"context_ref_8_1\">[8]</a>. Obviously, the more similar the model is to the real plant, the better the estimates of its future behavior are. This is not easy to achieve in many real cases, since there are plants with complex behaviors such as the stop\u2013and\u2013go maneuvers in commercial gasoline\u2013propelled vehicles, controlling the throttle pedal which exhibit highly non-linear dynamics at low speed <a ref-type=\"bibr\" anchor=\"ref9\" id=\"context_ref_9_1\">[9]</a>; or the viscoelasticity phenomenon in rheological tissues describing the flow of blood through the arteries <a ref-type=\"bibr\" anchor=\"ref10\" id=\"context_ref_10_1\">[10]</a>. In some of these cases, applying an advanced control strategy could be very beneficial to obtain the expected results compensating unmodeled dynamics and external disturbances. To do so, it might even be necessary to apply a hybrid model as in <a ref-type=\"bibr\" anchor=\"ref11\" id=\"context_ref_11_1\">[11]</a> and <a ref-type=\"bibr\" anchor=\"ref12\" id=\"context_ref_12_1\">[12]</a>.</p><p>In this sense, some recent implementations use both a fractional model to accurately describe non\u2013integer order dynamics exhibited by some real physical systems and a fractional formulation for the controller to reach a better performance. However, the idea of using fractional operators both for the formulation of the controller and for describing the dynamics of the used model is not exclusive to the MPC. These operators have been used in other control strategies to enhance the system performance. For example, the classical PID control was upgraded using fractional operators to re-formulate its integral and derivative terms <a ref-type=\"bibr\" anchor=\"ref13\" id=\"context_ref_13_1\">[13]</a>, <a ref-type=\"bibr\" anchor=\"ref14\" id=\"context_ref_14_1\">[14]</a>, <a ref-type=\"bibr\" anchor=\"ref15\" id=\"context_ref_15_1\">[15]</a> or the fractional\u2013order control methodology known as CRONE <a ref-type=\"bibr\" anchor=\"ref16\" id=\"context_ref_16_1\">[16]</a>.</p><p>The fractional predictive control strategy known as FGPC combines the valuable characteristics of fractional calculus and predictive control by means of a real\u2013order fractional cost function that is formulated using fractional operators. This is the fractional control strategy that is used in this work. In the literature, we can find more and more examples of authors who have followed this proposal; without the intention of being exhaustive; we can mention the manuscript <a ref-type=\"bibr\" anchor=\"ref17\" id=\"context_ref_17_1\">[17]</a> where the so\u2013called FPFC controller is used in fractional industrial processes, <a ref-type=\"bibr\" anchor=\"ref18\" id=\"context_ref_18_1\">[18]</a> where a neurophysiological process has been modeled by a fractional order system, <a ref-type=\"bibr\" anchor=\"ref19\" id=\"context_ref_19_1\">[19]</a> where the fractional order model of heating furnace is used or <a ref-type=\"bibr\" anchor=\"ref20\" id=\"context_ref_20_1\">[20]</a> where two rods thermal system has been identified and used.</p><p>Nowadays, the predictive control strategies have demonstrated to be a valuable option due to their intrinsic characteristics both for compensating un\u2013modelled dynamics and for reaching complex control objectives by means of the advisable setting of constraints. Although the computational cost for large number of variables and constraints of large\u2013scale processes could be troublesome, there are current techniques for mathematical processing using the so\u2013called GPU computing to get an important performance boost <a ref-type=\"bibr\" anchor=\"ref21\" id=\"context_ref_21_1\">[21]</a>.</p><p>In this sense, the main aim in this paper is to introduce the use of fractional constraints in the predictive fractional control strategy by means of using fractional operators not only in the cost function but also in the mathematical formulation of its constraints. Their effect on system performance is interpreted and discussed, analyzing the usefulness of the proposal to soften constraints and adjust the final response of the system. On the other hand, the optimal tuning method to obtain the controller parameters is revised and illustrated with some examples using two different mathematical solvers.</p><p>The remainder of this paper is structured as follows: In <a ref-type=\"sec\" anchor=\"sec2\" class=\"fulltext-link\">Section II</a> the fundamentals of the fractional calculus and the fractional\u2013order definite integral operator are described. <a ref-type=\"sec\" anchor=\"sec3\" class=\"fulltext-link\">Section III</a> summarizes the fundamentals of fractional predictive control strategy and includes the formulation, design and tuning of the FGPC controller using a practical guide with optimization software. <a ref-type=\"sec\" anchor=\"sec4\" class=\"fulltext-link\">Section IV</a> introduces the fractional constraints for FGPC controller, describing mathematically their formulation and discussing its impact on system performance. Furthermore, a new method to soften constraints using fractional operators is also introduced and explained. Finally, <a ref-type=\"sec\" anchor=\"sec5\" class=\"fulltext-link\">Section V</a> draws the main conclusions of this work.</p></div>\n<div class=\"section\" id=\"sec2\"><div class=\"header article-hdr\"><div class=\"kicker\">\n\t\t                        SECTION II.</div><h2>Fractional Calculus</h2></div><p>Fractional calculus is defined as a generalization of derivatives and integrals to non\u2013integer orders, in this way, it allows to make calculations such as differentiate a function to real, even complex order <a ref-type=\"bibr\" anchor=\"ref22\" id=\"context_ref_22_2\">[22]</a>. This branch of mathematical analysis dates from the 17th century when Leibniz and L\u2019H\u00f4pital discussed about the possibility of non\u2013integer derivatives, specifically that <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$n$\n</tex-math></inline-formula> could be a fraction 1/2 for <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$n$\n</tex-math></inline-formula>th derivative. Although this calculus is an old idea, it was really developed at the <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$19^{\\mathrm {th}}$\n</tex-math></inline-formula> century by Liouville, Letnikov, Riemann and other mathematicians <a ref-type=\"bibr\" anchor=\"ref23\" id=\"context_ref_23_2\">[23]</a>.</p><p>There exist several ways to evaluate fractional operators <a ref-type=\"bibr\" anchor=\"ref24\" id=\"context_ref_24_2\">[24]</a>, <a ref-type=\"bibr\" anchor=\"ref25\" id=\"context_ref_25_2\">[25]</a>, which are commonly represented by <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$D^{\\alpha }$\n</tex-math></inline-formula>, where positive values of <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\alpha $\n</tex-math></inline-formula> represents derivatives and negative values correspond to integrals. Since MPC formulation is usually described in discrete terms, in this work, it will be only considered the Gr\u00fcnwald\u2013Letnikov (GL) definition which expression is <a ref-type=\"disp-formula\" anchor=\"deqn1\" href=\"#deqn1\" class=\"fulltext-link\">(1)</a>.<disp-formula id=\"deqn1\" class=\"display-formula\"><tex-math notation=\"LaTeX\">\\begin{align*} D^{\\alpha }f{(t)}_{t=kh}=&amp;\\lim \\limits _{h\\to 0}h^{-\\alpha }\\sum \\limits _{j=0}^{\\infty} \\left ({-1 }\\right)^{j} \\left ({{\\begin{array}{c} \\alpha \\\\ j\\\\ \\end{array}} }\\right)f\\left ({kh-jh }\\right)\\!, \\\\&amp;\\forall \\alpha \\in \\mathbb {R}\\tag{1}\\end{align*}\n</tex-math><span class=\"formula\"><span class=\"link\">View Source</span><img aria-describedby=\"qtip-0\" style=\"display:inline;\" title=\"Right-click on figure or equation for MathML and additional features.\" data-hasqtip=\"0\" class=\"qtooltip moreInfo\" alt=\"Right-click on figure for MathML and additional features.\" src=\"/assets/img/icon.support.gif\" border=\"0\" height=\"20\" width=\"24\"/><span class=\"tex tex2jax_ignore\" style=\"display:none;\">\\begin{align*} D^{\\alpha }f{(t)}_{t=kh}=&amp;\\lim \\limits _{h\\to 0}h^{-\\alpha }\\sum \\limits _{j=0}^{\\infty} \\left ({-1 }\\right)^{j} \\left ({{\\begin{array}{c} \\alpha \\\\ j\\\\ \\end{array}} }\\right)f\\left ({kh-jh }\\right)\\!, \\\\&amp;\\forall \\alpha \\in \\mathbb {R}\\tag{1}\\end{align*}\n</span></span></disp-formula></p><p>It is important to note that expression <a ref-type=\"disp-formula\" anchor=\"deqn1\" href=\"#deqn1\" class=\"fulltext-link\">(1)</a> has infinite discrete terms. Because of this specific feature, fractional calculus is a valuable tool for modeling and describing complex effects associated with infinite memory behaviors such as polymer viscoelasticity.</p><p>The dynamic behavior of fractional systems is often described using the Laplace transform. Expression <a ref-type=\"disp-formula\" anchor=\"deqn2\" href=\"#deqn2\" class=\"fulltext-link\">(2)</a> gives the Laplace transform of the GL definition under zero initial conditions.<disp-formula id=\"deqn2\" class=\"display-formula\"><tex-math notation=\"LaTeX\">\\begin{equation*} L\\left \\{{D^{\\pm \\alpha }f(t) }\\right \\}=s^{\\pm \\alpha }F\\left ({s }\\right)\\!,\\quad \\forall \\alpha \\in \\mathbb {R}\\tag{2}\\end{equation*}\n</tex-math><span class=\"formula\"><span class=\"link\">View Source</span><img aria-describedby=\"qtip-0\" style=\"display:inline;\" title=\"Right-click on figure or equation for MathML and additional features.\" data-hasqtip=\"0\" class=\"qtooltip moreInfo\" alt=\"Right-click on figure for MathML and additional features.\" src=\"/assets/img/icon.support.gif\" border=\"0\" height=\"20\" width=\"24\"/><span class=\"tex tex2jax_ignore\" style=\"display:none;\">\\begin{equation*} L\\left \\{{D^{\\pm \\alpha }f(t) }\\right \\}=s^{\\pm \\alpha }F\\left ({s }\\right)\\!,\\quad \\forall \\alpha \\in \\mathbb {R}\\tag{2}\\end{equation*}\n</span></span></disp-formula></p><p>Nevertheless, the discretization of <a ref-type=\"disp-formula\" anchor=\"deqn2\" href=\"#deqn2\" class=\"fulltext-link\">(2)</a> does not lead to a transfer function with a limited number of coefficients in <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$z$\n</tex-math></inline-formula>. Thus, these infinite coefficients can be calculated using the binomial expression <a ref-type=\"disp-formula\" anchor=\"deqn3\" href=\"#deqn3\" class=\"fulltext-link\">(3)</a> or using the well\u2013known recursive algorithm <a ref-type=\"bibr\" anchor=\"ref26\" id=\"context_ref_26_2\">[26]</a>.<disp-formula id=\"deqn3\" class=\"display-formula\"><tex-math notation=\"LaTeX\">\\begin{align*} \\omega _{j}={(-1)}^{j}\\left ({{\\begin{array}{c} \\alpha \\\\ j\\\\ \\end{array}} }\\right)\\!,\\quad \\forall j\\in \\big[0,\\infty\\big)\\tag{3}\\end{align*}\n</tex-math><span class=\"formula\"><span class=\"link\">View Source</span><img aria-describedby=\"qtip-0\" style=\"display:inline;\" title=\"Right-click on figure or equation for MathML and additional features.\" data-hasqtip=\"0\" class=\"qtooltip moreInfo\" alt=\"Right-click on figure for MathML and additional features.\" src=\"/assets/img/icon.support.gif\" border=\"0\" height=\"20\" width=\"24\"/><span class=\"tex tex2jax_ignore\" style=\"display:none;\">\\begin{align*} \\omega _{j}={(-1)}^{j}\\left ({{\\begin{array}{c} \\alpha \\\\ j\\\\ \\end{array}} }\\right)\\!,\\quad \\forall j\\in \\big[0,\\infty\\big)\\tag{3}\\end{align*}\n</span></span></disp-formula></p><p>The coefficients evolve quickly approaching to 0 in accordance with the so\u2013called short memory principle which is generally used to evaluate fractional operators because of only the recent past plays an important role. Therefore, its application leads to a n\u2013term truncated series, paying a penalty in the form of some inaccuracy <a ref-type=\"bibr\" anchor=\"ref26\" id=\"context_ref_26_2\">[26]</a>.</p><p>In this paper, the fractional\u2013order definite integral operator <inline-formula id=\"\"><tex-math notation=\"LaTeX\">${}^{\\alpha } I_{a}^{b}(\\cdot)$\n</tex-math></inline-formula> is used. The concept of integer definite integral can be generalized to real\u2013order for a function <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$f(x)$\n</tex-math></inline-formula> using the expression <a ref-type=\"disp-formula\" anchor=\"deqn4\" href=\"#deqn4\" class=\"fulltext-link\">(4)</a>.<disp-formula id=\"deqn4\" class=\"display-formula\"><tex-math notation=\"LaTeX\">\\begin{equation*} {}^{\\alpha } I_{a}^{b}f\\left ({x }\\right)=\\int _{a}^{b} {\\left [{ D^{1-\\alpha }f(x) }\\right]dx}\\quad \\alpha,a,b\\in \\mathbb {R}\\tag{4}\\end{equation*}\n</tex-math><span class=\"formula\"><span class=\"link\">View Source</span><img aria-describedby=\"qtip-0\" style=\"display:inline;\" title=\"Right-click on figure or equation for MathML and additional features.\" data-hasqtip=\"0\" class=\"qtooltip moreInfo\" alt=\"Right-click on figure for MathML and additional features.\" src=\"/assets/img/icon.support.gif\" border=\"0\" height=\"20\" width=\"24\"/><span class=\"tex tex2jax_ignore\" style=\"display:none;\">\\begin{equation*} {}^{\\alpha } I_{a}^{b}f\\left ({x }\\right)=\\int _{a}^{b} {\\left [{ D^{1-\\alpha }f(x) }\\right]dx}\\quad \\alpha,a,b\\in \\mathbb {R}\\tag{4}\\end{equation*}\n</span></span></disp-formula></p><p>Using the previous GL definition and considering that <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$D^{1-\\alpha }\\left [{ f(x) }\\right]\\ne 0$\n</tex-math></inline-formula>, this fractional operator can be discretized with sampling period <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\mathrm {\\Delta }x$\n</tex-math></inline-formula> as:<disp-formula id=\"deqn5\" class=\"display-formula\"><tex-math notation=\"LaTeX\">\\begin{align*} {}^{\\alpha } I_{a}^{b}f\\left ({x }\\right)=\\Delta x^{\\alpha }W'f\\quad \\text {with}~w_{j}=\\omega _{j}-\\omega _{j-n},\\quad n=b-a \\tag{5}\\end{align*}\n</tex-math><span class=\"formula\"><span class=\"link\">View Source</span><img aria-describedby=\"qtip-0\" style=\"display:inline;\" title=\"Right-click on figure or equation for MathML and additional features.\" data-hasqtip=\"0\" class=\"qtooltip moreInfo\" alt=\"Right-click on figure for MathML and additional features.\" src=\"/assets/img/icon.support.gif\" border=\"0\" height=\"20\" width=\"24\"/><span class=\"tex tex2jax_ignore\" style=\"display:none;\">\\begin{align*} {}^{\\alpha } I_{a}^{b}f\\left ({x }\\right)=\\Delta x^{\\alpha }W'f\\quad \\text {with}~w_{j}=\\omega _{j}-\\omega _{j-n},\\quad n=b-a \\tag{5}\\end{align*}\n</span></span></disp-formula> where <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$f$\n</tex-math></inline-formula> is a vector with the values of the function and <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$W$\n</tex-math></inline-formula> is a vector with a weight sequence using the coefficients of binomial expression <a ref-type=\"disp-formula\" anchor=\"deqn3\" href=\"#deqn3\" class=\"fulltext-link\">(3)</a>. See <a ref-type=\"bibr\" anchor=\"ref27\" id=\"context_ref_27_2\">[27]</a> and the references within.</p></div>\n<div class=\"section\" id=\"sec3\"><div class=\"header article-hdr\"><div class=\"kicker\">\n\t\t                        SECTION III.</div><h2>Fractional Predictive Control Strategy</h2></div><p>The Fractional\u2013order Generalized Predictive Controller, FGPC, is defined as the fractional generalization of GPC control strategy <a ref-type=\"bibr\" anchor=\"ref28\" id=\"context_ref_28_3\">[28]</a>, <a ref-type=\"bibr\" anchor=\"ref29\" id=\"context_ref_29_3\">[29]</a>, that is one of the most representative MPC formulations. FGPC and GPC share characteristics but there exist important differences as they do not define the same set of controllers <a ref-type=\"bibr\" anchor=\"ref30\" id=\"context_ref_30_3\">[30]</a>. FGPC uses the fractional operators to enhance the system performance and it is part of predictive controller family. It follows the concept behind all model based predictive algorithms. This idea has been used by some authors to design their control strategies; without the intention of being exhaustive; such as <a ref-type=\"bibr\" anchor=\"ref31\" id=\"context_ref_31_3\">[31]</a> where a fractional predictive controller is applied to Steam/Water Loop in Large Scale Ships in a distributed scheme, <a ref-type=\"bibr\" anchor=\"ref32\" id=\"context_ref_32_3\">[32]</a> where this fractional control strategy has been used to achieve the optimal frequency control of an islanded microgrid or <a ref-type=\"bibr\" anchor=\"ref33\" id=\"context_ref_33_3\">[33]</a> where the fractional predictive method has been tested with an industrial heating furnace.</p><p>The FGPC control strategy can be summarized as follows. At each present instant of time, <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$t$\n</tex-math></inline-formula>, the controller generates a set of future control signals <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\Delta u(t+k\\vert t)$\n</tex-math></inline-formula> based on the prediction of the future process outputs <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$y(t+k\\vert t)$\n</tex-math></inline-formula> by means of minimization of a defined cost function within a time interval define by <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\left [{ N_{1},N_{2} }\\right]$\n</tex-math></inline-formula>. However, only the first term of the control signal vector is used as system input <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\Delta u(t\\vert t)$\n</tex-math></inline-formula>, the rest ones are neglected. Next step, <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$t+1$\n</tex-math></inline-formula>, the algorithm is repeated to calculate the new system input, <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\Delta u(t+1\\vert t+1)$\n</tex-math></inline-formula>. Therefore, the prediction window has moved forward (receding horizon control). The <a ref-type=\"fig\" anchor=\"fig1\" class=\"fulltext-link\">Figure 1</a> schematically presents this strategy.\n<div class=\"figure figure-full\" id=\"fig1\"><!--\n          Workaround for combined images.Eg.- 1000116 Fig. 5\n        --><div class=\"img-wrap\"><a href=\"/mediastore_new/IEEE/content/media/6287639/9668973/9975294/romer1-3227864-large.gif\" data-fig-id=\"fig1\"><img src=\"/mediastore_new/IEEE/content/media/6287639/9668973/9975294/romer1-3227864-small.gif\" alt=\"FIGURE 1. - FGPC basic diagram.\"/><div class=\"zoom\" title=\"View Larger Image\"/></a></div><div class=\"figcaption\"><b class=\"title\">FIGURE 1. </b><fig><p>FGPC basic diagram.</p></fig></div><p class=\"links\"><a href=\"/document/9975294/all-figures\" class=\"all\">Show All</a></p></div></p><p>Traditionally in MPC, the cost function is formulated using a quadratic criterion due to its mathematical convenience <a ref-type=\"bibr\" anchor=\"ref34\" id=\"context_ref_34_3\">[34]</a> for its optimization. FGPC also makes use of this formulation. However, some MPC strategies with non\u2013quadratic formulations could be also found in the literature as <a ref-type=\"bibr\" anchor=\"ref35\" id=\"context_ref_35_3\">[35]</a> and <a ref-type=\"bibr\" anchor=\"ref36\" id=\"context_ref_36_3\">[36]</a>. In any case, this cost function has as input the predicted errors which are defined as the difference between the predicted output and the reference trajectory, <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$e\\left ({{t+k}\\thinspace \\vert \\thinspace t}\\right) =y\\left ({{t+k}\\thinspace \\vert \\thinspace t}\\right) -r(t+k\\vert t)$\n</tex-math></inline-formula>, filtered or not.</p><p>On the other hand, FGPC uses a discrete time linear model to capture the dynamic behavior of the real plant, where the equations that describe its dynamics are formulated using integer\u2013order calculus. However, a fractional linear model could also be used in case of the plant to be controlled had that dynamic, but it is not the subject of this work.</p><p>Finally, the possibility of using process constraints in predictive control strategies is one of their most valuable characteristics. FGPC uses constraints that are expressed as a set of linear inequalities:<disp-formula id=\"deqn6\" class=\"display-formula\"><tex-math notation=\"LaTeX\">\\begin{equation*} L\\Delta u(k)\\le l(k)\\tag{6}\\end{equation*}\n</tex-math><span class=\"formula\"><span class=\"link\">View Source</span><img aria-describedby=\"qtip-0\" style=\"display:inline;\" title=\"Right-click on figure or equation for MathML and additional features.\" data-hasqtip=\"0\" class=\"qtooltip moreInfo\" alt=\"Right-click on figure for MathML and additional features.\" src=\"/assets/img/icon.support.gif\" border=\"0\" height=\"20\" width=\"24\"/><span class=\"tex tex2jax_ignore\" style=\"display:none;\">\\begin{equation*} L\\Delta u(k)\\le l(k)\\tag{6}\\end{equation*}\n</span></span></disp-formula> where <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$L$\n</tex-math></inline-formula> is a matrix and <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$l$\n</tex-math></inline-formula> is a vector with <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$c$\n</tex-math></inline-formula> terms. <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$c$\n</tex-math></inline-formula> is the number of constraints.</p><p>Due to the use of a quadratic programming algorithm in FGPC, which allows only to satisfy constraints with general expression as <a ref-type=\"disp-formula\" anchor=\"deqn6\" href=\"#deqn6\" class=\"fulltext-link\">(6)</a>, only linearly dependent variables of control signal <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\Delta u$\n</tex-math></inline-formula> are used.</p><div class=\"section_2\" id=\"sec3a\"><h3>A. Formulation of the FGPC Controller</h3><p>FGPC Controllers are characterized by relying on a CARIMA (Controlled Auto\u2013Regressive Integrated Moving Average) model to describe the system dynamics <a ref-type=\"disp-formula\" anchor=\"deqn7\" href=\"#deqn7\" class=\"fulltext-link\">(7)</a>.<disp-formula id=\"deqn7\" class=\"display-formula\"><tex-math notation=\"LaTeX\">\\begin{equation*} A\\left ({z^{\\mathrm {-1}} }\\right)y\\left ({t }\\right)=B\\left ({z^{\\mathrm {-1}} }\\right)u\\left ({t }\\right)+\\frac {T\\left ({z^{\\mathrm {-1}} }\\right)}{\\Delta }\\xi (t)\\tag{7}\\end{equation*}\n</tex-math><span class=\"formula\"><span class=\"link\">View Source</span><img aria-describedby=\"qtip-0\" style=\"display:inline;\" title=\"Right-click on figure or equation for MathML and additional features.\" data-hasqtip=\"0\" class=\"qtooltip moreInfo\" alt=\"Right-click on figure for MathML and additional features.\" src=\"/assets/img/icon.support.gif\" border=\"0\" height=\"20\" width=\"24\"/><span class=\"tex tex2jax_ignore\" style=\"display:none;\">\\begin{equation*} A\\left ({z^{\\mathrm {-1}} }\\right)y\\left ({t }\\right)=B\\left ({z^{\\mathrm {-1}} }\\right)u\\left ({t }\\right)+\\frac {T\\left ({z^{\\mathrm {-1}} }\\right)}{\\Delta }\\xi (t)\\tag{7}\\end{equation*}\n</span></span></disp-formula></p><p>The numerator and denominator of the model transfer function are <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$B\\left ({z^{-1} }\\right)$\n</tex-math></inline-formula> and <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$A\\left ({z^{-1} }\\right)\\!$\n</tex-math></inline-formula>, respectively. <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\Delta $\n</tex-math></inline-formula> is the increment operator, <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\xi (t)$\n</tex-math></inline-formula> is the uncorrelated zero\u2013mean white noise and <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$T\\left ({z^{-1} }\\right)$\n</tex-math></inline-formula> is a (pre)filter to improve the system robustness that rejects disturbances and noise.</p><p>Using the model <a ref-type=\"disp-formula\" anchor=\"deqn7\" href=\"#deqn7\" class=\"fulltext-link\">(7)</a>, the future outputs <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$y(t+k\\vert t)$\n</tex-math></inline-formula> can be predicted at any time. So, it is common to write these outputs as the sum of two terms: controlled response and free response, <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$y\\left ({{t+k}\\thinspace \\vert \\thinspace t}\\right) =y_{C}\\left ({{t+k}\\thinspace \\vert \\thinspace t}\\right) +y_{F}(t+k\\vert t)$\n</tex-math></inline-formula>, with <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$y_{C}\\equiv G\\cdot \\Delta u$\n</tex-math></inline-formula> the part of the future output that depends on the future control <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\Delta u$\n</tex-math></inline-formula>; and <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$y_{F}$\n</tex-math></inline-formula> the part of the future output that does not depend on <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\Delta u$\n</tex-math></inline-formula>; <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$G$\n</tex-math></inline-formula> is a matrix with the step response coefficients of the model. For the sake of simplicity in the notation <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\left ({\\cdot \\vert t }\\right)$\n</tex-math></inline-formula> is omitted, since all expression from this point are referred to the present time <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$t$\n</tex-math></inline-formula>, unless otherwise stated.<disp-formula id=\"deqn8\" class=\"display-formula\"><tex-math notation=\"LaTeX\">\\begin{align*} G=\\left [{ {\\begin{array}{cccc} g_{1} &amp;\\quad 0 &amp;\\quad \\ldots &amp;\\quad 0\\\\ g_{2} &amp;\\quad g_{1} &amp;\\quad \\ldots &amp;\\quad 0\\\\ \\ldots &amp;\\quad \\ldots &amp;\\quad \\ldots &amp;\\quad \\ldots \\\\ g_{N} &amp;\\quad g_{N-1} &amp;\\quad \\ldots &amp;\\quad g_{N-N_{u}+1}\\\\ \\end{array}} }\\right]\\tag{8}\\end{align*}\n</tex-math><span class=\"formula\"><span class=\"link\">View Source</span><img aria-describedby=\"qtip-0\" style=\"display:inline;\" title=\"Right-click on figure or equation for MathML and additional features.\" data-hasqtip=\"0\" class=\"qtooltip moreInfo\" alt=\"Right-click on figure for MathML and additional features.\" src=\"/assets/img/icon.support.gif\" border=\"0\" height=\"20\" width=\"24\"/><span class=\"tex tex2jax_ignore\" style=\"display:none;\">\\begin{align*} G=\\left [{ {\\begin{array}{cccc} g_{1} &amp;\\quad 0 &amp;\\quad \\ldots &amp;\\quad 0\\\\ g_{2} &amp;\\quad g_{1} &amp;\\quad \\ldots &amp;\\quad 0\\\\ \\ldots &amp;\\quad \\ldots &amp;\\quad \\ldots &amp;\\quad \\ldots \\\\ g_{N} &amp;\\quad g_{N-1} &amp;\\quad \\ldots &amp;\\quad g_{N-N_{u}+1}\\\\ \\end{array}} }\\right]\\tag{8}\\end{align*}\n</span></span></disp-formula> where <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$N=N_{2}-N_{1}+1$\n</tex-math></inline-formula> represents the number of predictions to make.</p><p>On the other hand, the FGPC cost function has the expression <a ref-type=\"disp-formula\" anchor=\"deqn9\" href=\"#deqn9\" class=\"fulltext-link\">(9)</a> and it is defined by means of the fractional\u2013order definite integral operators <inline-formula id=\"\"><tex-math notation=\"LaTeX\">${}_{a}^{b} I^{\\alpha }(\\cdot)$\n</tex-math></inline-formula> discretized with sampling period <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\Delta t$\n</tex-math></inline-formula> and evaluated using <a ref-type=\"disp-formula\" anchor=\"deqn4\" href=\"#deqn4\" class=\"fulltext-link\">(4)</a>.<disp-formula id=\"deqn9\" class=\"display-formula\"><tex-math notation=\"LaTeX\">\\begin{equation*} J_{FGPC}\\left ({\\Delta u,t }\\right)={}^{\\alpha } I_{N_{1}}^{N_{2}}\\left [{ e(t) }\\right]^{2}+{}^{\\beta } I_{1}^{N_{u}}\\left [{ \\Delta u(t-1) }\\right]^{2}\\tag{9}\\end{equation*}\n</tex-math><span class=\"formula\"><span class=\"link\">View Source</span><img aria-describedby=\"qtip-0\" style=\"display:inline;\" title=\"Right-click on figure or equation for MathML and additional features.\" data-hasqtip=\"0\" class=\"qtooltip moreInfo\" alt=\"Right-click on figure for MathML and additional features.\" src=\"/assets/img/icon.support.gif\" border=\"0\" height=\"20\" width=\"24\"/><span class=\"tex tex2jax_ignore\" style=\"display:none;\">\\begin{equation*} J_{FGPC}\\left ({\\Delta u,t }\\right)={}^{\\alpha } I_{N_{1}}^{N_{2}}\\left [{ e(t) }\\right]^{2}+{}^{\\beta } I_{1}^{N_{u}}\\left [{ \\Delta u(t-1) }\\right]^{2}\\tag{9}\\end{equation*}\n</span></span></disp-formula> where <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$N_{1}$\n</tex-math></inline-formula> and <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$N_{2}$\n</tex-math></inline-formula> are the minimum and maximum costing horizons, respectively, <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$N_{u}$\n</tex-math></inline-formula> represents the control horizon, and it is assumed that <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$u(t)$\n</tex-math></inline-formula> remains constant from time instant <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$t+N_{u}\\left ({1\\le N_{u}\\le N_{2} }\\right)$\n</tex-math></inline-formula>. The parameters <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\alpha,\\beta \\epsilon \\mathbb {R}$\n</tex-math></inline-formula> are the orders of the fractional definite integral operator <a ref-type=\"disp-formula\" anchor=\"deqn4\" href=\"#deqn4\" class=\"fulltext-link\">(4)</a>, discretized with sampling period <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\Delta t$\n</tex-math></inline-formula>. This fractional operator, under very general assumptions and using the GL definition <a ref-type=\"disp-formula\" anchor=\"deqn1\" href=\"#deqn1\" class=\"fulltext-link\">(1)</a>, verifies the so\u2013called fractional\u2013order Barrow\u2019s rule <a ref-type=\"disp-formula\" anchor=\"deqn10\" href=\"#deqn10\" class=\"fulltext-link\">(10)</a>. See <a ref-type=\"bibr\" anchor=\"ref37\" id=\"context_ref_37_3a\">[37]</a> for a more exhaustive explanation.<disp-formula id=\"deqn10\" class=\"display-formula\"><tex-math notation=\"LaTeX\">\\begin{equation*} {}^{\\alpha } I_{a}^{b}f\\left ({x }\\right)=F^{\\alpha }\\left ({b }\\right)-F^{\\alpha }\\left ({a }\\right)\\tag{10}\\end{equation*}\n</tex-math><span class=\"formula\"><span class=\"link\">View Source</span><img aria-describedby=\"qtip-0\" style=\"display:inline;\" title=\"Right-click on figure or equation for MathML and additional features.\" data-hasqtip=\"0\" class=\"qtooltip moreInfo\" alt=\"Right-click on figure for MathML and additional features.\" src=\"/assets/img/icon.support.gif\" border=\"0\" height=\"20\" width=\"24\"/><span class=\"tex tex2jax_ignore\" style=\"display:none;\">\\begin{equation*} {}^{\\alpha } I_{a}^{b}f\\left ({x }\\right)=F^{\\alpha }\\left ({b }\\right)-F^{\\alpha }\\left ({a }\\right)\\tag{10}\\end{equation*}\n</span></span></disp-formula> where <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$F^{\\alpha }\\left ({x }\\right)\\equiv I^{\\alpha }f(x)$\n</tex-math></inline-formula> is any <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\alpha $\n</tex-math></inline-formula>-order primitive of <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$f(x)$\n</tex-math></inline-formula>.</p><p>After using the above operator, it is possible to translate the cost function <a ref-type=\"disp-formula\" anchor=\"deqn9\" href=\"#deqn9\" class=\"fulltext-link\">(9)</a> into its matrix form <a ref-type=\"disp-formula\" anchor=\"deqn11\" href=\"#deqn11\" class=\"fulltext-link\">(11)</a>. <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\Gamma $\n</tex-math></inline-formula> and <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\Lambda $\n</tex-math></inline-formula> represent infinite\u2013dimensional square real weighting matrices.<disp-formula id=\"deqn11\" class=\"display-formula\"><tex-math notation=\"LaTeX\">\\begin{align*} J_{FGPC}\\left ({\\Delta u,t }\\right)=e^{\\prime }\\Gamma \\left ({\\alpha,\\Delta t }\\right)e+\\Delta u'\\Lambda \\left ({\\beta,\\Delta t }\\right)\\Delta u \\tag{11}\\end{align*}\n</tex-math><span class=\"formula\"><span class=\"link\">View Source</span><img aria-describedby=\"qtip-0\" style=\"display:inline;\" title=\"Right-click on figure or equation for MathML and additional features.\" data-hasqtip=\"0\" class=\"qtooltip moreInfo\" alt=\"Right-click on figure for MathML and additional features.\" src=\"/assets/img/icon.support.gif\" border=\"0\" height=\"20\" width=\"24\"/><span class=\"tex tex2jax_ignore\" style=\"display:none;\">\\begin{align*} J_{FGPC}\\left ({\\Delta u,t }\\right)=e^{\\prime }\\Gamma \\left ({\\alpha,\\Delta t }\\right)e+\\Delta u'\\Lambda \\left ({\\beta,\\Delta t }\\right)\\Delta u \\tag{11}\\end{align*}\n</span></span></disp-formula></p><p>The discrete expression of the operator <a ref-type=\"disp-formula\" anchor=\"deqn10\" href=\"#deqn10\" class=\"fulltext-link\">(10)</a> can be found in <a ref-type=\"bibr\" anchor=\"ref37\" id=\"context_ref_37_3a\">[37]</a> but it is reproduced here for convenience and adapted to the notation of <a ref-type=\"disp-formula\" anchor=\"deqn11\" href=\"#deqn11\" class=\"fulltext-link\">(11)</a>.<disp-formula id=\"deqn12\" class=\"display-formula\"><tex-math notation=\"LaTeX\">\\begin{align*} \\Gamma \\equiv \\Delta t^{\\alpha }diag\\left ({{\\begin{array}{cccccc} \\ldots &amp;\\quad w_{m} &amp;\\quad w_{m-1} &amp;\\quad \\ldots &amp;\\quad w_{1} &amp;\\quad w_{0}\\\\ \\end{array}} }\\right) \\tag{12}\\end{align*}\n</tex-math><span class=\"formula\"><span class=\"link\">View Source</span><img aria-describedby=\"qtip-0\" style=\"display:inline;\" title=\"Right-click on figure or equation for MathML and additional features.\" data-hasqtip=\"0\" class=\"qtooltip moreInfo\" alt=\"Right-click on figure for MathML and additional features.\" src=\"/assets/img/icon.support.gif\" border=\"0\" height=\"20\" width=\"24\"/><span class=\"tex tex2jax_ignore\" style=\"display:none;\">\\begin{align*} \\Gamma \\equiv \\Delta t^{\\alpha }diag\\left ({{\\begin{array}{cccccc} \\ldots &amp;\\quad w_{m} &amp;\\quad w_{m-1} &amp;\\quad \\ldots &amp;\\quad w_{1} &amp;\\quad w_{0}\\\\ \\end{array}} }\\right) \\tag{12}\\end{align*}\n</span></span></disp-formula> with <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\begin{aligned} {\\begin{array}{ccc} w_{j}=\\omega _{j}-\\omega _{j-n}, &amp; n=N_{2}-N_{1}, &amp; \\omega _{k}=\\left ({-1 }\\right)^{k}\\left ({{\\begin{array}{c} -\\alpha \\\\ k\\\\ \\end{array}} }\\right)\\\\ \\end{array}} \\end{aligned}$\n</tex-math></inline-formula><disp-formula id=\"deqn13\" class=\"display-formula\"><tex-math notation=\"LaTeX\">\\begin{align*} \\Lambda \\equiv \\Delta t^{\\beta }\\mathrm {diag}\\left ({{\\begin{array}{cccccc} \\ldots &amp;\\quad w_{N_{u}-1} &amp;\\quad w_{N_{u}-2} &amp;\\quad \\ldots &amp;\\quad w_{1} &amp;\\quad w_{0}\\\\ \\end{array}} }\\right) \\tag{13}\\end{align*}\n</tex-math><span class=\"formula\"><span class=\"link\">View Source</span><img aria-describedby=\"qtip-0\" style=\"display:inline;\" title=\"Right-click on figure or equation for MathML and additional features.\" data-hasqtip=\"0\" class=\"qtooltip moreInfo\" alt=\"Right-click on figure for MathML and additional features.\" src=\"/assets/img/icon.support.gif\" border=\"0\" height=\"20\" width=\"24\"/><span class=\"tex tex2jax_ignore\" style=\"display:none;\">\\begin{align*} \\Lambda \\equiv \\Delta t^{\\beta }\\mathrm {diag}\\left ({{\\begin{array}{cccccc} \\ldots &amp;\\quad w_{N_{u}-1} &amp;\\quad w_{N_{u}-2} &amp;\\quad \\ldots &amp;\\quad w_{1} &amp;\\quad w_{0}\\\\ \\end{array}} }\\right) \\tag{13}\\end{align*}\n</span></span></disp-formula> with <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\begin{aligned} {\\begin{array}{ccc} w_{j}=\\omega _{j}-\\omega _{j-n}, &amp; n=N_{u}-1, &amp; \\omega _{k}=\\left ({-1 }\\right)^{k}\\left ({{\\begin{array}{c} -\\beta \\\\ k\\\\ \\end{array}} }\\right)\\\\ \\end{array}} \\end{aligned}$\n</tex-math></inline-formula></p><p>In order to obtain the FGPC optimal control law and due to the memory characteristic of the fractional operator, the matrix form of cost function is rewritten using a new notation where the symbols (<inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\to$\n</tex-math></inline-formula>) and (<inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\leftarrow$\n</tex-math></inline-formula>) represent future and past values, respectively <a ref-type=\"bibr\" anchor=\"ref27\" id=\"context_ref_27_3a\">[27]</a>.<disp-formula id=\"deqn14\" class=\"display-formula\"><tex-math notation=\"LaTeX\">\\begin{align*} J_{FGPC}=&amp;\\left [{ {\\begin{array}{cc} \\mathord {\\stackrel {{\\lower 3pt\\hbox {$\\scriptscriptstyle \\leftarrow $}}} e^{\\prime }} &amp;\\quad \\overrightarrow {e^{\\prime }}\\\\ \\end{array}} }\\right]\\left [{ {\\begin{array}{cc} \\mathord {\\stackrel {{\\lower 3pt\\hbox {$\\scriptscriptstyle \\leftarrow $}}} \\Gamma } &amp;\\quad 0\\\\ 0 &amp;\\quad \\overrightarrow {\\Gamma }\\\\ \\end{array}} }\\right]\\left [{ {\\begin{array}{c} \\mathord {\\stackrel {{\\lower 3pt\\hbox {$\\scriptscriptstyle \\leftarrow $}}} e} \\\\ \\overrightarrow {e}\\\\ \\end{array}} }\\right]+\\left [{ {\\begin{array}{cc} \\mathord {\\stackrel {{\\lower 3pt\\hbox {$\\leftarrow $}}} {\\Delta u^{\\prime }}} &amp;\\quad \\overrightarrow {\\Delta u^{\\prime }}\\\\ \\end{array}} }\\right] \\\\&amp;\\times \\left [{ {\\begin{array}{cc} \\mathord {\\stackrel {{\\lower 3pt\\hbox {$\\scriptscriptstyle \\leftarrow $}}} \\Lambda } &amp;\\quad 0\\\\ 0 &amp;\\quad \\overrightarrow {\\Lambda }\\\\ \\end{array}} }\\right]\\left [{ {\\begin{array}{c} \\mathord {\\stackrel {{\\lower 3pt\\hbox {$\\leftarrow $}}} {\\Delta u}} \\\\ \\overrightarrow {\\Delta u}\\\\ \\end{array}} }\\right] \\\\=&amp;\\left ({\\overrightarrow {e^{\\prime }}\\overrightarrow {\\Gamma }\\overrightarrow {e}+\\overrightarrow {\\Delta u'}\\overrightarrow {\\Lambda }\\overrightarrow {\\Delta u} }\\right)+\\left ({\\mathord {\\stackrel {{\\lower 3pt\\hbox {$\\scriptscriptstyle \\leftarrow $}}} e^{\\prime }} \\mathord {\\stackrel {{\\lower 3pt\\hbox {$\\scriptscriptstyle \\leftarrow $}}} \\Gamma } \\mathord {\\stackrel {{\\lower 3pt\\hbox {$\\scriptscriptstyle \\leftarrow $}}} e} +\\mathord {\\stackrel {{\\lower 3pt\\hbox {$\\scriptscriptstyle \\leftarrow $}}} {\\Delta u'}} \\mathord {\\stackrel {{\\lower 3pt\\hbox {$\\scriptscriptstyle \\leftarrow $}}} \\Lambda } \\mathord {\\stackrel {{\\lower 3pt\\hbox {$\\scriptscriptstyle \\leftarrow $}}} {\\Delta u}} }\\right) \\\\=&amp;\\overrightarrow {J_{FGPC}}+\\overleftarrow {J_{FGPC}}\\tag{14}\\end{align*}\n</tex-math><span class=\"formula\"><span class=\"link\">View Source</span><img aria-describedby=\"qtip-0\" style=\"display:inline;\" title=\"Right-click on figure or equation for MathML and additional features.\" data-hasqtip=\"0\" class=\"qtooltip moreInfo\" alt=\"Right-click on figure for MathML and additional features.\" src=\"/assets/img/icon.support.gif\" border=\"0\" height=\"20\" width=\"24\"/><span class=\"tex tex2jax_ignore\" style=\"display:none;\">\\begin{align*} J_{FGPC}=&amp;\\left [{ {\\begin{array}{cc} \\mathord {\\stackrel {{\\lower 3pt\\hbox {$\\scriptscriptstyle \\leftarrow $}}} e^{\\prime }} &amp;\\quad \\overrightarrow {e^{\\prime }}\\\\ \\end{array}} }\\right]\\left [{ {\\begin{array}{cc} \\mathord {\\stackrel {{\\lower 3pt\\hbox {$\\scriptscriptstyle \\leftarrow $}}} \\Gamma } &amp;\\quad 0\\\\ 0 &amp;\\quad \\overrightarrow {\\Gamma }\\\\ \\end{array}} }\\right]\\left [{ {\\begin{array}{c} \\mathord {\\stackrel {{\\lower 3pt\\hbox {$\\scriptscriptstyle \\leftarrow $}}} e} \\\\ \\overrightarrow {e}\\\\ \\end{array}} }\\right]+\\left [{ {\\begin{array}{cc} \\mathord {\\stackrel {{\\lower 3pt\\hbox {$\\leftarrow $}}} {\\Delta u^{\\prime }}} &amp;\\quad \\overrightarrow {\\Delta u^{\\prime }}\\\\ \\end{array}} }\\right] \\\\&amp;\\times \\left [{ {\\begin{array}{cc} \\mathord {\\stackrel {{\\lower 3pt\\hbox {$\\scriptscriptstyle \\leftarrow $}}} \\Lambda } &amp;\\quad 0\\\\ 0 &amp;\\quad \\overrightarrow {\\Lambda }\\\\ \\end{array}} }\\right]\\left [{ {\\begin{array}{c} \\mathord {\\stackrel {{\\lower 3pt\\hbox {$\\leftarrow $}}} {\\Delta u}} \\\\ \\overrightarrow {\\Delta u}\\\\ \\end{array}} }\\right] \\\\=&amp;\\left ({\\overrightarrow {e^{\\prime }}\\overrightarrow {\\Gamma }\\overrightarrow {e}+\\overrightarrow {\\Delta u'}\\overrightarrow {\\Lambda }\\overrightarrow {\\Delta u} }\\right)+\\left ({\\mathord {\\stackrel {{\\lower 3pt\\hbox {$\\scriptscriptstyle \\leftarrow $}}} e^{\\prime }} \\mathord {\\stackrel {{\\lower 3pt\\hbox {$\\scriptscriptstyle \\leftarrow $}}} \\Gamma } \\mathord {\\stackrel {{\\lower 3pt\\hbox {$\\scriptscriptstyle \\leftarrow $}}} e} +\\mathord {\\stackrel {{\\lower 3pt\\hbox {$\\scriptscriptstyle \\leftarrow $}}} {\\Delta u'}} \\mathord {\\stackrel {{\\lower 3pt\\hbox {$\\scriptscriptstyle \\leftarrow $}}} \\Lambda } \\mathord {\\stackrel {{\\lower 3pt\\hbox {$\\scriptscriptstyle \\leftarrow $}}} {\\Delta u}} }\\right) \\\\=&amp;\\overrightarrow {J_{FGPC}}+\\overleftarrow {J_{FGPC}}\\tag{14}\\end{align*}\n</span></span></disp-formula></p><p>The manipulated independent variable is <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\overrightarrow {\\Delta u}$\n</tex-math></inline-formula>, the optimal control law is given by the expression <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\Delta u_{FGPC}^{\\ast }\\left ({t }\\right)=\\arg J_{FGPC}$\n</tex-math></inline-formula>.</p><p>Although the cost function <a ref-type=\"disp-formula\" anchor=\"deqn14\" href=\"#deqn14\" class=\"fulltext-link\">(14)</a> has two terms, past and future values of the variables, the minimization only depends on the future ones. On the other hand, predictions are made using the model <a ref-type=\"disp-formula\" anchor=\"deqn7\" href=\"#deqn7\" class=\"fulltext-link\">(7)</a>. Therefore <disp-formula id=\"deqn15\" class=\"display-formula\"><tex-math notation=\"LaTeX\">\\begin{align*} \\overrightarrow {J_{FGPC}}=\\overrightarrow {\\Delta u'}\\left ({G'\\overrightarrow {\\Gamma }G+\\overrightarrow {\\Lambda } }\\right)\\overrightarrow {\\Delta u}-2\\overrightarrow {E_{0}^{\\prime }}\\overrightarrow {\\Gamma }G\\overrightarrow {\\Delta u}+\\overrightarrow {E_{0}^{\\prime }}\\overrightarrow {\\Gamma }\\overrightarrow {E_{0}} \\!\\!\\!\\tag{15}\\end{align*}\n</tex-math><span class=\"formula\"><span class=\"link\">View Source</span><img aria-describedby=\"qtip-0\" style=\"display:inline;\" title=\"Right-click on figure or equation for MathML and additional features.\" data-hasqtip=\"0\" class=\"qtooltip moreInfo\" alt=\"Right-click on figure for MathML and additional features.\" src=\"/assets/img/icon.support.gif\" border=\"0\" height=\"20\" width=\"24\"/><span class=\"tex tex2jax_ignore\" style=\"display:none;\">\\begin{align*} \\overrightarrow {J_{FGPC}}=\\overrightarrow {\\Delta u'}\\left ({G'\\overrightarrow {\\Gamma }G+\\overrightarrow {\\Lambda } }\\right)\\overrightarrow {\\Delta u}-2\\overrightarrow {E_{0}^{\\prime }}\\overrightarrow {\\Gamma }G\\overrightarrow {\\Delta u}+\\overrightarrow {E_{0}^{\\prime }}\\overrightarrow {\\Gamma }\\overrightarrow {E_{0}} \\!\\!\\!\\tag{15}\\end{align*}\n</span></span></disp-formula></p><p>The predictive errors vector has the expression <a ref-type=\"disp-formula\" anchor=\"deqn16\" href=\"#deqn16\" class=\"fulltext-link\">(16)</a>.<disp-formula id=\"deqn16\" class=\"display-formula\"><tex-math notation=\"LaTeX\">\\begin{align*} E_{0}\\equiv \\left ({e_{0}\\left ({t+1 }\\right)\\!,\\ldots,e_{0}\\left ({t+N_{2} }\\right) }\\right)'=r(t+j)-y_{F}(t+j) \\tag{16}\\end{align*}\n</tex-math><span class=\"formula\"><span class=\"link\">View Source</span><img aria-describedby=\"qtip-0\" style=\"display:inline;\" title=\"Right-click on figure or equation for MathML and additional features.\" data-hasqtip=\"0\" class=\"qtooltip moreInfo\" alt=\"Right-click on figure for MathML and additional features.\" src=\"/assets/img/icon.support.gif\" border=\"0\" height=\"20\" width=\"24\"/><span class=\"tex tex2jax_ignore\" style=\"display:none;\">\\begin{align*} E_{0}\\equiv \\left ({e_{0}\\left ({t+1 }\\right)\\!,\\ldots,e_{0}\\left ({t+N_{2} }\\right) }\\right)'=r(t+j)-y_{F}(t+j) \\tag{16}\\end{align*}\n</span></span></disp-formula></p><p>Finally, the optimal control law has the expression <a ref-type=\"disp-formula\" anchor=\"deqn17\" href=\"#deqn17\" class=\"fulltext-link\">(17)</a> without active constraints.<disp-formula id=\"deqn17\" class=\"display-formula\"><tex-math notation=\"LaTeX\">\\begin{align*} \\Delta u_{FGPC}^{\\ast }\\left ({t }\\right)=&amp;{arg}~\\mathop {min}\\limits _{\\Delta u}~J_{FGPC}=\\left ({G'\\overrightarrow {\\Gamma }G\\!+\\!\\overrightarrow {\\Lambda } }\\right)^{-1}G'\\overrightarrow {\\Gamma }\\overrightarrow {E_{0}} \\\\\\equiv&amp;K\\overrightarrow {E_{0}}\\tag{17}\\end{align*}\n</tex-math><span class=\"formula\"><span class=\"link\">View Source</span><img aria-describedby=\"qtip-0\" style=\"display:inline;\" title=\"Right-click on figure or equation for MathML and additional features.\" data-hasqtip=\"0\" class=\"qtooltip moreInfo\" alt=\"Right-click on figure for MathML and additional features.\" src=\"/assets/img/icon.support.gif\" border=\"0\" height=\"20\" width=\"24\"/><span class=\"tex tex2jax_ignore\" style=\"display:none;\">\\begin{align*} \\Delta u_{FGPC}^{\\ast }\\left ({t }\\right)=&amp;{arg}~\\mathop {min}\\limits _{\\Delta u}~J_{FGPC}=\\left ({G'\\overrightarrow {\\Gamma }G\\!+\\!\\overrightarrow {\\Lambda } }\\right)^{-1}G'\\overrightarrow {\\Gamma }\\overrightarrow {E_{0}} \\\\\\equiv&amp;K\\overrightarrow {E_{0}}\\tag{17}\\end{align*}\n</span></span></disp-formula></p><p>This optimization problem has a solution if the matrix <a ref-type=\"disp-formula\" anchor=\"deqn18\" href=\"#deqn18\" class=\"fulltext-link\">(18)</a> can be inverted. This square hessian matrix is symmetric, and its eigenvalues determine the closed\u2013loop system response.<disp-formula id=\"deqn18\" class=\"display-formula\"><tex-math notation=\"LaTeX\">\\begin{equation*} H=G^{\\prime }\\overrightarrow {\\Gamma }G+\\overrightarrow {\\Lambda }\\tag{18}\\end{equation*}\n</tex-math><span class=\"formula\"><span class=\"link\">View Source</span><img aria-describedby=\"qtip-0\" style=\"display:inline;\" title=\"Right-click on figure or equation for MathML and additional features.\" data-hasqtip=\"0\" class=\"qtooltip moreInfo\" alt=\"Right-click on figure for MathML and additional features.\" src=\"/assets/img/icon.support.gif\" border=\"0\" height=\"20\" width=\"24\"/><span class=\"tex tex2jax_ignore\" style=\"display:none;\">\\begin{equation*} H=G^{\\prime }\\overrightarrow {\\Gamma }G+\\overrightarrow {\\Lambda }\\tag{18}\\end{equation*}\n</span></span></disp-formula></p><p>As it is well\u2013known, if matrix <a ref-type=\"disp-formula\" anchor=\"deqn18\" href=\"#deqn18\" class=\"fulltext-link\">(18)</a> is positive\u2013definite, that is, all its eigenvalues are positive, then the solution of optimization problem is unique. Thus, we could have some negative values in the weighting sequences but <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$H$\n</tex-math></inline-formula> would be positive definite.</p><p>This optimization without activating the constraints leads to a control law that is linear time invariant (LTI) and can be pre\u2013computed in advance. The equivalent closed loop control schema is shown in <a ref-type=\"fig\" anchor=\"fig2\" class=\"fulltext-link\">Figure 2</a>.\n<div class=\"figure figure-full\" id=\"fig2\"><!--\n          Workaround for combined images.Eg.- 1000116 Fig. 5\n        --><div class=\"img-wrap\"><a href=\"/mediastore_new/IEEE/content/media/6287639/9668973/9975294/romer2-3227864-large.gif\" data-fig-id=\"fig2\"><img src=\"/mediastore_new/IEEE/content/media/6287639/9668973/9975294/romer2-3227864-small.gif\" alt=\"FIGURE 2. - Closed\u2013loop equivalent control system schema.\"/><div class=\"zoom\" title=\"View Larger Image\"/></a></div><div class=\"figcaption\"><b class=\"title\">FIGURE 2. </b><fig><p>Closed\u2013loop equivalent control system schema.</p></fig></div><p class=\"links\"><a href=\"/document/9975294/all-figures\" class=\"all\">Show All</a></p></div></p><p>The polynomials <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$R_{c}$\n</tex-math></inline-formula> and <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$S_{c}$\n</tex-math></inline-formula> are obtained from the model polynomials <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$A$\n</tex-math></inline-formula> and <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$B$\n</tex-math></inline-formula>. See <a ref-type=\"bibr\" anchor=\"ref38\" id=\"context_ref_38_3a\">[38]</a> for an exhaustive explanation.</p><p><inline-formula id=\"\"><tex-math notation=\"LaTeX\">$T_{c}$\n</tex-math></inline-formula> is considered as a filter mainly due to the incremental constitution of control law. The selection of the polynomial <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$T_{c}$\n</tex-math></inline-formula> is not an easy task, there exist a general guideline in the manuscript <a ref-type=\"bibr\" anchor=\"ref39\" id=\"context_ref_39_3a\">[39]</a> where it is recommended the expression <a ref-type=\"disp-formula\" anchor=\"deqn19\" href=\"#deqn19\" class=\"fulltext-link\">(19)</a>.<disp-formula id=\"deqn19\" class=\"display-formula\"><tex-math notation=\"LaTeX\">\\begin{equation*} T_{c}(z^{-1})=\\left ({1-\\rho z^{-1} }\\right)^{N_{1}}\\tag{19}\\end{equation*}\n</tex-math><span class=\"formula\"><span class=\"link\">View Source</span><img aria-describedby=\"qtip-0\" style=\"display:inline;\" title=\"Right-click on figure or equation for MathML and additional features.\" data-hasqtip=\"0\" class=\"qtooltip moreInfo\" alt=\"Right-click on figure for MathML and additional features.\" src=\"/assets/img/icon.support.gif\" border=\"0\" height=\"20\" width=\"24\"/><span class=\"tex tex2jax_ignore\" style=\"display:none;\">\\begin{equation*} T_{c}(z^{-1})=\\left ({1-\\rho z^{-1} }\\right)^{N_{1}}\\tag{19}\\end{equation*}\n</span></span></disp-formula> where <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\rho $\n</tex-math></inline-formula> is recommended to be closed to the dominant pole of the system model.</p><p>Sensitive functions will play an important role in the tuning method explained posteriorly. Although many sensitivity functions can be defined in predictive control <a ref-type=\"bibr\" anchor=\"ref23\" id=\"context_ref_23_3a\">[23]</a>, we shall only consider two of them, the <i>classical</i> <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$S$\n</tex-math></inline-formula> and <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$T$\n</tex-math></inline-formula> functions which expressions are <a ref-type=\"disp-formula\" anchor=\"deqn20-deqn21\" href=\"#deqn20-deqn21\" class=\"fulltext-link\">(20)</a> and <a ref-type=\"disp-formula\" anchor=\"deqn20-deqn21\" href=\"#deqn20-deqn21\" class=\"fulltext-link\">(21)</a>, respectively.<disp-formula id=\"deqn20-deqn21\" class=\"display-formula\"><tex-math notation=\"LaTeX\">\\begin{align*} S=&amp;\\frac {R_{c}\\Delta A}{R_{c}\\Delta A+S_{c}B}\\tag{20}\\\\ T=&amp;\\frac {S_{c}B}{R_{c}\\Delta A+S_{c}B}\\tag{21}\\end{align*}\n</tex-math><span class=\"formula\"><span class=\"link\">View Source</span><img aria-describedby=\"qtip-0\" style=\"display:inline;\" title=\"Right-click on figure or equation for MathML and additional features.\" data-hasqtip=\"0\" class=\"qtooltip moreInfo\" alt=\"Right-click on figure for MathML and additional features.\" src=\"/assets/img/icon.support.gif\" border=\"0\" height=\"20\" width=\"24\"/><span class=\"tex tex2jax_ignore\" style=\"display:none;\">\\begin{align*} S=&amp;\\frac {R_{c}\\Delta A}{R_{c}\\Delta A+S_{c}B}\\tag{20}\\\\ T=&amp;\\frac {S_{c}B}{R_{c}\\Delta A+S_{c}B}\\tag{21}\\end{align*}\n</span></span></disp-formula></p></div><div class=\"section_2\" id=\"sec3b\"><h3>B. Practical Tuning of FGPC Using MATLAB<sup>TM</sup> Optimization Toolbox</h3><p>The proposed optimal tuning method for FGPC is shown in the Appendix of this manuscript. This method allows us to set horizon parameters together with fractional orders using different mathematical solvers included in numeric computing software as Matlab, GNU Octave\u2026 Evidently, this is a critical task because closed\u2013loop system performance depends on this choice.</p><p>The optimization toolbox of Matlab provides functions to find parameters that minimize or maximize the objectives subjects to a set of constraints. Specifically, it includes solvers for general optimization problems as the one described above. As the previous set of functions to optimize are continuous, <a ref-type=\"disp-formula\" anchor=\"deqn37\" href=\"#deqn37\" class=\"fulltext-link\">(37)</a><a ref-type=\"disp-formula\" anchor=\"deqn38\" href=\"#deqn38\" class=\"fulltext-link\"/><a ref-type=\"disp-formula\" anchor=\"deqn39\" href=\"#deqn39\" class=\"fulltext-link\"/><a ref-type=\"disp-formula\" anchor=\"deqn40\" href=\"#deqn40\" class=\"fulltext-link\"/>\u2013<a ref-type=\"disp-formula\" anchor=\"deqn41\" href=\"#deqn41\" class=\"fulltext-link\">(41)</a>, we have chosen specifically two solvers to resolve it. The solver for nonlinear optimization problems, <i>fmincon</i>, and the solver that uses genetic algorithms, <i>ga</i>. Both of them have a similar syntaxis:</p><p><b>mincon(@objfun,x0,[],[],[],[],[],[],@confuneq,options)</b></p><p>where: \n<ul style=\"list-style-type:disc\"><li><p>objfun: main function to optimize.</p></li><li><p>x0: initial values.</p></li><li><p>confuneq: constraints.</p></li><li><p>options: optimization options.</p></li></ul></p><p><b>ga(@objfun,nvars,[],[],[],[],[],[],@confuneq,options)</b></p><p>where:\n<ul style=\"list-style-type:disc\"><li><p>objfun: main function to optimize.</p></li><li><p>nvars: number of variables.</p></li><li><p>confuneq: constraints.</p></li><li><p>options: optimization options (in this case, initial values are passed within this vector of parameters).</p></li></ul></p><p>In order to illustrate the optimization process, two FGPC controllers will be tuned using previous solvers. The dynamics of the plant to be controlled has been discretized with a sampling time equal to 0.1 s. Its transfer function is shown in expression <a ref-type=\"disp-formula\" anchor=\"deqn22\" href=\"#deqn22\" class=\"fulltext-link\">(22)</a>.<disp-formula id=\"deqn22\" class=\"display-formula\"><tex-math notation=\"LaTeX\">\\begin{equation*} G\\left ({z^{-1} }\\right)=\\frac {0.0952}{1-0.9048z^{-1}}z^{-1}\\tag{22}\\end{equation*}\n</tex-math><span class=\"formula\"><span class=\"link\">View Source</span><img aria-describedby=\"qtip-0\" style=\"display:inline;\" title=\"Right-click on figure or equation for MathML and additional features.\" data-hasqtip=\"0\" class=\"qtooltip moreInfo\" alt=\"Right-click on figure for MathML and additional features.\" src=\"/assets/img/icon.support.gif\" border=\"0\" height=\"20\" width=\"24\"/><span class=\"tex tex2jax_ignore\" style=\"display:none;\">\\begin{equation*} G\\left ({z^{-1} }\\right)=\\frac {0.0952}{1-0.9048z^{-1}}z^{-1}\\tag{22}\\end{equation*}\n</span></span></disp-formula></p><p>Both controllers will be obtained using the following parameters:\n<ul style=\"list-style-type:disc\"><li><p><inline-formula id=\"\"><tex-math notation=\"LaTeX\">$N_{1}=1$\n</tex-math></inline-formula></p></li><li><p><inline-formula id=\"\"><tex-math notation=\"LaTeX\">$N_{u}=2$\n</tex-math></inline-formula></p></li><li><p><inline-formula id=\"\"><tex-math notation=\"LaTeX\">$N_{2}=30$\n</tex-math></inline-formula></p></li><li><p><inline-formula id=\"\"><tex-math notation=\"LaTeX\">$T_{c}\\left ({z^{-1} }\\right)=1-0.9z^{-1}$\n</tex-math></inline-formula> (Using prefilter.)</p></li></ul></p><p>and they will be optimized to fulfill the following requirements: \n<ul style=\"list-style-type:disc\"><li><p>Maximize the gain margin (no specification is set on the phase margin).</p></li><li><p><inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\left |{ S(j\\omega) }\\right |\\le -15\\,dB\\,\\,\\mathrm {for}\\,\\,\\omega \\le 0.1\\,rad/s$\n</tex-math></inline-formula></p></li><li><p><inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\left |{ T(j\\omega) }\\right |\\le -15\\,dB\\,\\,\\mathrm {for}\\,\\,\\omega \\ge 10\\,rad/s$\n</tex-math></inline-formula></p></li></ul></p><p>In order to find the optimal pair <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\alpha $\n</tex-math></inline-formula> and <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\beta $\n</tex-math></inline-formula>, an initial seed is needed to initialize the optimization algorithm. To do so, the gain and phase margin is calculated for different values of the fractional parameters, obtaining the graphic representation that is depicted in <a ref-type=\"fig\" anchor=\"fig3\" class=\"fulltext-link\">Figure 3</a> and <a ref-type=\"fig\" anchor=\"fig4\" class=\"fulltext-link\">Figure 4</a>.\n<div class=\"figure figure-full\" id=\"fig3\"><!--\n          Workaround for combined images.Eg.- 1000116 Fig. 5\n        --><div class=\"img-wrap\"><a href=\"/mediastore_new/IEEE/content/media/6287639/9668973/9975294/romer3-3227864-large.gif\" data-fig-id=\"fig3\"><img src=\"/mediastore_new/IEEE/content/media/6287639/9668973/9975294/romer3-3227864-small.gif\" alt=\"FIGURE 3. - Gain margin vs. &#10;$\\alpha $&#10; and &#10;$\\beta $&#10; for obtained optimization seed.\"/><div class=\"zoom\" title=\"View Larger Image\"/></a></div><div class=\"figcaption\"><b class=\"title\">FIGURE 3. </b><fig><p>Gain margin vs. <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\alpha $\n</tex-math></inline-formula> and <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\beta $\n</tex-math></inline-formula> for obtained optimization seed.</p></fig></div><p class=\"links\"><a href=\"/document/9975294/all-figures\" class=\"all\">Show All</a></p></div>\n<div class=\"figure figure-full\" id=\"fig4\"><!--\n          Workaround for combined images.Eg.- 1000116 Fig. 5\n        --><div class=\"img-wrap\"><a href=\"/mediastore_new/IEEE/content/media/6287639/9668973/9975294/romer4-3227864-large.gif\" data-fig-id=\"fig4\"><img src=\"/mediastore_new/IEEE/content/media/6287639/9668973/9975294/romer4-3227864-small.gif\" alt=\"FIGURE 4. - Phase margin vs. &#10;$\\alpha $&#10; and &#10;$\\beta $&#10; for obtained optimization seed.\"/><div class=\"zoom\" title=\"View Larger Image\"/></a></div><div class=\"figcaption\"><b class=\"title\">FIGURE 4. </b><fig><p>Phase margin vs. <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\alpha $\n</tex-math></inline-formula> and <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\beta $\n</tex-math></inline-formula> for obtained optimization seed.</p></fig></div><p class=\"links\"><a href=\"/document/9975294/all-figures\" class=\"all\">Show All</a></p></div></p><p>The values <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\alpha _{0}=0.9$\n</tex-math></inline-formula> and <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\beta _{0}=0.8$\n</tex-math></inline-formula> are selected as seed to start the optimization algorithm due to their corresponding initially good gain and phase margins.</p><p>The optimization process has been carried out in an interval of 20\u201330 seconds for <i>fmincon</i> solver and 60\u2013100 seconds for <i>ga</i> solver using a PC computer with AMD Ryzen<inline-formula id=\"\"><tex-math notation=\"LaTeX\">$^{\\mathrm {TM}}~1600$\n</tex-math></inline-formula> processor running MATLAB<inline-formula id=\"\"><tex-math notation=\"LaTeX\">$^{\\mathrm {TM}}~2019\\text{b}$\n</tex-math></inline-formula>. The results of the optimization process as well as the parameters of the resulting system are shown in the <a ref-type=\"table\" anchor=\"table1\" class=\"fulltext-link\">Table 1</a>.<div class=\"figure figure-full table\" id=\"table1\"><div class=\"figcaption\"><b class=\"title\">TABLE 1 </b>\nResults of the Optimization Process</div><div class=\"img-wrap\"><a href=\"/mediastore_new/IEEE/content/media/6287639/9668973/9975294/romer.t1-3227864-large.gif\"><img src=\"/mediastore_new/IEEE/content/media/6287639/9668973/9975294/romer.t1-3227864-small.gif\" alt=\"Table 1- &#10;Results of the Optimization Process\"/><div class=\"zoom\" title=\"View Larger Image\"/></a></div></div></p><p>Both systems are stable and have definite-positive <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$H$\n</tex-math></inline-formula> matrices with the following eigenvalues (0.5179, 3.4051) and (0.5481, 2.7256) for the <i>fmincon</i> and <i>ga</i> solvers, respectively. They also meet the requirements imposed in terms of sensitivity functions as shown in <a ref-type=\"fig\" anchor=\"fig5\" class=\"fulltext-link\">Figure 5</a>. The gain margin obtained with the solver <i>fmincon</i> is larger, but the system obtained by means of the solver <i>ga</i> has better phase margin, although it is not the objective of this optimization.\n<div class=\"figure figure-full\" id=\"fig5\"><!--\n          Workaround for combined images.Eg.- 1000116 Fig. 5\n        --><div class=\"img-wrap\"><a href=\"/mediastore_new/IEEE/content/media/6287639/9668973/9975294/romer5-3227864-large.gif\" data-fig-id=\"fig5\"><img src=\"/mediastore_new/IEEE/content/media/6287639/9668973/9975294/romer5-3227864-small.gif\" alt=\"FIGURE 5. - Sensitivity functions comparison.\"/><div class=\"zoom\" title=\"View Larger Image\"/></a></div><div class=\"figcaption\"><b class=\"title\">FIGURE 5. </b><fig><p>Sensitivity functions comparison.</p></fig></div><p class=\"links\"><a href=\"/document/9975294/all-figures\" class=\"all\">Show All</a></p></div></p><p><a ref-type=\"fig\" anchor=\"fig6\" class=\"fulltext-link\">Figure 6</a> depicts the responses of both systems. The system response with the controller obtained by <i>fmincon</i> solver is represented in blue line and the system response with the controller obtained by <i>ga</i> solver is represented in green line. One observes that these responses are quite similar. They follow the reference with no overshoot and fulfilling gain margins, sensitivity functions and robustness specifications in an easy and straightforward way.\n<div class=\"figure figure-full\" id=\"fig6\"><!--\n          Workaround for combined images.Eg.- 1000116 Fig. 5\n        --><div class=\"img-wrap\"><a href=\"/mediastore_new/IEEE/content/media/6287639/9668973/9975294/romer6-3227864-large.gif\" data-fig-id=\"fig6\"><img src=\"/mediastore_new/IEEE/content/media/6287639/9668973/9975294/romer6-3227864-small.gif\" alt=\"FIGURE 6. - Step responses of FGPC controllers.\"/><div class=\"zoom\" title=\"View Larger Image\"/></a></div><div class=\"figcaption\"><b class=\"title\">FIGURE 6. </b><fig><p>Step responses of FGPC controllers.</p></fig></div><p class=\"links\"><a href=\"/document/9975294/all-figures\" class=\"all\">Show All</a></p></div></p><p>In practice, due to the optimization problem and the constraints involved, the procedure described here must be repeated a few times. Normally, in the first attempts the solvers could not converge and we would not obtain the desired results due to feasibility problems. However, the experience gained during one of the runs is used to better adjust of the parameters such as the initial seed in the next run until consistent results are obtained. Moreover, this method discards during the execution of the algorithm those systems that are unstable.</p></div></div>\n<div class=\"section\" id=\"sec4\"><div class=\"header article-hdr\"><div class=\"kicker\">\n\t\t                        SECTION IV.</div><h2>Fractional Constraints</h2></div><p>Although any real control system is subject to diverse types of constrains: physical restrictions (actuators have a minimum and a maximum value that limit their operations), security boundaries (outside of them, the system integrity and people safety are not guaranteed), product quality specifications (without them, the product would not meet the established standards), technological requirements, etc. <a ref-type=\"bibr\" anchor=\"ref40\" id=\"context_ref_40_4\">[40]</a>; It is not usual that these constraints have been set explicitly in the design of many control strategies. Therefore, the designed controllers could result in inadequate closed\u2013loop performance or undesirable behavior.</p><p>In the case of predictive controllers, the constraints are introduced natively in the cost function. Therefore, they are systematically included during the controller design process, constituting one of the most important advantages of this control strategy in comparison with others. However, as the optimal control sequence must be obtained at each sampling time by minimization of the cost function <a ref-type=\"disp-formula\" anchor=\"deqn14\" href=\"#deqn14\" class=\"fulltext-link\">(14)</a> subject to set of constraints <a ref-type=\"disp-formula\" anchor=\"deqn6\" href=\"#deqn6\" class=\"fulltext-link\">(6)</a>, including these constraints leads to an increase of the computational cost necessary to solve the mathematical problem in real time.</p><p>Due to the growing presence of systems with fractional operating dynamics such as fuel cells <a ref-type=\"bibr\" anchor=\"ref41\" id=\"context_ref_41_4\">[41]</a>, supercapacitors <a ref-type=\"bibr\" anchor=\"ref42\" id=\"context_ref_42_4\">[42]</a> or applications in viscoelasticity <a ref-type=\"bibr\" anchor=\"ref43\" id=\"context_ref_43_4\">[43]</a>, the inclusion in the control strategy of constraints that act on the fractional increments of certain variables could be necessary. To this purpose, their formulation will be generalized in the same way as in the formulation of the cost function of the controller. Furthermore, in this paper, they are utilized to define a new method to soften constraints applying fractional operators, which may be of interest even for applications that do not present these fractional dynamics.</p><p>It is well known that the presence of hard constraints in predictive control strategies could lead to infeasibility causing instabilities <a ref-type=\"bibr\" anchor=\"ref44\" id=\"context_ref_44_4\">[44]</a>. In order to avoid them, some constraints could be relaxed by treating them as soft constraints. The case of infeasibility is treated by other authors using techniques as introducing slack variables that soften some of the constraints or even temporally removing some of them <a ref-type=\"bibr\" anchor=\"ref45\" id=\"context_ref_45_4\">[45]</a>.</p><p>Having these ideas in mind, we consider the possibility of introducing constraints with fractional behavior in our fractional predictive control strategy. To do so, we introduce the fractional <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\delta $\n</tex-math></inline-formula>\u2013increment of the future value of the control signal, <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$u(t+N_{u}-1)$\n</tex-math></inline-formula>, depending on the control horizon, <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$N_{u}$\n</tex-math></inline-formula>. Expression <a ref-type=\"disp-formula\" anchor=\"deqn23\" href=\"#deqn23\" class=\"fulltext-link\">(23)</a> shows the fractional expansion using the binomial expression <a ref-type=\"disp-formula\" anchor=\"deqn3\" href=\"#deqn3\" class=\"fulltext-link\">(3)</a>.<disp-formula id=\"deqn23\" class=\"display-formula\"><tex-math notation=\"LaTeX\">\\begin{align*} D^{\\delta }u\\left ({t+N_{u}-1 }\\right)=\\lim \\limits _{h\\to 0}{h^{-\\delta }\\sum \\limits _{j=0}^{\\infty} {\\omega _{j}u\\left ({t+N_{u}-1-j }\\right)}} \\tag{23}\\end{align*}\n</tex-math><span class=\"formula\"><span class=\"link\">View Source</span><img aria-describedby=\"qtip-0\" style=\"display:inline;\" title=\"Right-click on figure or equation for MathML and additional features.\" data-hasqtip=\"0\" class=\"qtooltip moreInfo\" alt=\"Right-click on figure for MathML and additional features.\" src=\"/assets/img/icon.support.gif\" border=\"0\" height=\"20\" width=\"24\"/><span class=\"tex tex2jax_ignore\" style=\"display:none;\">\\begin{align*} D^{\\delta }u\\left ({t+N_{u}-1 }\\right)=\\lim \\limits _{h\\to 0}{h^{-\\delta }\\sum \\limits _{j=0}^{\\infty} {\\omega _{j}u\\left ({t+N_{u}-1-j }\\right)}} \\tag{23}\\end{align*}\n</span></span></disp-formula></p><p>The value of the fractional <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\delta $\n</tex-math></inline-formula>\u2013increment has the expression:<disp-formula id=\"deqn24\" class=\"display-formula\"><tex-math notation=\"LaTeX\">\\begin{align*} \\Delta ^{\\delta }u\\left ({t+N_{u}-1 }\\right)=&amp;\\sum \\limits _{j=0}^{\\infty} {\\omega _{j}u\\left ({t+N_{u}-1-j }\\right)} \\\\=&amp;\\left [{ \\omega _{0}u\\left ({t+N_{u}-1 }\\right)+\\omega _{1}u\\left ({t+N_{u}-2 }\\right)}\\right. \\\\&amp;+\\ldots +\\omega _{N_{u}-1}u\\left ({t }\\right)+\\omega _{N_{u}}u\\left ({t-1 }\\right) \\\\&amp;\\left.{+\\,\\omega _{N_{u+1}}u\\left ({t-2 }\\right)+\\ldots }\\right] \\\\=&amp;\\left [{ \\sum \\mathord {\\stackrel {{\\lower 3pt\\hbox {$\\scriptscriptstyle \\leftarrow $}}} u} +\\sum \\overrightarrow {u} }\\right]\\tag{24}\\end{align*}\n</tex-math><span class=\"formula\"><span class=\"link\">View Source</span><img aria-describedby=\"qtip-0\" style=\"display:inline;\" title=\"Right-click on figure or equation for MathML and additional features.\" data-hasqtip=\"0\" class=\"qtooltip moreInfo\" alt=\"Right-click on figure for MathML and additional features.\" src=\"/assets/img/icon.support.gif\" border=\"0\" height=\"20\" width=\"24\"/><span class=\"tex tex2jax_ignore\" style=\"display:none;\">\\begin{align*} \\Delta ^{\\delta }u\\left ({t+N_{u}-1 }\\right)=&amp;\\sum \\limits _{j=0}^{\\infty} {\\omega _{j}u\\left ({t+N_{u}-1-j }\\right)} \\\\=&amp;\\left [{ \\omega _{0}u\\left ({t+N_{u}-1 }\\right)+\\omega _{1}u\\left ({t+N_{u}-2 }\\right)}\\right. \\\\&amp;+\\ldots +\\omega _{N_{u}-1}u\\left ({t }\\right)+\\omega _{N_{u}}u\\left ({t-1 }\\right) \\\\&amp;\\left.{+\\,\\omega _{N_{u+1}}u\\left ({t-2 }\\right)+\\ldots }\\right] \\\\=&amp;\\left [{ \\sum \\mathord {\\stackrel {{\\lower 3pt\\hbox {$\\scriptscriptstyle \\leftarrow $}}} u} +\\sum \\overrightarrow {u} }\\right]\\tag{24}\\end{align*}\n</span></span></disp-formula></p><p>Once the expression of the summation is performed in <a ref-type=\"disp-formula\" anchor=\"deqn24\" href=\"#deqn24\" class=\"fulltext-link\">(24)</a>, it is obtained the expression of <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\delta $\n</tex-math></inline-formula>\u2013increment of the control signal, <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\Delta ^{\\delta }u$\n</tex-math></inline-formula>. Analogously to what happened with the cost function <a ref-type=\"disp-formula\" anchor=\"deqn14\" href=\"#deqn14\" class=\"fulltext-link\">(14)</a>, the expression <a ref-type=\"disp-formula\" anchor=\"deqn24\" href=\"#deqn24\" class=\"fulltext-link\">(24)</a> depends on the values of the control signal, <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$u\\left ({t+k }\\right)$\n</tex-math></inline-formula> and presents two terms: one that depends on the future values (when <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$k$\n</tex-math></inline-formula> is higher or equal to 0), <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\overrightarrow {u}$\n</tex-math></inline-formula>, and another ones that depends on the past values of this signal (when <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$k$\n</tex-math></inline-formula> is less than 0), <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\mathord {\\stackrel {{\\lower 3pt\\hbox {$\\scriptscriptstyle \\leftarrow $}}} u}$\n</tex-math></inline-formula>. Assuming: \n<ul style=\"list-style-type:disc\"><li><p>a sufficiently high value of <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$N_{u}$\n</tex-math></inline-formula>, and</p></li><li><p>the past terms of increments <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\mathord {\\stackrel {{\\lower 3pt\\hbox {$\\scriptscriptstyle \\leftarrow $}}} u} $\n</tex-math></inline-formula> are not variables but constants. Therefore, they do not affect to the optimization problem.</p></li></ul></p><p>We can represent the constraint <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\Delta ^{\\delta }u(t+N_{u}-1)\\le \\Delta ^{\\delta }u_{max}$\n</tex-math></inline-formula> in the form <a ref-type=\"disp-formula\" anchor=\"deqn25\" href=\"#deqn25\" class=\"fulltext-link\">(25)</a>.<disp-formula id=\"deqn25\" class=\"display-formula\"><tex-math notation=\"LaTeX\">\\begin{align*}&amp;\\hspace {-2pc}\\left [{ {\\begin{array}{ccccc} 0 &amp;\\quad 0 &amp;\\quad 0 &amp;\\quad \\ldots &amp;\\quad 0\\\\ 0 &amp;\\quad 0 &amp;\\quad 0 &amp;\\quad \\ldots &amp;\\quad 0\\\\ \\ldots &amp;\\quad \\ldots &amp;\\quad \\ldots &amp;\\quad \\ldots &amp;\\quad \\ldots \\\\ \\omega _{N_{u}-1} &amp;\\quad \\omega _{N_{u}-2} &amp;\\quad \\omega _{N_{u}-3} &amp;\\quad \\ldots &amp;\\quad \\omega _{0}\\\\ \\end{array}} }\\right] \\\\&amp;\\times \\left [{ {\\begin{array}{c} u\\left ({t }\\right)\\\\ u\\left ({t+1 }\\right)\\\\ \\ldots \\\\ u\\left ({t+N_{u}-1 }\\right) \\\\ \\end{array}} }\\right] \\\\\\le&amp;\\left [{ {\\begin{array}{c} 0\\\\ 0\\\\ 0\\\\ \\Delta ^{\\delta }u_{max}\\left ({t+N_{u}-1 }\\right)\\\\ \\end{array}} }\\right]\\tag{25}\\end{align*}\n</tex-math><span class=\"formula\"><span class=\"link\">View Source</span><img aria-describedby=\"qtip-0\" style=\"display:inline;\" title=\"Right-click on figure or equation for MathML and additional features.\" data-hasqtip=\"0\" class=\"qtooltip moreInfo\" alt=\"Right-click on figure for MathML and additional features.\" src=\"/assets/img/icon.support.gif\" border=\"0\" height=\"20\" width=\"24\"/><span class=\"tex tex2jax_ignore\" style=\"display:none;\">\\begin{align*}&amp;\\hspace {-2pc}\\left [{ {\\begin{array}{ccccc} 0 &amp;\\quad 0 &amp;\\quad 0 &amp;\\quad \\ldots &amp;\\quad 0\\\\ 0 &amp;\\quad 0 &amp;\\quad 0 &amp;\\quad \\ldots &amp;\\quad 0\\\\ \\ldots &amp;\\quad \\ldots &amp;\\quad \\ldots &amp;\\quad \\ldots &amp;\\quad \\ldots \\\\ \\omega _{N_{u}-1} &amp;\\quad \\omega _{N_{u}-2} &amp;\\quad \\omega _{N_{u}-3} &amp;\\quad \\ldots &amp;\\quad \\omega _{0}\\\\ \\end{array}} }\\right] \\\\&amp;\\times \\left [{ {\\begin{array}{c} u\\left ({t }\\right)\\\\ u\\left ({t+1 }\\right)\\\\ \\ldots \\\\ u\\left ({t+N_{u}-1 }\\right) \\\\ \\end{array}} }\\right] \\\\\\le&amp;\\left [{ {\\begin{array}{c} 0\\\\ 0\\\\ 0\\\\ \\Delta ^{\\delta }u_{max}\\left ({t+N_{u}-1 }\\right)\\\\ \\end{array}} }\\right]\\tag{25}\\end{align*}\n</span></span></disp-formula></p><p>We also shall consider constraints on a linear combination of the increments of control signal <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\Delta u$\n</tex-math></inline-formula>. Manipulating algebraically the expression <a ref-type=\"disp-formula\" anchor=\"deqn25\" href=\"#deqn25\" class=\"fulltext-link\">(25)</a>, we can put the constraints in terms of <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\Delta u(t)$\n</tex-math></inline-formula> using <a ref-type=\"disp-formula\" anchor=\"deqn26\" href=\"#deqn26\" class=\"fulltext-link\">(26)</a>.<disp-formula id=\"deqn26\" class=\"display-formula\"><tex-math notation=\"LaTeX\">\\begin{equation*} \\Delta u\\left ({t }\\right)=u\\left ({t }\\right)-u(t-1)\\tag{26}\\end{equation*}\n</tex-math><span class=\"formula\"><span class=\"link\">View Source</span><img aria-describedby=\"qtip-0\" style=\"display:inline;\" title=\"Right-click on figure or equation for MathML and additional features.\" data-hasqtip=\"0\" class=\"qtooltip moreInfo\" alt=\"Right-click on figure for MathML and additional features.\" src=\"/assets/img/icon.support.gif\" border=\"0\" height=\"20\" width=\"24\"/><span class=\"tex tex2jax_ignore\" style=\"display:none;\">\\begin{equation*} \\Delta u\\left ({t }\\right)=u\\left ({t }\\right)-u(t-1)\\tag{26}\\end{equation*}\n</span></span></disp-formula></p><p>So:<disp-formula id=\"deqn27\" class=\"display-formula\"><tex-math notation=\"LaTeX\">\\begin{align*}&amp;\\hspace {-1.5pc}\\sum \\limits _{l=0}^{N_{u}-1} \\omega _{l} u\\left ({t+N_{u}-2-l }\\right) \\\\=&amp;\\sum \\limits _{l=0}^{N_{u}-1} \\omega _{l} \\left [{ \\left ({\\Delta u\\left ({t+N_{u}-2-l }\\right) }\\right)\\left ({u\\left ({t+N_{u}-3-l }\\right) }\\right) }\\right] \\\\=&amp;\\omega _{0}\\left [{ \\Delta u\\left ({t+N_{u}-1 }\\right)+u\\left ({t+N_{u}-2 }\\right) }\\right] \\\\&amp;+\\,\\omega _{1}\\left [{ \\Delta u\\left ({t+N_{u}-2 }\\right)+u\\left ({t+N_{u}-3 }\\right) }\\right]+\\ldots \\\\&amp;+\\,\\omega _{N_{u}-1}\\left [{ \\Delta u\\left ({t }\\right)+u\\left ({t-1 }\\right) }\\right] \\\\=&amp;\\omega _{l}\\left [{ \\sum {\\Delta u\\left ({t }\\right)} }\\right]+\\Delta ^{\\delta }u\\left ({t+N_{u}-2 }\\right)\\tag{27}\\end{align*}\n</tex-math><span class=\"formula\"><span class=\"link\">View Source</span><img aria-describedby=\"qtip-0\" style=\"display:inline;\" title=\"Right-click on figure or equation for MathML and additional features.\" data-hasqtip=\"0\" class=\"qtooltip moreInfo\" alt=\"Right-click on figure for MathML and additional features.\" src=\"/assets/img/icon.support.gif\" border=\"0\" height=\"20\" width=\"24\"/><span class=\"tex tex2jax_ignore\" style=\"display:none;\">\\begin{align*}&amp;\\hspace {-1.5pc}\\sum \\limits _{l=0}^{N_{u}-1} \\omega _{l} u\\left ({t+N_{u}-2-l }\\right) \\\\=&amp;\\sum \\limits _{l=0}^{N_{u}-1} \\omega _{l} \\left [{ \\left ({\\Delta u\\left ({t+N_{u}-2-l }\\right) }\\right)\\left ({u\\left ({t+N_{u}-3-l }\\right) }\\right) }\\right] \\\\=&amp;\\omega _{0}\\left [{ \\Delta u\\left ({t+N_{u}-1 }\\right)+u\\left ({t+N_{u}-2 }\\right) }\\right] \\\\&amp;+\\,\\omega _{1}\\left [{ \\Delta u\\left ({t+N_{u}-2 }\\right)+u\\left ({t+N_{u}-3 }\\right) }\\right]+\\ldots \\\\&amp;+\\,\\omega _{N_{u}-1}\\left [{ \\Delta u\\left ({t }\\right)+u\\left ({t-1 }\\right) }\\right] \\\\=&amp;\\omega _{l}\\left [{ \\sum {\\Delta u\\left ({t }\\right)} }\\right]+\\Delta ^{\\delta }u\\left ({t+N_{u}-2 }\\right)\\tag{27}\\end{align*}\n</span></span></disp-formula></p><p>In matrix form:<disp-formula id=\"deqn28\" class=\"display-formula\"><tex-math notation=\"LaTeX\">\\begin{align*}&amp;\\hspace {-2pc}\\left [{ {\\begin{array}{ccccc} 0 &amp;\\quad 0 &amp;\\quad 0 &amp;\\quad \\ldots &amp;\\quad 0\\\\ 0 &amp;\\quad 0 &amp;\\quad 0 &amp;\\quad \\ldots &amp;\\quad 0\\\\ \\ldots &amp;\\quad \\ldots &amp;\\quad \\ldots &amp;\\quad \\ldots &amp;\\quad \\ldots \\\\ \\omega _{N_{u}-1} &amp;\\quad \\omega _{N_{u}-2} &amp;\\quad \\omega _{N_{u}-3} &amp;\\quad \\ldots &amp;\\quad \\omega _{0}\\\\ \\end{array}} }\\right] \\\\&amp;\\times \\left [{ {\\begin{array}{c} \\Delta u\\left ({t }\\right)\\\\ \\Delta u\\left ({t+1 }\\right)\\\\ \\ldots \\\\ \\Delta u\\left ({t+N_{u}-1 }\\right)\\\\ \\end{array}} }\\right] \\\\\\le&amp;\\left [{ {\\begin{array}{c} 0\\\\ 0\\\\ 0\\\\ \\Delta ^{\\delta }u_{max}\\left ({t+N_{u}-1 }\\right)-\\Delta ^{\\delta }u(t+N_{u}-2)\\\\ \\end{array}} }\\right] \\tag{28}\\end{align*}\n</tex-math><span class=\"formula\"><span class=\"link\">View Source</span><img aria-describedby=\"qtip-0\" style=\"display:inline;\" title=\"Right-click on figure or equation for MathML and additional features.\" data-hasqtip=\"0\" class=\"qtooltip moreInfo\" alt=\"Right-click on figure for MathML and additional features.\" src=\"/assets/img/icon.support.gif\" border=\"0\" height=\"20\" width=\"24\"/><span class=\"tex tex2jax_ignore\" style=\"display:none;\">\\begin{align*}&amp;\\hspace {-2pc}\\left [{ {\\begin{array}{ccccc} 0 &amp;\\quad 0 &amp;\\quad 0 &amp;\\quad \\ldots &amp;\\quad 0\\\\ 0 &amp;\\quad 0 &amp;\\quad 0 &amp;\\quad \\ldots &amp;\\quad 0\\\\ \\ldots &amp;\\quad \\ldots &amp;\\quad \\ldots &amp;\\quad \\ldots &amp;\\quad \\ldots \\\\ \\omega _{N_{u}-1} &amp;\\quad \\omega _{N_{u}-2} &amp;\\quad \\omega _{N_{u}-3} &amp;\\quad \\ldots &amp;\\quad \\omega _{0}\\\\ \\end{array}} }\\right] \\\\&amp;\\times \\left [{ {\\begin{array}{c} \\Delta u\\left ({t }\\right)\\\\ \\Delta u\\left ({t+1 }\\right)\\\\ \\ldots \\\\ \\Delta u\\left ({t+N_{u}-1 }\\right)\\\\ \\end{array}} }\\right] \\\\\\le&amp;\\left [{ {\\begin{array}{c} 0\\\\ 0\\\\ 0\\\\ \\Delta ^{\\delta }u_{max}\\left ({t+N_{u}-1 }\\right)-\\Delta ^{\\delta }u(t+N_{u}-2)\\\\ \\end{array}} }\\right] \\tag{28}\\end{align*}\n</span></span></disp-formula></p><p>In a similar way, the constraint for minimum values <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\Delta ^{\\delta }u(t+N_{u}-1)\\ge \\Delta ^{\\delta }u_{min}$\n</tex-math></inline-formula> can be obtained IV-A.<disp-formula id=\"deqn29\" class=\"display-formula\"><tex-math notation=\"LaTeX\">\\begin{align*}&amp;\\hspace {-2pc}\\left [{ {\\begin{array}{ccccc} 0 &amp;\\quad 0 &amp;\\quad 0 &amp;\\quad \\ldots &amp;\\quad 0\\\\ 0 &amp;\\quad 0 &amp;\\quad 0 &amp;\\quad \\ldots &amp;\\quad 0\\\\ \\ldots &amp;\\quad \\ldots &amp;\\quad \\ldots &amp;\\quad \\ldots &amp;\\quad \\ldots \\\\ {-\\omega }_{N_{u}-1} &amp;\\quad {-\\omega }_{N_{u}-2} &amp;\\quad -\\omega _{N_{u}-3} &amp;\\quad \\ldots &amp;\\quad {-\\omega }_{0}\\\\ \\end{array}} }\\right] \\\\&amp;\\times \\left [{ {\\begin{array}{c} \\Delta u\\left ({t }\\right)\\\\ \\Delta u\\left ({t+1 }\\right)\\\\ \\ldots \\\\ \\Delta u\\left ({t+N_{u}-1 }\\right)\\\\ \\end{array}} }\\right] \\\\\\le&amp;\\left [{ {\\begin{array}{c} 0\\\\ 0\\\\ 0\\\\ -\\Delta ^{\\delta }u_{min}\\left ({t+N_{u}-1 }\\right)+\\Delta ^{\\delta }u(t+N_{u}-2)\\\\ \\end{array}} }\\right] \\tag{29}\\end{align*}\n</tex-math><span class=\"formula\"><span class=\"link\">View Source</span><img aria-describedby=\"qtip-0\" style=\"display:inline;\" title=\"Right-click on figure or equation for MathML and additional features.\" data-hasqtip=\"0\" class=\"qtooltip moreInfo\" alt=\"Right-click on figure for MathML and additional features.\" src=\"/assets/img/icon.support.gif\" border=\"0\" height=\"20\" width=\"24\"/><span class=\"tex tex2jax_ignore\" style=\"display:none;\">\\begin{align*}&amp;\\hspace {-2pc}\\left [{ {\\begin{array}{ccccc} 0 &amp;\\quad 0 &amp;\\quad 0 &amp;\\quad \\ldots &amp;\\quad 0\\\\ 0 &amp;\\quad 0 &amp;\\quad 0 &amp;\\quad \\ldots &amp;\\quad 0\\\\ \\ldots &amp;\\quad \\ldots &amp;\\quad \\ldots &amp;\\quad \\ldots &amp;\\quad \\ldots \\\\ {-\\omega }_{N_{u}-1} &amp;\\quad {-\\omega }_{N_{u}-2} &amp;\\quad -\\omega _{N_{u}-3} &amp;\\quad \\ldots &amp;\\quad {-\\omega }_{0}\\\\ \\end{array}} }\\right] \\\\&amp;\\times \\left [{ {\\begin{array}{c} \\Delta u\\left ({t }\\right)\\\\ \\Delta u\\left ({t+1 }\\right)\\\\ \\ldots \\\\ \\Delta u\\left ({t+N_{u}-1 }\\right)\\\\ \\end{array}} }\\right] \\\\\\le&amp;\\left [{ {\\begin{array}{c} 0\\\\ 0\\\\ 0\\\\ -\\Delta ^{\\delta }u_{min}\\left ({t+N_{u}-1 }\\right)+\\Delta ^{\\delta }u(t+N_{u}-2)\\\\ \\end{array}} }\\right] \\tag{29}\\end{align*}\n</span></span></disp-formula></p><p>The expressions <a ref-type=\"disp-formula\" anchor=\"deqn28\" href=\"#deqn28\" class=\"fulltext-link\">(28)</a> and <a ref-type=\"disp-formula\" anchor=\"deqn29\" href=\"#deqn29\" class=\"fulltext-link\">(29)</a> show as constraints affect to the future values of the control signal not to the values at the present instant of time. This time displacement allows to relax the fulfillment of the constraint depending on the value of control horizon, <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$N_{u}$\n</tex-math></inline-formula>. Evidently, a value of <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$N_{u}=1$\n</tex-math></inline-formula> implies a \u201chard\u201d compliance with the constraint. Furthermore, the assigning <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\delta = 1$\n</tex-math></inline-formula> leads to set the constraint as in the known integer case.</p><p>Although we have considered the constraints as hard and they must be satisfied at any cost from a mathematical point of view, increasing the value of <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$N_{u}$\n</tex-math></inline-formula> allows us to soften them the higher its value is, because of the hard constraints compliance will be further away in time. Therefore, the proposed method softens constraints on the future predicted values of the constraints, not on the values at the present instant of time. In the next subsection, we will illustrate these concepts with some examples.</p><div class=\"section_2\" id=\"sec4a\"><h3>A. Computing Simulation of Fractional Constraints</h3><p>In order to illustrate how these fractional constraints work, computational simulations have been performed, where the impact of the constraints on the closed\u2013loop performance is shown when the values of <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\delta $\n</tex-math></inline-formula> and <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$N_{u}$\n</tex-math></inline-formula> are modified. The plant is the one previously proposed for illustrating the optimization <a ref-type=\"disp-formula\" anchor=\"deqn22\" href=\"#deqn22\" class=\"fulltext-link\">(22)</a>. The controller setting parameters have also been maintained.</p><p>To do so, we have used again the optimization toolbox of Matlab, specifically, the solver <i>quadprog</i> <a ref-type=\"bibr\" anchor=\"ref46\" id=\"context_ref_46_4a\">[46]</a>, that allows to solve quadratic programming problems subject to constraints in the form:<disp-formula id=\"deqn30\" class=\"display-formula\"><tex-math notation=\"LaTeX\">\\begin{align*}&amp;\\min \\limits _{x}~\\frac {1}{2}x^{\\prime }Hx+f^{\\prime }x \\\\&amp;subject~to~Ax\\le b\\tag{30}\\end{align*}\n</tex-math><span class=\"formula\"><span class=\"link\">View Source</span><img aria-describedby=\"qtip-0\" style=\"display:inline;\" title=\"Right-click on figure or equation for MathML and additional features.\" data-hasqtip=\"0\" class=\"qtooltip moreInfo\" alt=\"Right-click on figure for MathML and additional features.\" src=\"/assets/img/icon.support.gif\" border=\"0\" height=\"20\" width=\"24\"/><span class=\"tex tex2jax_ignore\" style=\"display:none;\">\\begin{align*}&amp;\\min \\limits _{x}~\\frac {1}{2}x^{\\prime }Hx+f^{\\prime }x \\\\&amp;subject~to~Ax\\le b\\tag{30}\\end{align*}\n</span></span></disp-formula></p><p>From <a ref-type=\"disp-formula\" anchor=\"deqn15\" href=\"#deqn15\" class=\"fulltext-link\">equations (15)</a> and <a ref-type=\"disp-formula\" anchor=\"deqn18\" href=\"#deqn18\" class=\"fulltext-link\">(18)</a> we can obtain the values of <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$H$\n</tex-math></inline-formula> and <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$f$\n</tex-math></inline-formula> with ease. Therefore, <disp-formula id=\"deqn31\" class=\"display-formula\"><tex-math notation=\"LaTeX\">\\begin{equation*} \\min \\limits _{\\Delta u}\\frac {1}{2}\\overrightarrow {\\Delta u'}\\left ({G'\\overrightarrow {\\Gamma }G+\\overrightarrow {\\Lambda } }\\right)\\overrightarrow {\\Delta u}+\\overrightarrow {E_{0}^{\\prime }}\\overrightarrow {\\Gamma }G\\overrightarrow {\\Delta u}\\tag{31}\\end{equation*}\n</tex-math><span class=\"formula\"><span class=\"link\">View Source</span><img aria-describedby=\"qtip-0\" style=\"display:inline;\" title=\"Right-click on figure or equation for MathML and additional features.\" data-hasqtip=\"0\" class=\"qtooltip moreInfo\" alt=\"Right-click on figure for MathML and additional features.\" src=\"/assets/img/icon.support.gif\" border=\"0\" height=\"20\" width=\"24\"/><span class=\"tex tex2jax_ignore\" style=\"display:none;\">\\begin{equation*} \\min \\limits _{\\Delta u}\\frac {1}{2}\\overrightarrow {\\Delta u'}\\left ({G'\\overrightarrow {\\Gamma }G+\\overrightarrow {\\Lambda } }\\right)\\overrightarrow {\\Delta u}+\\overrightarrow {E_{0}^{\\prime }}\\overrightarrow {\\Gamma }G\\overrightarrow {\\Delta u}\\tag{31}\\end{equation*}\n</span></span></disp-formula></p><p>The values of matrices <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$A$\n</tex-math></inline-formula> and <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$b$\n</tex-math></inline-formula> are obtained directly from the expressions <a ref-type=\"disp-formula\" anchor=\"deqn28\" href=\"#deqn28\" class=\"fulltext-link\">(28)</a> and IV-A for each case. The solver syntax is:<disp-formula id=\"\" class=\"display-formula\"><tex-math notation=\"LaTeX\">\\begin{equation*} {\\mathbf {quadprog(H,f,A,b)}}\\end{equation*}\n</tex-math><span class=\"formula\"><span class=\"link\">View Source</span><img aria-describedby=\"qtip-0\" style=\"display:inline;\" title=\"Right-click on figure or equation for MathML and additional features.\" data-hasqtip=\"0\" class=\"qtooltip moreInfo\" alt=\"Right-click on figure for MathML and additional features.\" src=\"/assets/img/icon.support.gif\" border=\"0\" height=\"20\" width=\"24\"/><span class=\"tex tex2jax_ignore\" style=\"display:none;\">\\begin{equation*} {\\mathbf {quadprog(H,f,A,b)}}\\end{equation*}\n</span></span></disp-formula></p><p>Initially, we set a constraint on the minimum value of the fractional <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\delta $\n</tex-math></inline-formula>\u2013increment as it is shown in expression <a ref-type=\"disp-formula\" anchor=\"deqn32\" href=\"#deqn32\" class=\"fulltext-link\">(32)</a>. <a ref-type=\"fig\" anchor=\"fig7\" class=\"fulltext-link\">Figure 7</a> depicts the simulation for <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\delta =1$\n</tex-math></inline-formula> and <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$N_{u}=1$\n</tex-math></inline-formula>. It can be easily seen that <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\Delta u(t)$\n</tex-math></inline-formula> and <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\Delta ^{\\delta }u$\n</tex-math></inline-formula> are coincident as expected, <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\Delta ^{\\delta }u\\left ({t+N_{u}-1 }\\right)=\\Delta ^{1}u\\left ({t+1-1 }\\right)=\\Delta u(t)$\n</tex-math></inline-formula>. It is also observable that from <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$t=5$\n</tex-math></inline-formula> the constraint acts and the output cannot follow the reference as fast as it would be desirable, even a small ripple appears.<disp-formula id=\"deqn32\" class=\"display-formula\"><tex-math notation=\"LaTeX\">\\begin{equation*} \\Delta ^{\\delta }u\\left ({t+N_{u}-1 }\\right)\\ge -0.05\\tag{32}\\end{equation*}\n</tex-math><span class=\"formula\"><span class=\"link\">View Source</span><img aria-describedby=\"qtip-0\" style=\"display:inline;\" title=\"Right-click on figure or equation for MathML and additional features.\" data-hasqtip=\"0\" class=\"qtooltip moreInfo\" alt=\"Right-click on figure for MathML and additional features.\" src=\"/assets/img/icon.support.gif\" border=\"0\" height=\"20\" width=\"24\"/><span class=\"tex tex2jax_ignore\" style=\"display:none;\">\\begin{equation*} \\Delta ^{\\delta }u\\left ({t+N_{u}-1 }\\right)\\ge -0.05\\tag{32}\\end{equation*}\n</span></span></disp-formula>\n<div class=\"figure figure-full\" id=\"fig7\"><!--\n          Workaround for combined images.Eg.- 1000116 Fig. 5\n        --><div class=\"img-wrap\"><a href=\"/mediastore_new/IEEE/content/media/6287639/9668973/9975294/romer7-3227864-large.gif\" data-fig-id=\"fig7\"><img src=\"/mediastore_new/IEEE/content/media/6287639/9668973/9975294/romer7-3227864-small.gif\" alt=\"FIGURE 7. - Simulation 1 of the constrained controller 1.\"/><div class=\"zoom\" title=\"View Larger Image\"/></a></div><div class=\"figcaption\"><b class=\"title\">FIGURE 7. </b><fig><p>Simulation 1 of the constrained controller 1.</p></fig></div><p class=\"links\"><a href=\"/document/9975294/all-figures\" class=\"all\">Show All</a></p></div></p><p>We now consider a new value for the control horizon, <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$N_{u}=3$\n</tex-math></inline-formula>, to do a new simulation. <a ref-type=\"fig\" anchor=\"fig8\" class=\"fulltext-link\">Figure 8</a> depicts this simulation for three values of <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\delta $\n</tex-math></inline-formula>, specifically, <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\delta =(0.5,1.0,1.5)$\n</tex-math></inline-formula>. The lower plot shows the values of <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\Delta ^{\\delta }u(t)$\n</tex-math></inline-formula> (just when the step down occurs). The values at this moment for <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$t=5$\n</tex-math></inline-formula> are:<disp-formula id=\"deqn33\" class=\"display-formula\"><tex-math notation=\"LaTeX\">\\begin{align*} \\Delta ^{0.5}{u(t)}_{t=5}=&amp;0.0180 \\\\ \\Delta ^{1.0}{u(t)}_{t=5}=&amp;-0.0992 \\\\ \\Delta ^{1.5}{u(t)}_{t=5}=&amp;-0.0993\\tag{33}\\end{align*}\n</tex-math><span class=\"formula\"><span class=\"link\">View Source</span><img aria-describedby=\"qtip-0\" style=\"display:inline;\" title=\"Right-click on figure or equation for MathML and additional features.\" data-hasqtip=\"0\" class=\"qtooltip moreInfo\" alt=\"Right-click on figure for MathML and additional features.\" src=\"/assets/img/icon.support.gif\" border=\"0\" height=\"20\" width=\"24\"/><span class=\"tex tex2jax_ignore\" style=\"display:none;\">\\begin{align*} \\Delta ^{0.5}{u(t)}_{t=5}=&amp;0.0180 \\\\ \\Delta ^{1.0}{u(t)}_{t=5}=&amp;-0.0992 \\\\ \\Delta ^{1.5}{u(t)}_{t=5}=&amp;-0.0993\\tag{33}\\end{align*}\n</span></span></disp-formula>\n<div class=\"figure figure-full\" id=\"fig8\"><!--\n          Workaround for combined images.Eg.- 1000116 Fig. 5\n        --><div class=\"img-wrap\"><a href=\"/mediastore_new/IEEE/content/media/6287639/9668973/9975294/romer8-3227864-large.gif\" data-fig-id=\"fig8\"><img src=\"/mediastore_new/IEEE/content/media/6287639/9668973/9975294/romer8-3227864-small.gif\" alt=\"FIGURE 8. - Simulation 2 of the constrained controller 1.\"/><div class=\"zoom\" title=\"View Larger Image\"/></a></div><div class=\"figcaption\"><b class=\"title\">FIGURE 8. </b><fig><p>Simulation 2 of the constrained controller 1.</p></fig></div><p class=\"links\"><a href=\"/document/9975294/all-figures\" class=\"all\">Show All</a></p></div></p><p>It seems that the constraint set by <a ref-type=\"disp-formula\" anchor=\"deqn32\" href=\"#deqn32\" class=\"fulltext-link\">(32)</a> is not fulfilled for <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\delta =1.5$\n</tex-math></inline-formula> and <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\delta =1.0$\n</tex-math></inline-formula>. The values of the <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\delta $\n</tex-math></inline-formula>\u2013increments are below the minimum value set for them. However, the constraint concerns the predicted value for <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\Delta ^{\\delta }u\\left ({t+N_{u}-1 }\\right)$\n</tex-math></inline-formula> not the value at the current time <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\Delta ^{\\delta }u(t)$\n</tex-math></inline-formula> that is calculated using the pass values as is indicated by GL definition <a ref-type=\"disp-formula\" anchor=\"deqn1\" href=\"#deqn1\" class=\"fulltext-link\">(1)</a>. This results in a mathematical method of applying soft constraints to the system, which can be adjusted using the fractional <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\delta $\n</tex-math></inline-formula> parameter.</p><p>On the other hand, the variation of the <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\delta $\n</tex-math></inline-formula> parameter has also affected the temporal response of the system. One observes that both the output of the system, <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$y(t)$\n</tex-math></inline-formula>, and the value of the control signal, <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$u(t)$\n</tex-math></inline-formula>, are equal for the three values of <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\delta $\n</tex-math></inline-formula> considered within the interval<inline-formula id=\"\"><tex-math notation=\"LaTeX\">$t=[0,5$\n</tex-math></inline-formula>), before the step down occurs. In this case, it is obvious that the control signal is growing to allow the system to reach the reference, <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$r(t)$\n</tex-math></inline-formula>. Therefore, it is not affected by the constraint imposed by <a ref-type=\"disp-formula\" anchor=\"deqn32\" href=\"#deqn32\" class=\"fulltext-link\">(32)</a>. Nevertheless, after the step down, within interval <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$t=[5,10$\n</tex-math></inline-formula>), it is necessary for the control signal to decrease so that the system output also decreases and reaches the new reference. In this case, the output and the control signal are affected by the activation of the constraint <a ref-type=\"disp-formula\" anchor=\"deqn32\" href=\"#deqn32\" class=\"fulltext-link\">(32)</a> and have the shape that is shown in the upper plots of <a ref-type=\"fig\" anchor=\"fig8\" class=\"fulltext-link\">Figure 8</a>, with the values of both signals, <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$y$\n</tex-math></inline-formula> and <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$u$\n</tex-math></inline-formula>, for <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\delta =0.5$\n</tex-math></inline-formula> being below the values of both for <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\delta =1.0$\n</tex-math></inline-formula>. Analogously, the values of both signals for <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\delta =1.5$\n</tex-math></inline-formula> are above the values of both for <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\delta =1.0$\n</tex-math></inline-formula>. Therefore, we have different shapes of the system output depending on the parameter <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\delta $\n</tex-math></inline-formula>.</p><p><a ref-type=\"fig\" anchor=\"fig9\" class=\"fulltext-link\">Figure 9</a> depicts the simulation for <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\delta =0.01$\n</tex-math></inline-formula> and <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$N_{u}=3$\n</tex-math></inline-formula>. It can be easily seen that the shape of <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\Delta ^{\\delta }u\\left ({t }\\right)$\n</tex-math></inline-formula> (magenta line) tends to the shape of <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$u(t)$\n</tex-math></inline-formula> (green line) as expected.\n<div class=\"figure figure-full\" id=\"fig9\"><!--\n          Workaround for combined images.Eg.- 1000116 Fig. 5\n        --><div class=\"img-wrap\"><a href=\"/mediastore_new/IEEE/content/media/6287639/9668973/9975294/romer9-3227864-large.gif\" data-fig-id=\"fig9\"><img src=\"/mediastore_new/IEEE/content/media/6287639/9668973/9975294/romer9-3227864-small.gif\" alt=\"FIGURE 9. - Simulation 3 of the constrained controller 1.\"/><div class=\"zoom\" title=\"View Larger Image\"/></a></div><div class=\"figcaption\"><b class=\"title\">FIGURE 9. </b><fig><p>Simulation 3 of the constrained controller 1.</p></fig></div><p class=\"links\"><a href=\"/document/9975294/all-figures\" class=\"all\">Show All</a></p></div></p><p>In the same way, for illustrative purposes, we set a constraint on the maximum value of the fractional <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\delta $\n</tex-math></inline-formula>\u2013increment as it is shown in expression <a ref-type=\"disp-formula\" anchor=\"deqn34\" href=\"#deqn34\" class=\"fulltext-link\">(34)</a>.<disp-formula id=\"deqn34\" class=\"display-formula\"><tex-math notation=\"LaTeX\">\\begin{equation*} \\Delta ^{\\delta }u\\left ({t+N_{u}-1 }\\right) \\le 0.1\\tag{34}\\end{equation*}\n</tex-math><span class=\"formula\"><span class=\"link\">View Source</span><img aria-describedby=\"qtip-0\" style=\"display:inline;\" title=\"Right-click on figure or equation for MathML and additional features.\" data-hasqtip=\"0\" class=\"qtooltip moreInfo\" alt=\"Right-click on figure for MathML and additional features.\" src=\"/assets/img/icon.support.gif\" border=\"0\" height=\"20\" width=\"24\"/><span class=\"tex tex2jax_ignore\" style=\"display:none;\">\\begin{equation*} \\Delta ^{\\delta }u\\left ({t+N_{u}-1 }\\right) \\le 0.1\\tag{34}\\end{equation*}\n</span></span></disp-formula></p><p><a ref-type=\"fig\" anchor=\"fig10\" class=\"fulltext-link\">Figure 10</a> depicts the simulation for <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\delta =0.8$\n</tex-math></inline-formula> and the two values of the control horizon, <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$N_{u}=1$\n</tex-math></inline-formula> and <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$N_{u}=3$\n</tex-math></inline-formula>. In this case, the constraint acts within the interval <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$t=[0,5$\n</tex-math></inline-formula>) affecting the temporal response of both. However, the one tuned with <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$N_{u}=1$\n</tex-math></inline-formula> (blue line) suffers the effect of the hard constraint, appearing a small ripple in <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\Delta ^{\\delta }u(t)$\n</tex-math></inline-formula> as it is shown in lower plot. The upper plot shows as the system output grows more slowly with <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$N_{u}=1$\n</tex-math></inline-formula> than with <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$N_{u}=3$\n</tex-math></inline-formula>. With <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$N_{u}=3$\n</tex-math></inline-formula>, the constraint presents a soft behavior due to the constraint concerns a predicted value.\n<div class=\"figure figure-full\" id=\"fig10\"><!--\n          Workaround for combined images.Eg.- 1000116 Fig. 5\n        --><div class=\"img-wrap\"><a href=\"/mediastore_new/IEEE/content/media/6287639/9668973/9975294/romer10-3227864-large.gif\" data-fig-id=\"fig10\"><img src=\"/mediastore_new/IEEE/content/media/6287639/9668973/9975294/romer10-3227864-small.gif\" alt=\"FIGURE 10. - Simulation 4 of the constrained controller 1.\"/><div class=\"zoom\" title=\"View Larger Image\"/></a></div><div class=\"figcaption\"><b class=\"title\">FIGURE 10. </b><fig><p>Simulation 4 of the constrained controller 1.</p></fig></div><p class=\"links\"><a href=\"/document/9975294/all-figures\" class=\"all\">Show All</a></p></div></p><p>Finally, we shall test the behavior of the proposed method with a model of a real plant. Specifically, it is the identified model of the throttle pedal of a gasoline car used in <a ref-type=\"bibr\" anchor=\"ref38\" id=\"context_ref_38_4a\">[38]</a>, whose transfer function is shown in expression <a ref-type=\"disp-formula\" anchor=\"deqn35\" href=\"#deqn35\" class=\"fulltext-link\">(35)</a>. One observes that the dynamics of this model is more complex than the previous used model <a ref-type=\"disp-formula\" anchor=\"deqn22\" href=\"#deqn22\" class=\"fulltext-link\">(22)</a>.<disp-formula id=\"deqn35\" class=\"display-formula\"><tex-math notation=\"LaTeX\">\\begin{equation*} G\\left ({z^{-1} }\\right)=\\frac {5.1850}{1-0.7344z^{-1}-0.2075z^{-2}}z^{-4}\\tag{35}\\end{equation*}\n</tex-math><span class=\"formula\"><span class=\"link\">View Source</span><img aria-describedby=\"qtip-0\" style=\"display:inline;\" title=\"Right-click on figure or equation for MathML and additional features.\" data-hasqtip=\"0\" class=\"qtooltip moreInfo\" alt=\"Right-click on figure for MathML and additional features.\" src=\"/assets/img/icon.support.gif\" border=\"0\" height=\"20\" width=\"24\"/><span class=\"tex tex2jax_ignore\" style=\"display:none;\">\\begin{equation*} G\\left ({z^{-1} }\\right)=\\frac {5.1850}{1-0.7344z^{-1}-0.2075z^{-2}}z^{-4}\\tag{35}\\end{equation*}\n</span></span></disp-formula></p><p>For illustration purposes, a new FGPC controller for <a ref-type=\"disp-formula\" anchor=\"deqn35\" href=\"#deqn35\" class=\"fulltext-link\">(35)</a> will be tuned using the following parameters: <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$N_{1}=1,N_{2}=50,N_{u}=2$\n</tex-math></inline-formula>, using prefilter <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$T_{c}\\left ({z^{-1} }\\right)=1-0.9z^{-1}$\n</tex-math></inline-formula> and <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\alpha =0.22$\n</tex-math></inline-formula>, <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\beta =2.30$\n</tex-math></inline-formula>. This control system, without activating the constraints, presents a highly oscillating temporal response as it is shown in the upper plots of <a ref-type=\"fig\" anchor=\"fig11\" class=\"fulltext-link\">Figure 11</a> (blue line). In this case, the oscillations of <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\Delta u(t)$\n</tex-math></inline-formula> are approximately within the interval <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$[-0.1,0.1]$\n</tex-math></inline-formula>. Obviously, in order to illustrate our example, we have proposed this extreme case, where the controller has not been properly tuned.\n<div class=\"figure figure-full\" id=\"fig11\"><!--\n          Workaround for combined images.Eg.- 1000116 Fig. 5\n        --><div class=\"img-wrap\"><a href=\"/mediastore_new/IEEE/content/media/6287639/9668973/9975294/romer11-3227864-large.gif\" data-fig-id=\"fig11\"><img src=\"/mediastore_new/IEEE/content/media/6287639/9668973/9975294/romer11-3227864-small.gif\" alt=\"FIGURE 11. - Simulation 1 of the constrained controller 2.\"/><div class=\"zoom\" title=\"View Larger Image\"/></a></div><div class=\"figcaption\"><b class=\"title\">FIGURE 11. </b><fig><p>Simulation 1 of the constrained controller 2.</p></fig></div><p class=\"links\"><a href=\"/document/9975294/all-figures\" class=\"all\">Show All</a></p></div></p><p>In the following, we shall limit that oscillation using the interval <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$[-0.01,0.01]$\n</tex-math></inline-formula>, setting the minimum and maximum values of fractional constraints as it is shown in expression <a ref-type=\"disp-formula\" anchor=\"deqn36\" href=\"#deqn36\" class=\"fulltext-link\">(36)</a>.<disp-formula id=\"deqn36\" class=\"display-formula\"><tex-math notation=\"LaTeX\">\\begin{align*} \\Delta ^{\\delta }u\\left ({t+N_{u}-1 }\\right)\\ge&amp;-0.01 \\\\ \\Delta ^{\\delta }u\\left ({t+N_{u}-1 }\\right)\\le&amp;0.01\\tag{36}\\end{align*}\n</tex-math><span class=\"formula\"><span class=\"link\">View Source</span><img aria-describedby=\"qtip-0\" style=\"display:inline;\" title=\"Right-click on figure or equation for MathML and additional features.\" data-hasqtip=\"0\" class=\"qtooltip moreInfo\" alt=\"Right-click on figure for MathML and additional features.\" src=\"/assets/img/icon.support.gif\" border=\"0\" height=\"20\" width=\"24\"/><span class=\"tex tex2jax_ignore\" style=\"display:none;\">\\begin{align*} \\Delta ^{\\delta }u\\left ({t+N_{u}-1 }\\right)\\ge&amp;-0.01 \\\\ \\Delta ^{\\delta }u\\left ({t+N_{u}-1 }\\right)\\le&amp;0.01\\tag{36}\\end{align*}\n</span></span></disp-formula></p><p><a ref-type=\"fig\" anchor=\"fig11\" class=\"fulltext-link\">Figure 11</a> depicts the system simulations subject to previous constraints <a ref-type=\"disp-formula\" anchor=\"deqn36\" href=\"#deqn36\" class=\"fulltext-link\">(36)</a> for two values of the <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\delta $\n</tex-math></inline-formula> parameter, <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\delta =0.5$\n</tex-math></inline-formula> (green line) and <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\delta =1.5$\n</tex-math></inline-formula> (magenta line). One observes that the oscillations both in the system output, <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$y(t)$\n</tex-math></inline-formula>, and in the value of the control signal, <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$u(t)$\n</tex-math></inline-formula>, have been drastically reduced after setting the constraints.</p><p>Since the oscillation has been reduced to a small ripple that is larger in the case of <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\delta =0.5$\n</tex-math></inline-formula>, as it is shown in the lower plot of <a ref-type=\"fig\" anchor=\"fig11\" class=\"fulltext-link\">Figure 11</a>, the system presents a more suitable output, improving its performance with stable, smooth and reasonably good response in comparison with the system response without constraints. In this case, the control signal, <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$u(t)$\n</tex-math></inline-formula>, corresponds to the throttle pedal of the gasoline car. Therefore, it is crucial that the oscillation is as small as possible, both for a better comfort of the vehicle\u2019s occupants and to keep the engine running and avoid the car stalled.</p><p>Moreover, in the same way as with the previous controller (<a ref-type=\"fig\" anchor=\"fig9\" class=\"fulltext-link\">Figure 9</a>), the larger the <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\delta $\n</tex-math></inline-formula> parameter value is, the slower the system response will be. Thus, the system output, <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$y(t)$\n</tex-math></inline-formula>, will take longer to reach the reference. Nevertheless, larger values of the <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\delta $\n</tex-math></inline-formula> delta parameter also reduce the amplitude of the oscillations.</p></div></div>\n<div class=\"section\" id=\"sec5\"><div class=\"header article-hdr\"><div class=\"kicker\">\n\t\t                        SECTION V.</div><h2>Conclusion</h2></div><p>In this paper, the use of fractional constraints in the predictive control strategy has been introduced and explained, discussing the results obtained by means of the fractional <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\delta $\n</tex-math></inline-formula>\u2013increments depending on the <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\delta $\n</tex-math></inline-formula> parameter. Its use has also provided, on the one hand, a new method to soften constraints using fractional operators and, on the other hand, obtaining different shapes of the system output depending on the parameter <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\delta $\n</tex-math></inline-formula>.</p><p>Moreover, a practical tuning of a plant with FGPC using Matlab<inline-formula id=\"\"><tex-math notation=\"LaTeX\">$^{\\mathrm {TM}}$\n</tex-math></inline-formula> Optimization Toolbox FGPC is included in order to make use of the beneficial characteristics of this control strategy. This example has been carried out to illustrate the validity of this method using two solvers, one based on quadratic optimization and the other based on genetic algorithms. Using them and with the help of this well\u2013known mathematical software, the controller settings can be achieved that lead to optimal system performance with ease.</p><p>In this way, the design process of the FGPC involves finally two basic steps. In the first step, we obtain the controller parameter <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$N_{1},N_{2},N_{u}$\n</tex-math></inline-formula>, <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\alpha $\n</tex-math></inline-formula> and <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\beta $\n</tex-math></inline-formula> to fulfill an appropriated performance using the tuning method based on optimization of some criteria. In the second step, the constraints are set to meet the operating specifications and limitations of the real system using the parameter <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\delta $\n</tex-math></inline-formula>, moreover, for softening constraints as far as possible, even to adjust the final response of the system.</p></div>\n\n<div class=\"section\" id=\"app1\"><h2/><h1>Appendix Tuning FGPC Controller</h1><p>Tuning the predictive controller means to set numerical values for the controller parameters to fulfill a series of objectives in terms of robustness and performance criteria. Obviously, the final performance of the loop system will depend on the goodness of this adjustment. To do so, various algorithms could be proposed based on techniques such as optimization, genetic algorithms, expert knowledge, etc.</p><p>In our case, the FGPC controller presents a wide set of parameters for tuning: <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$N_{1}$\n</tex-math></inline-formula>, <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$N_{2}$\n</tex-math></inline-formula>, <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$N_{u}$\n</tex-math></inline-formula>, <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\alpha $\n</tex-math></inline-formula> and <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\beta $\n</tex-math></inline-formula>. The proposed method <a ref-type=\"bibr\" anchor=\"ref47\" id=\"context_ref_47_\">[47]</a> is based on optimization of some criteria to fulfill an appropriated performance:\n<ul style=\"list-style-type:disc\"><li><p>Gain margin (GM): <disp-formula id=\"deqn37\" class=\"display-formula\"><tex-math notation=\"LaTeX\">\\begin{align*} M=-20~log \\left |{ \\frac {BS_{c}}{R_{c}\\Delta A} }\\right |,\\quad \\mathrm {where}~arg \\left ({\\frac {BS_{c}}{R_{c}\\Delta A} }\\right)=-180^{\\circ } \\tag{37}\\end{align*}\n</tex-math><span class=\"formula\"><span class=\"link\">View Source</span><img aria-describedby=\"qtip-0\" style=\"display:inline;\" title=\"Right-click on figure or equation for MathML and additional features.\" data-hasqtip=\"0\" class=\"qtooltip moreInfo\" alt=\"Right-click on figure for MathML and additional features.\" src=\"/assets/img/icon.support.gif\" border=\"0\" height=\"20\" width=\"24\"/><span class=\"tex tex2jax_ignore\" style=\"display:none;\">\\begin{align*} M=-20~log \\left |{ \\frac {BS_{c}}{R_{c}\\Delta A} }\\right |,\\quad \\mathrm {where}~arg \\left ({\\frac {BS_{c}}{R_{c}\\Delta A} }\\right)=-180^{\\circ } \\tag{37}\\end{align*}\n</span></span></disp-formula></p></li><li><p>Phase margin (PM): <disp-formula id=\"deqn38\" class=\"display-formula\"><tex-math notation=\"LaTeX\">\\begin{align*}&amp;\\hspace {-2pc}arg \\left ({\\frac {BS_{c}}{R_{c}\\Delta A} }\\right)=-(-180^{\\circ })+PM, \\\\&amp;\\mathrm {where}\\,\\,-20~log \\left |{ \\frac {BS_{c}}{R_{c}\\Delta A} }\\right |=0\\tag{38}\\end{align*}\n</tex-math><span class=\"formula\"><span class=\"link\">View Source</span><img aria-describedby=\"qtip-0\" style=\"display:inline;\" title=\"Right-click on figure or equation for MathML and additional features.\" data-hasqtip=\"0\" class=\"qtooltip moreInfo\" alt=\"Right-click on figure for MathML and additional features.\" src=\"/assets/img/icon.support.gif\" border=\"0\" height=\"20\" width=\"24\"/><span class=\"tex tex2jax_ignore\" style=\"display:none;\">\\begin{align*}&amp;\\hspace {-2pc}arg \\left ({\\frac {BS_{c}}{R_{c}\\Delta A} }\\right)=-(-180^{\\circ })+PM, \\\\&amp;\\mathrm {where}\\,\\,-20~log \\left |{ \\frac {BS_{c}}{R_{c}\\Delta A} }\\right |=0\\tag{38}\\end{align*}\n</span></span></disp-formula></p></li><li><p>High frequency noise rejection:<disp-formula id=\"deqn39\" class=\"display-formula\"><tex-math notation=\"LaTeX\">\\begin{equation*} \\left |{ T(j\\omega) }\\right |\\le A_{t}dB\\quad \\mathrm {for}~\\omega \\ge \\omega _{t}rad/s\\tag{39}\\end{equation*}\n</tex-math><span class=\"formula\"><span class=\"link\">View Source</span><img aria-describedby=\"qtip-0\" style=\"display:inline;\" title=\"Right-click on figure or equation for MathML and additional features.\" data-hasqtip=\"0\" class=\"qtooltip moreInfo\" alt=\"Right-click on figure for MathML and additional features.\" src=\"/assets/img/icon.support.gif\" border=\"0\" height=\"20\" width=\"24\"/><span class=\"tex tex2jax_ignore\" style=\"display:none;\">\\begin{equation*} \\left |{ T(j\\omega) }\\right |\\le A_{t}dB\\quad \\mathrm {for}~\\omega \\ge \\omega _{t}rad/s\\tag{39}\\end{equation*}\n</span></span></disp-formula> where <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$T$\n</tex-math></inline-formula> is the complementary sensitivity function and <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$A_{t}$\n</tex-math></inline-formula> is the desired noise attenuation for frequencies <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\omega \\ge \\omega _{t}$\n</tex-math></inline-formula>.</p></li><li><p>Good output disturbance:<disp-formula id=\"deqn40\" class=\"display-formula\"><tex-math notation=\"LaTeX\">\\begin{equation*} \\left |{ S(j\\omega) }\\right |\\le B_{s}dB\\quad \\mathrm {for}~\\omega \\le \\omega _{s}rad/s\\tag{40}\\end{equation*}\n</tex-math><span class=\"formula\"><span class=\"link\">View Source</span><img aria-describedby=\"qtip-0\" style=\"display:inline;\" title=\"Right-click on figure or equation for MathML and additional features.\" data-hasqtip=\"0\" class=\"qtooltip moreInfo\" alt=\"Right-click on figure for MathML and additional features.\" src=\"/assets/img/icon.support.gif\" border=\"0\" height=\"20\" width=\"24\"/><span class=\"tex tex2jax_ignore\" style=\"display:none;\">\\begin{equation*} \\left |{ S(j\\omega) }\\right |\\le B_{s}dB\\quad \\mathrm {for}~\\omega \\le \\omega _{s}rad/s\\tag{40}\\end{equation*}\n</span></span></disp-formula> where <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$B_{s}$\n</tex-math></inline-formula> is the desired value of the sensitivity function <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$S$\n</tex-math></inline-formula> for frequencies <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\omega \\le \\omega _{s}$\n</tex-math></inline-formula>.</p></li><li><p>Robustness to variations in the gain of the plant:<disp-formula id=\"deqn41\" class=\"display-formula\"><tex-math notation=\"LaTeX\">\\begin{equation*} \\left [{ \\frac {d\\left ({arg \\left ({\\frac {BS_{c}}{R_{c}\\Delta A} }\\right) }\\right)}{d\\omega } }\\right]_{\\omega =\\omega _{c}}=0\\tag{41}\\end{equation*}\n</tex-math><span class=\"formula\"><span class=\"link\">View Source</span><img aria-describedby=\"qtip-0\" style=\"display:inline;\" title=\"Right-click on figure or equation for MathML and additional features.\" data-hasqtip=\"0\" class=\"qtooltip moreInfo\" alt=\"Right-click on figure for MathML and additional features.\" src=\"/assets/img/icon.support.gif\" border=\"0\" height=\"20\" width=\"24\"/><span class=\"tex tex2jax_ignore\" style=\"display:none;\">\\begin{equation*} \\left [{ \\frac {d\\left ({arg \\left ({\\frac {BS_{c}}{R_{c}\\Delta A} }\\right) }\\right)}{d\\omega } }\\right]_{\\omega =\\omega _{c}}=0\\tag{41}\\end{equation*}\n</span></span></disp-formula> with this condition, the phase of the open\u2013loop system is forced to be flat at <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\omega _{C}$\n</tex-math></inline-formula> (crossover frequency) and to be almost constant within an interval around this value.</p></li></ul></p><p>This method proposes that one of the previous expressions <a ref-type=\"disp-formula\" anchor=\"deqn37\" href=\"#deqn37\" class=\"fulltext-link\">(37)</a><a ref-type=\"disp-formula\" anchor=\"deqn38\" href=\"#deqn38\" class=\"fulltext-link\"/><a ref-type=\"disp-formula\" anchor=\"deqn39\" href=\"#deqn39\" class=\"fulltext-link\"/><a ref-type=\"disp-formula\" anchor=\"deqn40\" href=\"#deqn40\" class=\"fulltext-link\"/>\u2013<a ref-type=\"disp-formula\" anchor=\"deqn41\" href=\"#deqn41\" class=\"fulltext-link\">(41)</a> is chosen as the main function to optimize and the rest of them could be taken as constraints. In order to keep the dimension of the optimization problem low, it is assumed that the parameters <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$N_{1}$\n</tex-math></inline-formula>, <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$N_{2}$\n</tex-math></inline-formula>, <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$N_{u}$\n</tex-math></inline-formula>, whose values are integer, are given using, for example, the thumb\u2013rules proposed in <a ref-type=\"bibr\" anchor=\"ref28\" id=\"context_ref_28_\">[28]</a> and the fractional orders <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\alpha $\n</tex-math></inline-formula> and <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\beta $\n</tex-math></inline-formula>, whose values are real, are used in the optimization process as the parameters to be calculated. Including the horizons parameters in the optimization problem would lead to a mixed quadratic programming problem that would unnecessarily complicate the calculation process for the controller tuning.</p></div>\n</div></div></response>\n"
}