{
    "abstract": "The nonlinear representation of active devices plays an important role in microwave circuit design. Whereas, it takes a long time to extract a large amount of large signal data, and the problem of memory resource and CPU occupancy becomes significant. In order to address the problems in traditional large-signal modeling methods, in this paper an X-parameter modeling method for microwave power devi...",
    "articleNumber": "9973304",
    "articleTitle": "Approach for Extreme Learning Machine-Based Microwave Power Device Modeling",
    "authors": [
        {
            "preferredName": "Qian Lin",
            "normalizedName": "Q. Lin",
            "firstName": "Qian",
            "lastName": "Lin",
            "searchablePreferredName": "Qian Lin"
        },
        {
            "preferredName": "Xiao-Zheng Wang",
            "normalizedName": "X. -Z. Wang",
            "firstName": "Xiao-Zheng",
            "lastName": "Wang",
            "searchablePreferredName": "Xiao-Zheng Wang"
        },
        {
            "preferredName": "Hai-Feng Wu",
            "normalizedName": "H. -F. Wu",
            "firstName": "Hai-Feng",
            "lastName": "Wu",
            "searchablePreferredName": "Hai-Feng Wu"
        },
        {
            "preferredName": "Li-Ning Jia",
            "normalizedName": "L. -N. Jia",
            "firstName": "Li-Ning",
            "lastName": "Jia",
            "searchablePreferredName": "Li-Ning Jia"
        }
    ],
    "doi": "10.1109/ACCESS.2022.3227327",
    "publicationTitle": "IEEE Access",
    "publicationYear": "2022",
    "publicationVolume": null,
    "publicationIssue": null,
    "volume": "10",
    "issue": null,
    "documentLink": "/document/9973304/",
    "xml": "<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<div id=\"BodyWrapper\" class=\"ArticlePage\" xmlns:ieee=\"http://www.ieeexplore.ieee.org\"><div id=\"article\">\n<div class=\"section\" id=\"sec1\"><div class=\"header article-hdr\"><div class=\"kicker\">\n\t\t                        SECTION I.</div><h2>Introduction</h2></div><p>With the rapid development of the communication field, the demands for pretty ideal quality and efficiency of communication have been put forward. Therefore, higher requirements for communication systems output power, efficiency are proposed. Meanwhile microwave power devices are the key components in communications systems and play a decisive role in their performance. Therefore, the model accuracy of microwave power devices is highly related to the design efficiency and performance of communication systems. Consequently, improving the modeling accuracy is a goal for every microwave engineer and the key challenge for radio frequency (RF) circuit design.</p><p>Given the high efficiency and accuracy of artificial neural networks (ANNs), they are widely used in microwave power device modeling <a ref-type=\"bibr\" anchor=\"ref1\" id=\"context_ref_1_1\">[1]</a>. In the field of microwave radio frequency, with the continuous increase of input power, the working area of the microwave power device has gradually changed from the linear region to the nonlinear region. Therefore, it is vital to define the nonlinear characteristics of microwave power devices as accurately as possible.</p><p>Studies have shown that the common modeling methods include empirical, X-parameter, and ANN models have been developed <a ref-type=\"bibr\" anchor=\"ref2\" id=\"context_ref_2_1\">[2]</a>, <a ref-type=\"bibr\" anchor=\"ref3\" id=\"context_ref_3_1\">[3]</a>. Furthermore, because the large-signal model established by DC data cannot fully describe the nonlinear characteristics of transistors, the Curtice empirical model was proposed in 1980 <a ref-type=\"bibr\" anchor=\"ref4\" id=\"context_ref_4_1\">[4]</a>. Then, the large-signal characteristics of microwave power devices were fitted using polynomials. In 1996, Angelov model combined with CAD was proposed, which is suitable for parameter extraction <a ref-type=\"bibr\" anchor=\"ref5\" id=\"context_ref_5_1\">[5]</a>, <a ref-type=\"bibr\" anchor=\"ref6\" id=\"context_ref_6_1\">[6]</a>, <a ref-type=\"bibr\" anchor=\"ref7\" id=\"context_ref_7_1\">[7]</a>. However, the empirical model is easier to combine with the CAD software, which is widely used in circuit design. While the accuracy of the model is greatly affected by the formula <a ref-type=\"bibr\" anchor=\"ref8\" id=\"context_ref_8_1\">[8]</a>. Consequently, considering the influence of the conjugate signal, S-parameter was extended to X-parameter with higher accuracy in 2008 <a ref-type=\"bibr\" anchor=\"ref9\" id=\"context_ref_9_1\">[9]</a>. In 2014, a nonlinear vector network analyzer was utilized to characterize surface acoustic wave (SAW) filters <a ref-type=\"bibr\" anchor=\"ref10\" id=\"context_ref_10_1\">[10]</a>. Subsequently, an X-parameters modeling technique with high accuracy and fast convergence was proposed in 2014 <a ref-type=\"bibr\" anchor=\"ref11\" id=\"context_ref_11_1\">[11]</a>. In 2016, X-parameter was used to accurately predict the output power of a pseudomorphic high-electron-mobility transistor (pHEMT) under different loads by Lee <a ref-type=\"bibr\" anchor=\"ref12\" id=\"context_ref_12_1\">[12]</a>. In 2019, X-parameter was introduced in the sound field to process large signals with high nonlinearity <a ref-type=\"bibr\" anchor=\"ref13\" id=\"context_ref_13_1\">[13]</a>. Therefore, X-parameter can supplement the nonlinear theory and has become an essential approach for modeling of microwave power devices. The nonlinear characteristics of microwave power devices can be accurately described by X-parameters. Consequently, an accurate X-parameter model has great significance to research the nonlinear characteristics of microwave power devices.</p><p>At the same time, with the rapid evolution of ANNs such as multi-layer perceptron (MLP), back propagation (BP) neural network, recurrent neural network (RNN), and ELM are extensively used in the modeling of microwave power devices <a ref-type=\"bibr\" anchor=\"ref14\" id=\"context_ref_14_1\">[14]</a>, <a ref-type=\"bibr\" anchor=\"ref15\" id=\"context_ref_15_1\">[15]</a>, <a ref-type=\"bibr\" anchor=\"ref16\" id=\"context_ref_16_1\">[16]</a>. Due to high-speed and high-accuracy, ELM has become a critical tool for microwave power devices modeling <a ref-type=\"bibr\" anchor=\"ref17\" id=\"context_ref_17_1\">[17]</a>, <a ref-type=\"bibr\" anchor=\"ref18\" id=\"context_ref_18_1\">[18]</a>. In 2017, Xiao used ELM to model the electromagnetic behavior of a triple-mode filter <a ref-type=\"bibr\" anchor=\"ref19\" id=\"context_ref_19_1\">[19]</a>. Then, ELM was utilized to model the third-order intermodulation distortion (IMD3) of an RF power amplifier <a ref-type=\"bibr\" anchor=\"ref20\" id=\"context_ref_20_1\">[20]</a>. In 2021, an improved ELM algorithm was adopted to model ultra-wide band (UWB) antennas <a ref-type=\"bibr\" anchor=\"ref21\" id=\"context_ref_21_1\">[21]</a>. Notably, ELM is a powerful tool for device modeling.</p><p>In addition, the combination of neural network and X-parameters is used to establish the X-parameter model. In 2019, three-layer BP neural network was used to model the X-parameters <a ref-type=\"bibr\" anchor=\"ref22\" id=\"context_ref_22_1\">[22]</a>. However, this model was not verified in the actual circuit. In 2021, neural network was also used to model the X-parameters, and the circuit verification of the established model is carried out by the third harmonic error <a ref-type=\"bibr\" anchor=\"ref23\" id=\"context_ref_23_1\">[23]</a>.</p><p>To achieve high-accuracy modeling for microwave power devices, the CGH40010F transistor produced by Cree is chosen as the modeling object here. X-parameters of this transistor are extracted by ADS, and the prediction models are constructed by ELM and double layer BP neural networks, respectively. The test results show that the mean square error of ELM prediction model is 0.0027, and the fitting rate is 94%, which is higher than that of the double layer BP neural networks prediction model. Moreover, the X-parameter model is established through the predicted data preciously. Furthermore, to verify the accuracy of the model, harmonic balance simulation is carried out to measure the spectrogram and modulus for the constructed models. The errors of ELM for fundamental, second and third harmonic are 0.673 dBm, 0.314 dBm, and 3.09 dBm, respectively, which is much lower than double layer BP neural network. Therefore, the X-parameter modeling based on ELM can achieve accurate large-signal modeling. As a result, this research can characterize the non-linearity of the transistor accurately. Furthermore, this model is convenient for obtaining X-parameters of the transistor.</p><p>The rest of this paper is organized as follows. <a ref-type=\"sec\" anchor=\"sec2\" class=\"fulltext-link\">Section II</a> introduces the X-parameter modeling. The results and discussions are described in <a ref-type=\"sec\" anchor=\"sec3\" class=\"fulltext-link\">Section III</a>. The conclusions are presented in <a ref-type=\"sec\" anchor=\"sec4\" class=\"fulltext-link\">Section IV</a>.</p></div>\n<div class=\"section\" id=\"sec2\"><div class=\"header article-hdr\"><div class=\"kicker\">\n\t\t                        SECTION II.</div><h2>X-Parameter Modeling</h2></div><p>Since X-parameters can characterize the nonlinear characteristics of microwave power devices, they have become a tool for large-signal modeling. Thus, BP neural network and ELM are used to model X-parameters for transistor here. The specific modeling process is shown in <a ref-type=\"fig\" anchor=\"fig1\" class=\"fulltext-link\">Fig. 1</a>.\n<div class=\"figure figure-full\" id=\"fig1\"><!--\n          Workaround for combined images.Eg.- 1000116 Fig. 5\n        --><div class=\"img-wrap\"><a href=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973304/lin1-3227327-large.gif\" data-fig-id=\"fig1\"><img src=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973304/lin1-3227327-small.gif\" alt=\"FIGURE 1. - Flow chart of BP neural network and ELM for X-parameters modeling.\"/><div class=\"zoom\" title=\"View Larger Image\"/></a></div><div class=\"figcaption\"><b class=\"title\">FIGURE 1. </b><fig><p>Flow chart of BP neural network and ELM for X-parameters modeling.</p></fig></div><p class=\"links\"><a href=\"/document/9973304/all-figures\" class=\"all\">Show All</a></p></div></p><p>There are five steps involved in X-parameter modeling based on BP neural network and ELM: acquisition of data, construction and training of neural networks, testing of neural networks and generation of prediction model, verification of prediction model and generation of the X-parameter model.</p><div class=\"section_2\" id=\"sec2a\"><h3>A. Definition of X-Parameters</h3><p>An X-parameter model that fully characterizes the nonlinear behavior of the device under test (DUT) can be expressed by <a ref-type=\"disp-formula\" anchor=\"deqn1\" href=\"#deqn1\" class=\"fulltext-link\">equation (1)</a> <a ref-type=\"bibr\" anchor=\"ref24\" id=\"context_ref_24_2a\">[24]</a>:<disp-formula id=\"deqn1\" class=\"display-formula\"><tex-math notation=\"LaTeX\">\\begin{align*} B_{p,k} =X_{p,k}^{\\left ({{F,B} }\\right)} \\left ({{\\left \\{{{DCS_{q}} }\\right \\},\\left |{ {A_{1,1}} }\\right |,\\left \\{{{A_{\\mathop {q,k}\\limits _{\\left ({{q,k} }\\right)\\ne \\left ({{1,1} }\\right)}} P^{-k}} }\\right \\}} }\\right)P^{-k} \\\\{}\\tag{1}\\end{align*}\n</tex-math><span class=\"formula\"><span class=\"link\">View Source</span><img aria-describedby=\"qtip-0\" style=\"display:inline;\" title=\"Right-click on figure or equation for MathML and additional features.\" data-hasqtip=\"0\" class=\"qtooltip moreInfo\" alt=\"Right-click on figure for MathML and additional features.\" src=\"/assets/img/icon.support.gif\" border=\"0\" height=\"20\" width=\"24\"/><span class=\"tex tex2jax_ignore\" style=\"display:none;\">\\begin{align*} B_{p,k} =X_{p,k}^{\\left ({{F,B} }\\right)} \\left ({{\\left \\{{{DCS_{q}} }\\right \\},\\left |{ {A_{1,1}} }\\right |,\\left \\{{{A_{\\mathop {q,k}\\limits _{\\left ({{q,k} }\\right)\\ne \\left ({{1,1} }\\right)}} P^{-k}} }\\right \\}} }\\right)P^{-k} \\\\{}\\tag{1}\\end{align*}\n</span></span></disp-formula> where <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$B_{p,k}$\n</tex-math></inline-formula> represents the X-parameter model of the DUT, <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$X_{p,k}^{\\left ({{F,B} }\\right)} $\n</tex-math></inline-formula> is X-parameters, <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$q$\n</tex-math></inline-formula> is the number of ports, <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$F_{p,k}$\n</tex-math></inline-formula> is the scattered wave behavior of the amplifier at port <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$p$\n</tex-math></inline-formula>, <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$k$\n</tex-math></inline-formula> is the <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$k^{\\mathrm {th}}$\n</tex-math></inline-formula> harmonic of the amplifier port, <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$A$\n</tex-math></inline-formula> is the large signal excitation, <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$P$\n</tex-math></inline-formula> is the phase factor, and <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$DCS_{q}$\n</tex-math></inline-formula> is DC bias excitation.</p><p><a ref-type=\"disp-formula\" anchor=\"deqn1\" href=\"#deqn1\" class=\"fulltext-link\">Equation (1)</a> is original nonlinear model, and according to <a ref-type=\"disp-formula\" anchor=\"deqn1\" href=\"#deqn1\" class=\"fulltext-link\">(1)</a>, X-parameters can be extracted. Typically, the non-linear vector network analyzer (NVNA) and ADS are the major methods to extract X-parameters. In this paper, ADS software is used to do this. Then, the extracted data is divided into the training set and the test set.</p><p>The schematic of X-parameters extraction is established in ADS. In this case, [frequency, <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$P_{in}$\n</tex-math></inline-formula>, <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$V_{gs}$\n</tex-math></inline-formula>, <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$V_{ds}$\n</tex-math></inline-formula>] are chosen as the input vector, a group of X-parameter is the output vector. Specifically, the frequency is 1GHz to 5GHz with a step of 1GHz, <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$P_{in}$\n</tex-math></inline-formula> is 30 dBm to 39 dBm with 3 dBm, <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$V_{gs}$\n</tex-math></inline-formula> is \u22123.9 V to \u22120.9 V with step of \u22121 V, and <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$V_{ds}$\n</tex-math></inline-formula> is 8 V to 20 V with step of 4 V.</p><p>As shown in <a ref-type=\"fig\" anchor=\"fig2\" class=\"fulltext-link\">Fig. 2</a>, the schematic is comprised by a CGH40010F transistor, input matching circuit, output matching circuit, gate bias circuit, and drain bias circuit. By setting the corresponding bias voltage and frequency, X-parameter of this transistor can be extracted by the X-parameter control. Finally, a total of 320 groups of X-parameters are extracted, among which a group of X-parameters is composed of 307 data. In building the neural network model, 307 data are trained and tested together as outputs. Moreover, plus setting the parameters and creating the.xnp file, it took a total of 2 minutes to extract this data. And uniform sampling method is used to divide the data into training sets and test sets. Among them, the ratio of training set and test set is 2:1.\n<div class=\"figure figure-full\" id=\"fig2\"><!--\n          Workaround for combined images.Eg.- 1000116 Fig. 5\n        --><div class=\"img-wrap\"><a href=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973304/lin2-3227327-large.gif\" data-fig-id=\"fig2\"><img src=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973304/lin2-3227327-small.gif\" alt=\"FIGURE 2. - Extraction schematic of the X-parameters.\"/><div class=\"zoom\" title=\"View Larger Image\"/></a></div><div class=\"figcaption\"><b class=\"title\">FIGURE 2. </b><fig><p>Extraction schematic of the X-parameters.</p></fig></div><p class=\"links\"><a href=\"/document/9973304/all-figures\" class=\"all\">Show All</a></p></div></p><p>The names and specific meanings of the variables in the.xnp file are displayed in <a ref-type=\"table\" anchor=\"table1\" class=\"fulltext-link\">Table 1</a>. The nonlinear characteristics of the device is characterized by these parameters.<div class=\"figure figure-full table\" id=\"table1\"><div class=\"figcaption\"><b class=\"title\">TABLE 1 </b>\nThe Meaning of Variables in the.xnp File</div><div class=\"img-wrap\"><a href=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973304/lin.t1-3227327-large.gif\"><img src=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973304/lin.t1-3227327-small.gif\" alt=\"Table 1- &#10;The Meaning of Variables in the.xnp File\"/><div class=\"zoom\" title=\"View Larger Image\"/></a></div></div></p><p>Taking frequency is 3 GHz, <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$V_{gs}$\n</tex-math></inline-formula> is \u22123.9 V, <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$V_{ds}$\n</tex-math></inline-formula> is 8 V and <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$P_{in}$\n</tex-math></inline-formula> is 30 dBm as an example, the X- parameter data block is shown in <a ref-type=\"fig\" anchor=\"fig3\" class=\"fulltext-link\">Fig. 3</a>. It is can be seen that the data block header is the name of the variable, and the variable name followed by \u201ccomplex\u201d is a negative type, \u201creal\u201d is the real type. Combining with <a ref-type=\"table\" anchor=\"table1\" class=\"fulltext-link\">Table 1</a>, the extracted X-parameters not only include <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\text{X}^{\\mathrm {(FB)}}$\n</tex-math></inline-formula> term, but also include <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\text{X}^{\\mathrm {(T)}}$\n</tex-math></inline-formula> term, AN term, <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\text{X}^{\\mathrm {(FI)}}$\n</tex-math></inline-formula> term, <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\text{X}^{\\mathrm {(S)}}$\n</tex-math></inline-formula> term and XY term. It is worth noting that <a ref-type=\"table\" anchor=\"table1\" class=\"fulltext-link\">Table 1</a> and <a ref-type=\"fig\" anchor=\"fig1\" class=\"fulltext-link\">Fig. 1</a> show the X-parameter terms when the frequency is 3 GHz, <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$V_{gs}$\n</tex-math></inline-formula> is \u22123.9 V, <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$V_{ds}$\n</tex-math></inline-formula> is 8 V, and <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$P_{in}$\n</tex-math></inline-formula> is 30 dBm. If different conditions and order are used, which contain different terms.\n<div class=\"figure figure-full\" id=\"fig3\"><!--\n          Workaround for combined images.Eg.- 1000116 Fig. 5\n        --><div class=\"img-wrap\"><a href=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973304/lin3-3227327-large.gif\" data-fig-id=\"fig3\"><img src=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973304/lin3-3227327-small.gif\" alt=\"FIGURE 3. - X-parameter data block.\"/><div class=\"zoom\" title=\"View Larger Image\"/></a></div><div class=\"figcaption\"><b class=\"title\">FIGURE 3. </b><fig><p>X-parameter data block.</p></fig></div><p class=\"links\"><a href=\"/document/9973304/all-figures\" class=\"all\">Show All</a></p></div></p><p>Furthermore, among the 307 data, there are 1 AN term, 2 <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\text{X}^{\\mathrm {(FI)}}$\n</tex-math></inline-formula> terms, 16 <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\text{X}^{\\mathrm {(FB)}}$\n</tex-math></inline-formula> terms, 32 XY terms, 128 <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\text{X}^{\\mathrm {(S)}}$\n</tex-math></inline-formula> terms and 128 <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\text{X}^{\\mathrm {(T)}}$\n</tex-math></inline-formula> terms. It is worth noting that the values after the data block correspond one-to-one with the variables in the header.</p><p>And because X-parameters are the black box model, all the extracted terms form X-parameters, so each term is non-independent.</p></div><div class=\"section_2\" id=\"sec2b\"><h3>B. Back Propagation Neural Networks Prediction Model</h3><p>BP neural networks are widely used to solve nonlinear problems, such as speech recognition <a ref-type=\"bibr\" anchor=\"ref25\" id=\"context_ref_25_2b\">[25]</a>, image classification <a ref-type=\"bibr\" anchor=\"ref26\" id=\"context_ref_26_2b\">[26]</a>, fault detection <a ref-type=\"bibr\" anchor=\"ref27\" id=\"context_ref_27_2b\">[27]</a> and risk early warning <a ref-type=\"bibr\" anchor=\"ref28\" id=\"context_ref_28_2b\">[28]</a>.</p><p>The basic structure of the BP neural network is illustrated in <a ref-type=\"fig\" anchor=\"fig4\" class=\"fulltext-link\">Fig. 4</a>. It is mainly composed of the input layer, hidden layer and output layer. The number of neurons in the input and output layers is determined by the input data <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$[X_{{\\textit {1}}}$\n</tex-math></inline-formula>, <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$X_{{\\textit {2}}},\\ldots, X_{n}]$\n</tex-math></inline-formula> and output data <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$[Y_{{\\textit {1}}}$\n</tex-math></inline-formula>, <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$Y_{{\\textit {2}}},\\ldots, Y_{\\text {m}}]$\n</tex-math></inline-formula>, and the number of hidden layers is set according to the complexity of nonlinear relationship.\n<div class=\"figure figure-full\" id=\"fig4\"><!--\n          Workaround for combined images.Eg.- 1000116 Fig. 5\n        --><div class=\"img-wrap\"><a href=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973304/lin4-3227327-large.gif\" data-fig-id=\"fig4\"><img src=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973304/lin4-3227327-small.gif\" alt=\"FIGURE 4. - Basic structure of BP neural network.\"/><div class=\"zoom\" title=\"View Larger Image\"/></a></div><div class=\"figcaption\"><b class=\"title\">FIGURE 4. </b><fig><p>Basic structure of BP neural network.</p></fig></div><p class=\"links\"><a href=\"/document/9973304/all-figures\" class=\"all\">Show All</a></p></div></p><p>According to the train set, BP neural network starts training. The training of the BP neural network includes forward propagation and back propagation. Forward propagation can obtain the predicted value of the output layer, this value can be calculated from the <a ref-type=\"disp-formula\" anchor=\"deqn2\" href=\"#deqn2\" class=\"fulltext-link\">equation (2)</a>:<disp-formula id=\"deqn2\" class=\"display-formula\"><tex-math notation=\"LaTeX\">\\begin{equation*} O_{k} =\\sum \\limits _{j=1}^{l} {H_{j} \\omega _{jk} -b_{k}}\\quad k=1,2,\\cdots,m\\tag{2}\\end{equation*}\n</tex-math><span class=\"formula\"><span class=\"link\">View Source</span><img aria-describedby=\"qtip-0\" style=\"display:inline;\" title=\"Right-click on figure or equation for MathML and additional features.\" data-hasqtip=\"0\" class=\"qtooltip moreInfo\" alt=\"Right-click on figure for MathML and additional features.\" src=\"/assets/img/icon.support.gif\" border=\"0\" height=\"20\" width=\"24\"/><span class=\"tex tex2jax_ignore\" style=\"display:none;\">\\begin{equation*} O_{k} =\\sum \\limits _{j=1}^{l} {H_{j} \\omega _{jk} -b_{k}}\\quad k=1,2,\\cdots,m\\tag{2}\\end{equation*}\n</span></span></disp-formula> where <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$O_{k}$\n</tex-math></inline-formula> is the output layer result, <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$j$\n</tex-math></inline-formula> is the number of neurons in the hidden layer, <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$k$\n</tex-math></inline-formula> is the number of neurons in the output layer, <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$H_{j} $\n</tex-math></inline-formula> is the output value from the input layer to the hidden layer, <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\omega _{jk}$\n</tex-math></inline-formula> is the weight between the hidden layer neurons and the output layer neurons and <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$b$\n</tex-math></inline-formula> is the output layer threshold.</p><p>Then, the error between the predicted output and the expected output of the output layer is calculated by formula <a ref-type=\"disp-formula\" anchor=\"deqn3\" href=\"#deqn3\" class=\"fulltext-link\">(3)</a> as:<disp-formula id=\"deqn3\" class=\"display-formula\"><tex-math notation=\"LaTeX\">\\begin{equation*} e_{k} =Y_{k} -O_{k}\\tag{3}\\end{equation*}\n</tex-math><span class=\"formula\"><span class=\"link\">View Source</span><img aria-describedby=\"qtip-0\" style=\"display:inline;\" title=\"Right-click on figure or equation for MathML and additional features.\" data-hasqtip=\"0\" class=\"qtooltip moreInfo\" alt=\"Right-click on figure for MathML and additional features.\" src=\"/assets/img/icon.support.gif\" border=\"0\" height=\"20\" width=\"24\"/><span class=\"tex tex2jax_ignore\" style=\"display:none;\">\\begin{equation*} e_{k} =Y_{k} -O_{k}\\tag{3}\\end{equation*}\n</span></span></disp-formula> where <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$Y_{k}$\n</tex-math></inline-formula> is the expected output, the weights and thresholds are updated according to e<sub>k</sub>.</p><p>The purpose of back propagation is to repeatedly modify the weights and thresholds to minimize the error. The weights are updated as the <a ref-type=\"disp-formula\" anchor=\"deqn4-deqn5\" href=\"#deqn4-deqn5\" class=\"fulltext-link\">equation (4) and (5)</a>:<disp-formula id=\"deqn4-deqn5\" class=\"display-formula\"><tex-math notation=\"LaTeX\">\\begin{align*} \\omega _{ij}=&amp;\\omega _{ij} +\\eta H_{j} \\left ({{1-H_{j}} }\\right)x\\left ({i }\\right)\\sum \\limits _{k=1}^{m} {\\omega _{jk} e_{k}}\\tag{4}\\\\ \\omega _{jk}=&amp;\\omega _{jk} +\\eta H_{j} e_{k}\\tag{5}\\end{align*}\n</tex-math><span class=\"formula\"><span class=\"link\">View Source</span><img aria-describedby=\"qtip-0\" style=\"display:inline;\" title=\"Right-click on figure or equation for MathML and additional features.\" data-hasqtip=\"0\" class=\"qtooltip moreInfo\" alt=\"Right-click on figure for MathML and additional features.\" src=\"/assets/img/icon.support.gif\" border=\"0\" height=\"20\" width=\"24\"/><span class=\"tex tex2jax_ignore\" style=\"display:none;\">\\begin{align*} \\omega _{ij}=&amp;\\omega _{ij} +\\eta H_{j} \\left ({{1-H_{j}} }\\right)x\\left ({i }\\right)\\sum \\limits _{k=1}^{m} {\\omega _{jk} e_{k}}\\tag{4}\\\\ \\omega _{jk}=&amp;\\omega _{jk} +\\eta H_{j} e_{k}\\tag{5}\\end{align*}\n</span></span></disp-formula> where <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\omega _{ij}$\n</tex-math></inline-formula> is the connection weight between the input layer neurons and hidden layer neurons, <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$x_{i}$\n</tex-math></inline-formula> is the input variable and <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\eta $\n</tex-math></inline-formula> is the learning rate. After the weights are updated and the thresholds can be calculated by the <a ref-type=\"disp-formula\" anchor=\"deqn6-deqn7\" href=\"#deqn6-deqn7\" class=\"fulltext-link\">equation (6) and (7)</a>:<disp-formula id=\"deqn6-deqn7\" class=\"display-formula\"><tex-math notation=\"LaTeX\">\\begin{align*} a_{j}=&amp;a_{j} +\\eta H_{j} \\left ({{1-H_{j}} }\\right)\\sum \\limits _{k=1}^{m} {\\omega _{jk} e_{k}}\\tag{6}\\\\ b_{k}=&amp;b_{k} +e_{k}\\tag{7}\\end{align*}\n</tex-math><span class=\"formula\"><span class=\"link\">View Source</span><img aria-describedby=\"qtip-0\" style=\"display:inline;\" title=\"Right-click on figure or equation for MathML and additional features.\" data-hasqtip=\"0\" class=\"qtooltip moreInfo\" alt=\"Right-click on figure for MathML and additional features.\" src=\"/assets/img/icon.support.gif\" border=\"0\" height=\"20\" width=\"24\"/><span class=\"tex tex2jax_ignore\" style=\"display:none;\">\\begin{align*} a_{j}=&amp;a_{j} +\\eta H_{j} \\left ({{1-H_{j}} }\\right)\\sum \\limits _{k=1}^{m} {\\omega _{jk} e_{k}}\\tag{6}\\\\ b_{k}=&amp;b_{k} +e_{k}\\tag{7}\\end{align*}\n</span></span></disp-formula> where <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$a$\n</tex-math></inline-formula> is the hidden layer threshold. BP neural network repeats these two processes until it converges. By several training and testing, an X-parameter prediction model is generated.</p></div><div class=\"section_2\" id=\"sec2c\"><h3>C. Extreme Learning Machine Prediction Model</h3><p>Next, the ELM prediction model is built, and its structure is the same as that of the BP neural network. There are three steps in ELM modeling. First, the number of hidden layer neurons is set, and the weight <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\omega $\n</tex-math></inline-formula> of the neurons and the threshold <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$b$\n</tex-math></inline-formula> of hidden layer neurons are randomly generated. Second, the activation function <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$f$\n</tex-math></inline-formula> is selected so that the hidden layer output matrix <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$H$\n</tex-math></inline-formula> can be calculated by <a ref-type=\"disp-formula\" anchor=\"deqn8\" href=\"#deqn8\" class=\"fulltext-link\">equation (8)</a>:<disp-formula id=\"deqn8\" class=\"display-formula\"><tex-math notation=\"LaTeX\">\\begin{equation*} H=f\\left ({{\\sum \\limits _{i=1}^{n} {\\omega x_{i} \\textrm {+b}_{j}}} }\\right)\\quad j=1,2,\\cdots,l\\tag{8}\\end{equation*}\n</tex-math><span class=\"formula\"><span class=\"link\">View Source</span><img aria-describedby=\"qtip-0\" style=\"display:inline;\" title=\"Right-click on figure or equation for MathML and additional features.\" data-hasqtip=\"0\" class=\"qtooltip moreInfo\" alt=\"Right-click on figure for MathML and additional features.\" src=\"/assets/img/icon.support.gif\" border=\"0\" height=\"20\" width=\"24\"/><span class=\"tex tex2jax_ignore\" style=\"display:none;\">\\begin{equation*} H=f\\left ({{\\sum \\limits _{i=1}^{n} {\\omega x_{i} \\textrm {+b}_{j}}} }\\right)\\quad j=1,2,\\cdots,l\\tag{8}\\end{equation*}\n</span></span></disp-formula> where <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$x$\n</tex-math></inline-formula> is input data, <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$j$\n</tex-math></inline-formula> is the number of neurons in the hidden layer, <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$n$\n</tex-math></inline-formula> is the number of neurons in the input layer and <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$f$\n</tex-math></inline-formula> is the excitation function. Third, the weight matrix of neurons between the hidden layer and the output layer can be calculated by <a ref-type=\"disp-formula\" anchor=\"deqn9\" href=\"#deqn9\" class=\"fulltext-link\">equation (9)</a>:<disp-formula id=\"deqn9\" class=\"display-formula\"><tex-math notation=\"LaTeX\">\\begin{equation*} \\beta =\\min \\limits _{\\beta } \\left \\|{ {H\\beta -L} }\\right \\|\\tag{9}\\end{equation*}\n</tex-math><span class=\"formula\"><span class=\"link\">View Source</span><img aria-describedby=\"qtip-0\" style=\"display:inline;\" title=\"Right-click on figure or equation for MathML and additional features.\" data-hasqtip=\"0\" class=\"qtooltip moreInfo\" alt=\"Right-click on figure for MathML and additional features.\" src=\"/assets/img/icon.support.gif\" border=\"0\" height=\"20\" width=\"24\"/><span class=\"tex tex2jax_ignore\" style=\"display:none;\">\\begin{equation*} \\beta =\\min \\limits _{\\beta } \\left \\|{ {H\\beta -L} }\\right \\|\\tag{9}\\end{equation*}\n</span></span></disp-formula> where <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$L$\n</tex-math></inline-formula> is the expected output of ELM and <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\beta $\n</tex-math></inline-formula> is the weight matrix between the hidden layer and the output layer.</p><p>In short, the learning process of ELM is simpler than the BP neural network, and it can model for the nonlinear problems within a shorter time. Furthermore, the complex problem of locally optimal solutions will be largely avoided by ELM <a ref-type=\"bibr\" anchor=\"ref29\" id=\"context_ref_29_2c\">[29]</a>. Thus, in order to verify the prediction model, an X-parameter model based on the predicted data and expected data is built. Thus, the harmonic balance simulation is carried out to obtain the corresponding spectrograms and modulus. Finally, the deviation of model can be obtained by spectrograms and modulus comparison. If the deviation of spectrograms is in [0, 4], and the error of modulus is ideal, the modeling is successful. Otherwise, it needs to be re-modeled.</p></div></div>\n<div class=\"section\" id=\"sec3\"><div class=\"header article-hdr\"><div class=\"kicker\">\n\t\t                        SECTION III.</div><h2>Results and Discussions</h2></div><div class=\"section_2\" id=\"sec3a\"><h3>A. Predictive Modeling Based on Double Layer BP Neural Network and ELM</h3><p>In order to achieve X-parameter modeling for transistors, a double layer BP neural network is constructed firstly.</p><p>The X-parameter prediction model based on the double layer BP neural network is illustrated in <a ref-type=\"fig\" anchor=\"fig5\" class=\"fulltext-link\">Fig. 5</a>. It can be seen that the input layer is [frequency, <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$P_{in}$\n</tex-math></inline-formula>, <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$V_{gs}$\n</tex-math></inline-formula>, <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$V_{ds}$\n</tex-math></inline-formula>], and the output layer is a set of X-parameter composed of 307 data. LM (Levenberg-Marquardt) algorithm is utilized as the training algorithm. By persistent training and testing, the number of neurons in the two hidden layers is five and eight, respectively.\n<div class=\"figure figure-full\" id=\"fig5\"><!--\n          Workaround for combined images.Eg.- 1000116 Fig. 5\n        --><div class=\"img-wrap\"><a href=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973304/lin5-3227327-large.gif\" data-fig-id=\"fig5\"><img src=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973304/lin5-3227327-small.gif\" alt=\"FIGURE 5. - X-parameters prediction model based on double layer BP neural network.\"/><div class=\"zoom\" title=\"View Larger Image\"/></a></div><div class=\"figcaption\"><b class=\"title\">FIGURE 5. </b><fig><p>X-parameters prediction model based on double layer BP neural network.</p></fig></div><p class=\"links\"><a href=\"/document/9973304/all-figures\" class=\"all\">Show All</a></p></div></p><p>Let the frequency of transistor is 3 GHz, input power is 30 dBm, <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$V_{gs}$\n</tex-math></inline-formula> is \u22121.9 V and <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$V_{ds}$\n</tex-math></inline-formula> is 20 V. The fit rate between the predicted and expected data is shown in <a ref-type=\"fig\" anchor=\"fig6\" class=\"fulltext-link\">Fig. 6</a>. The horizontal axis of <a ref-type=\"fig\" anchor=\"fig6\" class=\"fulltext-link\">Fig. 6</a> represents the 307 X-parameter terms extracted, and the vertical axis is the corresponding values of X- parameter. It can be shown that the fitting rate of some predicted data is good when it is near 0, but the fitting rate of data deviating from 0 is not optimal.\n<div class=\"figure figure-full\" id=\"fig6\"><!--\n          Workaround for combined images.Eg.- 1000116 Fig. 5\n        --><div class=\"img-wrap\"><a href=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973304/lin6-3227327-large.gif\" data-fig-id=\"fig6\"><img src=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973304/lin6-3227327-small.gif\" alt=\"FIGURE 6. - Fitting results of double layer BP neural network at frequency=3 GHz, &#10;$P_{in}=30$&#10; dBm, &#10;$V_{gs}=-1.9$&#10; V and &#10;$V_{d\\text {s}}=20$&#10; V.\"/><div class=\"zoom\" title=\"View Larger Image\"/></a></div><div class=\"figcaption\"><b class=\"title\">FIGURE 6. </b><fig><p>Fitting results of double layer BP neural network at frequency=3 GHz, <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$P_{in}=30$\n</tex-math></inline-formula> dBm, <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$V_{gs}=-1.9$\n</tex-math></inline-formula> V and <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$V_{d\\text {s}}=20$\n</tex-math></inline-formula> V.</p></fig></div><p class=\"links\"><a href=\"/document/9973304/all-figures\" class=\"all\">Show All</a></p></div></p><p>In addition, the relative error is calculated, as shown in <a ref-type=\"disp-formula\" anchor=\"deqn10\" href=\"#deqn10\" class=\"fulltext-link\">equation (10)</a>:<disp-formula id=\"deqn10\" class=\"display-formula\"><tex-math notation=\"LaTeX\">\\begin{equation*} E_{R} =\\frac {C_{i} -T_{i}}{T_{i}}\\tag{10}\\end{equation*}\n</tex-math><span class=\"formula\"><span class=\"link\">View Source</span><img aria-describedby=\"qtip-0\" style=\"display:inline;\" title=\"Right-click on figure or equation for MathML and additional features.\" data-hasqtip=\"0\" class=\"qtooltip moreInfo\" alt=\"Right-click on figure for MathML and additional features.\" src=\"/assets/img/icon.support.gif\" border=\"0\" height=\"20\" width=\"24\"/><span class=\"tex tex2jax_ignore\" style=\"display:none;\">\\begin{equation*} E_{R} =\\frac {C_{i} -T_{i}}{T_{i}}\\tag{10}\\end{equation*}\n</span></span></disp-formula> where <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$E_{R}$\n</tex-math></inline-formula> is relative error, <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$i$\n</tex-math></inline-formula> is number of samples, <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$C$\n</tex-math></inline-formula> represents the predictive output, and <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$T$\n</tex-math></inline-formula> is expected output.</p><p>And the relative error of double layer BP neural network is displayed in <a ref-type=\"fig\" anchor=\"fig7\" class=\"fulltext-link\">Fig. 7</a>. Typically, the maximum relative error is allowed within [0.95, 1.05]. It can be seen that the relative error of double layer BP neural network at this case is basically within [\u22121, 1], and more points are concentrated around \u22121 or 1. Therefore, the relative errors of most prediction data are distributed around the boundary of maximum error. On the contrary, the relative error centered near 0 is less.\n<div class=\"figure figure-full\" id=\"fig7\"><!--\n          Workaround for combined images.Eg.- 1000116 Fig. 5\n        --><div class=\"img-wrap\"><a href=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973304/lin7-3227327-large.gif\" data-fig-id=\"fig7\"><img src=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973304/lin7-3227327-small.gif\" alt=\"FIGURE 7. - Relative error of double layer BP neural network at frequency=3 GHz, &#10;$P_{in}=30$&#10; dBm, &#10;$V_{gs}=-1.9$&#10; V and &#10;$V_{d\\text {s}}=20$&#10; V.\"/><div class=\"zoom\" title=\"View Larger Image\"/></a></div><div class=\"figcaption\"><b class=\"title\">FIGURE 7. </b><fig><p>Relative error of double layer BP neural network at frequency=3 GHz, <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$P_{in}=30$\n</tex-math></inline-formula> dBm, <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$V_{gs}=-1.9$\n</tex-math></inline-formula> V and <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$V_{d\\text {s}}=20$\n</tex-math></inline-formula> V.</p></fig></div><p class=\"links\"><a href=\"/document/9973304/all-figures\" class=\"all\">Show All</a></p></div></p><p>In addition, when the frequency is 1GHz, <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$P_{in}$\n</tex-math></inline-formula> is 36 dBm, <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$V_{gs}$\n</tex-math></inline-formula> is \u22123.9V, and <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$V_{ds}$\n</tex-math></inline-formula> is 8V, the fitting situation of the double layer BP neural network is shown in <a ref-type=\"fig\" anchor=\"fig8\" class=\"fulltext-link\">Fig. 8</a>. The overall fit is better than <a ref-type=\"fig\" anchor=\"fig6\" class=\"fulltext-link\">Fig. 6</a>. But some point errors much larger than 0 are still significant, which reflects the limitation of double layer BP neural network in X-parameter modeling. And the relative error of double layer BP neural network is displayed in <a ref-type=\"fig\" anchor=\"fig9\" class=\"fulltext-link\">Fig. 9</a>. It is seen that in this case the relative error of double layer BP neural network is also basically within [\u22121,1]. Although there are fewer points near \u22121 and 1 than in <a ref-type=\"fig\" anchor=\"fig7\" class=\"fulltext-link\">Fig. 7</a>, most of the points are concentrated between [\u22120.75, 0.75]. And a small part of the relative errors is concentrated near 0. Hence the relative error in this case is better than <a ref-type=\"fig\" anchor=\"fig7\" class=\"fulltext-link\">Fig. 7</a>.\n<div class=\"figure figure-full\" id=\"fig8\"><!--\n          Workaround for combined images.Eg.- 1000116 Fig. 5\n        --><div class=\"img-wrap\"><a href=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973304/lin8-3227327-large.gif\" data-fig-id=\"fig8\"><img src=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973304/lin8-3227327-small.gif\" alt=\"FIGURE 8. - Fitting results of double layer BP neural network at frequency=1 GHz, &#10;$P_{in}=36$&#10; dBm, &#10;$V_{gs}=-3.9$&#10; V and &#10;$V_{d\\text {s}}=8$&#10; V.\"/><div class=\"zoom\" title=\"View Larger Image\"/></a></div><div class=\"figcaption\"><b class=\"title\">FIGURE 8. </b><fig><p>Fitting results of double layer BP neural network at frequency=1 GHz, <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$P_{in}=36$\n</tex-math></inline-formula> dBm, <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$V_{gs}=-3.9$\n</tex-math></inline-formula> V and <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$V_{d\\text {s}}=8$\n</tex-math></inline-formula> V.</p></fig></div><p class=\"links\"><a href=\"/document/9973304/all-figures\" class=\"all\">Show All</a></p></div>\n<div class=\"figure figure-full\" id=\"fig9\"><!--\n          Workaround for combined images.Eg.- 1000116 Fig. 5\n        --><div class=\"img-wrap\"><a href=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973304/lin9-3227327-large.gif\" data-fig-id=\"fig9\"><img src=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973304/lin9-3227327-small.gif\" alt=\"FIGURE 9. - Relative error of double layer BP neural network at frequency=1 GHz, &#10;$P_{in}=36$&#10; dBm, &#10;$V_{gs}=-3.9$&#10; V and &#10;$V_{d\\text {s}}=8$&#10; V.\"/><div class=\"zoom\" title=\"View Larger Image\"/></a></div><div class=\"figcaption\"><b class=\"title\">FIGURE 9. </b><fig><p>Relative error of double layer BP neural network at frequency=1 GHz, <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$P_{in}=36$\n</tex-math></inline-formula> dBm, <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$V_{gs}=-3.9$\n</tex-math></inline-formula> V and <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$V_{d\\text {s}}=8$\n</tex-math></inline-formula> V.</p></fig></div><p class=\"links\"><a href=\"/document/9973304/all-figures\" class=\"all\">Show All</a></p></div></p><p>When the test set is used to verify the BP neural network prediction model, the maximum prediction error in each group of 307 predicted values is obtained, and the results are shown in <a ref-type=\"fig\" anchor=\"fig10\" class=\"fulltext-link\">Fig. 10</a>. The maximum error range is within [0, 0.8], but most of the errors are concentrated around [0.5,0.6], while the errors around [0,0.3] are few. Moreover, the mean square error of the prediction model is 0.1455. And the double layer BP model takes 65 seconds in training and testing.\n<div class=\"figure figure-full\" id=\"fig10\"><!--\n          Workaround for combined images.Eg.- 1000116 Fig. 5\n        --><div class=\"img-wrap\"><a href=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973304/lin10-3227327-large.gif\" data-fig-id=\"fig10\"><img src=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973304/lin10-3227327-small.gif\" alt=\"FIGURE 10. - Maximum prediction error in 307 terms of X-parameter with double layer BP neural network.\"/><div class=\"zoom\" title=\"View Larger Image\"/></a></div><div class=\"figcaption\"><b class=\"title\">FIGURE 10. </b><fig><p>Maximum prediction error in 307 terms of X-parameter with double layer BP neural network.</p></fig></div><p class=\"links\"><a href=\"/document/9973304/all-figures\" class=\"all\">Show All</a></p></div></p><p>The X-parameter prediction model based on ELM is illustrated in <a ref-type=\"fig\" anchor=\"fig11\" class=\"fulltext-link\">Fig. 11</a>. With the same input and output, the number of neurons in the hidden layer is four finally.\n<div class=\"figure figure-full\" id=\"fig11\"><!--\n          Workaround for combined images.Eg.- 1000116 Fig. 5\n        --><div class=\"img-wrap\"><a href=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973304/lin11-3227327-large.gif\" data-fig-id=\"fig11\"><img src=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973304/lin11-3227327-small.gif\" alt=\"FIGURE 11. - X-parameters prediction model based on ELM.\"/><div class=\"zoom\" title=\"View Larger Image\"/></a></div><div class=\"figcaption\"><b class=\"title\">FIGURE 11. </b><fig><p>X-parameters prediction model based on ELM.</p></fig></div><p class=\"links\"><a href=\"/document/9973304/all-figures\" class=\"all\">Show All</a></p></div></p><p>When working at the frequency of 3 GHz, with <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$P_{in}$\n</tex-math></inline-formula> of 30 dBm, <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$V_{gs}$\n</tex-math></inline-formula> of \u22121.9 V and <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$V_{ds}$\n</tex-math></inline-formula> of 20 V, the fitting curve between the predicted data and the expected data for ELM is illustrated in <a ref-type=\"fig\" anchor=\"fig12\" class=\"fulltext-link\">Fig. 12</a>. It can be seen that the fitting rate of the model near 0 is ideal, and some data deviating from 0 can be roughly fitted, but few data have errors. Even so, the error of ELM is smaller than the double layer BP neural network in the same case. And the relative error of ELM prediction model is shown in <a ref-type=\"fig\" anchor=\"fig13\" class=\"fulltext-link\">Fig. 13</a>. It is seen that some points are around 1 or \u22121, but most of them are around [\u22120.5, 0.5]. Relative errors concentrated around 1 or \u22121 are reduced compared with double layer BP neural network.\n<div class=\"figure figure-full\" id=\"fig12\"><!--\n          Workaround for combined images.Eg.- 1000116 Fig. 5\n        --><div class=\"img-wrap\"><a href=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973304/lin12-3227327-large.gif\" data-fig-id=\"fig12\"><img src=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973304/lin12-3227327-small.gif\" alt=\"FIGURE 12. - Fitting results of ELM prediction model at frequency=3 GHz, &#10;$P_{in}=30$&#10; dBm, &#10;$V_{gs}=-1.9$&#10; V and &#10;$V_{d\\text {s}}=20$&#10; V.\"/><div class=\"zoom\" title=\"View Larger Image\"/></a></div><div class=\"figcaption\"><b class=\"title\">FIGURE 12. </b><fig><p>Fitting results of ELM prediction model at frequency=3 GHz, <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$P_{in}=30$\n</tex-math></inline-formula> dBm, <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$V_{gs}=-1.9$\n</tex-math></inline-formula> V and <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$V_{d\\text {s}}=20$\n</tex-math></inline-formula> V.</p></fig></div><p class=\"links\"><a href=\"/document/9973304/all-figures\" class=\"all\">Show All</a></p></div>\n<div class=\"figure figure-full\" id=\"fig13\"><!--\n          Workaround for combined images.Eg.- 1000116 Fig. 5\n        --><div class=\"img-wrap\"><a href=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973304/lin13-3227327-large.gif\" data-fig-id=\"fig13\"><img src=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973304/lin13-3227327-small.gif\" alt=\"FIGURE 13. - Relative error of ELM prediction model at frequency=3 GHz, &#10;$P_{in}=30$&#10; dBm, &#10;$V_{gs}=-1.9$&#10; V and &#10;$V_{d\\text {s}}=20$&#10; V.\"/><div class=\"zoom\" title=\"View Larger Image\"/></a></div><div class=\"figcaption\"><b class=\"title\">FIGURE 13. </b><fig><p>Relative error of ELM prediction model at frequency=3 GHz, <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$P_{in}=30$\n</tex-math></inline-formula> dBm, <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$V_{gs}=-1.9$\n</tex-math></inline-formula> V and <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$V_{d\\text {s}}=20$\n</tex-math></inline-formula> V.</p></fig></div><p class=\"links\"><a href=\"/document/9973304/all-figures\" class=\"all\">Show All</a></p></div></p><p>In case of frequency is 1 GHz, <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$P_{in}$\n</tex-math></inline-formula> is 36 dBm, <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$V_{gs}$\n</tex-math></inline-formula> is \u22123.9 V and <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$V_{ds}$\n</tex-math></inline-formula> is 8 V, the fitting results of ELM is shown in <a ref-type=\"fig\" anchor=\"fig14\" class=\"fulltext-link\">Fig. 14</a>. It can be seen that the fitting results are very ideal, basically all points can be well matched. However, only very few points have errors, and the errors are within the acceptable range. The relative error of ELM prediction model in this case is shown in <a ref-type=\"fig\" anchor=\"fig15\" class=\"fulltext-link\">Fig. 15</a>. It can be seen that most points are around [\u22120.5, 0.5], the overall situation is better than double layer BP neural network. So according to the result of relative error, the prediction credibility of ELM is better than double layer BP neural network.\n<div class=\"figure figure-full\" id=\"fig14\"><!--\n          Workaround for combined images.Eg.- 1000116 Fig. 5\n        --><div class=\"img-wrap\"><a href=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973304/lin14-3227327-large.gif\" data-fig-id=\"fig14\"><img src=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973304/lin14-3227327-small.gif\" alt=\"FIGURE 14. - Fitting results of ELM prediction model at frequency=1 GHz, &#10;$P_{in}=36$&#10; dBm, &#10;$V_{gs}=-3.9$&#10; V and &#10;$V_{d\\text {s}}=8$&#10; V.\"/><div class=\"zoom\" title=\"View Larger Image\"/></a></div><div class=\"figcaption\"><b class=\"title\">FIGURE 14. </b><fig><p>Fitting results of ELM prediction model at frequency=1 GHz, <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$P_{in}=36$\n</tex-math></inline-formula> dBm, <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$V_{gs}=-3.9$\n</tex-math></inline-formula> V and <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$V_{d\\text {s}}=8$\n</tex-math></inline-formula> V.</p></fig></div><p class=\"links\"><a href=\"/document/9973304/all-figures\" class=\"all\">Show All</a></p></div>\n<div class=\"figure figure-full\" id=\"fig15\"><!--\n          Workaround for combined images.Eg.- 1000116 Fig. 5\n        --><div class=\"img-wrap\"><a href=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973304/lin15-3227327-large.gif\" data-fig-id=\"fig15\"><img src=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973304/lin15-3227327-small.gif\" alt=\"FIGURE 15. - Relative error of ELM prediction model at frequency=1 GHz, &#10;$P_{in}=36$&#10; dBm, &#10;$V_{gs}=-3.9$&#10; V and &#10;$V_{d\\text {s}}=8$&#10; V.\"/><div class=\"zoom\" title=\"View Larger Image\"/></a></div><div class=\"figcaption\"><b class=\"title\">FIGURE 15. </b><fig><p>Relative error of ELM prediction model at frequency=1 GHz, <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$P_{in}=36$\n</tex-math></inline-formula> dBm, <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$V_{gs}=-3.9$\n</tex-math></inline-formula> V and <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$V_{d\\text {s}}=8$\n</tex-math></inline-formula> V.</p></fig></div><p class=\"links\"><a href=\"/document/9973304/all-figures\" class=\"all\">Show All</a></p></div></p><p>Similarly, when ELM prediction is adopted, the maximum error of each test set is obtained, which the result is shown in <a ref-type=\"fig\" anchor=\"fig16\" class=\"fulltext-link\">Fig. 16</a>. Although the maximum error range of each group is [0,0.8], it can be roughly seen that the maximum error of ELM greater than 0.6 is relatively small. Finally, the mean square error of ELM is calculated as 0.0027, and training and testing of the ELM model takes 10 seconds.\n<div class=\"figure figure-full\" id=\"fig16\"><!--\n          Workaround for combined images.Eg.- 1000116 Fig. 5\n        --><div class=\"img-wrap\"><a href=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973304/lin16-3227327-large.gif\" data-fig-id=\"fig16\"><img src=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973304/lin16-3227327-small.gif\" alt=\"FIGURE 16. - Maximum prediction error in 307 terms of X-parameter with double ELM.\"/><div class=\"zoom\" title=\"View Larger Image\"/></a></div><div class=\"figcaption\"><b class=\"title\">FIGURE 16. </b><fig><p>Maximum prediction error in 307 terms of X-parameter with double ELM.</p></fig></div><p class=\"links\"><a href=\"/document/9973304/all-figures\" class=\"all\">Show All</a></p></div></p><p>In order to clearly show the maximum error distribution of BP and ELM, <a ref-type=\"fig\" anchor=\"fig17\" class=\"fulltext-link\">Fig. 17</a> is depicted. The error of double layer BP neural network is mostly concentrated in the range of [0.4, 0.6], while the error range of ELM is mostly in the range of [0, 0.4]. It is demonstrated that the error of double layer BP neural network is larger than ELM.\n<div class=\"figure figure-full\" id=\"fig17\"><!--\n          Workaround for combined images.Eg.- 1000116 Fig. 5\n        --><div class=\"img-wrap\"><a href=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973304/lin17-3227327-large.gif\" data-fig-id=\"fig17\"><img src=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973304/lin17-3227327-small.gif\" alt=\"FIGURE 17. - Maximum prediction error distribution of X-parameter.\"/><div class=\"zoom\" title=\"View Larger Image\"/></a></div><div class=\"figcaption\"><b class=\"title\">FIGURE 17. </b><fig><p>Maximum prediction error distribution of X-parameter.</p></fig></div><p class=\"links\"><a href=\"/document/9973304/all-figures\" class=\"all\">Show All</a></p></div></p><p>Besides building the neural network model, an interpolation experiment of X-parameter is performed. It is used to verify whether interpolation method can achieve better prediction of X-parameter. The interpolation method is utilized to calculate X-parameter of when <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$f=3$\n</tex-math></inline-formula> GHz, <i>Pin</i> = 30 dBm, <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$V_{gs}=-1.9\\,\\,V$\n</tex-math></inline-formula> and <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$V_{ds}=20\\,\\,V$\n</tex-math></inline-formula>, and the fitting result is shown in <a ref-type=\"fig\" anchor=\"fig18\" class=\"fulltext-link\">Fig. 18</a>. The error of X-parameter calculated by the interpolation method is relatively large. And the fitting effect of points far from 0 is not good, even the fitting of some points closes to 0 is not ideal.\n<div class=\"figure figure-full\" id=\"fig18\"><!--\n          Workaround for combined images.Eg.- 1000116 Fig. 5\n        --><div class=\"img-wrap\"><a href=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973304/lin18-3227327-large.gif\" data-fig-id=\"fig18\"><img src=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973304/lin18-3227327-small.gif\" alt=\"FIGURE 18. - Fitting results of interpolation at frequency=3 GHz, &#10;$P_{in}=30$&#10; dBm, &#10;$V_{gs}=-1.9\\,\\,V$&#10; and &#10;$V_{d\\text {s}}=20\\,\\,V$&#10;.\"/><div class=\"zoom\" title=\"View Larger Image\"/></a></div><div class=\"figcaption\"><b class=\"title\">FIGURE 18. </b><fig><p>Fitting results of interpolation at frequency=3 GHz, <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$P_{in}=30$\n</tex-math></inline-formula> dBm, <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$V_{gs}=-1.9\\,\\,V$\n</tex-math></inline-formula> and <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$V_{d\\text {s}}=20\\,\\,V$\n</tex-math></inline-formula>.</p></fig></div><p class=\"links\"><a href=\"/document/9973304/all-figures\" class=\"all\">Show All</a></p></div></p><p>The interpolation experiment with <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$f=1$\n</tex-math></inline-formula> GHz, <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$P_{in}=36$\n</tex-math></inline-formula> dBm, <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$V_{gs}=-3.9$\n</tex-math></inline-formula> V and <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$V_{ds}=8$\n</tex-math></inline-formula> V is carried out here, and the fitting result is shown in <a ref-type=\"fig\" anchor=\"fig19\" class=\"fulltext-link\">Fig. 19</a>. It can be seen that although the fitting situation of the data in the former part is generally ideal, the fitting situation of the data in the latter part is not optimistic, and the error is relatively large. It is proved from the interpolation experiments that the neural network model has a greater advantage than the interpolation method in predicting X-parameters.\n<div class=\"figure figure-full\" id=\"fig19\"><!--\n          Workaround for combined images.Eg.- 1000116 Fig. 5\n        --><div class=\"img-wrap\"><a href=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973304/lin19-3227327-large.gif\" data-fig-id=\"fig19\"><img src=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973304/lin19-3227327-small.gif\" alt=\"FIGURE 19. - Fitting results of interpolation at frequency=1 GHz, &#10;$P_{in}=36$&#10; dBm, &#10;$V_{gs}=-3.9$&#10; V and &#10;$V_{d\\text {s}}=8$&#10; V.\"/><div class=\"zoom\" title=\"View Larger Image\"/></a></div><div class=\"figcaption\"><b class=\"title\">FIGURE 19. </b><fig><p>Fitting results of interpolation at frequency=1 GHz, <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$P_{in}=36$\n</tex-math></inline-formula> dBm, <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$V_{gs}=-3.9$\n</tex-math></inline-formula> V and <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$V_{d\\text {s}}=8$\n</tex-math></inline-formula> V.</p></fig></div><p class=\"links\"><a href=\"/document/9973304/all-figures\" class=\"all\">Show All</a></p></div></p><p>In the above experiments, although the operation of the interpolation method is not restricted to a single software, its prediction ability for X-parameter is limited, and it is far less accurate than ELM and double layer BP neural network. And through the experiments on double layer BP neural network and ELM, it can be concluded that ELM is better than double layer BP neural network in terms of fitting situation, error or training time.</p><p>Moreover, the resource occupancy of X-parameters obtained by using double-layer BP neural network, ELM and ADS is shown in <a ref-type=\"table\" anchor=\"table2\" class=\"fulltext-link\">Table 2</a>. In general, it can be seen that ADS spends more time and occupies more computer resources when extracting data. And using neural network to obtain X-parameter occupies the least resources. Among them, BP neural network takes more computer resources than ELM because it takes longer time to train and test.<div class=\"figure figure-full table\" id=\"table2\"><div class=\"figcaption\"><b class=\"title\">TABLE 2 </b>\nResource Occupancy of Double Layer BP Neural Network, ELM and ADS</div><div class=\"img-wrap\"><a href=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973304/lin.t2-3227327-large.gif\"><img src=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973304/lin.t2-3227327-small.gif\" alt=\"Table 2- &#10;Resource Occupancy of Double Layer BP Neural Network, ELM and ADS\"/><div class=\"zoom\" title=\"View Larger Image\"/></a></div></div></p><p>In conclusion, when the two methods are used to establish a prediction model, ELM modeling is relatively ideal and has small resource occupation, which means that ELM is more effective than the double layer BP neural network in X-parameter modeling.</p></div><div class=\"section_2\" id=\"sec3b\"><h3>B. Validate Predictive Model</h3><p>Harmonic balance simulation focuses on signal frequency domain characteristics and is good at handling the analysis of nonlinear circuits. Therefore, harmonic balance simulation has become the most common method for nonlinear system analysis. This method can be used to simulate noise, gain compression, harmonic distortion, etc. in nonlinear circuits, which is faster than traditional SPICE simulation. Based on these advantages of harmonic simulation, the X-parameter model is verified by this method.</p><p>In order to verify the error of the model in the actual circuit, harmonic balance simulation is carried out. Finally, spectrogram of the third harmonic and the modulus of the output voltage for the X-parameter models are obtained.</p><p>Accordingly, a verification and prediction model of X-parameters is constructed. The prediction data and expected data of the double layer BP neural network and ELM are generated into the corresponding the X-parameter model. When the X-parameter model is generated, the X4P module in ADS is adopted, and then the.xnp parameter file is imported into the module. Because the.xnp file is a GMDIF file, the file type must be selected as GMDIF when imported into the X4P module. Otherwise, the generation of the X-parameter model will fail. It is worth noting that these X-parameter models are generated by X-parameter with a frequency of 3 GHz, <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$P_{in}$\n</tex-math></inline-formula> of 30 dBm, <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$V_{gs}$\n</tex-math></inline-formula> of \u22121.9 V and <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$V_{ds}$\n</tex-math></inline-formula> of 20 V.</p><p>The generated X-parameter model is shown in <a ref-type=\"fig\" anchor=\"fig20\" class=\"fulltext-link\">Fig. 20</a>. Where terminal 1 of the X-parameter model is the gate input, terminal 2 is the drain output, terminal 3 is the gate voltage, terminal 4 is the drain voltage, and the Ref terminal is grounded. The X-parameter model can be used to simulate CGH40010F transistors in ADS, such as load pull, harmonic balance simulation and so on. Thus, the relationship between X-parameter file and X-parameter model can be seen. X-parameter file is obtained by ADS to represent the large signal characteristics of the transistor under certain conditions, while X-parameter model is generated by importing X-parameter file into X4P module.\n<div class=\"figure figure-full\" id=\"fig20\"><!--\n          Workaround for combined images.Eg.- 1000116 Fig. 5\n        --><div class=\"img-wrap\"><a href=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973304/lin20-3227327-large.gif\" data-fig-id=\"fig20\"><img src=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973304/lin20-3227327-small.gif\" alt=\"FIGURE 20. - X-parameter model.\"/><div class=\"zoom\" title=\"View Larger Image\"/></a></div><div class=\"figcaption\"><b class=\"title\">FIGURE 20. </b><fig><p>X-parameter model.</p></fig></div><p class=\"links\"><a href=\"/document/9973304/all-figures\" class=\"all\">Show All</a></p></div></p><p>After that, the CGH40010F transistor in <a ref-type=\"fig\" anchor=\"fig2\" class=\"fulltext-link\">Fig. 2</a> is replaced by the X-parameter models. Then the balance simulation circuit is designed in ADS to obtain the harmonic balance simulation schematic as shown in <a ref-type=\"fig\" anchor=\"fig21\" class=\"fulltext-link\">Fig. 21</a>. After simulation, the corresponding spectrograms for the double layer BP neural network and ELM are obtained.\n<div class=\"figure figure-full\" id=\"fig21\"><!--\n          Workaround for combined images.Eg.- 1000116 Fig. 5\n        --><div class=\"img-wrap\"><a href=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973304/lin21-3227327-large.gif\" data-fig-id=\"fig21\"><img src=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973304/lin21-3227327-small.gif\" alt=\"FIGURE 21. - Schematic of the harmonic balance simulation.\"/><div class=\"zoom\" title=\"View Larger Image\"/></a></div><div class=\"figcaption\"><b class=\"title\">FIGURE 21. </b><fig><p>Schematic of the harmonic balance simulation.</p></fig></div><p class=\"links\"><a href=\"/document/9973304/all-figures\" class=\"all\">Show All</a></p></div></p><p>For the sake of comparison, the standard spectrum has been acquired. Where the fundamental wave is \u221221.670 dBm, the second harmonic is \u221221.566 dBm, and the third harmonic is \u221241.919 dBm.</p><p>Then X-parameter spectrogram predicted by the double layer BP neural network model is obtained. And the fundamental, second, and third harmonics of X-parameter spectrogram predicted by the double layer BP neural network model are \u221212.145 dBm, \u221220.257 dBm, and \u221227.326 dBm, respectively. The spectrogram error can be calculated by <a ref-type=\"disp-formula\" anchor=\"deqn11\" href=\"#deqn11\" class=\"fulltext-link\">(11)</a>:<disp-formula id=\"deqn11\" class=\"display-formula\"><tex-math notation=\"LaTeX\">\\begin{equation*} D_{i} =E_{i} -P_{i}\\tag{11}\\end{equation*}\n</tex-math><span class=\"formula\"><span class=\"link\">View Source</span><img aria-describedby=\"qtip-0\" style=\"display:inline;\" title=\"Right-click on figure or equation for MathML and additional features.\" data-hasqtip=\"0\" class=\"qtooltip moreInfo\" alt=\"Right-click on figure for MathML and additional features.\" src=\"/assets/img/icon.support.gif\" border=\"0\" height=\"20\" width=\"24\"/><span class=\"tex tex2jax_ignore\" style=\"display:none;\">\\begin{equation*} D_{i} =E_{i} -P_{i}\\tag{11}\\end{equation*}\n</span></span></disp-formula> where <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$D_{\\mathrm {i}}$\n</tex-math></inline-formula> is the error of the <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$i^{th}$\n</tex-math></inline-formula> harmonic, <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$E_{i}$\n</tex-math></inline-formula> is the <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$i^{th}$\n</tex-math></inline-formula> harmonic of the standard spectrum, and <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$P_{i}$\n</tex-math></inline-formula> is the <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$i^{th}$\n</tex-math></inline-formula> harmonic of the predicted X-parameter model.</p><p>Compared with the standard spectrogram, the error can be obtained as 9.525 dBm, 1.309 dBm, and 14.593 dBm, respectively, as shown in <a ref-type=\"table\" anchor=\"table1\" class=\"fulltext-link\">Table 1</a>. That is to say the error of the second harmonic is small, but the fundamental error and the third harmonic error are significant.</p><p>Finally, the spectrogram obtained by X-parameters modeled by ELM can be obtained. The fundamental, second, and third harmonics are \u221220.997 dBm, \u221221.880 dBm, and \u221238.829 dBm, respectively. Similarly, the errors for fundamental, second and third harmonic are 0.673 dBm, 0.314 dBm, and 3.09 dBm, respectively, as shown in <a ref-type=\"table\" anchor=\"table3\" class=\"fulltext-link\">Table 3</a>. It is concluded that the three harmonic errors of X-parameters are controlled within the range of [0, 4], the modeling accuracy is higher than double layer BP neural network.<div class=\"figure figure-full table\" id=\"table3\"><div class=\"figcaption\"><b class=\"title\">TABLE 3 </b>\nSpectrogram Errors of Double Layer BP Neural Network and ELM</div><div class=\"img-wrap\"><a href=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973304/lin.t3-3227327-large.gif\"><img src=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973304/lin.t3-3227327-small.gif\" alt=\"Table 3- &#10;Spectrogram Errors of Double Layer BP Neural Network and ELM\"/><div class=\"zoom\" title=\"View Larger Image\"/></a></div></div></p><p>Therefore, the double layer BP neural network model only has the ideal error of the second harmonic. In contrast, the fundamental and the third harmonic errors are relatively large, so the model cannot accurately characterize the nonlinear characteristics of the transistor. While, the fundamental error, the second harmonic error and the third harmonic error of the ELM prediction model are all in the range of [0, 4].</p><p>For the purpose of further verifying the accuracy of the prediction model, the three-harmonic modulus of the prediction data are compared with the expected data, and the result is displayed in the <a ref-type=\"table\" anchor=\"table4\" class=\"fulltext-link\">Table 4</a>. It can be shown that the three harmonic modulus error of double layer BP is much higher than ELM. Through the above verification experiments, it can be concluded that the error of ELM prediction model is lower than the double layer BP neural network, so the model can be used to model the X-parameters of transistors. The BP neural network model is easy to fall into local optimum and cannot reach global optimum, which leads to poor accuracy. However, except for the number of neurons in the hidden layer, other parameters of ELM are randomly generated, so the optimal solution can be obtained quickly and the model has a good accuracy.<div class=\"figure figure-full table\" id=\"table4\"><div class=\"figcaption\"><b class=\"title\">TABLE 4 </b>\nModulus Errors of Double Layer BP Neural Network and ELM</div><div class=\"img-wrap\"><a href=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973304/lin.t4-3227327-large.gif\"><img src=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973304/lin.t4-3227327-small.gif\" alt=\"Table 4- &#10;Modulus Errors of Double Layer BP Neural Network and ELM\"/><div class=\"zoom\" title=\"View Larger Image\"/></a></div></div></p></div><div class=\"section_2\" id=\"sec3c\"><h3>C. Design of RF Power Amplifier by Using X-Parameter Model</h3><p>X-parameter models can be used in nonlinear circuit designs <a ref-type=\"bibr\" anchor=\"ref30\" id=\"context_ref_30_3c\">[30]</a>. To verify the accuracy of the X-parameter prediction model in circuit design, it is used in power amplifier design.</p><p>Firstly, the predicted X-parameter is manually collated into a.xnp format. Then, the.xnp file is imported into the X4P module for the design of power amplifier. Because the expected X-parameter model is used first when designing amplifiers. Therefore, the expected X-parameter should be imported into the X4P module.</p><p>After the bias circuit by using the expected X-parameter is designed, the source pull and load pull simulation are implemented. Then the optimal source impedance and load impedance are obtained. Next, source impedance and load impedance matching are performed. Finally, the schematic of the power amplifier designed with the X-parameter model is displayed in <a ref-type=\"fig\" anchor=\"fig22\" class=\"fulltext-link\">Fig. 22</a>. It can be seen that the circuit structure is similar to <a ref-type=\"fig\" anchor=\"fig2\" class=\"fulltext-link\">Fig. 2</a>, which is also composed of four parts. In addition, to enhance the stability of the circuit, resistor <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$R_{1}$\n</tex-math></inline-formula> is added to the gate, and a capacitor <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$C_{1}$\n</tex-math></inline-formula> is connected in parallel at <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$R_{1}$\n</tex-math></inline-formula> to reduce the gain and power reduction.\n<div class=\"figure figure-full\" id=\"fig22\"><!--\n          Workaround for combined images.Eg.- 1000116 Fig. 5\n        --><div class=\"img-wrap\"><a href=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973304/lin22-3227327-large.gif\" data-fig-id=\"fig22\"><img src=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973304/lin22-3227327-small.gif\" alt=\"FIGURE 22. - Schematic of power amplifier by using X-parameter model.\"/><div class=\"zoom\" title=\"View Larger Image\"/></a></div><div class=\"figcaption\"><b class=\"title\">FIGURE 22. </b><fig><p>Schematic of power amplifier by using X-parameter model.</p></fig></div><p class=\"links\"><a href=\"/document/9973304/all-figures\" class=\"all\">Show All</a></p></div></p><p>When the design of power amplifier by using the expected X-parameter is completed, the small signal simulation is carried out. The small signal simulation results of S<sub>11</sub> and S<sub>22</sub> is shown in <a ref-type=\"fig\" anchor=\"fig23\" class=\"fulltext-link\">Fig. 23</a>. It can be seen that when the power amplifier is running at 2.5 GHz, both S<sub>11</sub> and S<sub>22</sub> are less than \u221210 dB, which indicates that most of the signal in the amplifier can be output.\n<div class=\"figure figure-full\" id=\"fig23\"><!--\n          Workaround for combined images.Eg.- 1000116 Fig. 5\n        --><div class=\"img-wrap\"><a href=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973304/lin23-3227327-large.gif\" data-fig-id=\"fig23\"><img src=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973304/lin23-3227327-small.gif\" alt=\"FIGURE 23. - Small Signal Simulation Results of S11 and S22.\"/><div class=\"zoom\" title=\"View Larger Image\"/></a></div><div class=\"figcaption\"><b class=\"title\">FIGURE 23. </b><fig><p>Small Signal Simulation Results of S<sub>11</sub> and S<sub>22</sub>.</p></fig></div><p class=\"links\"><a href=\"/document/9973304/all-figures\" class=\"all\">Show All</a></p></div></p><p>In addition, harmonic balance simulation is carried out. The output power simulated by the expected X-parameter model at 2.5 GHz, 5.0 GHz and 7.5 GHz is 8.917 dBm, 5.206 dBm and \u22122.899 dBm, respectively.</p><p>In order to verify whether the predicted X-parameters can be used in circuit design, the expected X-parameter model is replaced by the predicted X-parameter model for harmonic balance simulation. Finally, under the same conditions, the output power of the double layer BP neural network X-parameter prediction model at 2.5 GHz, 5.0 GHz and 7.5 GHz is 7.775 dBm, 3.770 dBm and 0.605 dBm, respectively. And the output power of the ELM X-parameter prediction model at 2.5 GHz, 5.0 GHz and 7.5 GHz is 8.828 dBm, 5.517 dBm and \u22123.208 dBm, respectively.</p><p>The output power error at different frequencies used by double layer BP neural network and ELM predictive models for amplifier design are shown in <a ref-type=\"table\" anchor=\"table5\" class=\"fulltext-link\">Table 5</a>. The error of the ELM model is below 0.35 dBm, while the error of the double layer BP neural network is below 2.5 dBm. It is concluded that the accuracy of the ELM predictive model in the actual circuit design is higher than the double layer BP neural network. Therefore, the precision of ELM model is sufficient for the power amplifier design.<div class=\"figure figure-full table\" id=\"table5\"><div class=\"figcaption\"><b class=\"title\">TABLE 5 </b>\nOutput Power Errors of Double Layer BP Neural Network and ELM</div><div class=\"img-wrap\"><a href=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973304/lin.t5-3227327-large.gif\"><img src=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973304/lin.t5-3227327-small.gif\" alt=\"Table 5- &#10;Output Power Errors of Double Layer BP Neural Network and ELM\"/><div class=\"zoom\" title=\"View Larger Image\"/></a></div></div></p></div></div>\n<div class=\"section\" id=\"sec4\"><div class=\"header article-hdr\"><div class=\"kicker\">\n\t\t                        SECTION IV.</div><h2>Conclusion</h2></div><p>To characterize the nonlinear characteristics of microwave power devices, double layer BP neural network and ELM models are built here. In addition, the harmonic balance simulation is carried out to verify the result. By comparison, ELM has higher accuracy. Therefore, ELM can accurately characterize the nonlinear characteristics of microwave power devices than double layer BP neural networks. It can serve as an essential method for further improving design efficiency and performance for RF microwave circuit. In future, the memory effect can be combined into the proposed ELM model. As a future potential direction, the proposed modeling technique can be further studied for other transistor modeling.</p></div>\n</div></div>\n"
}