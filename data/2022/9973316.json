{
    "abstract": "Human gait analysis and detection are critical for many applications, including wearable and rehabilitation robotic devices, reducing or tracking injury risk. The proposed work allows researchers to study the gait phase of human subjects in an unsupervised outdoor environment without the need for fixed thresholds and sensor-embedded insoles. We present an experimental protocol to label gait events...",
    "articleNumber": "9973316",
    "articleTitle": "Gait Phase Estimation of Unsupervised Outdoors Walking Using IMUs and a Linear Regression Model",
    "authors": [
        {
            "preferredName": "Ahmed Soliman",
            "normalizedName": "A. Soliman",
            "firstName": "Ahmed",
            "lastName": "Soliman",
            "searchablePreferredName": "Ahmed Soliman"
        },
        {
            "preferredName": "Guilherme A. Ribeiro",
            "normalizedName": "G. A. Ribeiro",
            "firstName": "Guilherme A.",
            "lastName": "Ribeiro",
            "searchablePreferredName": "Guilherme A. Ribeiro"
        },
        {
            "preferredName": "Andres Torres",
            "normalizedName": "A. Torres",
            "firstName": "Andres",
            "lastName": "Torres",
            "searchablePreferredName": "Andres Torres"
        },
        {
            "preferredName": "Li-Fan Wu",
            "normalizedName": "L. -F. Wu",
            "firstName": "Li-Fan",
            "lastName": "Wu",
            "searchablePreferredName": "Li-Fan Wu"
        },
        {
            "preferredName": "Mo Rastgaar",
            "normalizedName": "M. Rastgaar",
            "firstName": "Mo",
            "lastName": "Rastgaar",
            "searchablePreferredName": "Mo Rastgaar"
        }
    ],
    "doi": "10.1109/ACCESS.2022.3227344",
    "publicationTitle": "IEEE Access",
    "publicationYear": "2022",
    "publicationVolume": null,
    "publicationIssue": null,
    "volume": "10",
    "issue": null,
    "documentLink": "/document/9973316/",
    "xml": "<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<response><accessType>CCBY - IEEE is not the copyright holder of this material. Please follow the instructions via https://creativecommons.org/licenses/by/4.0/ to obtain full-text articles and stipulations in the API documentation.</accessType><div id=\"BodyWrapper\" class=\"ArticlePage\" xmlns:ieee=\"http://www.ieeexplore.ieee.org\"><div id=\"article\">\n<div class=\"section\" id=\"sec1\"><div class=\"header article-hdr\"><div class=\"kicker\">\n\t\t                        SECTION I.</div><h2>Introduction</h2></div><p>Walking is an essential part of humans\u2019 activities of daily living. As a result, there has been increasing clinical and research interest in gait monitoring and analysis. Gait cycles begin when the heel of one foot strikes the ground (0% of gait phase) and ends with the next strike of the same foot. Each cycle includes two major phases, a stance, and a swing phase. The stance phase is when the studied foot is on the ground; the stance starts at heel strike (HS) and ends at toe-off (TO). The swing phase is when the studied foot is off the ground; the swing starts at TO and goes to the next HS of the studied foot (100% of the gait cycle) <a ref-type=\"bibr\" anchor=\"ref1\" id=\"context_ref_1_1\">[1]</a>. Gait analysis systems are used to evaluate patients\u2019 health and study human gait <a ref-type=\"bibr\" anchor=\"ref2\" id=\"context_ref_2_1\">[2]</a>, <a ref-type=\"bibr\" anchor=\"ref3\" id=\"context_ref_3_1\">[3]</a> and are an essential clinical tool for a wide range of applications, such as assessing neurological and sports injuries <a ref-type=\"bibr\" anchor=\"ref4\" id=\"context_ref_4_1\">[4]</a>, risk of falls <a ref-type=\"bibr\" anchor=\"ref5\" id=\"context_ref_5_1\">[5]</a>, prostheses design <a ref-type=\"bibr\" anchor=\"ref6\" id=\"context_ref_6_1\">[6]</a>, <a ref-type=\"bibr\" anchor=\"ref7\" id=\"context_ref_7_1\">[7]</a>, rehabilitation devices <a ref-type=\"bibr\" anchor=\"ref8\" id=\"context_ref_8_1\">[8]</a>, <a ref-type=\"bibr\" anchor=\"ref9\" id=\"context_ref_9_1\">[9]</a> and gait emulators <a ref-type=\"bibr\" anchor=\"ref10\" id=\"context_ref_10_1\">[10]</a>, <a ref-type=\"bibr\" anchor=\"ref11\" id=\"context_ref_11_1\">[11]</a>. For optimal performance of such applications, accurate detection of the gait phase is required. For example, Cherell et al. designed the Ankle Mimicking Prosthetic Foot (AMP-Foot) that utilizes torque control of DC motors <a ref-type=\"bibr\" anchor=\"ref12\" id=\"context_ref_12_1\">[12]</a>. Distinct gait events are used to provide the required parameters for controlling the torque of the motors. Yang et al. used two hall effect sensors to detect two phases of the gait cycle and command a fuzzy controller for a passive prosthesis <a ref-type=\"bibr\" anchor=\"ref13\" id=\"context_ref_13_1\">[13]</a>.</p><p>Gait analysis and estimation are typically conducted in a proctored lab environment equipped with motion-capture systems <a ref-type=\"bibr\" anchor=\"ref14\" id=\"context_ref_14_1\">[14]</a> and force plates <a ref-type=\"bibr\" anchor=\"ref15\" id=\"context_ref_15_1\">[15]</a>. These approaches can provide an accurate measure of the human gait phase; however, they are expensive and require large laboratory spaces <a ref-type=\"bibr\" anchor=\"ref16\" id=\"context_ref_16_1\">[16]</a>. Alternatively, Inertial Measurement Units (IMUs) are utilized in many gait studies due to their low cost and portability. In more recent work, IMUs are attached to human subjects\u2019 feet, shanks, or waists to detect HS and TO events <a ref-type=\"bibr\" anchor=\"ref17\" id=\"context_ref_17_1\">[17]</a>. The placement of IMUs on foot is most common since it provides a clear distinction between the swing and stance phases <a ref-type=\"bibr\" anchor=\"ref16\" id=\"context_ref_16_1\">[16]</a>, <a ref-type=\"bibr\" anchor=\"ref18\" id=\"context_ref_18_1\">[18]</a>, <a ref-type=\"bibr\" anchor=\"ref19\" id=\"context_ref_19_1\">[19]</a>. Different gait phase estimation approaches use online and offline detection methods. Lee and Parkused a single-foot IMU to detect heel-strike (HS) (using spikes in linear acceleration) and toe-off (TO) in an offline process <a ref-type=\"bibr\" anchor=\"ref20\" id=\"context_ref_20_1\">[20]</a>. Bae and Tomizukaused Smart shoes embedded with four force sensors (FSR) and predicted the gait phase through an offline Hidden Markov Model <a ref-type=\"bibr\" anchor=\"ref21\" id=\"context_ref_21_1\">[21]</a>. Arvind et al. utilized a hybrid feed-forward neural network and hidden Markov model to estimate the gait phase online from measurements of seven IMUs attached to the subjects\u2019 lower extremities. They reported 88.7% detection accuracy of phases of the gait cycle <a ref-type=\"bibr\" anchor=\"ref22\" id=\"context_ref_22_1\">[22]</a>. Zhen et al. used a deep neural network and data from foot, thigh, and calf IMUs to detect 2 phases of the gait cycle offline, reporting an F-score accuracy of 92% <a ref-type=\"bibr\" anchor=\"ref23\" id=\"context_ref_23_1\">[23]</a>. Kim et al. utilized a single-foot IMU and time-frequency analysis to detect HS and TO events offline <a ref-type=\"bibr\" anchor=\"ref16\" id=\"context_ref_16_1\">[16]</a>. Mannini et al. utilized a custom-made wireless foot IMU for online decoding of Hidden Markov Models for Gait Event Detection <a ref-type=\"bibr\" anchor=\"ref24\" id=\"context_ref_24_1\">[24]</a>. Yan et al. used three IMUs (thigh, calf, and foot), principal component analysis (PCA), and a Voting-Weighted Integrated Neural Network to detect HS and TO offline <a ref-type=\"bibr\" anchor=\"ref25\" id=\"context_ref_25_1\">[25]</a>. Quintero et al. proposed using a single thigh IMU to continuously measure gait phase and speed estimation based on a single mechanical parameter derived from human thigh motion <a ref-type=\"bibr\" anchor=\"ref26\" id=\"context_ref_26_1\">[26]</a>. Potter et al. used an array of body-worn IMUs and an error-state Kalman filter to estimate lower-limb kinematics, testing their work on a simplified 3-body model of the human lower limbs <a ref-type=\"bibr\" anchor=\"ref27\" id=\"context_ref_27_1\">[27]</a>. Previous groups typically validated their work with human subjects ranging from 3-20 recruited human subjects. The authors previously used foot and shank magnetic, angular rate, and gravity sensor modules (MARGs) and an error-state Kalman filter to get a real-time estimate of foot and shank orientations, to calculate the ankle angle on 1) a 2-DOF prosthetic ankle, 2) a human ankle <a ref-type=\"bibr\" anchor=\"ref28\" id=\"context_ref_28_1\">[28]</a>. Similarly, Qiu et al. estimated HS and TO using wavelet analysis based on angular data of the thigh and shank IMUs <a ref-type=\"bibr\" anchor=\"ref29\" id=\"context_ref_29_1\">[29]</a>.</p><p>So far, available algorithms have depended on estimating the gait phase in a proctored indoor lab environment. One advantage of lab settings is that they provide tools to estimate ground truths reliably. However, gait analysis in an indoor lab environment considers multiple assumptions and does not consider all the variability in natural gait that typically occurs outdoors. Wearable devices with IMUs or combined with other sensors have been implemented on more realistic test conditions. Aminian et al. presented an algorithm for detecting gait events and identifying terrain types based on IMUs and electromyographs (EMGs) on the thigh and shank <a ref-type=\"bibr\" anchor=\"ref30\" id=\"context_ref_30_1\">[30]</a>. Pham et al. used an IMU wearable device on the waist to estimate the stride length of an outdoor walk on a square trajectory <a ref-type=\"bibr\" anchor=\"ref31\" id=\"context_ref_31_1\">[31]</a>. Wearable technology can be used to study numerous activities of daily living not limited to walking; however, PCA is still an effective parameter reduction technique when using machine learning or deep learning models <a ref-type=\"bibr\" anchor=\"ref32\" id=\"context_ref_32_1\">[32]</a>. Other previous efforts to label outdoor gait events used threshold values to detect HS and TO <a ref-type=\"bibr\" anchor=\"ref16\" id=\"context_ref_16_1\">[16]</a>, <a ref-type=\"bibr\" anchor=\"ref18\" id=\"context_ref_18_1\">[18]</a>, <a ref-type=\"bibr\" anchor=\"ref19\" id=\"context_ref_19_1\">[19]</a>. Alternatively, a smart shoe insole with force sensors is used to identify the stance phase <a ref-type=\"bibr\" anchor=\"ref21\" id=\"context_ref_21_1\">[21]</a>, <a ref-type=\"bibr\" anchor=\"ref33\" id=\"context_ref_33_1\">[33]</a>. However, threshold labeling isn\u2019t robust to changes in gait cycles and can lead to false labels based on noisy IMU readings. In addition, smart insoles can impede human subjects\u2019 natural gait and be sensitive to sweat, causing difficulties in the experimental protocol.</p><p>This paper proposes a novel approach to labeling outdoor kinematic data (HS and TO) based on ground-truth-developed patterns of foot IMU data. Generated patterns are driven in an indoor lab environment using a force plate. A gait-based PCA model is developed per subject to reduce feature selection and prevent overfitting and match computational power. The model estimates each subject\u2019s gait phase of an outdoor walking session. Furthermore, the models trained on three subjects were tested on a fourth subject.</p><p>The rest of this paper is organized as follows. <a ref-type=\"sec\" anchor=\"sec2\" class=\"fulltext-link\">Section II</a> describes the 2-IMU setup on the human subject and the experimental protocol. The experimental protocol includes IMU calibrations, an indoor 8-minute walk, and a 40-minute outdoor walk. Next, <a ref-type=\"sec\" anchor=\"sec3\" class=\"fulltext-link\">section III</a> presents the results of using the generated models to estimate the gait phase and further implications of developed methodologies. <a ref-type=\"sec\" anchor=\"sec6\" class=\"fulltext-link\">Section VI</a> concludes the paper. Finally, <a ref-type=\"sec\" anchor=\"sec5\" class=\"fulltext-link\">Section V</a> provides relevant details, videos, and data required to implement the proposed work. All the recorded human subjects\u2019 data is available as open-source data sets that can be used to replicate methodology or other gait analysis methods.</p></div>\n<div class=\"section\" id=\"sec2\"><div class=\"header article-hdr\"><div class=\"kicker\">\n\t\t                        SECTION II.</div><h2>Methodology</h2></div><div class=\"section_2\" id=\"sec2a\"><h3>A. 2- IMU Set Up</h3><p>Two IMUs (Precision NXP 9-DOF, Adafruit, USA) are secured to the shank and foot of human subjects, as shown in <a ref-type=\"fig\" anchor=\"fig1\" class=\"fulltext-link\">Fig. 1</a>. The IMUs are attached to the subject using athletic and skin-safe double-sided tape. Furthermore, wires are twisted together and protected using wire sleeves to limit interference with the subject\u2019s natural gait. The IMUs are connected to a microcontroller unit (MCU, Teensy 4.1, PJRC, USA) with a built-in SD card placed in a fanny pack around the subject\u2019s waist. MCU is powered using a small 3.7V LiPo battery. <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$IMU_{1}$\n</tex-math></inline-formula> is connected to the subject\u2019s foot, <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$IMU_{2}$\n</tex-math></inline-formula> is attached to the subject\u2019s shank. The MCU stores data packets of raw angular velocities <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$(\\omega _{\\mathrm {t}}^{\\mathrm {IMU}_{1,2}})$\n</tex-math></inline-formula> and linear accelerations <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$(\\mathrm {a}_{\\mathrm {t}}^{\\mathrm {IMU}_{1,2}})$\n</tex-math></inline-formula>. The IMUs signals are sampled at 400 Hz. Teensy 4.1 was selected since 1) it comes with a built-in SD Card reader that can write (Arduino SDFat library) to a text file at a high rate (400 Hz), and 2) it can be powered using a small 3.7 V battery. The placement of IMU on the human shank was placed midway between the knee and ankle joints and away from a dominant muscle group (tibialis anterior) to reduce the vibration effect. Foot IMU was centered around the subject\u2019s laces. The exact placement of the shank and foot IMU isn\u2019t critical, as raw IMU readings are corrected using calibration with a motion capture system that accurately defines a shank and foot frame.\n<div class=\"figure figure-full\" id=\"fig1\"><!--\n          Workaround for combined images.Eg.- 1000116 Fig. 5\n        --><div class=\"img-wrap\"><a href=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973316/solim1abc-3227344-large.gif\" data-fig-id=\"fig1\"><img src=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973316/solim1abc-3227344-small.gif\" alt=\"FIGURE 1. - 2-IMU setup for human subject gait analysis during (a) OMC IMUs calibration (b) outdoor walk. (c) The walkway was used for experimental protocols 1 and 2.\"/><div class=\"zoom\" title=\"View Larger Image\"/></a></div><div class=\"figcaption\"><b class=\"title\">FIGURE 1. </b><fig><p>2-IMU setup for human subject gait analysis during (a) OMC IMUs calibration (b) outdoor walk. (c) The walkway was used for experimental protocols 1 and 2.</p></fig></div><p class=\"links\"><a href=\"/document/9973316/all-figures\" class=\"all\">Show All</a></p></div></p></div><div class=\"section_2\" id=\"sec2b\"><h3>B. Experimental Protocol</h3><p>The experimental protocol aimed to quantify the gait phase estimation accuracy of human subjects during natural gait in an outdoor environment. To this end, four unimpaired participants (22.5 \u00b1 1.5 years old, 1.71 \u00b1 0.06 m, 77.5 \u00b1 14.81 kg) were enrolled in this study (<a ref-type=\"table\" anchor=\"table1\" class=\"fulltext-link\">Table 1</a>), giving written content to participate in the experiment, as approved by the Institutional Review Board (application number 1902021698).<div class=\"figure figure-full table\" id=\"table1\"><div class=\"figcaption\"><b class=\"title\">TABLE 1 </b>\nBiometrics of human subjects.</div><div class=\"img-wrap\"><a href=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973316/solim.t1-3227344-large.gif\"><img src=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973316/solim.t1-3227344-small.gif\" alt=\"Table 1- &#10;Biometrics of human subjects.\"/><div class=\"zoom\" title=\"View Larger Image\"/></a></div></div></p><p>Three experiments were designed with the purpose of 1) calibrating IMUs to correct raw IMU readings, 2) identifying gait patterns through an Indoor walk in a lab environment, and 3) training and testing gait phase estimation models through an outdoor walk. All human subjects participated in all three experiments. Based on the statistical power analysis, 1068 steps are needed for a 95% confidence interval estimation, with a margin of error of \u00b13%. Each subject had at least 1100 steps (20 minutes of walking time) on the studied foot to validate the model and computed error.</p><div class=\"section_2\" id=\"sec2b1\"><h4>1) IMU Calibration</h4><p>The two IMUs are calibrated to account for 1) the coordinate frame rotation between the IMU frames (IMU<sub>1</sub> and IMU<sub>2</sub>) and the body frames (foot and shank), 2) scaling errors, and 3) axis misalignment errors of the IMUs <a ref-type=\"bibr\" anchor=\"ref34\" id=\"context_ref_34_2b1\">[34]</a>. Calibration parameters are used to transform raw IMU measurements <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$(\\omega _{\\mathrm {t}}^{\\mathrm {IMU}_{1,2}}, \\mathrm {a}_{\\mathrm {t}}^{\\mathrm {IMU}_{1,2}})$\n</tex-math></inline-formula> to foot <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$(\\omega _{\\mathrm {t}}^{\\mathrm {F}}, \\mathrm {a}_{\\mathrm {t}}^{\\mathrm {F}})$\n</tex-math></inline-formula> and shank <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$(\\omega _{\\mathrm {t}}^{\\mathrm {S}}, \\mathrm {a}_{\\mathrm {t}}^{\\mathrm {S}})$\n</tex-math></inline-formula> gyroscope and accelerometer measurements as shown in <a ref-type=\"disp-formula\" anchor=\"deqn1-deqn4\" href=\"#deqn1-deqn4\" class=\"fulltext-link\">equations 1-4</a>.</p><p>Ten optical marker cameras (OMC) (Miqus M5, Qualisys, Sweden) calibrate the IMUs using an extrinsic calibration scheme <a ref-type=\"bibr\" anchor=\"ref28\" id=\"context_ref_28_2b1\">[28]</a>. Moreover, eight optical markers are placed on the subjects\u2019 feet and shank (four each) to define the shank and foot frames. The IMUs are calibrated by exciting the gyroscope and the accelerometer axes in two steps: 1) the human subject raises the foot off the ground and moves their foot and shank linearly in all axes of motion (x, y, z) to excite the IMUs\u2019 accelerometers, then 2) with the foot still in the air, subject rotates foot and shank about all axes of rotation to excite the IMUs\u2019 gyroscopes. Each of the IMUs\u2019 axes is excited for 15 seconds in each calibration step. The OMC records the shank\u2019s and foot\u2019s orientations, translations, and body rates. Synchronized measurements from IMUs\u2019 (<inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\omega _{\\mathrm {t}}^{{\\mathrm {IMU}}_{\\mathrm {1,2}}}, \\mathrm {a}_{\\mathrm {t}}^{{\\mathrm {IMU}}_{\\mathrm {1,2}}}$\n</tex-math></inline-formula>) are fitted against OMC measurements based on continuous-time batch estimation to provide the transformation matrices <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$(T_{Sw}, T_{Sa},T_{Fw},T_{Fa})$\n</tex-math></inline-formula> between IMU frames and OMC shank and foot frames <a ref-type=\"bibr\" anchor=\"ref35\" id=\"context_ref_35_2b1\">[35]</a>. The bias parameters <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\left ({\\overline {{\\text {b}}_{\\omega _{}^{{\\text {IMU}}_{1,2}}}},\\overline {{\\text {b}}_{\\text {a}_{}^{{\\text {IMU}}_{1,2}}}} }\\right)\\vphantom {{\\left ({\\overline {{\\text {b}}_{\\omega _{}^{{\\text {IMU}}_{1,2}}}},\\overline {{\\text {b}}_{\\text {a}_{}^{{\\text {IMU}}_{1,2}}}} }\\right)}_{j}}$\n</tex-math></inline-formula> of the IMUs are estimated using Allan Variance analysis <a ref-type=\"bibr\" anchor=\"ref36\" id=\"context_ref_36_2b1\">[36]</a>.<disp-formula id=\"deqn1-deqn4\" class=\"display-formula\"><tex-math notation=\"LaTeX\">\\begin{align*} \\boldsymbol {\\omega }_{\\mathrm {t}}^{\\mathrm {F}}=&amp;\\mathrm {T}_{\\mathrm {Fw}}\\boldsymbol {\\omega }_{\\mathrm {t}}^{{\\mathrm {IMU}}_{1}}-\\overline {\\mathrm {b}_{\\omega _{}^{{\\mathrm {IMU}}_{1}}}}\\tag{1}\\\\ \\mathrm {a}_{\\mathrm {t}}^{\\mathrm {F}}=&amp;\\mathrm {T}_{\\mathrm {Fa}}\\boldsymbol {\\omega }_{\\mathrm {t}}^{{\\mathrm {IMU}}_{1}}-\\overline {\\mathrm {b}_{a_{}^{{\\mathrm {IMU}}_{1}}}}\\tag{2}\\\\ \\boldsymbol {\\omega }_{\\mathrm {t}}^{\\mathrm {S}}=&amp;\\mathrm {T}_{\\mathrm {Sw}}\\boldsymbol {\\omega }_{\\mathrm {t}}^{{\\mathrm {IMU}}_{2}}-\\overline {\\mathrm {b}_{\\omega _{}^{{\\mathrm {IMU}}_{2}}}}\\tag{3}\\\\ \\mathrm {a}_{\\mathrm {t}}^{\\mathrm {S}}=&amp;\\mathrm {T}_{\\mathrm {Sa}}\\boldsymbol {\\omega }_{\\mathrm {t}}^{{\\mathrm {IMU}}_{2}}-\\overline {\\mathrm {b}_{a_{}^{{\\mathrm {IMU}}_{2}}}}\\tag{4}\\end{align*}\n</tex-math><span class=\"formula\"><span class=\"link\">View Source</span><img aria-describedby=\"qtip-0\" style=\"display:inline;\" title=\"Right-click on figure or equation for MathML and additional features.\" data-hasqtip=\"0\" class=\"qtooltip moreInfo\" alt=\"Right-click on figure for MathML and additional features.\" src=\"/assets/img/icon.support.gif\" border=\"0\" height=\"20\" width=\"24\"/><span class=\"tex tex2jax_ignore\" style=\"display:none;\">\\begin{align*} \\boldsymbol {\\omega }_{\\mathrm {t}}^{\\mathrm {F}}=&amp;\\mathrm {T}_{\\mathrm {Fw}}\\boldsymbol {\\omega }_{\\mathrm {t}}^{{\\mathrm {IMU}}_{1}}-\\overline {\\mathrm {b}_{\\omega _{}^{{\\mathrm {IMU}}_{1}}}}\\tag{1}\\\\ \\mathrm {a}_{\\mathrm {t}}^{\\mathrm {F}}=&amp;\\mathrm {T}_{\\mathrm {Fa}}\\boldsymbol {\\omega }_{\\mathrm {t}}^{{\\mathrm {IMU}}_{1}}-\\overline {\\mathrm {b}_{a_{}^{{\\mathrm {IMU}}_{1}}}}\\tag{2}\\\\ \\boldsymbol {\\omega }_{\\mathrm {t}}^{\\mathrm {S}}=&amp;\\mathrm {T}_{\\mathrm {Sw}}\\boldsymbol {\\omega }_{\\mathrm {t}}^{{\\mathrm {IMU}}_{2}}-\\overline {\\mathrm {b}_{\\omega _{}^{{\\mathrm {IMU}}_{2}}}}\\tag{3}\\\\ \\mathrm {a}_{\\mathrm {t}}^{\\mathrm {S}}=&amp;\\mathrm {T}_{\\mathrm {Sa}}\\boldsymbol {\\omega }_{\\mathrm {t}}^{{\\mathrm {IMU}}_{2}}-\\overline {\\mathrm {b}_{a_{}^{{\\mathrm {IMU}}_{2}}}}\\tag{4}\\end{align*}\n</span></span></disp-formula> where <inline-formula id=\"\"><tex-math notation=\"LaTeX\">${\\mathrm {T}}_{\\mathrm {Fw}}$\n</tex-math></inline-formula>, <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\mathrm {T}_{\\mathrm {Fa}}$\n</tex-math></inline-formula>, <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\mathrm {T}_{\\mathrm {Sw}}$\n</tex-math></inline-formula>, <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\mathrm {T}_{\\mathrm {Sa}}\\,\\,\\mathbb {R}^{3\\times 3}$\n</tex-math></inline-formula>, <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\mathrm {a}_{\\mathrm {t}}^{{\\mathrm {IMU}}_{\\mathrm {1,2}}}$\n</tex-math></inline-formula>, <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\overline {{\\mathrm {b}}_{\\mathrm {a}_{}^{{\\mathrm {IMU}}_{1,2}}}}$\n</tex-math></inline-formula>, <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\boldsymbol {\\omega }_{\\mathrm {t}}^{{\\mathrm {IMU}}_{\\mathrm {1,2}}}$\n</tex-math></inline-formula>, <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\overline {{\\mathrm {b}}_{\\omega _{}^{{\\mathrm {IMU}}_{1,2}}}}$\n</tex-math></inline-formula>, <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\boldsymbol {\\omega }_{\\mathrm {t}}^{\\mathrm {F}}$\n</tex-math></inline-formula>, <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\mathrm {a}_{\\mathrm {t}}^{\\mathrm {F}}$\n</tex-math></inline-formula>, <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\boldsymbol {\\omega }_{\\mathrm {t}}^{\\mathrm {S}}$\n</tex-math></inline-formula>, <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\mathrm {a}_{\\mathrm {t}}^{\\mathrm {S}}\\in \\mathbb {R}^{3}$\n</tex-math></inline-formula></p></div><div class=\"section_2\" id=\"sec2b2\"><h4>2) Gait Pattern Generation</h4><p>A gait pattern representative of each subject\u2019s gait is produced using an indoor walk. The pattern focuses on relating how the foot IMU <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$(\\omega _{\\mathrm {t}}^{\\mathrm {F}},{\\mathrm {a}}_{\\mathrm {t}}^{\\mathrm {F}})$\n</tex-math></inline-formula> behaves during heel strike (HS) and toe-off (TO). A walkway equipped with a</p><p>force plate sensor (9260AA3, Kistler, Switzerland) is utilized to accurately detect and label HSs and TOs during the human subject\u2019s gait. The force plate measures force <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$(\\mathrm {F}_{\\mathrm {N}})$\n</tex-math></inline-formula> on the 3-axis of motion. Subjects wearing the 2-IMU setup walked repetitively on the walkway, ensuring they stepped on the force plate in each run (<a ref-type=\"fig\" anchor=\"fig1\" class=\"fulltext-link\">Fig 1.c</a>). Subjects walked for eight minutes, during which they performed straight and turning gait cycles, replicating their natural gait as much as possible. Heel strike is identified whenever the vertical force measurement on the force plate exceeds a threshold (2 N), and Toe-off is identified whenever the vertical force drops again below the threshold. The threshold is set based on empirically examining the data to find the instant of time the heel contacts the force plate.</p><p>An average gait length was assumed to be 1 second <a ref-type=\"bibr\" anchor=\"ref37\" id=\"context_ref_37_2b2\">[37]</a>, and it takes 4 steps to go from one side of the walkway (embedded with the force plate) to the other, meaning subjects averaged approximately 125 steps on the force plate <a ref-type=\"bibr\" anchor=\"ref38\" id=\"context_ref_38_2b2\">[38]</a>. Taking more steps (longer time) would increase the strength of the gait pattern however can fatigue the subjects. HSs and TOs identified using the force plate are used to label (HS and TO) adjacent foot IMU <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$(\\omega _{\\mathrm {t}}^{\\mathrm {F}},{\\mathrm {a}}_{\\mathrm {t}}^{\\mathrm {F}})$\n</tex-math></inline-formula> measurements as shown in <a ref-type=\"fig\" anchor=\"fig2\" class=\"fulltext-link\">Fig. 2</a>. HS and TO patterns are saved for all steps on the force plate. Note that the gait pattern included HS or TO gait event, occurring at time zero and half a second before and after the gait event, respectively. The half a second before and after each gait event are selected to collect data from approximately half a gait cycle (assuming an average gait cycle of approximately 1 second <a ref-type=\"bibr\" anchor=\"ref37\" id=\"context_ref_37_2b2\">[37]</a>).\n<div class=\"figure figure-full\" id=\"fig2\"><!--\n          Workaround for combined images.Eg.- 1000116 Fig. 5\n        --><div class=\"img-wrap\"><a href=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973316/solim2abcd-3227344-large.gif\" data-fig-id=\"fig2\"><img src=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973316/solim2abcd-3227344-small.gif\" alt=\"FIGURE 2. - Labelled HS and TO events of indoor gait walk of a representative subject (D), using a force plate. (a) shows complete indoor gait data (b) shows a time segment to highlight the force plate labeling.\"/><div class=\"zoom\" title=\"View Larger Image\"/></a></div><div class=\"figcaption\"><b class=\"title\">FIGURE 2. </b><fig><p>Labelled HS and TO events of indoor gait walk of a representative subject (D), using a force plate. (a) shows complete indoor gait data (b) shows a time segment to highlight the force plate labeling.</p></fig></div><p class=\"links\"><a href=\"/document/9973316/all-figures\" class=\"all\">Show All</a></p></div></p><p>The mean of the generated patterns of the human subjects are shown in <a ref-type=\"fig\" anchor=\"fig3\" class=\"fulltext-link\">Fig 3</a>; the standard deviation is also shown, representing the variance of <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\omega _{\\mathrm {t}}^{\\mathrm {F}},{\\mathrm {a}}_{\\mathrm {t}}^{\\mathrm {F}}$\n</tex-math></inline-formula> during different gait phases performed in the eight-minute indoor walk. Increased variance is encouraged as it shows that the human subject replicated the various step trajectories in their natural gait.\n<div class=\"figure figure-full\" id=\"fig3\"><!--\n          Workaround for combined images.Eg.- 1000116 Fig. 5\n        --><div class=\"img-wrap\"><a href=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973316/solim3-3227344-large.gif\" data-fig-id=\"fig3\"><img src=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973316/solim3-3227344-small.gif\" alt=\"FIGURE 3. - HS and TO patterns of 4 human subjects. Subject D had the highest variability in the original gait phase pattern, meaning that the subject\u2019s pattern included a wide variety of all the steps the subject takes in their natural gait.\"/><div class=\"zoom\" title=\"View Larger Image\"/></a></div><div class=\"figcaption\"><b class=\"title\">FIGURE 3. </b><fig><p>HS and TO patterns of 4 human subjects. Subject D had the highest variability in the original gait phase pattern, meaning that the subject\u2019s pattern included a wide variety of all the steps the subject takes in their natural gait.</p></fig></div><p class=\"links\"><a href=\"/document/9973316/all-figures\" class=\"all\">Show All</a></p></div></p></div><div class=\"section_2\" id=\"sec2b3\"><h4>3) Outdoor Walk</h4><p>Upon completing the indoor walk, subjects walked outdoors while wearing the 2-IMU setup (<a ref-type=\"fig\" anchor=\"fig1\" class=\"fulltext-link\">Fig. 1.b</a>). Subjects were instructed to walk for forty minutes in any direction, stopping whenever needed. <a ref-type=\"fig\" anchor=\"fig4\" class=\"fulltext-link\">Fig 4</a>. shows the shank and foot IMU measurements during the outdoor walking trial of one of the subjects.\n<div class=\"figure figure-full\" id=\"fig4\"><!--\n          Workaround for combined images.Eg.- 1000116 Fig. 5\n        --><div class=\"img-wrap\"><a href=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973316/solim4-3227344-large.gif\" data-fig-id=\"fig4\"><img src=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973316/solim4-3227344-small.gif\" alt=\"FIGURE 4. - Segment of Shank and Foot IMU measurements during the outdoor walking trial of subject D.\"/><div class=\"zoom\" title=\"View Larger Image\"/></a></div><div class=\"figcaption\"><b class=\"title\">FIGURE 4. </b><fig><p>Segment of Shank and Foot IMU measurements during the outdoor walking trial of subject D.</p></fig></div><p class=\"links\"><a href=\"/document/9973316/all-figures\" class=\"all\">Show All</a></p></div></p></div></div><div class=\"section_2\" id=\"sec2c\"><h3>C. Gait Model</h3><p>A gait model of each subject is used to predict their current gait phase. Note that the aim is to predict the gait phase using measurements from the shank IMU <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$(\\omega _{\\mathrm {t}}^{\\mathrm {S}}$\n</tex-math></inline-formula>, <inline-formula id=\"\"><tex-math notation=\"LaTeX\">${\\mathrm {a}}_{\\mathrm {t}}^{\\mathrm {S}}$\n</tex-math></inline-formula>). On the other hand, the foot IMU <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$(\\omega _{\\mathrm {t}}^{\\mathrm {F}}$\n</tex-math></inline-formula>, <inline-formula id=\"\"><tex-math notation=\"LaTeX\">${\\mathrm {a}}_{\\mathrm {t}}^{\\mathrm {F}}$\n</tex-math></inline-formula>) is only used to label HS and TO on data sets to find the gait phase of an outdoor walk.</p><div class=\"section_2\" id=\"sec2c1\"><h4>1) LABELING Outdoor Data Sets</h4><p>To produce and train the gait model, previously generated gait patterns are used to identify the HSs and TOs of the outdoor walk on the foot IMU. HS and TO are labeled based on cross-correlation (under MATLAB\u2019s xcorr2 function) between generated HS and TO patterns (<a ref-type=\"fig\" anchor=\"fig3\" class=\"fulltext-link\">Fig. 3</a>) and measured foot IMU data <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$(\\omega _{\\mathrm {t}}^{\\mathrm {F}}$\n</tex-math></inline-formula>, <inline-formula id=\"\"><tex-math notation=\"LaTeX\">${\\mathrm {a}}_{\\mathrm {t}}^{\\mathrm {F}}$\n</tex-math></inline-formula>), as shown in <a ref-type=\"fig\" anchor=\"fig5\" class=\"fulltext-link\">Fig. 5</a>. To distinctively label HS and TO, the IMU data points that have the highest correlation to the pattern (peak) were selected. Note that HS and TO data points are labeled to ensure that peak points are at least 0.8 seconds apart (assuming 0.8 seconds is the minimum gait length <a ref-type=\"bibr\" anchor=\"ref36\" id=\"context_ref_36_2c1\">[36]</a>). Peak magnitude is at least in the 75th percentile of correlation between pattern and outdoor walk data point (under MATLAB\u2019s findpeaks function).\n<div class=\"figure figure-full\" id=\"fig5\"><!--\n          Workaround for combined images.Eg.- 1000116 Fig. 5\n        --><div class=\"img-wrap\"><a href=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973316/solim5-3227344-large.gif\" data-fig-id=\"fig5\"><img src=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973316/solim5-3227344-small.gif\" alt=\"FIGURE 5. - Labelling outdoor gait (subject D) with HS and TO events based on previously generated gait patterns. Correlation peaks represent HS and TO gait events.\"/><div class=\"zoom\" title=\"View Larger Image\"/></a></div><div class=\"figcaption\"><b class=\"title\">FIGURE 5. </b><fig><p>Labelling outdoor gait (subject D) with HS and TO events based on previously generated gait patterns. Correlation peaks represent HS and TO gait events.</p></fig></div><p class=\"links\"><a href=\"/document/9973316/all-figures\" class=\"all\">Show All</a></p></div></p><p>The labeled data set (<a ref-type=\"fig\" anchor=\"fig5\" class=\"fulltext-link\">Fig.5</a>) is used to find the outdoor walk gait phase <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\mathrm {(\\theta)}$\n</tex-math></inline-formula>. Linear interpolation between two adjacent heel strike points defines the gait phase. <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\boldsymbol {\\theta }$\n</tex-math></inline-formula> equals 0 to represent the 1st heel strike and <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\mathrm {2\\pi }$\n</tex-math></inline-formula> as the next heel strike (end of the gait cycle). Furthermore, <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\boldsymbol {\\theta }$\n</tex-math></inline-formula> is split into two phasors <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$(\\gamma)$\n</tex-math></inline-formula> as shown in <a ref-type=\"disp-formula\" anchor=\"deqn5\" href=\"#deqn5\" class=\"fulltext-link\">equation 5</a> and <a ref-type=\"fig\" anchor=\"fig6\" class=\"fulltext-link\">Fig 6.a</a>.<disp-formula id=\"deqn5\" class=\"display-formula\"><tex-math notation=\"LaTeX\">\\begin{equation*} \\gamma =[\\sin \\left ({\\theta }\\right) \\quad \\cos {\\left ({\\theta }\\right)}]\\tag{5}\\end{equation*}\n</tex-math><span class=\"formula\"><span class=\"link\">View Source</span><img aria-describedby=\"qtip-0\" style=\"display:inline;\" title=\"Right-click on figure or equation for MathML and additional features.\" data-hasqtip=\"0\" class=\"qtooltip moreInfo\" alt=\"Right-click on figure for MathML and additional features.\" src=\"/assets/img/icon.support.gif\" border=\"0\" height=\"20\" width=\"24\"/><span class=\"tex tex2jax_ignore\" style=\"display:none;\">\\begin{equation*} \\gamma =[\\sin \\left ({\\theta }\\right) \\quad \\cos {\\left ({\\theta }\\right)}]\\tag{5}\\end{equation*}\n</span></span></disp-formula> where <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\gamma \\in \\mathbb {R}^{2}$\n</tex-math></inline-formula>.</p></div><div class=\"section_2\" id=\"sec2c2\"><h4>2) Training Model Using PCA and Linear Regression</h4><p>Twenty minutes of the subject\u2019s outdoor data is used to create a regression fit model of the gait phase phasors <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$(\\gamma)$\n</tex-math></inline-formula>. The independent variables (<inline-formula id=\"\"><tex-math notation=\"LaTeX\">$X$\n</tex-math></inline-formula>) are the Z-score <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$(Z)$\n</tex-math></inline-formula> of shank IMU accelerations and angular velocities <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$(\\omega _{\\mathrm {t}}^{\\mathrm {S}},{\\mathrm {a}}_{\\mathrm {t}}^{\\mathrm {S}})$\n</tex-math></inline-formula> from one second before heel strike (400 samples) as shown in <a ref-type=\"fig\" anchor=\"fig6\" class=\"fulltext-link\">Fig. 6.b, c</a> and <a ref-type=\"disp-formula\" anchor=\"deqn6\" href=\"#deqn6\" class=\"fulltext-link\">equation 6</a>.<disp-formula id=\"deqn6\" class=\"display-formula\"><tex-math notation=\"LaTeX\">\\begin{align*} X= Z\\left({\\left[{\\begin{array}{cc} {\\mathrm {a}}_{\\mathrm {t}}^{\\mathrm {S}} &amp;\\quad \\omega _{\\mathrm {t}}^{\\mathrm {S}}\\\\ \\end{array}}\\right]}\\right)\\tag{6}\\end{align*}\n</tex-math><span class=\"formula\"><span class=\"link\">View Source</span><img aria-describedby=\"qtip-0\" style=\"display:inline;\" title=\"Right-click on figure or equation for MathML and additional features.\" data-hasqtip=\"0\" class=\"qtooltip moreInfo\" alt=\"Right-click on figure for MathML and additional features.\" src=\"/assets/img/icon.support.gif\" border=\"0\" height=\"20\" width=\"24\"/><span class=\"tex tex2jax_ignore\" style=\"display:none;\">\\begin{align*} X= Z\\left({\\left[{\\begin{array}{cc} {\\mathrm {a}}_{\\mathrm {t}}^{\\mathrm {S}} &amp;\\quad \\omega _{\\mathrm {t}}^{\\mathrm {S}}\\\\ \\end{array}}\\right]}\\right)\\tag{6}\\end{align*}\n</span></span></disp-formula> where <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$X\\in \\mathbb {R}^{n\\times 6}$\n</tex-math></inline-formula>, n <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$=$\n</tex-math></inline-formula> number of data points.\n<div class=\"figure figure-full\" id=\"fig6\"><!--\n          Workaround for combined images.Eg.- 1000116 Fig. 5\n        --><div class=\"img-wrap\"><a href=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973316/solim6abc-3227344-large.gif\" data-fig-id=\"fig6\"><img src=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973316/solim6abc-3227344-small.gif\" alt=\"FIGURE 6. - Subject D\u2019s (a) gait phasors represented by &#10;$\\gamma $&#10;, (b, c) linear regression model predictor variables &#10;${(\\omega }_{t}^{S},{a}_{t}^{S})$&#10;.\"/><div class=\"zoom\" title=\"View Larger Image\"/></a></div><div class=\"figcaption\"><b class=\"title\">FIGURE 6. </b><fig><p>Subject D\u2019s (a) gait phasors represented by <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\gamma $\n</tex-math></inline-formula>, (b, c) linear regression model predictor variables <inline-formula id=\"\"><tex-math notation=\"LaTeX\">${(\\omega }_{t}^{S},{a}_{t}^{S})$\n</tex-math></inline-formula>.</p></fig></div><p class=\"links\"><a href=\"/document/9973316/all-figures\" class=\"all\">Show All</a></p></div></p><p>PCA is used to select the principal components of <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$X$\n</tex-math></inline-formula>; principal components remove noise by reducing many features to a smaller set of principal components. PCA is used because it compresses large amounts of information that speeds up the real-time implementation of models and prevents the overfitting of predictive algorithms <a ref-type=\"bibr\" anchor=\"ref39\" id=\"context_ref_39_2c2\">[39]</a>. PCA is used since it maximizes the variance of data, meaning we can reduce the number of features in the model while having a varied representation of the subject\u2019s gait cycle. Note since IMUs are sampled at 400 Hz, to avoid repetitive data samples, <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$X$\n</tex-math></inline-formula> is down-sampled to 10 Hz. 100 PCA coefficients (PC) are used to select principal features. Down-sampling to 10 Hz and selecting 100 PCA coefficients were empirically tuned under the constraints of the computer\u2019s processing power. 100 PCA coefficients are selected to reduce feature size to meet the constraints of the processing power computer. A high number of PCA coefficients increases the chance of overfitting; reducing the number of coefficients can eliminate important gait features. 100 PCA coefficients were selected experimentally by examining pre and post-PCA feature reduction figures. Down sampled features, <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\text {X}_{\\text {d}}$\n</tex-math></inline-formula> are used to fit the model <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$(\\beta)$\n</tex-math></inline-formula> as shown in <a ref-type=\"disp-formula\" anchor=\"deqn7-deqn9\" href=\"#deqn7-deqn9\" class=\"fulltext-link\">equations 7-9</a>.<disp-formula id=\"deqn7-deqn9\" class=\"display-formula\"><tex-math notation=\"LaTeX\">\\begin{align*} \\mathrm {X}_{\\mathrm {d}}=&amp;\\left ({X-\\overline {X} }\\right)PC\\tag{7}\\\\[-1pt] \\beta=&amp;\\frac {\\gamma }{X_{d}}\\tag{8}\\\\[-1pt] \\hat {\\gamma }=&amp;\\mathrm {X}_{\\mathrm {d}}\\beta\\tag{9}\\end{align*}\n</tex-math><span class=\"formula\"><span class=\"link\">View Source</span><img aria-describedby=\"qtip-0\" style=\"display:inline;\" title=\"Right-click on figure or equation for MathML and additional features.\" data-hasqtip=\"0\" class=\"qtooltip moreInfo\" alt=\"Right-click on figure for MathML and additional features.\" src=\"/assets/img/icon.support.gif\" border=\"0\" height=\"20\" width=\"24\"/><span class=\"tex tex2jax_ignore\" style=\"display:none;\">\\begin{align*} \\mathrm {X}_{\\mathrm {d}}=&amp;\\left ({X-\\overline {X} }\\right)PC\\tag{7}\\\\[-1pt] \\beta=&amp;\\frac {\\gamma }{X_{d}}\\tag{8}\\\\[-1pt] \\hat {\\gamma }=&amp;\\mathrm {X}_{\\mathrm {d}}\\beta\\tag{9}\\end{align*}\n</span></span></disp-formula> where <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\mathrm {X}_{\\mathrm {d}}\\in \\mathbb {R}^{n\\times 6}$\n</tex-math></inline-formula>, <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\text {PC} \\in \\mathbb {R}^{6\\times 100}$\n</tex-math></inline-formula>.</p><p>The gait phase error <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$(\\mathrm {e}_{\\gamma })$\n</tex-math></inline-formula> of the model <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$(\\beta)$\n</tex-math></inline-formula> is calculated using equation 10 (shown for a representative subject in <a ref-type=\"fig\" anchor=\"fig7\" class=\"fulltext-link\">Fig 7.a</a>). <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\beta $\n</tex-math></inline-formula> is then used to predict the gait phase of the remaining twenty minutes of the outdoor walk, representing the validation data set. The gait phase error (<inline-formula id=\"\"><tex-math notation=\"LaTeX\">$e_{\\gamma }$\n</tex-math></inline-formula>) for the validation data set of subject D is shown in <a ref-type=\"fig\" anchor=\"fig7\" class=\"fulltext-link\">Fig 7.b</a>.<disp-formula id=\"deqn10\" class=\"display-formula\"><tex-math notation=\"LaTeX\">\\begin{equation*} e_{\\gamma }=\\frac {\\text {acos}\\left ({\\sum \\nolimits _{j= 1}^{2} {\\gamma \\left ({:,j }\\right)} \\hat {\\gamma }\\left ({:,j }\\right) }\\right)}{2\\pi }\\tag{10}\\end{equation*}\n</tex-math><span class=\"formula\"><span class=\"link\">View Source</span><img aria-describedby=\"qtip-0\" style=\"display:inline;\" title=\"Right-click on figure or equation for MathML and additional features.\" data-hasqtip=\"0\" class=\"qtooltip moreInfo\" alt=\"Right-click on figure for MathML and additional features.\" src=\"/assets/img/icon.support.gif\" border=\"0\" height=\"20\" width=\"24\"/><span class=\"tex tex2jax_ignore\" style=\"display:none;\">\\begin{equation*} e_{\\gamma }=\\frac {\\text {acos}\\left ({\\sum \\nolimits _{j= 1}^{2} {\\gamma \\left ({:,j }\\right)} \\hat {\\gamma }\\left ({:,j }\\right) }\\right)}{2\\pi }\\tag{10}\\end{equation*}\n</span></span></disp-formula>\n<div class=\"figure figure-full\" id=\"fig7\"><!--\n          Workaround for combined images.Eg.- 1000116 Fig. 5\n        --><div class=\"img-wrap\"><a href=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973316/solim7ab-3227344-large.gif\" data-fig-id=\"fig7\"><img src=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973316/solim7ab-3227344-small.gif\" alt=\"FIGURE 7. - Gait phase error for the (a) training dataset (b) validation dataset of subject D represented through a normalized histogram of residuals.\"/><div class=\"zoom\" title=\"View Larger Image\"/></a></div><div class=\"figcaption\"><b class=\"title\">FIGURE 7. </b><fig><p>Gait phase error for the (a) training dataset (b) validation dataset of subject D represented through a normalized histogram of residuals.</p></fig></div><p class=\"links\"><a href=\"/document/9973316/all-figures\" class=\"all\">Show All</a></p></div></p></div></div></div>\n<div class=\"section\" id=\"sec3\"><div class=\"header article-hdr\"><div class=\"kicker\">\n\t\t                        SECTION III.</div><h2>Results</h2></div><div class=\"section_2\" id=\"sec3a\"><h3>A. Gait Phase Estimation</h3><p>The average gait phase estimation error (<inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\overline {e_{\\gamma }}$\n</tex-math></inline-formula>) for the validation data sets of the human subjects is shown in <a ref-type=\"table\" anchor=\"table2\" class=\"fulltext-link\">Table 2</a>. The gait phase estimation error <inline-formula id=\"\"><tex-math notation=\"LaTeX\">${\\mathrm {(e}}_{\\gamma })$\n</tex-math></inline-formula> for each subject\u2019s validation data set was calculated based on a trained model from their gait pattern (<a ref-type=\"fig\" anchor=\"fig3\" class=\"fulltext-link\">Fig 3</a>).<div class=\"figure figure-full table\" id=\"table2\"><div class=\"figcaption\"><b class=\"title\">TABLE 2 </b>\nAverage gait phase estimation error (\n$\\overline{e_{\\gamma}}$\n) of the four human subjects.</div><div class=\"img-wrap\"><a href=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973316/solim.t2-3227344-large.gif\"><img src=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973316/solim.t2-3227344-small.gif\" alt=\"Table 2- &#10;Average gait phase estimation error (&#10;$\\overline{e_{\\gamma}}$&#10;) of the four human subjects.\"/><div class=\"zoom\" title=\"View Larger Image\"/></a></div></div></p><p>Subject D had the highest gait phase estimation accuracy due to the varied gait pattern observed in the subject\u2019s recorded indoor walk. <a ref-type=\"fig\" anchor=\"fig3\" class=\"fulltext-link\">Fig 3.d</a> shows that subject D had the highest standard deviation in HS and TO patterns, meaning the subject tried to replicate all the various steps she typically takes during an outdoor walk. This allows the generation of a fully representative model of the subject\u2019s outdoor walk. Conversely, the lowest tracking accuracy is subject C, the subject with the lowest deviation in their gait pattern (<a ref-type=\"fig\" anchor=\"fig3\" class=\"fulltext-link\">Fig 3.c</a>); meaning their indoor gait wasn\u2019t fully representative of their gait characteristics.</p></div><div class=\"section_2\" id=\"sec3b\"><h3>B. Gait Phase Estimation Without Motion Capture and Force Plate Pattern</h3><p>Due to similarities in HS and TO patterns between humans (based on foot IMU data) <a ref-type=\"bibr\" anchor=\"ref19\" id=\"context_ref_19_3b\">[19]</a>, <a ref-type=\"bibr\" anchor=\"ref21\" id=\"context_ref_21_3b\">[21]</a>, <a ref-type=\"bibr\" anchor=\"ref22\" id=\"context_ref_22_3b\">[22]</a>, large models of gait patterns can be used to estimate the gait phase of a human subject. This is useful for outdoor studies that are performed without a motion capture system and a force place, where it is unable to create a gait pattern for each human subject. <a ref-type=\"table\" anchor=\"table3\" class=\"fulltext-link\">Table 3</a> shows the gait phase estimation error <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$(\\overline {e_{\\gamma }})$\n</tex-math></inline-formula> for the subjects\u2019 outdoor walks when trained with other subjects\u2019 concatenated gait patterns. While the accuracy of gait phase estimation is reduced, it\u2019s still comparable to other gait phase estimation methods <a ref-type=\"bibr\" anchor=\"ref17\" id=\"context_ref_17_3b\">[17]</a>. Increasing the number of concatenated gait patterns decreases the gait phase estimation error of the studied subject, as it\u2019s more likely that one of the concatenated patterns is representative of the studied subject\u2019s gait. To expand on this work, more gait patterns of multiple subjects can be concatenated and used to estimate the gait phase of subjects without a uniquely defined gait pattern. In addition, IMU calibrations can be done without a motion capture system through repetitive static calibration to correct IMU readings <a ref-type=\"bibr\" anchor=\"ref40\" id=\"context_ref_40_3b\">[40]</a>.<div class=\"figure figure-full table\" id=\"table3\"><div class=\"figcaption\"><b class=\"title\">TABLE 3 </b>\nAverage gait phase estimation error (\n$\\overline{e_{\\gamma}}$\n) of the four human subjects trained with varied patterns.</div><div class=\"img-wrap\"><a href=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973316/solim.t3-3227344-large.gif\"><img src=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973316/solim.t3-3227344-small.gif\" alt=\"Table 3- &#10;Average gait phase estimation error (&#10;$\\overline{e_{\\gamma}}$&#10;) of the four human subjects trained with varied patterns.\"/><div class=\"zoom\" title=\"View Larger Image\"/></a></div></div></p></div></div>\n<div class=\"section\" id=\"sec4\"><div class=\"header article-hdr\"><div class=\"kicker\">\n\t\t                        SECTION IV.</div><h2>Discussion</h2></div><p>The presented work was designed to help analyze the gait kinematics of healthy and impaired humans in a natural outdoor environment. The 2-IMU setup, besides the ability to accurately detect distinct gait events, provides a robust algorithm that does not require set subject-independent thresholds and labels outdoor gait events based on statistical correlation to ground truth data. Another advantage of the proposed work is that it offers an experimental setup that does not require special shoes/insoles or excessive sensors that can interfere with the subject\u2019s natural gait.</p><p>The outdoor gait events (HS and TO) are successfully identified based on a ground-truth pattern of each subject. A gait pattern for each subject is accurately defined based on a force plate precisely detecting heel strikes and toe-offs. Outdoor walk data was labeled with HS and TO gait events based on defined patterns. The proposed methodology is advantageous to researchers 1) as it allows them to label gait events harmoniously and with a known correlation to a ground truth measurement without the need for any external validation instrumentation, and 2) as it allows researchers to conduct gait tests outside of a proctored lab space, eliminating any bias related to the lab environment. Another implication of the proposed work is the continuous control of a lower limb prosthesis.</p><div class=\"section_2\" id=\"sec4a\"><h3>A. Prosthesis Implementation</h3><p>The team previously designed a 2-DOF prosthesis <a ref-type=\"bibr\" anchor=\"ref6\" id=\"context_ref_6_4a\">[6]</a> that was operated to detect heel strike upon the impact of the prosthetic ankle with the ground, creating a delay in launching the prosthesis\u2019s controller. This approach generally does not consider the users\u2019 change of speed or varying their gait length. The PCA-Based can be expanded to control the prosthesis by installing a foot and shank, IMU. In future work, the amputee users will wear a 2-DOF prosthesis and walk indoors to generate a gait pattern for their walk. Furthermore, amputee subjects will wear the prosthesis for a long duration to provide training and validation data sets for the linear regression model. This work can be expanded for real-time estimation of the gait phase, allowing control of powered prosthesis to have gait trajectories as a function of a time-varying gait phase.</p><p>In a limited study, an unimpaired operator carries the prosthesis and walks with it, as shown in <a ref-type=\"fig\" anchor=\"fig8\" class=\"fulltext-link\">Fig 8</a>. The operator walks with the prosthesis for 10 minutes; 4 minutes is used to produce a pattern, 3 minutes to train the model., and 3 minutes to test the model (validation dataset).\n<div class=\"figure figure-full\" id=\"fig8\"><!--\n          Workaround for combined images.Eg.- 1000116 Fig. 5\n        --><div class=\"img-wrap\"><a href=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973316/solim8ab-3227344-large.gif\" data-fig-id=\"fig8\"><img src=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973316/solim8ab-3227344-small.gif\" alt=\"FIGURE 8. - (a) IMU setup on 2-DOF prosthesis (b) operator walking with a 2-DOF prosthesis over an instrumented walkway.\"/><div class=\"zoom\" title=\"View Larger Image\"/></a></div><div class=\"figcaption\"><b class=\"title\">FIGURE 8. </b><fig><p>(a) IMU setup on 2-DOF prosthesis (b) operator walking with a 2-DOF prosthesis over an instrumented walkway.</p></fig></div><p class=\"links\"><a href=\"/document/9973316/all-figures\" class=\"all\">Show All</a></p></div></p><p>Longer times weren\u2019t used, as it\u2019s difficult for the operator to carry the prosthesis for an extensive period. The HS and TO patterns of <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\omega _{t}^{F}$\n</tex-math></inline-formula> The gait phase estimation error of the training and validation data sets are shown in <a ref-type=\"fig\" anchor=\"fig9\" class=\"fulltext-link\">Fig. 9</a>. Note that PCA estimation and down-sampling weren\u2019t used for this estimate due to the small data set size.\n<div class=\"figure figure-full\" id=\"fig9\"><!--\n          Workaround for combined images.Eg.- 1000116 Fig. 5\n        --><div class=\"img-wrap\"><a href=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973316/solim9abc-3227344-large.gif\" data-fig-id=\"fig9\"><img src=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973316/solim9abc-3227344-small.gif\" alt=\"FIGURE 9. - (a) HS pattern of 2-DOF prosthesis (b, c) gait phase estimation error of the training and validation data sets.\"/><div class=\"zoom\" title=\"View Larger Image\"/></a></div><div class=\"figcaption\"><b class=\"title\">FIGURE 9. </b><fig><p>(a) HS pattern of 2-DOF prosthesis (b, c) gait phase estimation error of the training and validation data sets.</p></fig></div><p class=\"links\"><a href=\"/document/9973316/all-figures\" class=\"all\">Show All</a></p></div></p><p>Nevertheless, estimation results were promising and needed to be expanded using amputated human subjects, as further deviation is expected. In future work, impaired subjects will use the 2-DOF prosthesis and walk around with it to generate a gait pattern similar to <a ref-type=\"fig\" anchor=\"fig3\" class=\"fulltext-link\">Fig 3</a>. Impaired subjects will then walk outdoors at their natural gait speed. A gait model will be generated for each impaired subject. This is advantageous to amputees as it allows for improved autonomous interaction between amputee and prosthesis. To estimate the gait phase real time, shank data <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$(\\omega _{\\mathrm {t}}^{\\mathrm {S}},{\\mathrm {a}}_{\\mathrm {t}}^{\\mathrm {S}})$\n</tex-math></inline-formula> from half a second before the gait event (200 samples) can be used to predict when the upcoming gait event. The linear regression model can predict the point of gait based on previous shank IMU data <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$(\\omega _{\\mathrm {t}}^{\\mathrm {S}},{\\mathrm {a}}_{\\mathrm {t}}^{\\mathrm {S}})$\n</tex-math></inline-formula>.</p><p>A limitation and an ongoing study of this work is the lack of ability to identify gait activities. Gait activities include turning and incline (stairs) maneuvers. When subjects vary their indoor gait pattern to include several turning maneuvers representing outdoor turns, the gait model can still accurately detect HSs and TOs. For optimal results, subjects should try to replicate as many maneuvers typically done in outdoor walks during the indoor gait trial. Further studies are needed to identify and predict inclination activities; the team conducted a preliminary study using a previously designed ESKF to estimate stair activities <a ref-type=\"bibr\" anchor=\"ref28\" id=\"context_ref_28_4a\">[28]</a>.</p></div></div>\n<div class=\"section\" id=\"sec5\"><div class=\"header article-hdr\"><div class=\"kicker\">\n\t\t                        SECTION V.</div><h2>Conclusion</h2></div><p>This paper presents two IMU-based methods that can accurately estimate the gait phase of human subjects based on a one-second time history. The estimation method is based on initially producing a gait pattern representative of each human subject. To produce the pattern, human subjects carry out two experimental protocols: 1) IMU calibration to correct raw IMU readings, transforming readings to be representative of the body frame to the IMU is attached, and 2) an indoor walking experiment where subjects carry out continuous and varying gait cycles while being monitored by a motion capture system and a force plate. The motion capture and force plate readings are used to form the ground truth and are synchronized to foot IMU readings. They produce a gait pattern for heel strike (HS) and toe-off (TO) events. The pattern embodies the gait event and half a second of data before and after the event. Upon completing the indoor walk, subjects walk for 40 minutes in an unsupervised outdoor environment. Subjects walked for 40 minutes because 1) it\u2019s long enough to have adequate data sets for training and testing the gait model, 2) subjects didn\u2019t walk longer due to risks of battery draining, and 3) adhesives on human shank weakening due to sweat. An outdoor walk experiment is used as it is more representative of a human\u2019s natural gait than a lab environment or a treadmill. Data from twenty minutes of the outdoor walk generates a linear regression model representative of the subject\u2019s natural gait. The model is built on shank IMU readings; outdoor walk data is labeled with gait events (HS and TO) based on the pre-defined gait pattern of the subject. The model uses PCA estimation to narrow down the large data sets into a 100 representative features, remove any unnecessary noise, and limit its over-training. The model estimates the gait phase of the remaining twenty minutes of the subject\u2019s outdoor walk.</p><p>Gait phase estimation error for each of the subjects is calculated. The average error for the subjects was <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$2.21~\\pm ~0.258$\n</tex-math></inline-formula> %. Subject D reported the lowest error due to having the highest variability in the original gait phase pattern, meaning that the subject\u2019s pattern included a wide variety of all the steps the subject took in the outdoor environment. The lowest estimation accuracy was reported in subject C, the subject with the lowest variability in their indoor pattern walk (<a ref-type=\"fig\" anchor=\"fig3\" class=\"fulltext-link\">Fig 3</a>). Our team also proposed a method that allows groups without a force plate and a motion capture system to replicate the described work with high accuracy. Concatenated patterns from other human subjects can be used to label outdoor data from a subject that does not have a representative pattern. The more subjects represented in the concatenated pattern, the higher the correlation confidence between the pattern and unlabeled outdoor data. Further application of the proposed work is the autonomous control of an active lower limb 2-DOF prosthesis.</p><p>The proposed work allows researchers to study the gait phase of human subjects in an unsupervised outdoor environment. This is advantageous over lab and treadmill testing as it\u2019s a closer representation of a human\u2019s natural gait and allows subjects to varying speeds as needed. Furthermore, in terms of labeling gait events (HS and TO), the proposed work offers a unique methodology that does not require fixed thresholds, external sensors (force sensors), or special shoes (sensor-embedded insoles). The labels for HS and TO are based on statistical correlation confidence that is robust to any human subject and does not require embedded sensors that can impose the subject\u2019s natural gait. Additionally, the proposed methodology may offer opportunities for extended gait experiments without requiring fully equipped laboratory settings to replicate work. Finally, the methodology can be expanded to aid patients in gait training as proposed regression models can be run offline and in real-time. Presented work can also control wearable assistive devices to offer seamless interaction between humans and robotic devices.</p></div>\n<div class=\"section\" id=\"sec6\"><div class=\"header article-hdr\"><div class=\"kicker\">\n\t\t                        SECTION VI.</div><h2>Availability</h2></div><p>The MATLAB and C deployment of the gait model training and experimental raw data described in the Methods section is available through (<a target=\"_blank\" href=\"https://github.com/hirolab/gaitphase-estimation\">https://github.com/hirolab/gaitphase-estimation</a>).</p></div>\n</div></div></response>\n"
}