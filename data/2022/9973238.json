{
    "abstract": "To attenuate the resonance of the LCL filter, capacitor-current-feedback (CCF) active damping has been extensively adopted in LCL-Type grid-connected inverters. Owing to the appearance of a negative damping region caused by the digital control delay, however, the damping performance has significantly deteriorated, thus the system is susceptible to being unstable under weak grid operation. To addre...",
    "articleNumber": "9973238",
    "articleTitle": "Capacitor-Current-Feedback With Improved Delay Compensation for LCL-Type Grid-Connected Inverter to Achieve High Robustness in Weak Grid",
    "authors": [
        {
            "preferredName": "Tieying Zhao",
            "normalizedName": "T. Zhao",
            "firstName": "Tieying",
            "lastName": "Zhao",
            "searchablePreferredName": "Tieying Zhao"
        },
        {
            "preferredName": "Junran Li",
            "normalizedName": "J. Li",
            "firstName": "Junran",
            "lastName": "Li",
            "searchablePreferredName": "Junran Li"
        },
        {
            "preferredName": "Ning Gao",
            "normalizedName": "N. Gao",
            "firstName": "Ning",
            "lastName": "Gao",
            "searchablePreferredName": "Ning Gao"
        }
    ],
    "doi": "10.1109/ACCESS.2022.3227391",
    "publicationTitle": "IEEE Access",
    "publicationYear": "2022",
    "publicationVolume": null,
    "publicationIssue": null,
    "volume": "10",
    "issue": null,
    "documentLink": "/document/9973238/",
    "xml": "<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<response><accessType>CCBY - IEEE is not the copyright holder of this material. Please follow the instructions via https://creativecommons.org/licenses/by/4.0/ to obtain full-text articles and stipulations in the API documentation.</accessType><div id=\"BodyWrapper\" class=\"ArticlePage\" xmlns:ieee=\"http://www.ieeexplore.ieee.org\"><div id=\"article\">\n<div class=\"section\" id=\"sec1\"><div class=\"header article-hdr\"><div class=\"kicker\">\n\t\t                        SECTION I.</div><h2>Introduction</h2></div><p>NOWADAYS, driven by the increasing concern about energy shortage and environmental pollution problems, distributed power generation systems (DPGSs) are attracting growing attention. As the power conversion interfaces between the DPGSs and the public grid, in which, inverter plays a key role in injecting stable and high-quality current into the grid <a ref-type=\"bibr\" anchor=\"ref1\" id=\"context_ref_1_1\">[1]</a>, <a ref-type=\"bibr\" anchor=\"ref2\" id=\"context_ref_2_1\">[2]</a>.</p><p>To reduce the switching harmonics content in the output current, an <inline-formula id=\"\"><tex-math notation=\"LaTeX\">${L}$\n</tex-math></inline-formula> or <i>LCL</i> filter has been widely used, while the total volume required for the <i>LCL</i> filter is smaller for the same harmonic attenuation performance <a ref-type=\"bibr\" anchor=\"ref3\" id=\"context_ref_3_1\">[3]</a>. However, an inherent resonance problem is introduced by <i>LCL</i> filter, which might lead to system instability. To address this issue, damping methods must be adopted to suppress the resonance peak <a ref-type=\"bibr\" anchor=\"ref4\" id=\"context_ref_4_1\">[4]</a>, <a ref-type=\"bibr\" anchor=\"ref5\" id=\"context_ref_5_1\">[5]</a>, <a ref-type=\"bibr\" anchor=\"ref6\" id=\"context_ref_6_1\">[6]</a>, <a ref-type=\"bibr\" anchor=\"ref7\" id=\"context_ref_7_1\">[7]</a>, <a ref-type=\"bibr\" anchor=\"ref8\" id=\"context_ref_8_1\">[8]</a>, <a ref-type=\"bibr\" anchor=\"ref9\" id=\"context_ref_9_1\">[9]</a>, <a ref-type=\"bibr\" anchor=\"ref10\" id=\"context_ref_10_1\">[10]</a>. Passive damping is a direct way to dampen the <i>LCL</i> resonance by inserting a passive resistor in series or parallel with the filter network <a ref-type=\"bibr\" anchor=\"ref4\" id=\"context_ref_4_1\">[4]</a>, <a ref-type=\"bibr\" anchor=\"ref5\" id=\"context_ref_5_1\">[5]</a>. This is a simple and effective way while it also introduces into considerable power loss, which is not cost-effective. Compared with passive damping, active damping features high efficiency and flexibility, and it can be implemented in two ways. One is based on digital filters, which are cascading with the current regulator <a ref-type=\"bibr\" anchor=\"ref6\" id=\"context_ref_6_1\">[6]</a>. The other way is based on filter state variables feedback <a ref-type=\"bibr\" anchor=\"ref7\" id=\"context_ref_7_1\">[7]</a>, <a ref-type=\"bibr\" anchor=\"ref8\" id=\"context_ref_8_1\">[8]</a>, <a ref-type=\"bibr\" anchor=\"ref9\" id=\"context_ref_9_1\">[9]</a>, <a ref-type=\"bibr\" anchor=\"ref10\" id=\"context_ref_10_1\">[10]</a>. This article adopts the capacitor-current-feedback (CCF) active damping method, which is extensively used in industry due to its simplicity and effectiveness <a ref-type=\"bibr\" anchor=\"ref10\" id=\"context_ref_10_1\">[10]</a>.</p><p>For obtaining high flexibility, the grid-connected inverter is most digitally controlled. Considering the influence of digital control delay <a ref-type=\"bibr\" anchor=\"ref11\" id=\"context_ref_11_1\">[11]</a>, however, the CCF active damping performance is weakened <a ref-type=\"bibr\" anchor=\"ref12\" id=\"context_ref_12_1\">[12]</a>, <a ref-type=\"bibr\" anchor=\"ref13\" id=\"context_ref_13_1\">[13]</a>, <a ref-type=\"bibr\" anchor=\"ref14\" id=\"context_ref_14_1\">[14]</a>, <a ref-type=\"bibr\" anchor=\"ref15\" id=\"context_ref_15_1\">[15]</a>, <a ref-type=\"bibr\" anchor=\"ref16\" id=\"context_ref_16_1\">[16]</a>. As revealed in <a ref-type=\"bibr\" anchor=\"ref12\" id=\"context_ref_12_1\">[12]</a>, it is no longer equivalent to a pure resistance but an impedance that varies with the frequency of the system. In <a ref-type=\"bibr\" anchor=\"ref13\" id=\"context_ref_13_1\">[13]</a>, one-sixth of the sampling frequency <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$f_{s}/6$\n</tex-math></inline-formula> is regarded as the critical frequency, signed as <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$f_{\\text {cri}}$\n</tex-math></inline-formula>, which is the boundary frequency of the positive equivalent resistance region. When the actual resonance frequency is higher than the critical frequency, the open-loop unstable poles would be introduced into the control loop, leading to nonminimum-frequency behavior. Note that, if the resonance frequency is too close to the critical frequency, the system is apt to be unstable due to the inadequate gain margin. So, <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$f_{\\text {cri}}$\n</tex-math></inline-formula> and its vicinity can be defined as the resonance frequency forbidden region <a ref-type=\"bibr\" anchor=\"ref14\" id=\"context_ref_14_1\">[14]</a>. In particular, when the resonance frequency is equal to <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$f_{s}/6$\n</tex-math></inline-formula>, the system stability cannot be maintained <a ref-type=\"bibr\" anchor=\"ref16\" id=\"context_ref_16_1\">[16]</a>. Therefore, the digitally controlled grid-connected inverter with CCF active damping is susceptible to instability under weak grid conditions.</p><p>To mitigate the adverse effect of digital control delay on the CCF active damping, numerous solutions are proposed <a ref-type=\"bibr\" anchor=\"ref12\" id=\"context_ref_12_1\">[12]</a>, <a ref-type=\"bibr\" anchor=\"ref17\" id=\"context_ref_17_1\">[17]</a>, <a ref-type=\"bibr\" anchor=\"ref18\" id=\"context_ref_18_1\">[18]</a>, <a ref-type=\"bibr\" anchor=\"ref19\" id=\"context_ref_19_1\">[19]</a>, <a ref-type=\"bibr\" anchor=\"ref20\" id=\"context_ref_20_1\">[20]</a>, <a ref-type=\"bibr\" anchor=\"ref21\" id=\"context_ref_21_1\">[21]</a>, <a ref-type=\"bibr\" anchor=\"ref22\" id=\"context_ref_22_1\">[22]</a>, <a ref-type=\"bibr\" anchor=\"ref23\" id=\"context_ref_23_1\">[23]</a>, <a ref-type=\"bibr\" anchor=\"ref24\" id=\"context_ref_24_1\">[24]</a>, <a ref-type=\"bibr\" anchor=\"ref25\" id=\"context_ref_25_1\">[25]</a>, <a ref-type=\"bibr\" anchor=\"ref26\" id=\"context_ref_26_1\">[26]</a>, <a ref-type=\"bibr\" anchor=\"ref27\" id=\"context_ref_27_1\">[27]</a>, <a ref-type=\"bibr\" anchor=\"ref28\" id=\"context_ref_28_1\">[28]</a>, <a ref-type=\"bibr\" anchor=\"ref29\" id=\"context_ref_29_1\">[29]</a>, <a ref-type=\"bibr\" anchor=\"ref30\" id=\"context_ref_30_1\">[30]</a>, <a ref-type=\"bibr\" anchor=\"ref31\" id=\"context_ref_31_1\">[31]</a>, <a ref-type=\"bibr\" anchor=\"ref32\" id=\"context_ref_32_1\">[32]</a>, <a ref-type=\"bibr\" anchor=\"ref33\" id=\"context_ref_33_1\">[33]</a>, which can be classified into two types. One is to directly reduce the digital control delay. In <a ref-type=\"bibr\" anchor=\"ref12\" id=\"context_ref_12_1\">[12]</a> and <a ref-type=\"bibr\" anchor=\"ref17\" id=\"context_ref_17_1\">[17]</a>, the computation delay is reduced by shortening the time interval between the signal sampling instant and the PWM reference update instant. However, signal aliasing and switching noises might be introduced. To overcome this drawback, the real-time computation scheme is proposed in <a ref-type=\"bibr\" anchor=\"ref18\" id=\"context_ref_18_1\">[18]</a> by immediately updating the computed PWM reference. Nevertheless, it is highly dependent on DSP computation performance. In <a ref-type=\"bibr\" anchor=\"ref19\" id=\"context_ref_19_1\">[19]</a>, the multiple sampling scheme is proposed, which is equivalented to reducing the computation delay by increasing the sampling frequency. Nevertheless, it is also susceptible to aliasing and switching noise.</p><p>Another method is to use the model-based predictive control <a ref-type=\"bibr\" anchor=\"ref20\" id=\"context_ref_20_1\">[20]</a>, <a ref-type=\"bibr\" anchor=\"ref21\" id=\"context_ref_21_1\">[21]</a>, <a ref-type=\"bibr\" anchor=\"ref22\" id=\"context_ref_22_1\">[22]</a> or the model-free phase-lead compensator <a ref-type=\"bibr\" anchor=\"ref23\" id=\"context_ref_23_1\">[23]</a>, <a ref-type=\"bibr\" anchor=\"ref24\" id=\"context_ref_24_1\">[24]</a>, <a ref-type=\"bibr\" anchor=\"ref25\" id=\"context_ref_25_1\">[25]</a>, <a ref-type=\"bibr\" anchor=\"ref26\" id=\"context_ref_26_1\">[26]</a>, <a ref-type=\"bibr\" anchor=\"ref27\" id=\"context_ref_27_1\">[27]</a>, <a ref-type=\"bibr\" anchor=\"ref28\" id=\"context_ref_28_1\">[28]</a>, <a ref-type=\"bibr\" anchor=\"ref29\" id=\"context_ref_29_1\">[29]</a>, <a ref-type=\"bibr\" anchor=\"ref30\" id=\"context_ref_30_1\">[30]</a>, <a ref-type=\"bibr\" anchor=\"ref31\" id=\"context_ref_31_1\">[31]</a> to compensate the digital control delay. In <a ref-type=\"bibr\" anchor=\"ref20\" id=\"context_ref_20_1\">[20]</a>, the smith predictor is proposed to alleviate the delay effect, which is effective and more readily implemented. However, it is sensitive to the variation of system parameters and operating conditions. State observer can also be used to calculate the next beat of system state variables for compensating the computation delay <a ref-type=\"bibr\" anchor=\"ref21\" id=\"context_ref_21_1\">[21]</a>, <a ref-type=\"bibr\" anchor=\"ref22\" id=\"context_ref_22_1\">[22]</a>. However, it also needs modeling error mitigation, which imposes extra computation burdens. In <a ref-type=\"bibr\" anchor=\"ref23\" id=\"context_ref_23_1\">[23]</a> and <a ref-type=\"bibr\" anchor=\"ref24\" id=\"context_ref_24_1\">[24]</a>, the <i>RC</i> damping and the <i>RLC</i> damping are respectively proposed by feeding back capacitor current with a first-order high-pass filter (HPF) and a second-order one, which can extend the boundary frequency of the equivalent resistance region from <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$f_{s}/6$\n</tex-math></inline-formula> to <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$f_{s}/3$\n</tex-math></inline-formula>. Nevertheless, it is subject to noise amplification, which is introduced by the HPF. Based on the graphical evaluation, Lu et al. <a ref-type=\"bibr\" anchor=\"ref25\" id=\"context_ref_25_1\">[25]</a> investigate several phase-lead compensators, e.g., linear predictor <a ref-type=\"bibr\" anchor=\"ref26\" id=\"context_ref_26_1\">[26]</a>, first-order phase-lead compensator <a ref-type=\"bibr\" anchor=\"ref27\" id=\"context_ref_27_1\">[27]</a>, <a ref-type=\"bibr\" anchor=\"ref28\" id=\"context_ref_28_1\">[28]</a>, second-order generalized integrator <a ref-type=\"bibr\" anchor=\"ref29\" id=\"context_ref_29_1\">[29]</a> and propose a novel phase-lead compensator. Those above-mentioned compensators are revealed that can compensate a maximum time delay of half-sampling period. The characteristic of them are that the higher phase compensation, the higher gain in high frequency region. To compensate more phase-lag resulting by the digital control delay, a second-order phase-lead compensator is respectively inserted into the CCF path and the feedforward path <a ref-type=\"bibr\" anchor=\"ref30\" id=\"context_ref_30_1\">[30]</a>, <a ref-type=\"bibr\" anchor=\"ref31\" id=\"context_ref_31_1\">[31]</a>, which has significant phase-lead performance and higher magnitude response near the Nyquist frequency. However, those delay compensation methods put more attention on the phase-lead performance of the compensator while neglecting the high magnitude response in high frequency region, which introduces significant noise amplification and increases the difficulty of control parameters design.</p><p>In this paper, an improved delay compensation method with better noise immunity performance is proposed. After compensation, the positive equivalent resistance can cover the range of <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$(0,f_{s}/4)$\n</tex-math></inline-formula>, and the resonance frequency forbidden region is eliminated. Thus, the system robustness against the grid impedance variation is enhanced and noise amplification can be relieved.</p><p>The rest of this paper is organized as follows. In <a ref-type=\"sec\" anchor=\"sec2\" class=\"fulltext-link\">Section II</a>, the configuration of the system is described and the mathematical model in discrete-domain is presented. In <a ref-type=\"sec\" anchor=\"sec3\" class=\"fulltext-link\">Section III</a>, the effect resulting by digital control delay on the damping performance is investigated. In <a ref-type=\"sec\" anchor=\"sec4\" class=\"fulltext-link\">Section IV</a>, an improved delay compensation method with better noise immunity performance is proposed and the stability analysis of the system after compensation is further analyzed detailedly. For obtaining good control performance, the detailed parameters design procedure is also presented. In <a ref-type=\"sec\" anchor=\"sec5\" class=\"fulltext-link\">Section V</a>, the experimental results are shown to verify the validity of the proposed delay compensation method. Finally, <a ref-type=\"sec\" anchor=\"sec6\" class=\"fulltext-link\">Section VI</a> concludes this paper.</p></div>\n<div class=\"section\" id=\"sec2\"><div class=\"header article-hdr\"><div class=\"kicker\">\n\t\t                        SECTION II.</div><h2>Modeling the Digital Controlled LCL-Type Grid-Connected Inverter</h2></div><p><a ref-type=\"fig\" anchor=\"fig1\" class=\"fulltext-link\">Fig. 1</a> shows the configuration of a digital controlled single-phase <i>LCL</i>-Type grid-connected inverter, in which <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$V_{\\text {in}}$\n</tex-math></inline-formula> is the DC voltage, and <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$v_{g}$\n</tex-math></inline-formula> denotes the grid voltage. <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$L_{1}$\n</tex-math></inline-formula> is the inverter-side inductor, <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$C$\n</tex-math></inline-formula> is the capacitor filter, and <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$L_{2}$\n</tex-math></inline-formula> is the grid-side inductor, which constitutes the <i>LCL</i> filter. <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$H_{i1}$\n</tex-math></inline-formula> and <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$H_{i2}$\n</tex-math></inline-formula> are the sense coefficient of the capacitor current <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$i_{c}$\n</tex-math></inline-formula> and the grid-side current <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$i_{g}$\n</tex-math></inline-formula>, respectively. The main purpose is to regulate <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$i_{g}$\n</tex-math></inline-formula> to be sinusoidal and synchronized with the voltage at the point of common coupling (PCC). So, the demanded amplitude <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$I^{*}$\n</tex-math></inline-formula>, which is generated by the outer voltage loop, and the phase <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\theta $\n</tex-math></inline-formula> extracted by the Phase-locked loop (PLL) from <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$v_{\\text {PCC}}$\n</tex-math></inline-formula> constitute the current reference <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$i_{\\text {ref}}$\n</tex-math></inline-formula>. The grid impedance at PCC composes of resistance and inductance. Since grid resistance can contribute to damping to some degree, thus grid resistance is ignored to emulate the worst situation. A proportional-resonant (PR) current controller <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$G_{R}$\n</tex-math></inline-formula> is applied to achieve zero steady-state error tracking.\n<div class=\"figure figure-full\" id=\"fig1\"><!--\n          Workaround for combined images.Eg.- 1000116 Fig. 5\n        --><div class=\"img-wrap\"><a href=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973238/li1-3227391-large.gif\" data-fig-id=\"fig1\"><img src=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973238/li1-3227391-small.gif\" alt=\"FIGURE 1. - Digitally controlled single-phase LCL-Type grid-connected inverter and digital control block diagram.\"/><div class=\"zoom\" title=\"View Larger Image\"/></a></div><div class=\"figcaption\"><b class=\"title\">FIGURE 1. </b><fig><p>Digitally controlled single-phase LCL-Type grid-connected inverter and digital control block diagram.</p></fig></div><p class=\"links\"><a href=\"/document/9973238/all-figures\" class=\"all\">Show All</a></p></div></p><p>According to <a ref-type=\"fig\" anchor=\"fig1\" class=\"fulltext-link\">Fig. 1</a>, the continuous-domain control block diagram of the digitally controlled <i>LCL</i>-Type grid-connected inverters is given in <a ref-type=\"fig\" anchor=\"fig2\" class=\"fulltext-link\">Fig. 2(a)</a>, where <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$1/T_{s}$\n</tex-math></inline-formula> is represented the sample <a ref-type=\"bibr\" anchor=\"ref32\" id=\"context_ref_32_2\">[32]</a>. <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$K_{\\text {PWM}}$\n</tex-math></inline-formula> is equivalent to the inverter bridge gain, which can be approximated as <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$v_{\\text {inv}}/v_{\\text {tri}}$\n</tex-math></inline-formula>. <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$v_{\\text {inv}}$\n</tex-math></inline-formula> and <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$v_{\\text {tri}}$\n</tex-math></inline-formula> are respectively the inverter bridge output voltage and the amplitude of the triangular carrier. The digital control delay contains computation delay and PWM delay <a ref-type=\"bibr\" anchor=\"ref33\" id=\"context_ref_33_2\">[33]</a>. In order to avoid multiple intersections between the modulation signal and the carrier signal, there is one sampling period delay between the current loading instant and the current sampling instant, which is the computation delay. In s-domain, the computation delay can be expressed as <disp-formula id=\"deqn1\" class=\"display-formula\"><tex-math notation=\"LaTeX\">\\begin{equation*} G_{d}(s)=e^{-sT_{s}}.\\tag{1}\\end{equation*}\n</tex-math><span class=\"formula\"><span class=\"link\">View Source</span><img aria-describedby=\"qtip-0\" style=\"display:inline;\" title=\"Right-click on figure or equation for MathML and additional features.\" data-hasqtip=\"0\" class=\"qtooltip moreInfo\" alt=\"Right-click on figure for MathML and additional features.\" src=\"/assets/img/icon.support.gif\" border=\"0\" height=\"20\" width=\"24\"/><span class=\"tex tex2jax_ignore\" style=\"display:none;\">\\begin{equation*} G_{d}(s)=e^{-sT_{s}}.\\tag{1}\\end{equation*}\n</span></span></disp-formula>\n<div class=\"figure figure-full\" id=\"fig2\"><!--\n          Workaround for combined images.Eg.- 1000116 Fig. 5\n        --><div class=\"img-wrap\"><a href=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973238/li2ab-3227391-large.gif\" data-fig-id=\"fig2\"><img src=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973238/li2ab-3227391-small.gif\" alt=\"FIGURE 2. - Control block diagram of the digitally controlled LCL-Type inverter with the CCF active damping. (a) In s-domain. (b) In z-domain.\"/><div class=\"zoom\" title=\"View Larger Image\"/></a></div><div class=\"figcaption\"><b class=\"title\">FIGURE 2. </b><fig><p>Control block diagram of the digitally controlled <i>LCL</i>-Type inverter with the CCF active damping. (a) In s-domain. (b) In z-domain.</p></fig></div><p class=\"links\"><a href=\"/document/9973238/all-figures\" class=\"all\">Show All</a></p></div></p><p>The modulation signal should remain unchanged and compare to the triangular carrier, this process can be modeled by ZOH, which is written as follows <disp-formula id=\"deqn2\" class=\"display-formula\"><tex-math notation=\"LaTeX\">\\begin{equation*} G_{\\text {ZOH}}(s)=\\displaystyle \\frac {1-e^{-s T_{s}}}{s} \\approx T_{s} e^{-0.5~s T_{s}}.\\tag{2}\\end{equation*}\n</tex-math><span class=\"formula\"><span class=\"link\">View Source</span><img aria-describedby=\"qtip-0\" style=\"display:inline;\" title=\"Right-click on figure or equation for MathML and additional features.\" data-hasqtip=\"0\" class=\"qtooltip moreInfo\" alt=\"Right-click on figure for MathML and additional features.\" src=\"/assets/img/icon.support.gif\" border=\"0\" height=\"20\" width=\"24\"/><span class=\"tex tex2jax_ignore\" style=\"display:none;\">\\begin{equation*} G_{\\text {ZOH}}(s)=\\displaystyle \\frac {1-e^{-s T_{s}}}{s} \\approx T_{s} e^{-0.5~s T_{s}}.\\tag{2}\\end{equation*}\n</span></span></disp-formula></p><p>According to <a ref-type=\"disp-formula\" anchor=\"deqn2\" href=\"#deqn2\" class=\"fulltext-link\">(2)</a>, a half sampling period delay <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$0.5T_{s}$\n</tex-math></inline-formula> is introduced by the PWM process. Therefore, the total delay in the control loop will be <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$1.5T_{s}$\n</tex-math></inline-formula>, which consists of computation delay (one sampling period delay) and PWM delay (<inline-formula id=\"\"><tex-math notation=\"LaTeX\">$0.5T_{s}$\n</tex-math></inline-formula>). <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$G_{R}(s)$\n</tex-math></inline-formula> is the PR current controller, expressed as <disp-formula id=\"deqn3\" class=\"display-formula\"><tex-math notation=\"LaTeX\">\\begin{equation*} G_{R}(s)=K_{P}+\\displaystyle \\frac {2 K_{r} \\omega _{i} s}{s^{2}+2 \\omega _{i} s+\\omega _{o}^{2}}\\tag{3}\\end{equation*}\n</tex-math><span class=\"formula\"><span class=\"link\">View Source</span><img aria-describedby=\"qtip-0\" style=\"display:inline;\" title=\"Right-click on figure or equation for MathML and additional features.\" data-hasqtip=\"0\" class=\"qtooltip moreInfo\" alt=\"Right-click on figure for MathML and additional features.\" src=\"/assets/img/icon.support.gif\" border=\"0\" height=\"20\" width=\"24\"/><span class=\"tex tex2jax_ignore\" style=\"display:none;\">\\begin{equation*} G_{R}(s)=K_{P}+\\displaystyle \\frac {2 K_{r} \\omega _{i} s}{s^{2}+2 \\omega _{i} s+\\omega _{o}^{2}}\\tag{3}\\end{equation*}\n</span></span></disp-formula> where <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$K_{p}$\n</tex-math></inline-formula> is the proportional gain and <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$K_{r}$\n</tex-math></inline-formula> is the resonant gain, <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\omega _{o}=2\\pi {f_{o}}$\n</tex-math></inline-formula> is the fundamental angular frequency. <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\omega _{i}$\n</tex-math></inline-formula> is the resonant cutoff frequency, due to the typical \u00b11% fluctuation of the grid fundamental frequency <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$f_{o}$\n</tex-math></inline-formula>, <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\omega _{i}$\n</tex-math></inline-formula> is set as <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\pi $\n</tex-math></inline-formula>.</p><p>The transfer function from the grid-side current and the capacitor current to the inverter bridge output voltage can be respectively obtained as <disp-formula id=\"deqn4-deqn5\" class=\"display-formula\"><tex-math notation=\"LaTeX\">\\begin{align*} G_{i g}(s)=&amp;\\displaystyle \\frac {i_{g}(s)}{v_{\\text {inv}}(s)}=\\displaystyle \\frac {1}{s L_{1}\\left ({L_{2}+L_{g}}\\right) C}\\cdot \\displaystyle \\frac {1}{s^{2}+\\omega _{r}^{2}}\\tag{4}\\\\ G_{i c}(s)=&amp;\\displaystyle \\frac {i_{c}(s)}{v_{\\text {inv}}(s)}=\\displaystyle \\frac {1}{L_{1}}\\cdot \\displaystyle \\frac {s}{s^{2}+\\omega _{r}^{2}}\\tag{5}\\end{align*}\n</tex-math><span class=\"formula\"><span class=\"link\">View Source</span><img aria-describedby=\"qtip-0\" style=\"display:inline;\" title=\"Right-click on figure or equation for MathML and additional features.\" data-hasqtip=\"0\" class=\"qtooltip moreInfo\" alt=\"Right-click on figure for MathML and additional features.\" src=\"/assets/img/icon.support.gif\" border=\"0\" height=\"20\" width=\"24\"/><span class=\"tex tex2jax_ignore\" style=\"display:none;\">\\begin{align*} G_{i g}(s)=&amp;\\displaystyle \\frac {i_{g}(s)}{v_{\\text {inv}}(s)}=\\displaystyle \\frac {1}{s L_{1}\\left ({L_{2}+L_{g}}\\right) C}\\cdot \\displaystyle \\frac {1}{s^{2}+\\omega _{r}^{2}}\\tag{4}\\\\ G_{i c}(s)=&amp;\\displaystyle \\frac {i_{c}(s)}{v_{\\text {inv}}(s)}=\\displaystyle \\frac {1}{L_{1}}\\cdot \\displaystyle \\frac {s}{s^{2}+\\omega _{r}^{2}}\\tag{5}\\end{align*}\n</span></span></disp-formula> where <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\omega _{r}$\n</tex-math></inline-formula> is the inherent resonance angular frequency, expressed as <disp-formula id=\"deqn6\" class=\"display-formula\"><tex-math notation=\"LaTeX\">\\begin{equation*} \\omega _{r}=\\sqrt {\\displaystyle \\frac {L_{1}+L_{2}+L_{g}}{L_{1}\\left ({L_{2}+L_{g}}\\right) C}}.\\tag{6}\\end{equation*}\n</tex-math><span class=\"formula\"><span class=\"link\">View Source</span><img aria-describedby=\"qtip-0\" style=\"display:inline;\" title=\"Right-click on figure or equation for MathML and additional features.\" data-hasqtip=\"0\" class=\"qtooltip moreInfo\" alt=\"Right-click on figure for MathML and additional features.\" src=\"/assets/img/icon.support.gif\" border=\"0\" height=\"20\" width=\"24\"/><span class=\"tex tex2jax_ignore\" style=\"display:none;\">\\begin{equation*} \\omega _{r}=\\sqrt {\\displaystyle \\frac {L_{1}+L_{2}+L_{g}}{L_{1}\\left ({L_{2}+L_{g}}\\right) C}}.\\tag{6}\\end{equation*}\n</span></span></disp-formula></p><p><a ref-type=\"fig\" anchor=\"fig2\" class=\"fulltext-link\">Fig. 2(b)</a> shows the control block diagram of the digitally controlled <i>LCL</i>-Type inverter with the CCF active damping in z-domain. <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$G_{ig}(z)$\n</tex-math></inline-formula> and <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$G_{ic}(z)$\n</tex-math></inline-formula> can be respectively derived by Z-transform to <a ref-type=\"disp-formula\" anchor=\"deqn7-deqn8\" href=\"#deqn7-deqn8\" class=\"fulltext-link\">(7) and (8)</a> with ZOH as <disp-formula id=\"deqn7-deqn8\" class=\"display-formula\"><tex-math notation=\"LaTeX\">\\begin{align*}&amp;\\hspace {-3.3pc}{G_{i g}}(z) = \\frac {{\\omega _{r}{T_{s}}\\left [{ {z^{2} - 2\\cos ({\\omega _{r}}{T_{s}})z + 1} }\\right] \\!-\\! \\sin ({\\omega _{r}}{T_{s}}){(z - 1)^{2}}}}{{\\omega _{r}({L_{1}} \\!+\\! {L_{2}} \\!+\\! {L_{g}})(z - 1)\\left [{ {z^{2} \\!-\\! 2\\cos ({\\omega _{r}}{T_{s}})z + 1} }\\right]}}. \\\\ {}\\tag{7}\\\\ G_{i c}(z)=&amp;\\displaystyle \\frac {\\sin \\left ({\\omega _{r} T_{s}}\\right)}{\\omega _{r} L_{1}} \\cdot \\frac {z-1}{z^{2}-2 \\cos \\left ({\\omega _{r} T_{s}}\\right) z+1}\\tag{8}\\end{align*}\n</tex-math><span class=\"formula\"><span class=\"link\">View Source</span><img aria-describedby=\"qtip-0\" style=\"display:inline;\" title=\"Right-click on figure or equation for MathML and additional features.\" data-hasqtip=\"0\" class=\"qtooltip moreInfo\" alt=\"Right-click on figure for MathML and additional features.\" src=\"/assets/img/icon.support.gif\" border=\"0\" height=\"20\" width=\"24\"/><span class=\"tex tex2jax_ignore\" style=\"display:none;\">\\begin{align*}&amp;\\hspace {-3.3pc}{G_{i g}}(z) = \\frac {{\\omega _{r}{T_{s}}\\left [{ {z^{2} - 2\\cos ({\\omega _{r}}{T_{s}})z + 1} }\\right] \\!-\\! \\sin ({\\omega _{r}}{T_{s}}){(z - 1)^{2}}}}{{\\omega _{r}({L_{1}} \\!+\\! {L_{2}} \\!+\\! {L_{g}})(z - 1)\\left [{ {z^{2} \\!-\\! 2\\cos ({\\omega _{r}}{T_{s}})z + 1} }\\right]}}. \\\\ {}\\tag{7}\\\\ G_{i c}(z)=&amp;\\displaystyle \\frac {\\sin \\left ({\\omega _{r} T_{s}}\\right)}{\\omega _{r} L_{1}} \\cdot \\frac {z-1}{z^{2}-2 \\cos \\left ({\\omega _{r} T_{s}}\\right) z+1}\\tag{8}\\end{align*}\n</span></span></disp-formula></p><p>According to <a ref-type=\"fig\" anchor=\"fig2\" class=\"fulltext-link\">Fig. 2(b)</a>, the discrete-domain open-loop gain can be derived as <a ref-type=\"disp-formula\" anchor=\"deqn9\" href=\"#deqn9\" class=\"fulltext-link\">(9)</a>, shown at the bottom of next page, \n<div class=\"figure figure-full\" id=\"\"><!--\n          Workaround for combined images.Eg.- 1000116 Fig. 5\n        --><div class=\"figcaption\"><b class=\"title\"> </b><fig/></div><p class=\"links\"><a href=\"/document/9973238/all-figures\" class=\"all\">Show All</a></p></div> and the discrete expression of <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$G_{R}(z)$\n</tex-math></inline-formula> can be obtained as <disp-formula id=\"deqn10\" class=\"display-formula\"><tex-math notation=\"LaTeX\">\\begin{align*}G_{R}(z)=K_{P}+\\displaystyle \\frac {2 K_{r} \\omega _{i} T_{s}(z-1)}{z^{2}+\\left ({\\omega _{o}^{2} T_{s}^{2}+2 \\omega _{i} T_{s}-2}\\right) z-2 \\omega _{i} T_{s}+1}. \\\\{}\\tag{10}\\end{align*}\n</tex-math><span class=\"formula\"><span class=\"link\">View Source</span><img aria-describedby=\"qtip-0\" style=\"display:inline;\" title=\"Right-click on figure or equation for MathML and additional features.\" data-hasqtip=\"0\" class=\"qtooltip moreInfo\" alt=\"Right-click on figure for MathML and additional features.\" src=\"/assets/img/icon.support.gif\" border=\"0\" height=\"20\" width=\"24\"/><span class=\"tex tex2jax_ignore\" style=\"display:none;\">\\begin{align*}G_{R}(z)=K_{P}+\\displaystyle \\frac {2 K_{r} \\omega _{i} T_{s}(z-1)}{z^{2}+\\left ({\\omega _{o}^{2} T_{s}^{2}+2 \\omega _{i} T_{s}-2}\\right) z-2 \\omega _{i} T_{s}+1}. \\\\{}\\tag{10}\\end{align*}\n</span></span></disp-formula></p></div>\n<div class=\"section\" id=\"sec3\"><div class=\"header article-hdr\"><div class=\"kicker\">\n\t\t                        SECTION III.</div><h2>Impacts of the Control Delay on the Capacitor-Current-Feedback Active Damping Performance</h2></div><p>In order to analysis the effect of control delay on the CCF active damping, control block diagram in continuous-domain and its equivalent transformation is shown in <a ref-type=\"fig\" anchor=\"fig3\" class=\"fulltext-link\">Fig. 3</a>. Replacing the feedback variable <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$i_{c}(s)$\n</tex-math></inline-formula> with <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$u_{c}(s)$\n</tex-math></inline-formula>, and moving the feedback node from the output of <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$G_{R}(s)$\n</tex-math></inline-formula> to the input of <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$1/sC$\n</tex-math></inline-formula>. By means of the equivalent transformation, the CCF active damping can be equivalent to a virtual impedance <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$Z_{eq}$\n</tex-math></inline-formula> paralleled with the filter capacitor <a ref-type=\"bibr\" anchor=\"ref34\" id=\"context_ref_34_3\">[34]</a>, expressed as <disp-formula id=\"deqn11\" class=\"display-formula\"><tex-math notation=\"LaTeX\">\\begin{equation*} Z_{eq}(s)=\\displaystyle \\frac {L_{1}e^{1.5sT_{s}}}{H_{i1}K_{\\text {PWM}}C}.\\tag{11}\\end{equation*}\n</tex-math><span class=\"formula\"><span class=\"link\">View Source</span><img aria-describedby=\"qtip-0\" style=\"display:inline;\" title=\"Right-click on figure or equation for MathML and additional features.\" data-hasqtip=\"0\" class=\"qtooltip moreInfo\" alt=\"Right-click on figure for MathML and additional features.\" src=\"/assets/img/icon.support.gif\" border=\"0\" height=\"20\" width=\"24\"/><span class=\"tex tex2jax_ignore\" style=\"display:none;\">\\begin{equation*} Z_{eq}(s)=\\displaystyle \\frac {L_{1}e^{1.5sT_{s}}}{H_{i1}K_{\\text {PWM}}C}.\\tag{11}\\end{equation*}\n</span></span></disp-formula>\n<div class=\"figure figure-full\" id=\"fig3\"><!--\n          Workaround for combined images.Eg.- 1000116 Fig. 5\n        --><div class=\"img-wrap\"><a href=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973238/li3-3227391-large.gif\" data-fig-id=\"fig3\"><img src=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973238/li3-3227391-small.gif\" alt=\"FIGURE 3. - Control block diagram in continuous-domain and its equivalent transformation.\"/><div class=\"zoom\" title=\"View Larger Image\"/></a></div><div class=\"figcaption\"><b class=\"title\">FIGURE 3. </b><fig><p>Control block diagram in continuous-domain and its equivalent transformation.</p></fig></div><p class=\"links\"><a href=\"/document/9973238/all-figures\" class=\"all\">Show All</a></p></div></p><p>Substituting <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$s=j\\omega $\n</tex-math></inline-formula> into <a ref-type=\"disp-formula\" anchor=\"deqn11\" href=\"#deqn11\" class=\"fulltext-link\">(11)</a>, yields <disp-formula id=\"deqn12\" class=\"display-formula\"><tex-math notation=\"LaTeX\">\\begin{equation*} Z_{eq}({\\omega })=\\displaystyle \\frac {L_{1}e^{1.5j{\\omega }{T_{s}}}}{H_{i1}K_{\\text {PWM}}C}=R_{eq}({\\omega })//jX_{eq}({\\omega }).\\tag{12}\\end{equation*}\n</tex-math><span class=\"formula\"><span class=\"link\">View Source</span><img aria-describedby=\"qtip-0\" style=\"display:inline;\" title=\"Right-click on figure or equation for MathML and additional features.\" data-hasqtip=\"0\" class=\"qtooltip moreInfo\" alt=\"Right-click on figure for MathML and additional features.\" src=\"/assets/img/icon.support.gif\" border=\"0\" height=\"20\" width=\"24\"/><span class=\"tex tex2jax_ignore\" style=\"display:none;\">\\begin{equation*} Z_{eq}({\\omega })=\\displaystyle \\frac {L_{1}e^{1.5j{\\omega }{T_{s}}}}{H_{i1}K_{\\text {PWM}}C}=R_{eq}({\\omega })//jX_{eq}({\\omega }).\\tag{12}\\end{equation*}\n</span></span></disp-formula></p><p>According to <a ref-type=\"disp-formula\" anchor=\"deqn12\" href=\"#deqn12\" class=\"fulltext-link\">(12)</a>, <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$Z_{eq}$\n</tex-math></inline-formula> can be represent as a parallel connected between a resistor <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$R_{eq}$\n</tex-math></inline-formula> and a reactor <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$X_{eq}$\n</tex-math></inline-formula>, expressed as <disp-formula id=\"deqn13-deqn14\" class=\"display-formula\"><tex-math notation=\"LaTeX\">\\begin{align*} R_{eq}({\\omega })=&amp;\\displaystyle \\frac {L_{1}}{H_{i1}K_{\\text {PWM}}C{\\text {cos}}(1.5{\\omega }T_{s})}\\tag{13}\\\\ X_{eq}({\\omega })=&amp;\\displaystyle \\frac {L_{1}}{H_{i1}K_{\\text {PWM}}C{\\text {sin}}(1.5{\\omega }T_{s})}.\\tag{14}\\end{align*}\n</tex-math><span class=\"formula\"><span class=\"link\">View Source</span><img aria-describedby=\"qtip-0\" style=\"display:inline;\" title=\"Right-click on figure or equation for MathML and additional features.\" data-hasqtip=\"0\" class=\"qtooltip moreInfo\" alt=\"Right-click on figure for MathML and additional features.\" src=\"/assets/img/icon.support.gif\" border=\"0\" height=\"20\" width=\"24\"/><span class=\"tex tex2jax_ignore\" style=\"display:none;\">\\begin{align*} R_{eq}({\\omega })=&amp;\\displaystyle \\frac {L_{1}}{H_{i1}K_{\\text {PWM}}C{\\text {cos}}(1.5{\\omega }T_{s})}\\tag{13}\\\\ X_{eq}({\\omega })=&amp;\\displaystyle \\frac {L_{1}}{H_{i1}K_{\\text {PWM}}C{\\text {sin}}(1.5{\\omega }T_{s})}.\\tag{14}\\end{align*}\n</span></span></disp-formula></p><p>According to <a ref-type=\"disp-formula\" anchor=\"deqn13-deqn14\" href=\"#deqn13-deqn14\" class=\"fulltext-link\">(13) and (14)</a>, the frequency characteristics of <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$R_{eq}$\n</tex-math></inline-formula> and <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$X_{eq}$\n</tex-math></inline-formula> can be drawn in <a ref-type=\"fig\" anchor=\"fig4\" class=\"fulltext-link\">Fig. 4</a>. As seen, <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$R_{eq}&gt;0$\n</tex-math></inline-formula> when <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$f_{r}{\\in }(0,f_{s}/6)$\n</tex-math></inline-formula>, <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$R_{eq} &lt; 0$\n</tex-math></inline-formula> when <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$f_{r}{\\in }(f_{s}/6,f_{s}/2)$\n</tex-math></inline-formula>, and <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$R_{eq}=0$\n</tex-math></inline-formula> when <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$f_{r}=f_{s}/6$\n</tex-math></inline-formula>. Obviously, <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$f_{s}/6$\n</tex-math></inline-formula> is the boundary frequency of the positive equivalent resistance region, which can be defined as the critical frequency <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$f_{\\text {cri}}$\n</tex-math></inline-formula>. With respect to <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$X_{eq}$\n</tex-math></inline-formula>, <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$X_{eq}&gt;0$\n</tex-math></inline-formula> when <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$f_{r}{\\in }(0,f_{s}/3)$\n</tex-math></inline-formula>, which is inductive. <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$X_{eq} &lt; 0$\n</tex-math></inline-formula> when <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$f_{r}{\\in }(f_{s}/3,f_{s}/2)$\n</tex-math></inline-formula>, which is capacitive. Note that, when <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$X_{eq}&gt;0$\n</tex-math></inline-formula>, <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$f_{r}$\n</tex-math></inline-formula> increases with the increase of <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$H_{i1}$\n</tex-math></inline-formula>. Thus, a higher actual resonance frequency is yielded, signed as <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$f_{r}^{\\prime }$\n</tex-math></inline-formula>. When <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$X_{eq} &lt; 0$\n</tex-math></inline-formula>, <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$f_{r}^{\\prime }$\n</tex-math></inline-formula> is lower than <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$f_{r}$\n</tex-math></inline-formula>. According to <a ref-type=\"disp-formula\" anchor=\"deqn9\" href=\"#deqn9\" class=\"fulltext-link\">(9)</a>, the Bode diagrams of the loop gain <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$T_{D}(z)$\n</tex-math></inline-formula> with <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$G_{R}(z)=1$\n</tex-math></inline-formula> for different <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$f_{r}$\n</tex-math></inline-formula> are shown in <a ref-type=\"fig\" anchor=\"fig5\" class=\"fulltext-link\">Fig. 5</a>. According to <a ref-type=\"fig\" anchor=\"fig5\" class=\"fulltext-link\">Fig. 5</a> and the research in <a ref-type=\"bibr\" anchor=\"ref12\" id=\"context_ref_12_3\">[12]</a>, the stability criterion for digitally controlled grid-connected inverter with the CCF active damping can be summarized in <a ref-type=\"table\" anchor=\"table1\" class=\"fulltext-link\">Table 1</a>, where the subscript (+) and (-) represent \u2212180\u00b0 crossing in the direction of phase raising and phase falling, respectively. <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$P$\n</tex-math></inline-formula> is the number of the open-loop unstable poles, PM is the phase margin, GM<sub>1</sub> and GM<sub>2</sub> are respectively the gain margin at <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$f_{r}$\n</tex-math></inline-formula> and <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$f_{s}/6$\n</tex-math></inline-formula>, and <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$H_{ilc}$\n</tex-math></inline-formula> is the boundary of <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$H_{i1}$\n</tex-math></inline-formula> when <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$f_{r}\\in (0,f_{s}/6)$\n</tex-math></inline-formula>. If <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$f_{r}\\in (0,f_{s}/6)$\n</tex-math></inline-formula> and <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$H_{i1}&gt;H_{ilc}$\n</tex-math></inline-formula>, a pair of right half-plane open-loop poles might arise. The expression of <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$H_{ilc}$\n</tex-math></inline-formula> can be given as <disp-formula id=\"deqn15\" class=\"display-formula\"><tex-math notation=\"LaTeX\">\\begin{equation*} H_{i l c}=\\displaystyle \\frac {\\omega _{r} L_{1}\\left ({2 \\cos \\left ({\\omega _{r} T_{s}}\\right)-1}\\right)}{K_{P W M} \\sin \\left ({\\omega _{r} T_{s}}\\right)}.\\tag{15}\\end{equation*}\n</tex-math><span class=\"formula\"><span class=\"link\">View Source</span><img aria-describedby=\"qtip-0\" style=\"display:inline;\" title=\"Right-click on figure or equation for MathML and additional features.\" data-hasqtip=\"0\" class=\"qtooltip moreInfo\" alt=\"Right-click on figure for MathML and additional features.\" src=\"/assets/img/icon.support.gif\" border=\"0\" height=\"20\" width=\"24\"/><span class=\"tex tex2jax_ignore\" style=\"display:none;\">\\begin{equation*} H_{i l c}=\\displaystyle \\frac {\\omega _{r} L_{1}\\left ({2 \\cos \\left ({\\omega _{r} T_{s}}\\right)-1}\\right)}{K_{P W M} \\sin \\left ({\\omega _{r} T_{s}}\\right)}.\\tag{15}\\end{equation*}\n</span></span></disp-formula><div class=\"figure figure-full table\" id=\"table1\"><div class=\"figcaption\"><b class=\"title\">TABLE 1 </b>\nStability Criterion for Digitally Controlled Grid-Connected Inverter With the CCF Active Damping</div><div class=\"img-wrap\"><a href=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973238/li.t1-3227391-large.gif\"><img src=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973238/li.t1-3227391-small.gif\" alt=\"Table 1- &#10;Stability Criterion for Digitally Controlled Grid-Connected Inverter With the CCF Active Damping\"/><div class=\"zoom\" title=\"View Larger Image\"/></a></div></div>\n<div class=\"figure figure-full\" id=\"fig4\"><!--\n          Workaround for combined images.Eg.- 1000116 Fig. 5\n        --><div class=\"img-wrap\"><a href=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973238/li4-3227391-large.gif\" data-fig-id=\"fig4\"><img src=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973238/li4-3227391-small.gif\" alt=\"FIGURE 4. - Frequency characteristics of &#10;$R_{eq}$&#10; and &#10;$X_{eq}$&#10;.\"/><div class=\"zoom\" title=\"View Larger Image\"/></a></div><div class=\"figcaption\"><b class=\"title\">FIGURE 4. </b><fig><p>Frequency characteristics of <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$R_{eq}$\n</tex-math></inline-formula> and <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$X_{eq}$\n</tex-math></inline-formula>.</p></fig></div><p class=\"links\"><a href=\"/document/9973238/all-figures\" class=\"all\">Show All</a></p></div>\n<div class=\"figure figure-full\" id=\"fig5\"><!--\n          Workaround for combined images.Eg.- 1000116 Fig. 5\n        --><div class=\"img-wrap\"><a href=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973238/li5ab-3227391-large.gif\" data-fig-id=\"fig5\"><img src=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973238/li5ab-3227391-small.gif\" alt=\"FIGURE 5. - Bode diagrams of the open-loop gain with &#10;$G_{R}(z)=1$&#10;. (a) &#10;$f_{r}\\in (0,f_{s}/6)$&#10; (b) &#10;$f_{r}\\in (f_{s}/6,f_{s}/2)$&#10;. &#10;\\begin{equation*} G_{c}(z)=\\frac {2(2-z^{-1})}{1+z^{-1}}.\\tag{16}\\end{equation*}&#10;\"/><div class=\"zoom\" title=\"View Larger Image\"/></a></div><div class=\"figcaption\"><b class=\"title\">FIGURE 5. </b><fig><p>Bode diagrams of the open-loop gain with <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$G_{R}(z)=1$\n</tex-math></inline-formula>. (a) <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$f_{r}\\in (0,f_{s}/6)$\n</tex-math></inline-formula> (b) <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$f_{r}\\in (f_{s}/6,f_{s}/2)$\n</tex-math></inline-formula>. <disp-formula id=\"deqn16\" class=\"display-formula\"><tex-math notation=\"LaTeX\">\\begin{equation*} G_{c}(z)=\\frac {2(2-z^{-1})}{1+z^{-1}}.\\tag{16}\\end{equation*}\n</tex-math><span class=\"formula\"><span class=\"link\">View Source</span><img aria-describedby=\"qtip-0\" style=\"display:inline;\" title=\"Right-click on figure or equation for MathML and additional features.\" data-hasqtip=\"0\" class=\"qtooltip moreInfo\" alt=\"Right-click on figure for MathML and additional features.\" src=\"/assets/img/icon.support.gif\" border=\"0\" height=\"20\" width=\"24\"/><span class=\"tex tex2jax_ignore\" style=\"display:none;\">\\begin{equation*} G_{c}(z)=\\frac {2(2-z^{-1})}{1+z^{-1}}.\\tag{16}\\end{equation*}\n</span></span></disp-formula></p></fig></div><p class=\"links\"><a href=\"/document/9973238/all-figures\" class=\"all\">Show All</a></p></div></p><p>According to the aforementioned analysis, it is recommended to obtain a relatively low resonance frequency, which is lower than one-sixth of the sampling frequency. However, it needs a larger volume capacitor or inductor which is not cost-effective and would cause the slow dynamic performance of the inverter owing to the influence of the weak grid. Moreover, it is noticed that the gain margin requirement for case 2 conflicts with case 4. Since <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$f_{r}$\n</tex-math></inline-formula> decreases as the <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$L_{g}$\n</tex-math></inline-formula> increases, the actual resonant frequency <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$f_{r}^{\\prime }$\n</tex-math></inline-formula> might be close to the critical frequency, which leads to system instability due to the inadequate gain margin. Besides, when <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$f_{r}=f_{s}/6$\n</tex-math></inline-formula>, the inverter will never be stable. Hence, the critical frequency and its vicinity can be defined as the resonance frequency forbidden region. Due to this characteristic, the robustness against grid impedance variation of the system is weakened. So, it is desirable to obtain a wider positive region of <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$R_{eq}$\n</tex-math></inline-formula> and eliminate the resonance frequency forbidden region.</p></div>\n<div class=\"section\" id=\"sec4\"><div class=\"header article-hdr\"><div class=\"kicker\">\n\t\t                        SECTION IV.</div><h2>Capacitor-Current-Feedback Damping With Improved Delay Compensation Method</h2></div><div class=\"section_2\" id=\"sec4a\"><h3>A. The Improved Delay Compensation Method</h3><p>In order to relieve the influence of the digital control delay, the phase-lead compensator <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$G_{c}(z)$\n</tex-math></inline-formula> is added into the capacitor current feedback path. The expression of <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$G_{c}(z)$\n</tex-math></inline-formula> is</p><p>The Bode plots of <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$G_{c}(z)$\n</tex-math></inline-formula> can be presented in <a ref-type=\"fig\" anchor=\"fig6\" class=\"fulltext-link\">Fig. 6</a>. As shown, the desired 90\u00b0 can be obtained at Nyquist frequency. However, the magnitude response increases with frequency to infinite at Nyquist frequency, which may cause system instability. For explaining this, <a ref-type=\"disp-formula\" anchor=\"deqn16\" href=\"#deqn16\" class=\"fulltext-link\">(16)</a> can be expanded as <disp-formula id=\"deqn17\" class=\"display-formula\"><tex-math notation=\"LaTeX\">\\begin{equation*} G_{c}(z=e^{j\\omega {T_{s}}})=\\displaystyle \\frac {e^{j0.5\\omega {T_{s}}}(2-e^{-j\\omega {T_{s}}})}{\\text {cos}(0.5\\omega {T_{s}})}.\\tag{17}\\end{equation*}\n</tex-math><span class=\"formula\"><span class=\"link\">View Source</span><img aria-describedby=\"qtip-0\" style=\"display:inline;\" title=\"Right-click on figure or equation for MathML and additional features.\" data-hasqtip=\"0\" class=\"qtooltip moreInfo\" alt=\"Right-click on figure for MathML and additional features.\" src=\"/assets/img/icon.support.gif\" border=\"0\" height=\"20\" width=\"24\"/><span class=\"tex tex2jax_ignore\" style=\"display:none;\">\\begin{equation*} G_{c}(z=e^{j\\omega {T_{s}}})=\\displaystyle \\frac {e^{j0.5\\omega {T_{s}}}(2-e^{-j\\omega {T_{s}}})}{\\text {cos}(0.5\\omega {T_{s}})}.\\tag{17}\\end{equation*}\n</span></span></disp-formula>\n<div class=\"figure figure-full\" id=\"fig6\"><!--\n          Workaround for combined images.Eg.- 1000116 Fig. 5\n        --><div class=\"img-wrap\"><a href=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973238/li6-3227391-large.gif\" data-fig-id=\"fig6\"><img src=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973238/li6-3227391-small.gif\" alt=\"FIGURE 6. - The Bode plots of &#10;$G_{c}(z)$&#10; and &#10;$G_{c}(z)^{\\prime }$&#10;.\"/><div class=\"zoom\" title=\"View Larger Image\"/></a></div><div class=\"figcaption\"><b class=\"title\">FIGURE 6. </b><fig><p>The Bode plots of <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$G_{c}(z)$\n</tex-math></inline-formula> and <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$G_{c}(z)^{\\prime }$\n</tex-math></inline-formula>.</p></fig></div><p class=\"links\"><a href=\"/document/9973238/all-figures\" class=\"all\">Show All</a></p></div></p><p>According to <a ref-type=\"disp-formula\" anchor=\"deqn17\" href=\"#deqn17\" class=\"fulltext-link\">(17)</a>, the phase of <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$G_{c}(z)$\n</tex-math></inline-formula> can be calculated as <disp-formula id=\"deqn18\" class=\"display-formula\"><tex-math notation=\"LaTeX\">\\begin{equation*} \\angle {G_{c}}\\left ({z }\\right) = 0.5\\omega {T_{s}} + \\arctan \\left ({{\\displaystyle \\frac {{\\sin \\left ({{\\omega {T_{s}}} }\\right)}}{{2 - \\cos \\left ({{\\omega T_{s}} }\\right)}}} }\\right)\\!.\\tag{18}\\end{equation*}\n</tex-math><span class=\"formula\"><span class=\"link\">View Source</span><img aria-describedby=\"qtip-0\" style=\"display:inline;\" title=\"Right-click on figure or equation for MathML and additional features.\" data-hasqtip=\"0\" class=\"qtooltip moreInfo\" alt=\"Right-click on figure for MathML and additional features.\" src=\"/assets/img/icon.support.gif\" border=\"0\" height=\"20\" width=\"24\"/><span class=\"tex tex2jax_ignore\" style=\"display:none;\">\\begin{equation*} \\angle {G_{c}}\\left ({z }\\right) = 0.5\\omega {T_{s}} + \\arctan \\left ({{\\displaystyle \\frac {{\\sin \\left ({{\\omega {T_{s}}} }\\right)}}{{2 - \\cos \\left ({{\\omega T_{s}} }\\right)}}} }\\right)\\!.\\tag{18}\\end{equation*}\n</span></span></disp-formula></p><p>When <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\omega ={\\omega _{s}/2}$\n</tex-math></inline-formula>, the phase of 90\u00b0 can be obtained, and the magnitude response will be infinite due to cos<inline-formula id=\"\"><tex-math notation=\"LaTeX\">$(0.5{\\omega _{s}}T_{s}/2)=0$\n</tex-math></inline-formula>, which is in agreement with <a ref-type=\"fig\" anchor=\"fig6\" class=\"fulltext-link\">Fig. 6</a>. However, an ideal phase-lead compensator should only raise the phase of the system while retain the amplitude relatively unchanged. Therefore, a first-order zero-phase-shift digital low filter <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$G_{low}(z)=az+b+az^{-1}$\n</tex-math></inline-formula> is proposed, which <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$b=1-2a$\n</tex-math></inline-formula> should be met <a ref-type=\"bibr\" anchor=\"ref35\" id=\"context_ref_35_4a\">[35]</a>, <a ref-type=\"bibr\" anchor=\"ref36\" id=\"context_ref_36_4a\">[36]</a>. However, <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$G_{low}(z)$\n</tex-math></inline-formula> has a \u201c<inline-formula id=\"\"><tex-math notation=\"LaTeX\">$z$\n</tex-math></inline-formula>\u201d, which is hard realized in the digital system. Fortunately, the term \u201c<inline-formula id=\"\"><tex-math notation=\"LaTeX\">$z$\n</tex-math></inline-formula>\u201d in <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$G_{low}(z)$\n</tex-math></inline-formula> can be eliminated by integrating into the term \u201c<inline-formula id=\"\"><tex-math notation=\"LaTeX\">$z^{-1}$\n</tex-math></inline-formula>\u201d in the denominator of <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$G_{c}(z)$\n</tex-math></inline-formula>. Substituting <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$b=1-2a$\n</tex-math></inline-formula> and <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$z=e^{j\\omega {T_{s}}}$\n</tex-math></inline-formula> into <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$G_{low}(z)$\n</tex-math></inline-formula>, it can be derived as <disp-formula id=\"deqn19\" class=\"display-formula\"><tex-math notation=\"LaTeX\">\\begin{equation*} {G_{low}}\\left ({{{e^{j\\omega {T_{s}}}}} }\\right) = 2a\\cos \\left ({{\\omega {T_{s}}} }\\right) + 1 - 2a.\\tag{19}\\end{equation*}\n</tex-math><span class=\"formula\"><span class=\"link\">View Source</span><img aria-describedby=\"qtip-0\" style=\"display:inline;\" title=\"Right-click on figure or equation for MathML and additional features.\" data-hasqtip=\"0\" class=\"qtooltip moreInfo\" alt=\"Right-click on figure for MathML and additional features.\" src=\"/assets/img/icon.support.gif\" border=\"0\" height=\"20\" width=\"24\"/><span class=\"tex tex2jax_ignore\" style=\"display:none;\">\\begin{equation*} {G_{low}}\\left ({{{e^{j\\omega {T_{s}}}}} }\\right) = 2a\\cos \\left ({{\\omega {T_{s}}} }\\right) + 1 - 2a.\\tag{19}\\end{equation*}\n</span></span></disp-formula></p><p>When <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\omega = {\\omega _{s/2}}$\n</tex-math></inline-formula>, the value of it is <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$1-4a$\n</tex-math></inline-formula>. If <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$20\\lg {\\left |{ {{G_{low}}\\left ({{{e^{j\\omega {T_{s}}}}} }\\right)} }\\right |_{\\omega = {\\omega _{s}}/2}} = - {}\\infty $\n</tex-math></inline-formula>, the digital low filter has maximum attenuation at <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$f_{s}/2$\n</tex-math></inline-formula>, so <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$a=0.25$\n</tex-math></inline-formula>, <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$b=0.5$\n</tex-math></inline-formula> are selected in this paper. The frequency characteristic of <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$G_{low}(z)$\n</tex-math></inline-formula> with different <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$a$\n</tex-math></inline-formula> is shown in <a ref-type=\"fig\" anchor=\"fig7\" class=\"fulltext-link\">Fig. 7</a>. As shown, when <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$a=0.25$\n</tex-math></inline-formula>, the maximum attenuation at Nyquist frequency with zero-phase-shift is obtained. The improved phase-lead compensator expression can be written as <disp-formula id=\"deqn20\" class=\"display-formula\"><tex-math notation=\"LaTeX\">\\begin{equation*} G_{c}(z)^{\\prime }=\\frac {2\\left ({2-z^{-1}}\\right)}{1+G_{low}(z) z^{-1}}.\\tag{20}\\end{equation*}\n</tex-math><span class=\"formula\"><span class=\"link\">View Source</span><img aria-describedby=\"qtip-0\" style=\"display:inline;\" title=\"Right-click on figure or equation for MathML and additional features.\" data-hasqtip=\"0\" class=\"qtooltip moreInfo\" alt=\"Right-click on figure for MathML and additional features.\" src=\"/assets/img/icon.support.gif\" border=\"0\" height=\"20\" width=\"24\"/><span class=\"tex tex2jax_ignore\" style=\"display:none;\">\\begin{equation*} G_{c}(z)^{\\prime }=\\frac {2\\left ({2-z^{-1}}\\right)}{1+G_{low}(z) z^{-1}}.\\tag{20}\\end{equation*}\n</span></span></disp-formula>\n<div class=\"figure figure-full\" id=\"fig7\"><!--\n          Workaround for combined images.Eg.- 1000116 Fig. 5\n        --><div class=\"img-wrap\"><a href=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973238/li7-3227391-large.gif\" data-fig-id=\"fig7\"><img src=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973238/li7-3227391-small.gif\" alt=\"FIGURE 7. - Frequency characteristic diagram of &#10;$G_{low}(z)$&#10; with different &#10;$a$&#10;.\"/><div class=\"zoom\" title=\"View Larger Image\"/></a></div><div class=\"figcaption\"><b class=\"title\">FIGURE 7. </b><fig><p>Frequency characteristic diagram of <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$G_{low}(z)$\n</tex-math></inline-formula> with different <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$a$\n</tex-math></inline-formula>.</p></fig></div><p class=\"links\"><a href=\"/document/9973238/all-figures\" class=\"all\">Show All</a></p></div></p><p>The bode plots of <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$G_{c}(z)$\n</tex-math></inline-formula> and <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$G_{c}(z)^{\\prime }$\n</tex-math></inline-formula> is shown in <a ref-type=\"fig\" anchor=\"fig6\" class=\"fulltext-link\">Fig. 6</a>. It can be seen that the high magnitude response of <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$G_{c}(z)$\n</tex-math></inline-formula> is effectively attenuated at the expense of the phase in high frequency region gradually decreased to zero. According to the expression of <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$G_{c}(z)^{\\prime }$\n</tex-math></inline-formula>, the block diagram of the improved phase-lead compensator can be presented in <a ref-type=\"fig\" anchor=\"fig8\" class=\"fulltext-link\">Fig. 8</a>. According to <a ref-type=\"disp-formula\" anchor=\"deqn9\" href=\"#deqn9\" class=\"fulltext-link\">(9)</a>, the discrete-domain loop gain <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$T_{D}(z)^{\\prime }$\n</tex-math></inline-formula> with <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$G_{c}(z)^{\\prime }$\n</tex-math></inline-formula> can be obtained as <a ref-type=\"disp-formula\" anchor=\"deqn21\" href=\"#deqn21\" class=\"fulltext-link\">(21)</a>, shown at the bottom of the page. \n<div class=\"figure figure-full\" id=\"\"><!--\n          Workaround for combined images.Eg.- 1000116 Fig. 5\n        --><div class=\"figcaption\"><b class=\"title\"> </b><fig/></div><p class=\"links\"><a href=\"/document/9973238/all-figures\" class=\"all\">Show All</a></p></div>\n<div class=\"figure figure-full\" id=\"fig8\"><!--\n          Workaround for combined images.Eg.- 1000116 Fig. 5\n        --><div class=\"img-wrap\"><a href=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973238/li8-3227391-large.gif\" data-fig-id=\"fig8\"><img src=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973238/li8-3227391-small.gif\" alt=\"FIGURE 8. - Block diagram of the improved phase-lead compensator.\"/><div class=\"zoom\" title=\"View Larger Image\"/></a></div><div class=\"figcaption\"><b class=\"title\">FIGURE 8. </b><fig><p>Block diagram of the improved phase-lead compensator.</p></fig></div><p class=\"links\"><a href=\"/document/9973238/all-figures\" class=\"all\">Show All</a></p></div></p><p>After compensation, the virtual equivalent impedance is changed, expressed as<disp-formula id=\"deqn22\" class=\"display-formula\"><tex-math notation=\"LaTeX\">\\begin{align*} {Z_{eq}}{(\\omega)^{\\prime }} =\\displaystyle \\frac {L_{1}}{{{H_{i1}}{K_{\\text {PWM}}}C}}\\displaystyle \\frac {{[1 + {G_{low}}\\left ({{{e^{ j\\omega {T_{s}}}}} }\\right){e^{ - j\\omega {T_{s}}}}]{e^{1.5j\\omega {T_{s}}}}}}{{2(2 - {e^{ - j\\omega {T_{s}}}})}} \\\\{}\\tag{22}\\end{align*}\n</tex-math><span class=\"formula\"><span class=\"link\">View Source</span><img aria-describedby=\"qtip-0\" style=\"display:inline;\" title=\"Right-click on figure or equation for MathML and additional features.\" data-hasqtip=\"0\" class=\"qtooltip moreInfo\" alt=\"Right-click on figure for MathML and additional features.\" src=\"/assets/img/icon.support.gif\" border=\"0\" height=\"20\" width=\"24\"/><span class=\"tex tex2jax_ignore\" style=\"display:none;\">\\begin{align*} {Z_{eq}}{(\\omega)^{\\prime }} =\\displaystyle \\frac {L_{1}}{{{H_{i1}}{K_{\\text {PWM}}}C}}\\displaystyle \\frac {{[1 + {G_{low}}\\left ({{{e^{ j\\omega {T_{s}}}}} }\\right){e^{ - j\\omega {T_{s}}}}]{e^{1.5j\\omega {T_{s}}}}}}{{2(2 - {e^{ - j\\omega {T_{s}}}})}} \\\\{}\\tag{22}\\end{align*}\n</span></span></disp-formula></p><p>Same as the mentioned discussion, <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$Z_{eq}^{\\prime }$\n</tex-math></inline-formula> can also be represented as a parallel connection of a resistor <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$R_{eq}^{\\prime }$\n</tex-math></inline-formula> and a reactor <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$X_{eq}^{\\prime }$\n</tex-math></inline-formula>, which can be written as <disp-formula id=\"deqn23\" class=\"display-formula\"><tex-math notation=\"LaTeX\">\\begin{align*} \\begin{cases} \\displaystyle R_{e q}(\\omega)^{\\prime }=\\displaystyle \\frac {L_{1}}{2 H_{i 1} K_{\\text {PWM}}C} \\displaystyle \\frac {A^{2}+B^{2}}{A D} \\\\ \\displaystyle X_{e q}(\\omega)^{\\prime }=\\displaystyle \\frac {L_{1}}{2 H_{i 1} K_{\\text {PWM}}C} \\displaystyle \\frac {A^{2}+B^{2}}{B D} \\end{cases}\\tag{23}\\end{align*}\n</tex-math><span class=\"formula\"><span class=\"link\">View Source</span><img aria-describedby=\"qtip-0\" style=\"display:inline;\" title=\"Right-click on figure or equation for MathML and additional features.\" data-hasqtip=\"0\" class=\"qtooltip moreInfo\" alt=\"Right-click on figure for MathML and additional features.\" src=\"/assets/img/icon.support.gif\" border=\"0\" height=\"20\" width=\"24\"/><span class=\"tex tex2jax_ignore\" style=\"display:none;\">\\begin{align*} \\begin{cases} \\displaystyle R_{e q}(\\omega)^{\\prime }=\\displaystyle \\frac {L_{1}}{2 H_{i 1} K_{\\text {PWM}}C} \\displaystyle \\frac {A^{2}+B^{2}}{A D} \\\\ \\displaystyle X_{e q}(\\omega)^{\\prime }=\\displaystyle \\frac {L_{1}}{2 H_{i 1} K_{\\text {PWM}}C} \\displaystyle \\frac {A^{2}+B^{2}}{B D} \\end{cases}\\tag{23}\\end{align*}\n</span></span></disp-formula> where <disp-formula id=\"deqn24\" class=\"display-formula\"><tex-math notation=\"LaTeX\">\\begin{align*} \\begin{cases} \\displaystyle A =2 \\cos ^{2}\\left ({0.5 \\omega T_{s}}\\right) \\cos \\left ({0.5 \\omega T_{s}}\\right) \\\\ \\displaystyle \\quad +[2-\\cos ^{2}\\left ({0.5 \\omega T_{s}}\\right)] \\cos \\left ({1.5 \\omega T_{s}}\\right)-\\cos \\left ({2.5 \\omega T_{s}}\\right) \\\\ \\displaystyle B =2 \\cos ^{2}\\left ({0.5 \\omega T_{s}}\\right) \\sin \\left ({0.5 \\omega T_{s}}\\right) \\\\ \\displaystyle \\quad +[2-\\cos ^{2}\\left ({0.5 \\omega T_{s}}\\right)] \\sin \\left ({1.5 \\omega T_{s}}\\right)-\\sin \\left ({2.5 \\omega T_{s}}\\right) \\\\ \\displaystyle D =5-4 \\cos \\left ({\\omega T_{s}}\\right). \\end{cases} \\\\{}\\tag{24}\\end{align*}\n</tex-math><span class=\"formula\"><span class=\"link\">View Source</span><img aria-describedby=\"qtip-0\" style=\"display:inline;\" title=\"Right-click on figure or equation for MathML and additional features.\" data-hasqtip=\"0\" class=\"qtooltip moreInfo\" alt=\"Right-click on figure for MathML and additional features.\" src=\"/assets/img/icon.support.gif\" border=\"0\" height=\"20\" width=\"24\"/><span class=\"tex tex2jax_ignore\" style=\"display:none;\">\\begin{align*} \\begin{cases} \\displaystyle A =2 \\cos ^{2}\\left ({0.5 \\omega T_{s}}\\right) \\cos \\left ({0.5 \\omega T_{s}}\\right) \\\\ \\displaystyle \\quad +[2-\\cos ^{2}\\left ({0.5 \\omega T_{s}}\\right)] \\cos \\left ({1.5 \\omega T_{s}}\\right)-\\cos \\left ({2.5 \\omega T_{s}}\\right) \\\\ \\displaystyle B =2 \\cos ^{2}\\left ({0.5 \\omega T_{s}}\\right) \\sin \\left ({0.5 \\omega T_{s}}\\right) \\\\ \\displaystyle \\quad +[2-\\cos ^{2}\\left ({0.5 \\omega T_{s}}\\right)] \\sin \\left ({1.5 \\omega T_{s}}\\right)-\\sin \\left ({2.5 \\omega T_{s}}\\right) \\\\ \\displaystyle D =5-4 \\cos \\left ({\\omega T_{s}}\\right). \\end{cases} \\\\{}\\tag{24}\\end{align*}\n</span></span></disp-formula></p><p>Combining <a ref-type=\"disp-formula\" anchor=\"deqn23\" href=\"#deqn23\" class=\"fulltext-link\">(23)</a> and <a ref-type=\"disp-formula\" anchor=\"deqn24\" href=\"#deqn24\" class=\"fulltext-link\">(24)</a>, the frequency characteristic plot of <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$R_{eq}(\\omega)^{\\prime }$\n</tex-math></inline-formula> can be shown in <a ref-type=\"fig\" anchor=\"fig9\" class=\"fulltext-link\">Fig. 9</a>. As seen, the boundary frequency of the positive equivalent resistance region after compensation can be defined as <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$f_{p}$\n</tex-math></inline-formula>, which is extended from <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$f_{s}/6$\n</tex-math></inline-formula> to <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$f_{s}$\n</tex-math></inline-formula>/4.\n<div class=\"figure figure-full\" id=\"fig9\"><!--\n          Workaround for combined images.Eg.- 1000116 Fig. 5\n        --><div class=\"img-wrap\"><a href=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973238/li9-3227391-large.gif\" data-fig-id=\"fig9\"><img src=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973238/li9-3227391-small.gif\" alt=\"FIGURE 9. - Frequency characteristic plot of &#10;$R_{eq}(\\omega)^{\\prime }$&#10;.\"/><div class=\"zoom\" title=\"View Larger Image\"/></a></div><div class=\"figcaption\"><b class=\"title\">FIGURE 9. </b><fig><p>Frequency characteristic plot of <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$R_{eq}(\\omega)^{\\prime }$\n</tex-math></inline-formula>.</p></fig></div><p class=\"links\"><a href=\"/document/9973238/all-figures\" class=\"all\">Show All</a></p></div></p></div><div class=\"section_2\" id=\"sec4b\"><h3>B. Stability Analysis of the System After Compensation</h3><p>After compensation, the system stability might be changed, so it need to be further analyzed. The poles <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$z=0$\n</tex-math></inline-formula> and <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$z=1$\n</tex-math></inline-formula> in <a ref-type=\"disp-formula\" anchor=\"deqn21\" href=\"#deqn21\" class=\"fulltext-link\">(21)</a> are inside the unit circle and not right half-plane open-loop poles, which can be ignored here. Therefore, the characteristic equation of <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$T_{D}(z)^{\\prime }$\n</tex-math></inline-formula> can be expressed as <disp-formula id=\"deqn25\" class=\"display-formula\"><tex-math notation=\"LaTeX\">\\begin{align*}&amp;\\hspace {-2pc}{\\left [{4 z^{2}+(z+1)^{2}}\\right][z^{2}-2 \\cos \\left ({\\omega _{r} T_{s}}\\right) z+1]+\\frac {8 H_{i 1} K_{P W M}}{\\omega _{r} L_{1}}} \\\\&amp;\\cdot \\,\\sin \\left ({\\omega _{r} T_{s}}\\right)(z-1)(2 z-1)=0.\\tag{25}\\end{align*}\n</tex-math><span class=\"formula\"><span class=\"link\">View Source</span><img aria-describedby=\"qtip-0\" style=\"display:inline;\" title=\"Right-click on figure or equation for MathML and additional features.\" data-hasqtip=\"0\" class=\"qtooltip moreInfo\" alt=\"Right-click on figure for MathML and additional features.\" src=\"/assets/img/icon.support.gif\" border=\"0\" height=\"20\" width=\"24\"/><span class=\"tex tex2jax_ignore\" style=\"display:none;\">\\begin{align*}&amp;\\hspace {-2pc}{\\left [{4 z^{2}+(z+1)^{2}}\\right][z^{2}-2 \\cos \\left ({\\omega _{r} T_{s}}\\right) z+1]+\\frac {8 H_{i 1} K_{P W M}}{\\omega _{r} L_{1}}} \\\\&amp;\\cdot \\,\\sin \\left ({\\omega _{r} T_{s}}\\right)(z-1)(2 z-1)=0.\\tag{25}\\end{align*}\n</span></span></disp-formula></p><p>For the simplicity of analysis, <a ref-type=\"disp-formula\" anchor=\"deqn25\" href=\"#deqn25\" class=\"fulltext-link\">(25)</a> can be mapped from <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$z$\n</tex-math></inline-formula> domain to <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\omega $\n</tex-math></inline-formula> domain by <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$z=(1+\\omega)/(1-\\omega)$\n</tex-math></inline-formula>, resulting in <disp-formula id=\"deqn26\" class=\"display-formula\"><tex-math notation=\"LaTeX\">\\begin{equation*} {a_{0}}{\\omega ^{4}} + {a_{1}}{\\omega ^{3}} + {a_{2}}{\\omega ^{2}} + {a_{3}}\\omega + {a_{4}} = 0\\tag{26}\\end{equation*}\n</tex-math><span class=\"formula\"><span class=\"link\">View Source</span><img aria-describedby=\"qtip-0\" style=\"display:inline;\" title=\"Right-click on figure or equation for MathML and additional features.\" data-hasqtip=\"0\" class=\"qtooltip moreInfo\" alt=\"Right-click on figure for MathML and additional features.\" src=\"/assets/img/icon.support.gif\" border=\"0\" height=\"20\" width=\"24\"/><span class=\"tex tex2jax_ignore\" style=\"display:none;\">\\begin{equation*} {a_{0}}{\\omega ^{4}} + {a_{1}}{\\omega ^{3}} + {a_{2}}{\\omega ^{2}} + {a_{3}}\\omega + {a_{4}} = 0\\tag{26}\\end{equation*}\n</span></span></disp-formula> where <disp-formula id=\"deqn27\" class=\"display-formula\"><tex-math notation=\"LaTeX\">\\begin{align*} \\begin{cases} \\displaystyle a_{0}=4[1+\\cos \\left ({\\omega _{r} T_{s}}\\right)]+4 H \\\\ \\displaystyle a_{1}=8[1+\\cos \\left ({\\omega _{r} T_{s}}\\right)]-5 H \\\\ \\displaystyle a_{2}=12[1-\\cos \\left ({\\omega _{r} T_{s}}\\right)]+H \\\\ \\displaystyle a_{3}=8[1-\\cos \\left ({\\omega _{r} T_{s}}\\right)]+H \\\\ \\displaystyle a_{4}=8[1-\\cos \\left ({\\omega _{r} T_{s}}\\right)] \\\\ \\displaystyle H=\\displaystyle \\frac {8 H_{i 1} K_{P W M} \\sin \\left ({\\omega _{r} T_{s}}\\right)}{\\omega _{r} L_{1}}. \\end{cases}\\tag{27}\\end{align*}\n</tex-math><span class=\"formula\"><span class=\"link\">View Source</span><img aria-describedby=\"qtip-0\" style=\"display:inline;\" title=\"Right-click on figure or equation for MathML and additional features.\" data-hasqtip=\"0\" class=\"qtooltip moreInfo\" alt=\"Right-click on figure for MathML and additional features.\" src=\"/assets/img/icon.support.gif\" border=\"0\" height=\"20\" width=\"24\"/><span class=\"tex tex2jax_ignore\" style=\"display:none;\">\\begin{align*} \\begin{cases} \\displaystyle a_{0}=4[1+\\cos \\left ({\\omega _{r} T_{s}}\\right)]+4 H \\\\ \\displaystyle a_{1}=8[1+\\cos \\left ({\\omega _{r} T_{s}}\\right)]-5 H \\\\ \\displaystyle a_{2}=12[1-\\cos \\left ({\\omega _{r} T_{s}}\\right)]+H \\\\ \\displaystyle a_{3}=8[1-\\cos \\left ({\\omega _{r} T_{s}}\\right)]+H \\\\ \\displaystyle a_{4}=8[1-\\cos \\left ({\\omega _{r} T_{s}}\\right)] \\\\ \\displaystyle H=\\displaystyle \\frac {8 H_{i 1} K_{P W M} \\sin \\left ({\\omega _{r} T_{s}}\\right)}{\\omega _{r} L_{1}}. \\end{cases}\\tag{27}\\end{align*}\n</span></span></disp-formula></p><p>The Routh table of <a ref-type=\"disp-formula\" anchor=\"deqn27\" href=\"#deqn27\" class=\"fulltext-link\">(27)</a> can be obtained as <disp-formula id=\"deqn28\" class=\"display-formula\"><tex-math notation=\"LaTeX\">\\begin{align*} \\begin{array}{rllll} \\omega ^{4} &amp;: &amp; a_{0} &amp; a_{2} &amp; a_{4} \\\\ \\omega ^{3} &amp;: &amp; a_{1} &amp; a_{3} &amp; \\\\ \\omega ^{2} &amp;: &amp; b_{1} &amp; a_{4} &amp; \\\\ \\omega ^{1} &amp;: &amp; b_{2} &amp; &amp; \\\\ \\omega ^{0} &amp;: &amp; a_{4} &amp; \\end{array}\\tag{28}\\end{align*}\n</tex-math><span class=\"formula\"><span class=\"link\">View Source</span><img aria-describedby=\"qtip-0\" style=\"display:inline;\" title=\"Right-click on figure or equation for MathML and additional features.\" data-hasqtip=\"0\" class=\"qtooltip moreInfo\" alt=\"Right-click on figure for MathML and additional features.\" src=\"/assets/img/icon.support.gif\" border=\"0\" height=\"20\" width=\"24\"/><span class=\"tex tex2jax_ignore\" style=\"display:none;\">\\begin{align*} \\begin{array}{rllll} \\omega ^{4} &amp;: &amp; a_{0} &amp; a_{2} &amp; a_{4} \\\\ \\omega ^{3} &amp;: &amp; a_{1} &amp; a_{3} &amp; \\\\ \\omega ^{2} &amp;: &amp; b_{1} &amp; a_{4} &amp; \\\\ \\omega ^{1} &amp;: &amp; b_{2} &amp; &amp; \\\\ \\omega ^{0} &amp;: &amp; a_{4} &amp; \\end{array}\\tag{28}\\end{align*}\n</span></span></disp-formula> where <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$b_{1}=(a_{1}a_{2}-a_{0}a_{3})/a_{1}$\n</tex-math></inline-formula>, <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$b_{2}=(b_{1}a_{3}-a_{1}a_{4})/b_{1}$\n</tex-math></inline-formula>.</p><p>In order to ensure the controllability of the system, <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$f_{r}$\n</tex-math></inline-formula> should lower than <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$f_{s}/2$\n</tex-math></inline-formula>, then <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\omega _{r}T_{s} &lt; \\pi $\n</tex-math></inline-formula> is obtained <a ref-type=\"bibr\" anchor=\"ref37\" id=\"context_ref_37_4b\">[37]</a>. Since <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$H_{i1}$\n</tex-math></inline-formula> is defined higher than zero, so <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\text {sin}(\\omega _{r}T_{s})&gt;0$\n</tex-math></inline-formula> and <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$1- \\text {cos}(\\omega _{r}T_{s})&gt;0$\n</tex-math></inline-formula> can be derived. According to Routh criterion, the first row in the Routh table should retain the same sign for ensuring the system stability. So <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$a_{1}&gt;0$\n</tex-math></inline-formula>, <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$b_{1}&gt;0$\n</tex-math></inline-formula> and <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$b_{2}&gt;0$\n</tex-math></inline-formula> are required. According to this requirement, <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$H_{ilc1}$\n</tex-math></inline-formula>, <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$H_{ilc2}$\n</tex-math></inline-formula> and <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$H_{ilc3}$\n</tex-math></inline-formula> can be derived, respectively. So <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$H_{ilc}^{\\prime }$\n</tex-math></inline-formula> can be defined as the minimum among them, expressed as <disp-formula id=\"deqn29\" class=\"display-formula\"><tex-math notation=\"LaTeX\">\\begin{equation*} H_{ilc}'=\\min \\left \\{{H_{i l c 1}, H_{i l c 2}, H_{i l c 3}}\\right \\}.\\tag{29}\\end{equation*}\n</tex-math><span class=\"formula\"><span class=\"link\">View Source</span><img aria-describedby=\"qtip-0\" style=\"display:inline;\" title=\"Right-click on figure or equation for MathML and additional features.\" data-hasqtip=\"0\" class=\"qtooltip moreInfo\" alt=\"Right-click on figure for MathML and additional features.\" src=\"/assets/img/icon.support.gif\" border=\"0\" height=\"20\" width=\"24\"/><span class=\"tex tex2jax_ignore\" style=\"display:none;\">\\begin{equation*} H_{ilc}'=\\min \\left \\{{H_{i l c 1}, H_{i l c 2}, H_{i l c 3}}\\right \\}.\\tag{29}\\end{equation*}\n</span></span></disp-formula></p><p>According to <a ref-type=\"disp-formula\" anchor=\"deqn21\" href=\"#deqn21\" class=\"fulltext-link\">(21)</a>, the Bode diagrams of <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$T_{D}(z)^{\\prime }$\n</tex-math></inline-formula> with <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$G_{R}(z)=1$\n</tex-math></inline-formula> can be shown in <a ref-type=\"fig\" anchor=\"fig10\" class=\"fulltext-link\">Fig. 10</a>. The \u2212180\u00b0 crossing frequency in the direction of phase falling and rising can be respectively defined as <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$f_{1}$\n</tex-math></inline-formula> and <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$f_{2}$\n</tex-math></inline-formula>. As seen in <a ref-type=\"fig\" anchor=\"fig10\" class=\"fulltext-link\">Fig. 10(a)</a>, when <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$f_{r}{\\in }(0,f_{p})$\n</tex-math></inline-formula> and <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$H_{i1} &lt; H_{ilc}^{\\prime }$\n</tex-math></inline-formula>, with the increases of <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$H_{i1}$\n</tex-math></inline-formula>, <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$f_{1}$\n</tex-math></inline-formula> keeps on deviating to the left side of <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$f_{r}$\n</tex-math></inline-formula>. If <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$H_{i1}&gt;H_{ilc}^{\\prime }$\n</tex-math></inline-formula>, with the increases of <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$H_{i1}$\n</tex-math></inline-formula>, <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$f_{1}$\n</tex-math></inline-formula> deviates to the left side of <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$f_{r}$\n</tex-math></inline-formula> while <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$f_{2}$\n</tex-math></inline-formula> deviates to the right side of <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$f_{p}$\n</tex-math></inline-formula>. As seen in <a ref-type=\"fig\" anchor=\"fig10\" class=\"fulltext-link\">Fig. 10(b)</a>, when <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$f_{r}{\\in }(f_{p},f_{s}/2)$\n</tex-math></inline-formula>, with the increases of <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$H_{i1}$\n</tex-math></inline-formula>, <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$f_{1}$\n</tex-math></inline-formula> deviates to the left side of <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$f_{p}$\n</tex-math></inline-formula> while <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$f_{2}$\n</tex-math></inline-formula> deviates to the right side of <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$f_{r}$\n</tex-math></inline-formula>. As the discussed above, <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$f_{1}$\n</tex-math></inline-formula> is never equal with <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$f_{2}$\n</tex-math></inline-formula>, and satisfies the characteristic, i.e.<disp-formula id=\"deqn30\" class=\"display-formula\"><tex-math notation=\"LaTeX\">\\begin{align*} \\begin{cases} \\displaystyle f_{1} &lt; \\min \\left \\{{f_{r}, f_{p}}\\right \\} \\\\ \\displaystyle f_{2}&gt;\\max \\left \\{{f_{r}, f_{p}}\\right \\}\\!. \\end{cases}\\tag{30}\\end{align*}\n</tex-math><span class=\"formula\"><span class=\"link\">View Source</span><img aria-describedby=\"qtip-0\" style=\"display:inline;\" title=\"Right-click on figure or equation for MathML and additional features.\" data-hasqtip=\"0\" class=\"qtooltip moreInfo\" alt=\"Right-click on figure for MathML and additional features.\" src=\"/assets/img/icon.support.gif\" border=\"0\" height=\"20\" width=\"24\"/><span class=\"tex tex2jax_ignore\" style=\"display:none;\">\\begin{align*} \\begin{cases} \\displaystyle f_{1} &lt; \\min \\left \\{{f_{r}, f_{p}}\\right \\} \\\\ \\displaystyle f_{2}&gt;\\max \\left \\{{f_{r}, f_{p}}\\right \\}\\!. \\end{cases}\\tag{30}\\end{align*}\n</span></span></disp-formula>\n<div class=\"figure figure-full\" id=\"fig10\"><!--\n          Workaround for combined images.Eg.- 1000116 Fig. 5\n        --><div class=\"img-wrap\"><a href=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973238/li10ab-3227391-large.gif\" data-fig-id=\"fig10\"><img src=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973238/li10ab-3227391-small.gif\" alt=\"FIGURE 10. - Bode diagrams of &#10;$T_{D}(z)^{\\prime }$&#10; with &#10;$G_{R}(z)=1$&#10;. (a) &#10;$f_{r}\\in (0,f_{p})$&#10; (b) &#10;$f_{r}\\in (f_{p},f_{s}/2)$&#10;.\"/><div class=\"zoom\" title=\"View Larger Image\"/></a></div><div class=\"figcaption\"><b class=\"title\">FIGURE 10. </b><fig><p>Bode diagrams of <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$T_{D}(z)^{\\prime }$\n</tex-math></inline-formula> with <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$G_{R}(z)=1$\n</tex-math></inline-formula>. (a) <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$f_{r}\\in (0,f_{p})$\n</tex-math></inline-formula> (b) <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$f_{r}\\in (f_{p},f_{s}/2)$\n</tex-math></inline-formula>.</p></fig></div><p class=\"links\"><a href=\"/document/9973238/all-figures\" class=\"all\">Show All</a></p></div></p><p>Therefore, the improved delay compensation method can extend the boundary frequency of the positive equivalent resistance region to <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$f_{s}$\n</tex-math></inline-formula>/4 and eliminate the forbidden region of the <i>LCL</i> filter resonance frequency. Then, the robustness against the grid impedance varying in a wide region is enhanced.</p></div><div class=\"section_2\" id=\"sec4c\"><h3>C. Parameter Design</h3><p>In order to ensure that inverter can operate stably varying with <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$L_{g}$\n</tex-math></inline-formula>, the CCF coefficient and the current regulator parameters need to be reasonably designed.</p><p>Derived by <a ref-type=\"fig\" anchor=\"fig3\" class=\"fulltext-link\">Fig. 3</a>, the open loop gain after compensation in s-domain can be given in <disp-formula id=\"deqn31\" class=\"display-formula\"><tex-math notation=\"LaTeX\">\\begin{equation*} T_{D}(s)^{\\prime }=\\displaystyle \\frac {1}{s L_{1}\\left ({L_{2}+L_{g}}\\right) C} \\frac {H_{i 2} K_{\\text {PWM}} e^{-1.5~s T_{s}} G_{R}(s)}{s^{2}+\\displaystyle \\frac {1}{C Z_{e q}(s)^{\\prime }}s+\\omega _{r}^{2}}.\\tag{31}\\end{equation*}\n</tex-math><span class=\"formula\"><span class=\"link\">View Source</span><img aria-describedby=\"qtip-0\" style=\"display:inline;\" title=\"Right-click on figure or equation for MathML and additional features.\" data-hasqtip=\"0\" class=\"qtooltip moreInfo\" alt=\"Right-click on figure for MathML and additional features.\" src=\"/assets/img/icon.support.gif\" border=\"0\" height=\"20\" width=\"24\"/><span class=\"tex tex2jax_ignore\" style=\"display:none;\">\\begin{equation*} T_{D}(s)^{\\prime }=\\displaystyle \\frac {1}{s L_{1}\\left ({L_{2}+L_{g}}\\right) C} \\frac {H_{i 2} K_{\\text {PWM}} e^{-1.5~s T_{s}} G_{R}(s)}{s^{2}+\\displaystyle \\frac {1}{C Z_{e q}(s)^{\\prime }}s+\\omega _{r}^{2}}.\\tag{31}\\end{equation*}\n</span></span></disp-formula></p><p>Due to the capacitor filter has less impact on the loop gain at or beyond the crossover frequency <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$f_{c}$\n</tex-math></inline-formula>, so the loop gain at <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$f_{c}$\n</tex-math></inline-formula> can be approximately as <disp-formula id=\"deqn32\" class=\"display-formula\"><tex-math notation=\"LaTeX\">\\begin{equation*} \\left |{ {T_{D}{{\\left ({{j2\\pi {f_{c}}} }\\right)}'}} }\\right | \\approx \\left |{ {\\displaystyle \\frac {{{H_{i2}}{K_{\\text {PWM}}}{G_{R}}\\left ({s }\\right)}}{{s\\left ({{L_{1} + {L_{2}}} }\\right)}}} }\\right |\\!.\\tag{32}\\end{equation*}\n</tex-math><span class=\"formula\"><span class=\"link\">View Source</span><img aria-describedby=\"qtip-0\" style=\"display:inline;\" title=\"Right-click on figure or equation for MathML and additional features.\" data-hasqtip=\"0\" class=\"qtooltip moreInfo\" alt=\"Right-click on figure for MathML and additional features.\" src=\"/assets/img/icon.support.gif\" border=\"0\" height=\"20\" width=\"24\"/><span class=\"tex tex2jax_ignore\" style=\"display:none;\">\\begin{equation*} \\left |{ {T_{D}{{\\left ({{j2\\pi {f_{c}}} }\\right)}'}} }\\right | \\approx \\left |{ {\\displaystyle \\frac {{{H_{i2}}{K_{\\text {PWM}}}{G_{R}}\\left ({s }\\right)}}{{s\\left ({{L_{1} + {L_{2}}} }\\right)}}} }\\right |\\!.\\tag{32}\\end{equation*}\n</span></span></disp-formula></p><p>Because <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$f_{c}$\n</tex-math></inline-formula> is far great than <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$f_{o}$\n</tex-math></inline-formula>, thus <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\left |{ G_{R}(j2\\pi {f_{c}}) }\\right | \\approx K_{p}$\n</tex-math></inline-formula> can be obtained. Substituting it and <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\left |{ {T_{D}{{\\left ({{j2\\pi {f_{c}}} }\\right)}^{\\prime }}} }\\right | = 1$\n</tex-math></inline-formula> into <a ref-type=\"disp-formula\" anchor=\"deqn32\" href=\"#deqn32\" class=\"fulltext-link\">(32)</a>, yields <disp-formula id=\"deqn33\" class=\"display-formula\"><tex-math notation=\"LaTeX\">\\begin{equation*} {K_{P}} \\approx \\displaystyle \\frac {{2\\pi {f_{c}}({L_{1}} + {L_{2}})}}{{{H_{i2}}{K_{\\text {PWM}}}}}.\\tag{33}\\end{equation*}\n</tex-math><span class=\"formula\"><span class=\"link\">View Source</span><img aria-describedby=\"qtip-0\" style=\"display:inline;\" title=\"Right-click on figure or equation for MathML and additional features.\" data-hasqtip=\"0\" class=\"qtooltip moreInfo\" alt=\"Right-click on figure for MathML and additional features.\" src=\"/assets/img/icon.support.gif\" border=\"0\" height=\"20\" width=\"24\"/><span class=\"tex tex2jax_ignore\" style=\"display:none;\">\\begin{equation*} {K_{P}} \\approx \\displaystyle \\frac {{2\\pi {f_{c}}({L_{1}} + {L_{2}})}}{{{H_{i2}}{K_{\\text {PWM}}}}}.\\tag{33}\\end{equation*}\n</span></span></disp-formula></p><p><inline-formula id=\"\"><tex-math notation=\"LaTeX\">$T_{fo}$\n</tex-math></inline-formula> is the loop gain at the fundamental frequency <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$f_{o}$\n</tex-math></inline-formula>, which is related to the steady state error. It can be derived as follow <disp-formula id=\"deqn34\" class=\"display-formula\"><tex-math notation=\"LaTeX\">\\begin{equation*} {T_{fo}} = 20\\lg \\displaystyle \\frac {{{H_{i2}}{K_{\\text {PWM}}}({K_{p}} + {K_{r}})}}{{2\\pi {f_{o}}\\left ({{L_{1} + {L_{2}}} }\\right)}}.\\tag{34}\\end{equation*}\n</tex-math><span class=\"formula\"><span class=\"link\">View Source</span><img aria-describedby=\"qtip-0\" style=\"display:inline;\" title=\"Right-click on figure or equation for MathML and additional features.\" data-hasqtip=\"0\" class=\"qtooltip moreInfo\" alt=\"Right-click on figure for MathML and additional features.\" src=\"/assets/img/icon.support.gif\" border=\"0\" height=\"20\" width=\"24\"/><span class=\"tex tex2jax_ignore\" style=\"display:none;\">\\begin{equation*} {T_{fo}} = 20\\lg \\displaystyle \\frac {{{H_{i2}}{K_{\\text {PWM}}}({K_{p}} + {K_{r}})}}{{2\\pi {f_{o}}\\left ({{L_{1} + {L_{2}}} }\\right)}}.\\tag{34}\\end{equation*}\n</span></span></disp-formula></p><p>Substituting <a ref-type=\"disp-formula\" anchor=\"deqn33\" href=\"#deqn33\" class=\"fulltext-link\">(33)</a> into <a ref-type=\"disp-formula\" anchor=\"deqn34\" href=\"#deqn34\" class=\"fulltext-link\">(34)</a>, the resonant gain of PR current controller under the constraint of <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$T_{fo}$\n</tex-math></inline-formula> is presented as <disp-formula id=\"deqn35\" class=\"display-formula\"><tex-math notation=\"LaTeX\">\\begin{equation*} {K_{r\\_{}{T_{fo}}}} = \\left({f_{o}{10^{\\frac {{{T_{fo}}}}{20}}} - {f_{c}}}\\right)\\displaystyle \\frac {{2\\pi ({L_{1}} + {L_{2}})}}{{{H_{i2}}{K_{\\text {PWM}}}}}.\\tag{35}\\end{equation*}\n</tex-math><span class=\"formula\"><span class=\"link\">View Source</span><img aria-describedby=\"qtip-0\" style=\"display:inline;\" title=\"Right-click on figure or equation for MathML and additional features.\" data-hasqtip=\"0\" class=\"qtooltip moreInfo\" alt=\"Right-click on figure for MathML and additional features.\" src=\"/assets/img/icon.support.gif\" border=\"0\" height=\"20\" width=\"24\"/><span class=\"tex tex2jax_ignore\" style=\"display:none;\">\\begin{equation*} {K_{r\\_{}{T_{fo}}}} = \\left({f_{o}{10^{\\frac {{{T_{fo}}}}{20}}} - {f_{c}}}\\right)\\displaystyle \\frac {{2\\pi ({L_{1}} + {L_{2}})}}{{{H_{i2}}{K_{\\text {PWM}}}}}.\\tag{35}\\end{equation*}\n</span></span></disp-formula></p><p>Since <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$f_{c}$\n</tex-math></inline-formula> is much higher than <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$f_{o}$\n</tex-math></inline-formula> and <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$f_{i}$\n</tex-math></inline-formula>, substituting <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$s=j\\omega {f_{c}}$\n</tex-math></inline-formula> into <a ref-type=\"disp-formula\" anchor=\"deqn3\" href=\"#deqn3\" class=\"fulltext-link\">(3)</a> can obtain <inline-formula id=\"\"><tex-math notation=\"LaTeX\">${G_{R}}\\left ({{j2\\pi {f_{c}}} }\\right) \\approx {K_{P}} + 2{K_{r}}{\\omega _{i}}/j2\\pi {f_{c}}$\n</tex-math></inline-formula>, then substituting it and <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$s=j\\omega {f_{c}}$\n</tex-math></inline-formula> into <a ref-type=\"disp-formula\" anchor=\"deqn31\" href=\"#deqn31\" class=\"fulltext-link\">(31)</a> with simplification, PM can be written as <disp-formula id=\"deqn36\" class=\"display-formula\"><tex-math notation=\"LaTeX\">\\begin{align*} \\mathrm {PM}=&amp;\\arctan \\frac { f_{c} H_{i 1} K_{\\mathrm {PWM}} B D+ \\pi L_{1}\\left ({f_{r}^{2}-f_{c}^{2}}\\right)\\left ({A^{2}+B^{2}}\\right)}{ f_{c} H_{i 1} K_{\\mathrm {PWM}} A D} \\\\&amp;-\\,3 \\pi f_{c} T_{s}-\\arctan \\frac {K_{r} \\omega _{i}}{\\pi f_{c} K_{p}}.\\tag{36}\\end{align*}\n</tex-math><span class=\"formula\"><span class=\"link\">View Source</span><img aria-describedby=\"qtip-0\" style=\"display:inline;\" title=\"Right-click on figure or equation for MathML and additional features.\" data-hasqtip=\"0\" class=\"qtooltip moreInfo\" alt=\"Right-click on figure for MathML and additional features.\" src=\"/assets/img/icon.support.gif\" border=\"0\" height=\"20\" width=\"24\"/><span class=\"tex tex2jax_ignore\" style=\"display:none;\">\\begin{align*} \\mathrm {PM}=&amp;\\arctan \\frac { f_{c} H_{i 1} K_{\\mathrm {PWM}} B D+ \\pi L_{1}\\left ({f_{r}^{2}-f_{c}^{2}}\\right)\\left ({A^{2}+B^{2}}\\right)}{ f_{c} H_{i 1} K_{\\mathrm {PWM}} A D} \\\\&amp;-\\,3 \\pi f_{c} T_{s}-\\arctan \\frac {K_{r} \\omega _{i}}{\\pi f_{c} K_{p}}.\\tag{36}\\end{align*}\n</span></span></disp-formula></p><p>According to <a ref-type=\"disp-formula\" anchor=\"deqn36\" href=\"#deqn36\" class=\"fulltext-link\">(36)</a>, the resonant gain of PR current controller under the restriction of PM can be derived as <a ref-type=\"disp-formula\" anchor=\"deqn37\" href=\"#deqn37\" class=\"fulltext-link\">(37)</a>, shown at the bottom of the page. \n<div class=\"figure figure-full\" id=\"\"><!--\n          Workaround for combined images.Eg.- 1000116 Fig. 5\n        --><div class=\"figcaption\"><b class=\"title\"> </b><fig/></div><p class=\"links\"><a href=\"/document/9973238/all-figures\" class=\"all\">Show All</a></p></div></p><p>Substituting <a ref-type=\"disp-formula\" anchor=\"deqn33\" href=\"#deqn33\" class=\"fulltext-link\">(33)</a> and <a ref-type=\"disp-formula\" anchor=\"deqn35\" href=\"#deqn35\" class=\"fulltext-link\">(35)</a> into <a ref-type=\"disp-formula\" anchor=\"deqn31\" href=\"#deqn31\" class=\"fulltext-link\">(31)</a>, the damping coefficient under the constraint of PM can be obtained as <a ref-type=\"disp-formula\" anchor=\"deqn38\" href=\"#deqn38\" class=\"fulltext-link\">(38)</a>, shown at the bottom of the page. \n<div class=\"figure figure-full\" id=\"\"><!--\n          Workaround for combined images.Eg.- 1000116 Fig. 5\n        --><div class=\"figcaption\"><b class=\"title\"> </b><fig/></div><p class=\"links\"><a href=\"/document/9973238/all-figures\" class=\"all\">Show All</a></p></div> As the analysis above, the loop gain at <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$f_{1}$\n</tex-math></inline-formula> and <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$f_{2}$\n</tex-math></inline-formula> should have enough gain margins. So, expressions can be given as <disp-formula id=\"deqn39-deqn40\" class=\"display-formula\"><tex-math notation=\"LaTeX\">\\begin{align*}&amp;\\begin{cases} \\displaystyle \\angle {T_{D}}(j2\\pi {f_{1}}) = - {180^{\\circ } }\\\\ \\displaystyle G{M_{1}} = - 20\\lg |{T_{D}}(j2\\pi {f_{1}})| \\end{cases}\\tag{39}\\\\&amp;\\begin{cases} \\displaystyle \\angle {T_{D}}(j2\\pi {f_{2}}) = - {180^{\\circ } }\\\\ \\displaystyle G{M_{2}} = - 20\\lg |{T_{D}}(j2\\pi {f_{2}})| \\end{cases}\\tag{40}\\end{align*}\n</tex-math><span class=\"formula\"><span class=\"link\">View Source</span><img aria-describedby=\"qtip-0\" style=\"display:inline;\" title=\"Right-click on figure or equation for MathML and additional features.\" data-hasqtip=\"0\" class=\"qtooltip moreInfo\" alt=\"Right-click on figure for MathML and additional features.\" src=\"/assets/img/icon.support.gif\" border=\"0\" height=\"20\" width=\"24\"/><span class=\"tex tex2jax_ignore\" style=\"display:none;\">\\begin{align*}&amp;\\begin{cases} \\displaystyle \\angle {T_{D}}(j2\\pi {f_{1}}) = - {180^{\\circ } }\\\\ \\displaystyle G{M_{1}} = - 20\\lg |{T_{D}}(j2\\pi {f_{1}})| \\end{cases}\\tag{39}\\\\&amp;\\begin{cases} \\displaystyle \\angle {T_{D}}(j2\\pi {f_{2}}) = - {180^{\\circ } }\\\\ \\displaystyle G{M_{2}} = - 20\\lg |{T_{D}}(j2\\pi {f_{2}})| \\end{cases}\\tag{40}\\end{align*}\n</span></span></disp-formula></p><p>According to <a ref-type=\"disp-formula\" anchor=\"deqn39-deqn40\" href=\"#deqn39-deqn40\" class=\"fulltext-link\">(39) and (40)</a>, <a ref-type=\"disp-formula\" anchor=\"deqn41-deqn42\" href=\"#deqn41-deqn42\" class=\"fulltext-link\">(41) and (42)</a> can be respectively derived, i.e., <a ref-type=\"disp-formula\" anchor=\"deqn41-deqn42\" href=\"#deqn41-deqn42\" class=\"fulltext-link\">(41) and (42)</a>, as shown at the bottom of the next page,\n<div class=\"figure figure-full\" id=\"\"><!--\n          Workaround for combined images.Eg.- 1000116 Fig. 5\n        --><div class=\"figcaption\"><b class=\"title\"> </b><fig/></div><p class=\"links\"><a href=\"/document/9973238/all-figures\" class=\"all\">Show All</a></p></div> where <disp-formula id=\"deqn43\" class=\"display-formula\"><tex-math notation=\"LaTeX\">\\begin{align*} \\begin{cases} \\displaystyle {Q_{1}} = \\displaystyle \\frac {{\\displaystyle \\frac {{K_{r}{\\omega _{i}}}}{{\\pi {f_{1}}{K_{p}}}} + \\tan (3\\pi {f_{1}}{T_{s}})}}{{1 - \\displaystyle \\frac {{K_{r}{\\omega _{i}}}}{{\\pi {f_{1}}{K_{p}}}}\\tan (3\\pi {f_{1}}{T_{s}})}}\\\\ \\displaystyle {Q_{2}} = \\displaystyle \\frac {{\\displaystyle \\frac {{K_{r}{\\omega _{i}}}}{{\\pi {f_{2}}{K_{p}}}} + \\tan (3\\pi {f_{2}}{T_{s}})}}{{1 - \\displaystyle \\frac {{K_{r}{\\omega _{i}}}}{{\\pi {f_{2}}{K_{p}}}}\\tan (3\\pi {f_{2}}{T_{s}})}}. \\end{cases}\\tag{43}\\end{align*}\n</tex-math><span class=\"formula\"><span class=\"link\">View Source</span><img aria-describedby=\"qtip-0\" style=\"display:inline;\" title=\"Right-click on figure or equation for MathML and additional features.\" data-hasqtip=\"0\" class=\"qtooltip moreInfo\" alt=\"Right-click on figure for MathML and additional features.\" src=\"/assets/img/icon.support.gif\" border=\"0\" height=\"20\" width=\"24\"/><span class=\"tex tex2jax_ignore\" style=\"display:none;\">\\begin{align*} \\begin{cases} \\displaystyle {Q_{1}} = \\displaystyle \\frac {{\\displaystyle \\frac {{K_{r}{\\omega _{i}}}}{{\\pi {f_{1}}{K_{p}}}} + \\tan (3\\pi {f_{1}}{T_{s}})}}{{1 - \\displaystyle \\frac {{K_{r}{\\omega _{i}}}}{{\\pi {f_{1}}{K_{p}}}}\\tan (3\\pi {f_{1}}{T_{s}})}}\\\\ \\displaystyle {Q_{2}} = \\displaystyle \\frac {{\\displaystyle \\frac {{K_{r}{\\omega _{i}}}}{{\\pi {f_{2}}{K_{p}}}} + \\tan (3\\pi {f_{2}}{T_{s}})}}{{1 - \\displaystyle \\frac {{K_{r}{\\omega _{i}}}}{{\\pi {f_{2}}{K_{p}}}}\\tan (3\\pi {f_{2}}{T_{s}})}}. \\end{cases}\\tag{43}\\end{align*}\n</span></span></disp-formula></p><p>Based on the above analysis, the design procedure is shown in <a ref-type=\"fig\" anchor=\"fig11\" class=\"fulltext-link\">Fig. 11</a>, which can be elaborated as follows\n<ol><li><p>Specify the requirements of <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$T_{fo}$\n</tex-math></inline-formula>, PM, GM<sub>1</sub>, GM<sub>2</sub>, and <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$f_{c}$\n</tex-math></inline-formula> for satisfying system steady-state error, phase margin, gain margin and control bandwidth. Then <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$K_{p}$\n</tex-math></inline-formula> and <inline-formula id=\"\"><tex-math notation=\"LaTeX\">${K_{r\\_{}{T_{fo}}}}$\n</tex-math></inline-formula> are obtained from <a ref-type=\"disp-formula\" anchor=\"deqn33\" href=\"#deqn33\" class=\"fulltext-link\">(33)</a> and <a ref-type=\"disp-formula\" anchor=\"deqn35\" href=\"#deqn35\" class=\"fulltext-link\">(35)</a>, respectively. It is noticed that the selection of <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$K_{r}$\n</tex-math></inline-formula> needs to be slightly larger than <inline-formula id=\"\"><tex-math notation=\"LaTeX\">${K_{r\\_{}{T_{fo}}}}$\n</tex-math></inline-formula> for reducing the effect of the reduction of fundamental frequency gain owing to the grid impedance variation.</p></li><li><p>According to <a ref-type=\"disp-formula\" anchor=\"deqn38\" href=\"#deqn38\" class=\"fulltext-link\">(38)</a>, <a ref-type=\"disp-formula\" anchor=\"deqn41-deqn42\" href=\"#deqn41-deqn42\" class=\"fulltext-link\">(41)</a>, and <a ref-type=\"disp-formula\" anchor=\"deqn41-deqn42\" href=\"#deqn41-deqn42\" class=\"fulltext-link\">(42)</a>, curves of <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$H_{i1}$\n</tex-math></inline-formula> against the variation of <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$L_{g}$\n</tex-math></inline-formula> can be obtained, and check if there is a selectable region that satisfies the requirements of PM, GM<sub>1</sub> and GM<sub>2</sub> vary with <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$L_{g}$\n</tex-math></inline-formula> over the entire region. If not, the specification of <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$f_{c}$\n</tex-math></inline-formula> or PM is too strict, and need to be adjusted.</p></li><li><p>Selecting <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$H_{i1}$\n</tex-math></inline-formula> from the acceptable region and substitute into <a ref-type=\"disp-formula\" anchor=\"deqn37\" href=\"#deqn37\" class=\"fulltext-link\">(37)</a>, and check if <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$K_{r}$\n</tex-math></inline-formula> is lower than <inline-formula id=\"\"><tex-math notation=\"LaTeX\">${K_{r\\_{}{\\text {PM}}}}$\n</tex-math></inline-formula>. If it is satisfied, the design is over. Otherwise, reduce <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$K_{r}$\n</tex-math></inline-formula> and iterate the design procedure.</p></li></ol>\n<div class=\"figure figure-full\" id=\"fig11\"><!--\n          Workaround for combined images.Eg.- 1000116 Fig. 5\n        --><div class=\"img-wrap\"><a href=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973238/li11-3227391-large.gif\" data-fig-id=\"fig11\"><img src=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973238/li11-3227391-small.gif\" alt=\"FIGURE 11. - Flow chart of the design procedure.\"/><div class=\"zoom\" title=\"View Larger Image\"/></a></div><div class=\"figcaption\"><b class=\"title\">FIGURE 11. </b><fig><p>Flow chart of the design procedure.</p></fig></div><p class=\"links\"><a href=\"/document/9973238/all-figures\" class=\"all\">Show All</a></p></div></p></div><div class=\"section_2\" id=\"sec4d\"><h3>D. Design Example</h3><p>For better verifying the effectiveness of the above parameters design procedure and the proposed delay compensation method, a design example is illustrated. <a ref-type=\"table\" anchor=\"table2\" class=\"fulltext-link\">Table 2</a> gives the main parameters of a 2kW single-phase <i>LCL</i>-Type grid-connected inverter.<div class=\"figure figure-full table\" id=\"table2\"><div class=\"figcaption\"><b class=\"title\">TABLE 2 </b>\nSystems Parameters</div><div class=\"img-wrap\"><a href=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973238/li.t2-3227391-large.gif\"><img src=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973238/li.t2-3227391-small.gif\" alt=\"Table 2- &#10;Systems Parameters\"/><div class=\"zoom\" title=\"View Larger Image\"/></a></div></div></p><p>According to the aforementioned design procedure, step 1 is to specify the desired parameter as <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$T_{fo}&gt;73{\\text {dB}}$\n</tex-math></inline-formula>, <inline-formula id=\"\"><tex-math notation=\"LaTeX\">${\\text {PM}}&gt;45^{\\circ }$\n</tex-math></inline-formula>, <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\text {GM}_{1}&gt;3{\\text {dB}}$\n</tex-math></inline-formula> and <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\text {GM}_{2} &lt; 3{\\text {dB}}$\n</tex-math></inline-formula>. The <i>LCL</i> filter with resonance frequency <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$f_{r}=6.5{\\text {kHz}}$\n</tex-math></inline-formula> is applied and the initial <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$f_{c}$\n</tex-math></inline-formula> is set as 1300Hz. According to <a ref-type=\"disp-formula\" anchor=\"deqn33\" href=\"#deqn33\" class=\"fulltext-link\">(33)</a> and <a ref-type=\"disp-formula\" anchor=\"deqn35\" href=\"#deqn35\" class=\"fulltext-link\">(35)</a>, <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$K_{p}$\n</tex-math></inline-formula> and <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$K_{r\\_{}{T_{fo}}}$\n</tex-math></inline-formula> can be respectively calculated as 0.85 and 147, for reducing the impact of the weak grid on the fundamental frequency gain, <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$K_{r}$\n</tex-math></inline-formula> is taken as 170.</p><p>Due to <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$f_{1}$\n</tex-math></inline-formula> and <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$f_{2}$\n</tex-math></inline-formula> cannot accurately obtain, so two three-dimensional graphs of <a ref-type=\"disp-formula\" anchor=\"deqn41-deqn42\" href=\"#deqn41-deqn42\" class=\"fulltext-link\">equation (41)</a> can be drawn in <a ref-type=\"fig\" anchor=\"fig12\" class=\"fulltext-link\">Fig. 12</a>. In the three-dimensional coordinate system with <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$L_{g}$\n</tex-math></inline-formula> as the x-axis, <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$f_{1}$\n</tex-math></inline-formula> as the y-axis, and <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$H_{i1}$\n</tex-math></inline-formula> as the z-axis. Next, the common line of the three-dimensional graphs is projected onto the xoz plane. This projection is the curve of <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$H_{i1}$\n</tex-math></inline-formula> under the constraint of GM<sub>1</sub> with the variation of <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$L_{g}$\n</tex-math></inline-formula>. In this way, the curve of <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$H_{i1}$\n</tex-math></inline-formula> under the constraint of GM<sub>2</sub> with the variation of <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$L_{g}$\n</tex-math></inline-formula> can also be obtained. By using <a ref-type=\"disp-formula\" anchor=\"deqn38\" href=\"#deqn38\" class=\"fulltext-link\">(38)</a>, <a ref-type=\"disp-formula\" anchor=\"deqn41-deqn42\" href=\"#deqn41-deqn42\" class=\"fulltext-link\">(41) and (42)</a>, curves of <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$H_{i1}$\n</tex-math></inline-formula> varying with <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$L_{g}$\n</tex-math></inline-formula> from 0 to 1.93mH constrained by PM, GM<sub>1</sub> and GM<sub>2</sub> can be obtained in <a ref-type=\"fig\" anchor=\"fig13\" class=\"fulltext-link\">Fig. 13</a>. It can be seen that the acceptable range of <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$H_{i1}$\n</tex-math></inline-formula> ranges from 0.0118 to 0.0135, so <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$H_{i1}=0.013$\n</tex-math></inline-formula> is selected. Substituting <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$H_{i1}$\n</tex-math></inline-formula> into <a ref-type=\"disp-formula\" anchor=\"deqn37\" href=\"#deqn37\" class=\"fulltext-link\">(37)</a>, the <inline-formula id=\"\"><tex-math notation=\"LaTeX\">${K_{r\\_{}{\\text {PM}}}}=189$\n</tex-math></inline-formula> can be calculated, and <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$K_{r} &lt; {K_{r\\_{}{\\text {PM}}}}$\n</tex-math></inline-formula> is satisfied.\n<div class=\"figure figure-full\" id=\"fig12\"><!--\n          Workaround for combined images.Eg.- 1000116 Fig. 5\n        --><div class=\"img-wrap\"><a href=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973238/li12-3227391-large.gif\" data-fig-id=\"fig12\"><img src=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973238/li12-3227391-small.gif\" alt=\"FIGURE 12. - Relationships between &#10;$L_{g}$&#10;, &#10;$GM_{1}$&#10; and &#10;$H_{i1}$&#10;.\"/><div class=\"zoom\" title=\"View Larger Image\"/></a></div><div class=\"figcaption\"><b class=\"title\">FIGURE 12. </b><fig><p>Relationships between <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$L_{g}$\n</tex-math></inline-formula>, <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$GM_{1}$\n</tex-math></inline-formula> and <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$H_{i1}$\n</tex-math></inline-formula>.</p></fig></div><p class=\"links\"><a href=\"/document/9973238/all-figures\" class=\"all\">Show All</a></p></div>\n<div class=\"figure figure-full\" id=\"fig13\"><!--\n          Workaround for combined images.Eg.- 1000116 Fig. 5\n        --><div class=\"img-wrap\"><a href=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973238/li13-3227391-large.gif\" data-fig-id=\"fig13\"><img src=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973238/li13-3227391-small.gif\" alt=\"FIGURE 13. - Curves of &#10;$H_{i1}$&#10; against varying &#10;$L_{g}$&#10; constrained by PM, &#10;$GM_{1}$&#10; and &#10;$GM_{2}$&#10;.\"/><div class=\"zoom\" title=\"View Larger Image\"/></a></div><div class=\"figcaption\"><b class=\"title\">FIGURE 13. </b><fig><p>Curves of <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$H_{i1}$\n</tex-math></inline-formula> against varying <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$L_{g}$\n</tex-math></inline-formula> constrained by PM, <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$GM_{1}$\n</tex-math></inline-formula> and <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$GM_{2}$\n</tex-math></inline-formula>.</p></fig></div><p class=\"links\"><a href=\"/document/9973238/all-figures\" class=\"all\">Show All</a></p></div></p><p>With the parameters given in <a ref-type=\"table\" anchor=\"table2\" class=\"fulltext-link\">Table 2</a>, the close-loop pole maps with the grid impedance variation before and after compensation are shown in <a ref-type=\"fig\" anchor=\"fig14\" class=\"fulltext-link\">Fig. 14(a)</a> and <a ref-type=\"fig\" anchor=\"fig14\" class=\"fulltext-link\">Fig. 14(b)</a>, respectively. As shown in <a ref-type=\"fig\" anchor=\"fig14\" class=\"fulltext-link\">Fig. 14(a)</a>, the close poles will move outside the unit circle when grid impedance varies from <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$250~\\mu {\\text {H}}$\n</tex-math></inline-formula> to 1.05mH, which fall into the resonance frequency forbidden region. When the proposed delay compensation is adopted, the resonance frequency forbidden region is eliminated. So the close poles shown in <a ref-type=\"fig\" anchor=\"fig14\" class=\"fulltext-link\">Fig. 14(b)</a> can be trapped within the unit circle, which verifies the feasibility of the parameters design and the effectiveness of the proposed delay compensation method.\n<div class=\"figure figure-full\" id=\"fig14\"><!--\n          Workaround for combined images.Eg.- 1000116 Fig. 5\n        --><div class=\"img-wrap\"><a href=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973238/li14ab-3227391-large.gif\" data-fig-id=\"fig14\"><img src=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973238/li14ab-3227391-small.gif\" alt=\"FIGURE 14. - Close-loop pole maps with the grid impedance variation. (a) Before compensation (b) After compensation.\"/><div class=\"zoom\" title=\"View Larger Image\"/></a></div><div class=\"figcaption\"><b class=\"title\">FIGURE 14. </b><fig><p>Close-loop pole maps with the grid impedance variation. (a) Before compensation (b) After compensation.</p></fig></div><p class=\"links\"><a href=\"/document/9973238/all-figures\" class=\"all\">Show All</a></p></div></p><p>The Bode diagrams of the loop gain against <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$L_{g}=250~\\mu {\\text {H}}$\n</tex-math></inline-formula> with and without delay compensation can be shown in <a ref-type=\"fig\" anchor=\"fig15\" class=\"fulltext-link\">Fig. 15</a>. Before compensation, the actual resonance frequency falls into the resonance frequency region and the gain margin are respectively <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\text {GM}_{1}=8.21{\\text {dB}}$\n</tex-math></inline-formula> and <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\text {GM}_{2}=0.2{\\text {dB}}$\n</tex-math></inline-formula>, which is not stable due to the inadequate stability margin. Then, the open-loop unstable poles is removed owing to the extension of the positive equivalent resistance region. So, just one \u2212180\u00b0 crossing exists, and corresponding gain margin is <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\text {GM}_{1}=4.76{\\text {dB}}$\n</tex-math></inline-formula>. In <a ref-type=\"fig\" anchor=\"fig15\" class=\"fulltext-link\">Fig. 15</a>, the <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$f_{c}=1300$\n</tex-math></inline-formula>Hz and PM = 45\u00b0 are clearly identified. Therefore, the control system has a good control performance after compensation.\n<div class=\"figure figure-full\" id=\"fig15\"><!--\n          Workaround for combined images.Eg.- 1000116 Fig. 5\n        --><div class=\"img-wrap\"><a href=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973238/li15-3227391-large.gif\" data-fig-id=\"fig15\"><img src=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973238/li15-3227391-small.gif\" alt=\"FIGURE 15. - Bode diagrams of the open loop gain against &#10;$L_{g}=250~\\mu {\\text {H}}$&#10; with and without compensation.\"/><div class=\"zoom\" title=\"View Larger Image\"/></a></div><div class=\"figcaption\"><b class=\"title\">FIGURE 15. </b><fig><p>Bode diagrams of the open loop gain against <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$L_{g}=250~\\mu {\\text {H}}$\n</tex-math></inline-formula> with and without compensation.</p></fig></div><p class=\"links\"><a href=\"/document/9973238/all-figures\" class=\"all\">Show All</a></p></div></p></div></div>\n<div class=\"section\" id=\"sec5\"><div class=\"header article-hdr\"><div class=\"kicker\">\n\t\t                        SECTION V.</div><h2>Experimental Results</h2></div><p>To confirm the effectiveness of the proposed method, a 2-kW experimental set up is constructed, which is shown in <a ref-type=\"fig\" anchor=\"fig16\" class=\"fulltext-link\">Fig. 16</a>. The main parameters are given in <a ref-type=\"table\" anchor=\"table2\" class=\"fulltext-link\">Table 2</a> and the controller is implemented in a TI TMS320C28346 DSP. Furthermore, the grid impedance <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$L_{g}$\n</tex-math></inline-formula> is emulated by an external inductor.\n<div class=\"figure figure-full\" id=\"fig16\"><!--\n          Workaround for combined images.Eg.- 1000116 Fig. 5\n        --><div class=\"img-wrap\"><a href=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973238/li16-3227391-large.gif\" data-fig-id=\"fig16\"><img src=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973238/li16-3227391-small.gif\" alt=\"FIGURE 16. - Configuration of the experimental setup.\"/><div class=\"zoom\" title=\"View Larger Image\"/></a></div><div class=\"figcaption\"><b class=\"title\">FIGURE 16. </b><fig><p>Configuration of the experimental setup.</p></fig></div><p class=\"links\"><a href=\"/document/9973238/all-figures\" class=\"all\">Show All</a></p></div></p><p>In order to make a straightforward comparison, the experimental waveform is altered from one method to another one. The experimental waveforms when altering from <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$G_{c}(z)$\n</tex-math></inline-formula> to <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$G_{c}(z)^{\\prime }$\n</tex-math></inline-formula> is shown in <a ref-type=\"fig\" anchor=\"fig17\" class=\"fulltext-link\">Fig. 17</a>. As shown, the grid-side current is significantly distorted due to the noise amplification while the current is stable when alternation is occurred, which is agree with <a ref-type=\"fig\" anchor=\"fig7\" class=\"fulltext-link\">Fig. 7</a>. The noise amplification is effectively reduced when the digital low filter is added. Furthermore, <a ref-type=\"fig\" anchor=\"fig18\" class=\"fulltext-link\">Fig. 18</a> presents the experimental results when altering from the proposed method to the conventional CCF damping method against different grid impedance, in which <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$v_{\\text {PCC}}$\n</tex-math></inline-formula> presents the PCC voltage and <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$i_{g}$\n</tex-math></inline-formula> presents the grid-side current. As seen, when <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$L_{g}=0$\n</tex-math></inline-formula>, the inverter remains stable with either the proposed method or the conventional CCF damping method. However, when the damping method altering from the proposed method to the conventional CCF damping method under <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$L_{g}=250~\\mu \\text{H}$\n</tex-math></inline-formula> or 1.05mH, which <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$f_{r}^{\\prime }$\n</tex-math></inline-formula> falls into the resonance frequency forbidden region. The grid-side current and the PCC voltage arise significantly oscillation and further trigger protection. Moreover, when <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$L_{g}=1.93{\\text {m}}\\text{H}$\n</tex-math></inline-formula>, the actual resonance frequency is away from the resonance frequency forbidden region. So, the inverter is constantly stable. The experimental results are consistent with the analysis given in <a ref-type=\"sec\" anchor=\"sec4\" class=\"fulltext-link\">Section IV</a>. Thus, it is meaning that the proposed delay compensation method can improve the <i>LCL</i>-Type grid-connected inverter robustness against the grid impedance variation and significantly relieve the noise amplification.\n<div class=\"figure figure-full\" id=\"fig17\"><!--\n          Workaround for combined images.Eg.- 1000116 Fig. 5\n        --><div class=\"img-wrap\"><a href=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973238/li17-3227391-large.gif\" data-fig-id=\"fig17\"><img src=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973238/li17-3227391-small.gif\" alt=\"FIGURE 17. - Experimental results when altering from &#10;$G_{c}(z)$&#10; to &#10;$G_{c}(z)^{\\prime }$&#10;.\"/><div class=\"zoom\" title=\"View Larger Image\"/></a></div><div class=\"figcaption\"><b class=\"title\">FIGURE 17. </b><fig><p>Experimental results when altering from <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$G_{c}(z)$\n</tex-math></inline-formula> to <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$G_{c}(z)^{\\prime }$\n</tex-math></inline-formula>.</p></fig></div><p class=\"links\"><a href=\"/document/9973238/all-figures\" class=\"all\">Show All</a></p></div>\n<div class=\"figure figure-full\" id=\"fig18\"><!--\n          Workaround for combined images.Eg.- 1000116 Fig. 5\n        --><div class=\"img-wrap\"><a href=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973238/li18abcd-3227391-large.gif\" data-fig-id=\"fig18\"><img src=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973238/li18abcd-3227391-small.gif\" alt=\"FIGURE 18. - Experimental results when altering from the proposed method to the conventional CCF damping method. (a) &#10;$L_{g}=0$&#10; (b) &#10;$L_{g}=250~\\mu {\\text {H}}$&#10; (&#10;$c$&#10;) &#10;$L_{g}=1.05$&#10;mH (d) &#10;$L_{g}=1.93$&#10;mH.\"/><div class=\"zoom\" title=\"View Larger Image\"/></a></div><div class=\"figcaption\"><b class=\"title\">FIGURE 18. </b><fig><p>Experimental results when altering from the proposed method to the conventional CCF damping method. (a) <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$L_{g}=0$\n</tex-math></inline-formula> (b) <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$L_{g}=250~\\mu {\\text {H}}$\n</tex-math></inline-formula> (<inline-formula id=\"\"><tex-math notation=\"LaTeX\">$c$\n</tex-math></inline-formula>) <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$L_{g}=1.05$\n</tex-math></inline-formula>mH (d) <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$L_{g}=1.93$\n</tex-math></inline-formula>mH.</p></fig></div><p class=\"links\"><a href=\"/document/9973238/all-figures\" class=\"all\">Show All</a></p></div></p><p>For verifying the feasibility of the parameters design procedure given in <a ref-type=\"sec\" anchor=\"sec4\" class=\"fulltext-link\">Section IV</a>. The experimental results with the proposed method when the grid current reference <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$i_{\\text {ref}}$\n</tex-math></inline-formula> step between half- and full-load against different grid impedance is shown in <a ref-type=\"fig\" anchor=\"fig19\" class=\"fulltext-link\">Fig. 19</a>. To exhibit the worst situation, the step action is occurred at the peak of <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$i_{g}$\n</tex-math></inline-formula>. As seen, the inverter features good dynamic performance and stability with the grid impedance varies from 0 to 1.93mH. The experimental results demonstrate that the parameters design procedure is valid.\n<div class=\"figure figure-full\" id=\"fig19\"><!--\n          Workaround for combined images.Eg.- 1000116 Fig. 5\n        --><div class=\"img-wrap\"><a href=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973238/li19abcd-3227391-large.gif\" data-fig-id=\"fig19\"><img src=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973238/li19abcd-3227391-small.gif\" alt=\"FIGURE 19. - Experimental results with the proposed method when the grid current changes between half- and full-load. (a) &#10;$L_{g}=0$&#10; (b) &#10;$L_{g}=250~\\mu {\\text {H}}$&#10; (&#10;$c$&#10;) &#10;$L_{g}=1.05$&#10;mH (d) &#10;$L_{g}=1.93$&#10;mH.\"/><div class=\"zoom\" title=\"View Larger Image\"/></a></div><div class=\"figcaption\"><b class=\"title\">FIGURE 19. </b><fig><p>Experimental results with the proposed method when the grid current changes between half- and full-load. (a) <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$L_{g}=0$\n</tex-math></inline-formula> (b) <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$L_{g}=250~\\mu {\\text {H}}$\n</tex-math></inline-formula> (<inline-formula id=\"\"><tex-math notation=\"LaTeX\">$c$\n</tex-math></inline-formula>) <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$L_{g}=1.05$\n</tex-math></inline-formula>mH (d) <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$L_{g}=1.93$\n</tex-math></inline-formula>mH.</p></fig></div><p class=\"links\"><a href=\"/document/9973238/all-figures\" class=\"all\">Show All</a></p></div></p></div>\n<div class=\"section\" id=\"sec6\"><div class=\"header article-hdr\"><div class=\"kicker\">\n\t\t                        SECTION VI.</div><h2>Conclusion</h2></div><p>Owing to the digital control delay effect, the <i>LCL</i>-Type grid-connected inverter with the CCF active damping is apt to be unstable when the grid impedance varies in a wide range. To address this issue, this paper proposes an improved delay compensation method which is inserting a phase-lead compensator with a digital low-pass filter into the CCF path. Accordingly, the boundary frequency of the positive equivalent resistance region is boosted from <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$f_{s}/6$\n</tex-math></inline-formula> to <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$f_{s}/4$\n</tex-math></inline-formula> and the resonance frequency forbidden region is completely eliminated, which the inverter robustness against the grid impedance variation is enhanced. Moreover, the improved phase-lead compensator provides both substantial phase compensation and does not introduce excessive amplitude gain in the high frequency domain, which relieves the noise amplification. For obtaining good control performance of the inverter, a parameters design procedure is further presented. Finally, a 2kW prototype is built and the experimental results verify the validity of the theoretical analysis and the proposed method.</p></div>\n</div></div></response>\n"
}