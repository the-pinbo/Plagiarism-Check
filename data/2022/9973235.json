{
    "abstract": "Beamforming, user scheduling and transmit power on existing interference management schemes in multi-cell mmWave networks have been independently controlled due to the high computational complexity of the problem. In this paper, we formulate a long-term utility maximization problem where beam activation, user scheduling and transmit power are incorporated in a single framework. To develop a low-co...",
    "articleNumber": "9973235",
    "articleTitle": "Three Steps Toward Low-Complexity: Practical Interference Management in NOMA-Based mmWave Networks",
    "authors": [
        {
            "preferredName": "Joonpyo Hong",
            "normalizedName": "J. Hong",
            "firstName": "Joonpyo",
            "lastName": "Hong",
            "searchablePreferredName": "Joonpyo Hong"
        },
        {
            "preferredName": "Pildo Yoon",
            "normalizedName": "P. Yoon",
            "firstName": "Pildo",
            "lastName": "Yoon",
            "searchablePreferredName": "Pildo Yoon"
        },
        {
            "preferredName": "Suyoung Ahn",
            "normalizedName": "S. Ahn",
            "firstName": "Suyoung",
            "lastName": "Ahn",
            "searchablePreferredName": "Suyoung Ahn"
        },
        {
            "preferredName": "Yunhee Cho",
            "normalizedName": "Y. Cho",
            "firstName": "Yunhee",
            "lastName": "Cho",
            "searchablePreferredName": "Yunhee Cho"
        },
        {
            "preferredName": "Jeehyeon Na",
            "normalizedName": "J. Na",
            "firstName": "Jeehyeon",
            "lastName": "Na",
            "searchablePreferredName": "Jeehyeon Na"
        },
        {
            "preferredName": "Jeongho Kwak",
            "normalizedName": "J. Kwak",
            "firstName": "Jeongho",
            "lastName": "Kwak",
            "searchablePreferredName": "Jeongho Kwak"
        }
    ],
    "doi": "10.1109/ACCESS.2022.3227444",
    "publicationTitle": "IEEE Access",
    "publicationYear": "2022",
    "publicationVolume": null,
    "publicationIssue": null,
    "volume": "10",
    "issue": null,
    "documentLink": "/document/9973235/",
    "xml": "<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<div id=\"BodyWrapper\" class=\"ArticlePage\" xmlns:ieee=\"http://www.ieeexplore.ieee.org\"><div id=\"article\">\n<div class=\"section\" id=\"sec1\"><div class=\"header article-hdr\"><div class=\"kicker\">\n\t\t                        SECTION I.</div><h2>Introduction</h2></div><p>As UHD (Ultra High Definition) video streaming or MR (Mixed Reality) services have been emerging as killer applications in 5G+/6G, mobile data traffic has been drastically increasing <a ref-type=\"bibr\" anchor=\"ref1\" id=\"context_ref_1_1\">[1]</a>. To cope with such exploding traffic, various communication technologies such as massive MIMO (Multiple Input Multiple Output) <a ref-type=\"bibr\" anchor=\"ref2\" id=\"context_ref_2_1\">[2]</a>, CoMP (Cooperative MultiPoint) <a ref-type=\"bibr\" anchor=\"ref3\" id=\"context_ref_3_1\">[3]</a>, UDN (Ultra Dense Networks) <a ref-type=\"bibr\" anchor=\"ref4\" id=\"context_ref_4_1\">[4]</a>, and NOMA (Non-Orthogonal Multiple Access) <a ref-type=\"bibr\" anchor=\"ref5\" id=\"context_ref_5_1\">[5]</a> have been recently developed. Besides, mmWave has been regarded as a promising frequency band for future communication systems thanks to its significantly wide bandwidth. On the other hand, mmWave has a limited range and is susceptible to blockage due to its high frequency and short wavelength characteristics. Consequently, mmWave communication for long-distance cellular access is problematic, but it provides a great opportunity for small cells aiming to support short-range communication with high traffic demand <a ref-type=\"bibr\" anchor=\"ref6\" id=\"context_ref_6_1\">[6]</a>.</p><p>Reducing cell size (equivalently, deploying more BSs (Base Station)) can be one of the ways to enhance the entire network throughput in the same area. However, such a small cell network is likely to increase both the strength and the variation of the inter-cell interference due to the shorter distance between cells and more heterogeneous cell deployment <a ref-type=\"bibr\" anchor=\"ref7\" id=\"context_ref_7_1\">[7]</a>. Accordingly, an efficient and adaptive inter-cell (and intra-cell) interference mitigation policy must be devised to improve the network throughput.</p><p>There have been many studies on IM (Interference Management) in a multi-cell single antenna system <a ref-type=\"bibr\" anchor=\"ref8\" id=\"context_ref_8_1\">[8]</a>, <a ref-type=\"bibr\" anchor=\"ref9\" id=\"context_ref_9_1\">[9]</a>. Since the utility maximization problem to jointly make decisions of transmit power and user scheduling for all BSs is an MINLP (Mixed-Integer NonLinear Programming), most studies focused on the development of approximation algorithms by reducing the computational complexity. For example, Xiao et al. <a ref-type=\"bibr\" anchor=\"ref8\" id=\"context_ref_8_1\">[8]</a> proposed an algorithm based on the game theory where each BS belongs to more than one cluster, and considered only intra-cluster interference to make decisions of user scheduling and transmit powers. Moreover, Liu et al. <a ref-type=\"bibr\" anchor=\"ref9\" id=\"context_ref_9_1\">[9]</a> managed interference by decomposing it into cross-tier/co-tier interference to reduce the complexity and by allocating resources separately for utility maximization.</p><p>Meanwhile, as an enhanced interference mitigation technique, the MIMO system was proposed to form a directional beam which can focus the signal on a specific point so that it reduces the loss of the spreading signal <a ref-type=\"bibr\" anchor=\"ref2\" id=\"context_ref_2_1\">[2]</a>. Thanks to this advantage, many IM schemes on top of the MIMO system have been proposed <a ref-type=\"bibr\" anchor=\"ref10\" id=\"context_ref_10_1\">[10]</a>, <a ref-type=\"bibr\" anchor=\"ref11\" id=\"context_ref_11_1\">[11]</a>. However, although the MIMO system can mitigate the inter-cell interference significantly, joint optimization of beamforming, user scheduling and transmit power control has high computational complexity. Therefore, there have been many studies on the development of low-complex and practical algorithms rather than theoretically-optimal algorithms <a ref-type=\"bibr\" anchor=\"ref10\" id=\"context_ref_10_1\">[10]</a>, <a ref-type=\"bibr\" anchor=\"ref11\" id=\"context_ref_11_1\">[11]</a>. For example, Cui et al. <a ref-type=\"bibr\" anchor=\"ref10\" id=\"context_ref_10_1\">[10]</a> proposed a joint user scheduling and power control algorithm with ORBF (Orthogonal Random BeamForming) technique to reduce the computational complexity where the solution strikes a good computational complexity-optimality trade-off by exploiting the matching theory and successive convex approximation techniques. Moreover, Song et al. <a ref-type=\"bibr\" anchor=\"ref11\" id=\"context_ref_11_1\">[11]</a> proposed a multi-beams prioritized transmit power allocation algorithm to guarantee the QoS (Quality of Service) of users and improve the achievable data rate while intra-cell interference is ignored for low complexity.</p><p>One step further, by incorporating NOMA in the MIMO system, it is possible to schedule more than two users in the same beam thanks to SC (Superposition Coding) and SIC (Successive Interference Cancellation) so that the sum capacity for one beam can be increased <a ref-type=\"bibr\" anchor=\"ref13\" id=\"context_ref_13_1\">[13]</a>. There have been a few works to address IM on top of this NOMA-based MIMO system <a ref-type=\"bibr\" anchor=\"ref14\" id=\"context_ref_14_1\">[14]</a>, <a ref-type=\"bibr\" anchor=\"ref15\" id=\"context_ref_15_1\">[15]</a>. For example, Fang et al. <a ref-type=\"bibr\" anchor=\"ref15\" id=\"context_ref_15_1\">[15]</a> proposed a two-side matching theory-based subchannel assignment and power control algorithm where the objective is to maximize energy efficiency. <i>However, they assumed that the number of allocated users for one beam is up to two users.</i></p><p>Although they provided several IM solutions to enhance the system performance, the existing works in small cell systems have two obstacles as follows: <i>(i)</i> The number of BSs to be managed by one BS controller gets higher as the cell size becomes smaller; hence more low-complexity IM is required. <i>(ii)</i> The inter-cell interference becomes higher due to the shorter distance between cells; hence more efficient transmit power management is required. To overcome these obstacles, we exploit features of future network as follows.</p><p>Future 6G networks are likely not only to be reluctant to manage a lot of BSs in a single BS controller due to the reduced cell size but also pervasively deploy the MEC (Multi-access Edge Computing) servers attached to BSs <a ref-type=\"bibr\" anchor=\"ref16\" id=\"context_ref_16_1\">[16]</a>. Hence, the hierarchical cellular architecture is expected where one MEC server manages a small number of physically close BSs whereas a cloud server manages such MEC servers with a long time scale as shown in <a ref-type=\"fig\" anchor=\"fig1\" class=\"fulltext-link\">Fig. 1</a> <a ref-type=\"bibr\" anchor=\"ref17\" id=\"context_ref_17_1\">[17]</a>. A single MEC server can manage a small number of multiple BSs within a short range (e.g., 1km radius of the circle) via a rapid fronthaul interface (e.g., X2 interface <a ref-type=\"bibr\" anchor=\"ref18\" id=\"context_ref_18_1\">[18]</a>); hence it would be possible to share the parameters required for cellular operations in real-time. Moreover, since a smart grid system is known to be able to measure the power usage and manage the power supply in real-time within approximately 1km coverage <a ref-type=\"bibr\" anchor=\"ref7\" id=\"context_ref_7_1\">[7]</a>, a single MEC server would be able to manage the transmit power of BSs in real-time as well. This fact enables an MEC server to manage the long-term transmit power budget, which leads to the flexible adaptation of transmit powers to the spatio-temporally varying interference environment.\n<div class=\"figure figure-full\" id=\"fig1\"><!--\n          Workaround for combined images.Eg.- 1000116 Fig. 5\n        --><div class=\"img-wrap\"><a href=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973235/kwak1-3227444-large.gif\" data-fig-id=\"fig1\"><img src=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973235/kwak1-3227444-small.gif\" alt=\"FIGURE 1. - An illustration of the considered network architecture.\"/><div class=\"zoom\" title=\"View Larger Image\"/></a></div><div class=\"figcaption\"><b class=\"title\">FIGURE 1. </b><fig><p>An illustration of the considered network architecture.</p></fig></div><p class=\"links\"><a href=\"/document/9973235/all-figures\" class=\"all\">Show All</a></p></div></p><p>Accordingly, in this paper, we propose the <i>CRIM</i> (CRitical user based Interference Management) algorithm on top of the future 6G network architecture in which each MEC server controls a small set of BSs in a centralized manner while exchanging the lowest amount of feedback information with each other in a decentralized manner. Specifically, <i>CRIM</i> has the following characteristics: <i>(i)</i> It reduces the computational complexity by sequentially solving beam activation, user scheduling, and power allocation subproblems. <i>(ii)</i> It utilizes the critical user concept, which considers only the highest victim of the interference when making a decision of the transmit power. <i>(iii)</i> It spatio-temporally shares the transmit powers of BSs managed by a single MEC server. To this end, we first formulate a long-term utility maximization problem constrained by a time-average transmit power to each MEC server to make decisions of beam activation, user scheduling, and transmit power every time slot. Since the optimal solution of the original problem probably has extremely high computational complexity, we decompose the original problem into two subproblems with different time scales where the solution of the beam activation runs on a slower time scale than that of the user scheduling and transmit power allocation problem. Besides, we apply Lyapunov DMU (Drift-Minus-Utility framework) <a ref-type=\"bibr\" anchor=\"ref19\" id=\"context_ref_19_1\">[19]</a> to the subproblems so that they are solved every time slot without loss of optimality. However, the transformed subproblems are still known as NP-hard; hence we introduce the intuitive idea, namely inner and outer reference users to optimize the transmit power with low computational complexity.</p><p>The contributions of this paper are summarized as follows.\n<ol><li><p>We formulate beam selection, user scheduling, and transmit power allocation problems on top of future network architecture with MEC aiming to maximize the time-averaged sum of utilities of users.</p></li><li><p>We propose a low-complex sequential beam selection, user scheduling, and transmit power allocation algorithm, namely <i>CRIM</i> where the low-complexity comes from three steps of approximations as follows. The first step is the decomposition of time scales between beam selection and the user scheduling/transmit power allocation. The second step is to cut the loop among the beam selection, user scheduling and transmit power allocation. The third step is to introduce two virtual queues (i.e., power sharing queue and fairness queue) and the critical user concept.</p></li><li><p>Extensive simulations based on the real mmWave standard parameters demonstrate that the proposed <i>CRIM</i> algorithm outperforms the existing algorithms up to 47.4% in terms of utility.</p></li></ol></p><p>In the rest of this paper, we begin with the system model in <a ref-type=\"sec\" anchor=\"sec2\" class=\"fulltext-link\">section II</a>. Next, in <a ref-type=\"sec\" anchor=\"sec3\" class=\"fulltext-link\">Section III</a>, we formulate the optimization problem and propose the CRIM algorithm. Then, in <a ref-type=\"sec\" anchor=\"sec4\" class=\"fulltext-link\">Section IV</a>, we evaluate the CRIM algorithm by extensive simulation. Finally, we conclude this paper in <a ref-type=\"sec\" anchor=\"sec5\" class=\"fulltext-link\">Section V</a>.</p></div>\n<div class=\"section\" id=\"sec2\"><div class=\"header article-hdr\"><div class=\"kicker\">\n\t\t                        SECTION II.</div><h2>System Model</h2></div><div class=\"section_2\" id=\"sec2a\"><h3>A. Network Model</h3><p>We consider a mmWave small cell network architecture where a small number of BSs are managed by a single MEC server (we call a set of the managed BSs as a cluster) and each MEC server exchanges sparse information among them as shown in <a ref-type=\"fig\" anchor=\"fig1\" class=\"fulltext-link\">Fig. 1</a>. In this architecture, there are <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$C$\n</tex-math></inline-formula> clusters and <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$N$\n</tex-math></inline-formula> BSs where <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\mathcal {C} = \\{1, \\cdots, c, \\cdots, C\\}$\n</tex-math></inline-formula> and <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\mathcal {N} = \\{1, \\cdots, n, \\cdots, N\\}$\n</tex-math></inline-formula> mean the set of clusters and BSs, respectively. Each cluster <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$c$\n</tex-math></inline-formula> has <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$N_{c}$\n</tex-math></inline-formula> BSs and the set of BSs included in cluster <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$c$\n</tex-math></inline-formula> is denoted by <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\mathcal {N}_{c} = \\{{1_{c}}, \\cdots, {n_{c}}, \\cdots, {N_{c}}\\}$\n</tex-math></inline-formula>. Besides, there are the set of users denoted by <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\mathcal {K}=\\{1, \\cdots, K\\}$\n</tex-math></inline-formula>, and the set of users included in BS <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$n_{c}$\n</tex-math></inline-formula> are denoted by <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\mathcal {K}_{n_{c}}$\n</tex-math></inline-formula>. Each BS has to be included in a single cluster, and each user has to be included in a single BS. In the aforementioned system model, each BS has <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$L$\n</tex-math></inline-formula> transmit antennas and each user has a single receive antenna. Hence, BS <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$n$\n</tex-math></inline-formula> can generate up to <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$L$\n</tex-math></inline-formula> precoding vectors <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\mathcal {B}_{n}=\\{{ \\boldsymbol b}_{n, 1}, { \\boldsymbol b}_{n, 2}, \\cdots, { \\boldsymbol b}_{n, \\left |{\\mathcal {B}_{n}}\\right |}\\}$\n</tex-math></inline-formula>,<a ref-type=\"fn\" anchor=\"fn1\" class=\"footnote-link\">1</a> <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$|\\mathcal {B}_{n}| \\leq L$\n</tex-math></inline-formula> and can schedule multiple users to a precoding vector <inline-formula id=\"\"><tex-math notation=\"LaTeX\">${ \\boldsymbol b} \\in \\mathcal {B}_{n}$\n</tex-math></inline-formula> by taking advantage of NOMA.<a ref-type=\"fn\" anchor=\"fn2\" class=\"footnote-link\">2</a> Moreover, we consider a time-slotted system where each time slot is indexed by <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$t \\in \\{0, 1, \\cdots, T-1\\}$\n</tex-math></inline-formula> and assume a full buffer traffic model meaning that an infinite data packet queue is allocated to all users. This assumption makes each user achieve a different instantaneous data rate based on the time-varying wireless channel and the different average data rate. Moreover, achievement of different data rates among users makes users to be scheduled in different beams or the same beam. Consequently, each BS has to make decisions of <i>(i)</i> the beams to be activated, <i>(ii)</i> the users to be scheduled in the activated beams, and <i>(iii)</i> the amount of power to be allocated for each activated beam every time slot.</p><div class=\"section_2\" id=\"sec2a1\"><h4>1) Beam Activation</h4><p>At each time slot <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$t$\n</tex-math></inline-formula>, each BS has to determine which beams are activated. However, exhaustive search of all beams can be a computational burden for the BS when the number of beams is high. To avoid high complexity, we define a set of beam patterns <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\mathcal {A}$\n</tex-math></inline-formula>. It is composed of sets of the activated beams by ensuring that adjacent beams are not activated simultaneously as shown in <a ref-type=\"fig\" anchor=\"fig2\" class=\"fulltext-link\">Fig. 2</a>.<a ref-type=\"fn\" anchor=\"fn3\" class=\"footnote-link\">3</a> Note that this constraint extremely reduces the set of candidates of the activated beams <a ref-type=\"bibr\" anchor=\"ref20\" id=\"context_ref_20_2a1\">[20]</a>. Hence, each BS selects a set of beam activations <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$a$\n</tex-math></inline-formula> from the predefined set of beam patterns <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\mathcal {A}$\n</tex-math></inline-formula> every time slot and then activates beams in <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$a$\n</tex-math></inline-formula>. We define <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$X_{n,a}(t)$\n</tex-math></inline-formula> as pattern selection indicator where <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$X_{n, a}(t)=1$\n</tex-math></inline-formula> means BS <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$n$\n</tex-math></inline-formula> selects a set of beam activations <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$a$\n</tex-math></inline-formula>, and <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$X_{n, a}(t)=0$\n</tex-math></inline-formula> otherwise. Moreover, we denote <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$a_{n}(t)$\n</tex-math></inline-formula> as a selected set of beam activations by BS <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$n$\n</tex-math></inline-formula>. <disp-formula id=\"deqn1\" class=\"display-formula\"><tex-math notation=\"LaTeX\">\\begin{equation*} \\sum _{a \\in \\mathcal {A}}X_{n,a}(t)=1, \\quad \\forall n \\in \\mathcal {N}. \\tag{1}\\end{equation*}\n</tex-math><span class=\"formula\"><span class=\"link\">View Source</span><img aria-describedby=\"qtip-0\" style=\"display:inline;\" title=\"Right-click on figure or equation for MathML and additional features.\" data-hasqtip=\"0\" class=\"qtooltip moreInfo\" alt=\"Right-click on figure for MathML and additional features.\" src=\"/assets/img/icon.support.gif\" border=\"0\" height=\"20\" width=\"24\"/><span class=\"tex tex2jax_ignore\" style=\"display:none;\">\\begin{equation*} \\sum _{a \\in \\mathcal {A}}X_{n,a}(t)=1, \\quad \\forall n \\in \\mathcal {N}. \\tag{1}\\end{equation*}\n</span></span></disp-formula>\n<div class=\"figure figure-full\" id=\"fig2\"><!--\n          Workaround for combined images.Eg.- 1000116 Fig. 5\n        --><div class=\"img-wrap\"><a href=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973235/kwak2-3227444-large.gif\" data-fig-id=\"fig2\"><img src=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973235/kwak2-3227444-small.gif\" alt=\"FIGURE 2. - Examples of the set of beam activations in &#10;$L=8$&#10;.\"/><div class=\"zoom\" title=\"View Larger Image\"/></a></div><div class=\"figcaption\"><b class=\"title\">FIGURE 2. </b><fig><p>Examples of the set of beam activations in <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$L=8$\n</tex-math></inline-formula>.</p></fig></div><p class=\"links\"><a href=\"/document/9973235/all-figures\" class=\"all\">Show All</a></p></div>\n<div class=\"figure figure-full\" id=\"fig3\"><!--\n          Workaround for combined images.Eg.- 1000116 Fig. 5\n        --><div class=\"img-wrap\"><a href=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973235/kwak3-3227444-large.gif\" data-fig-id=\"fig3\"><img src=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973235/kwak3-3227444-small.gif\" alt=\"FIGURE 3. - The proposed solution with complexity reduction from the ideal solution.\"/><div class=\"zoom\" title=\"View Larger Image\"/></a></div><div class=\"figcaption\"><b class=\"title\">FIGURE 3. </b><fig><p>The proposed solution with complexity reduction from the ideal solution.</p></fig></div><p class=\"links\"><a href=\"/document/9973235/all-figures\" class=\"all\">Show All</a></p></div></p></div><div class=\"section_2\" id=\"sec2a2\"><h4>2) User Scheduling</h4><p>Once beam activation is decided, users are scheduled to be served by the activated beams. First, we define the user scheduling indicator denoted by <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$I_{n, \\boldsymbol b}^{k}(t)$\n</tex-math></inline-formula> where <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$I_{n, \\boldsymbol b}^{k}(t)=1$\n</tex-math></inline-formula> implies that user <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$k$\n</tex-math></inline-formula> is scheduled on beam <inline-formula id=\"\"><tex-math notation=\"LaTeX\">${ \\boldsymbol b}$\n</tex-math></inline-formula> of BS <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$n$\n</tex-math></inline-formula> at time slot <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$t$\n</tex-math></inline-formula>, and <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$I_{n, \\boldsymbol b}^{k}(t)=0$\n</tex-math></inline-formula> otherwise. Moreover, since we consider NOMA system, each BS can schedule multiple users on a single beam. To address this, we denote <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\mathcal {I}_{n, \\boldsymbol b}(t) = \\{k_{1}, \\cdots, k_{\\left |{\\mathcal {I}_{n, \\boldsymbol b}(t)}\\right |}\\}$\n</tex-math></inline-formula> by the set of scheduled users in beam <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\boldsymbol b$\n</tex-math></inline-formula> of BS <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$n$\n</tex-math></inline-formula>. Moreover, we sort <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\mathcal {I}_{n, \\boldsymbol b}(t)$\n</tex-math></inline-formula> in descending order for computational convenience in SIC. Then, we have:<disp-formula id=\"deqn2\" class=\"display-formula\"><tex-math notation=\"LaTeX\">\\begin{equation*} \\sum _{k \\in \\mathcal {K}} I_{n, \\boldsymbol b}^{k}(t) = \\left |{\\mathcal {I}_{n, \\boldsymbol b}(t)}\\right |, \\quad \\forall n \\in \\mathcal {N}, \\quad \\forall \\boldsymbol b \\in \\mathcal {B}_{n}. \\tag{2}\\end{equation*}\n</tex-math><span class=\"formula\"><span class=\"link\">View Source</span><img aria-describedby=\"qtip-0\" style=\"display:inline;\" title=\"Right-click on figure or equation for MathML and additional features.\" data-hasqtip=\"0\" class=\"qtooltip moreInfo\" alt=\"Right-click on figure for MathML and additional features.\" src=\"/assets/img/icon.support.gif\" border=\"0\" height=\"20\" width=\"24\"/><span class=\"tex tex2jax_ignore\" style=\"display:none;\">\\begin{equation*} \\sum _{k \\in \\mathcal {K}} I_{n, \\boldsymbol b}^{k}(t) = \\left |{\\mathcal {I}_{n, \\boldsymbol b}(t)}\\right |, \\quad \\forall n \\in \\mathcal {N}, \\quad \\forall \\boldsymbol b \\in \\mathcal {B}_{n}. \\tag{2}\\end{equation*}\n</span></span></disp-formula> Naturally, beams on which no users are scheduled are deactivated. To represent this, we define <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\boldsymbol b^{a_{n}}(t)$\n</tex-math></inline-formula> as the set of activated beams where <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\boldsymbol b^{a_{n}}(t) \\subset a_{n}(t)$\n</tex-math></inline-formula>.</p></div><div class=\"section_2\" id=\"sec2a3\"><h4>3) Power Allocation</h4><p>In NOMA system, multiple users can be scheduled in the same frequency/time resource; hence different transmit powers are allocated to different users in the resource. Therefore, each BS has to decide the amount of transmit powers to be allocated for scheduled users. We denote by <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$p^{k}_{n_{c}, \\boldsymbol b}(t)$\n</tex-math></inline-formula> the transmit power for user <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$k$\n</tex-math></inline-formula> scheduled on beam <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\boldsymbol b$\n</tex-math></inline-formula> of BS <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$n_{c}$\n</tex-math></inline-formula> at time slot <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$t$\n</tex-math></inline-formula>, and <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$p_{n_{c}, \\boldsymbol b}(t)$\n</tex-math></inline-formula> the transmit power for beam <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\boldsymbol b$\n</tex-math></inline-formula> of BS <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$n_{c}$\n</tex-math></inline-formula> at time slot <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$t$\n</tex-math></inline-formula> where <disp-formula id=\"deqn3\" class=\"display-formula\"><tex-math notation=\"LaTeX\">\\begin{align*} \\sum _{k \\in \\mathcal {K}} p^{k}_{n_{c}, \\boldsymbol b}(t) = p_{n_{c}, \\boldsymbol b}(t), \\quad \\forall n_{c} \\in \\mathcal {N}_{c}, \\quad \\forall \\boldsymbol b \\in \\! \\mathcal {B}_{n_{c}}, \\quad \\forall c \\in \\mathcal {C}. \\tag{3}\\end{align*}\n</tex-math><span class=\"formula\"><span class=\"link\">View Source</span><img aria-describedby=\"qtip-0\" style=\"display:inline;\" title=\"Right-click on figure or equation for MathML and additional features.\" data-hasqtip=\"0\" class=\"qtooltip moreInfo\" alt=\"Right-click on figure for MathML and additional features.\" src=\"/assets/img/icon.support.gif\" border=\"0\" height=\"20\" width=\"24\"/><span class=\"tex tex2jax_ignore\" style=\"display:none;\">\\begin{align*} \\sum _{k \\in \\mathcal {K}} p^{k}_{n_{c}, \\boldsymbol b}(t) = p_{n_{c}, \\boldsymbol b}(t), \\quad \\forall n_{c} \\in \\mathcal {N}_{c}, \\quad \\forall \\boldsymbol b \\in \\! \\mathcal {B}_{n_{c}}, \\quad \\forall c \\in \\mathcal {C}. \\tag{3}\\end{align*}\n</span></span></disp-formula> Then, we define <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$P_{n_{c}}^{max}$\n</tex-math></inline-formula> and <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$P_{n_{c}, \\boldsymbol b}^{max}$\n</tex-math></inline-formula> as the maximum transmit power of a BS and an activated beam, respectively. Accordingly, we have the following power constraints:<disp-formula id=\"deqn4-deqn5\" class=\"display-formula\"><tex-math notation=\"LaTeX\">\\begin{align*} \\sum _{b \\in \\mathcal {B}_{n_{c}}} p_{n_{c}, \\boldsymbol b}(t)\\leq\\unicode{0x0026}P_{n_{c}}^{max}, \\quad \\forall n_{c} \\in \\mathcal {N}_{c}, \\quad \\forall c \\in \\mathcal {C}, \\tag{4}\\\\ p_{n_{c}, \\boldsymbol b}(t)\\leq\\unicode{0x0026}P_{n_{c}, \\boldsymbol b}^{max}, \\forall n_{c} \\in \\mathcal {N}_{c}, \\quad \\forall \\boldsymbol b \\in \\mathcal {B}_{n_{c}}, \\quad \\forall c \\in \\mathcal {C}. \\tag{5}\\end{align*}\n</tex-math><span class=\"formula\"><span class=\"link\">View Source</span><img aria-describedby=\"qtip-0\" style=\"display:inline;\" title=\"Right-click on figure or equation for MathML and additional features.\" data-hasqtip=\"0\" class=\"qtooltip moreInfo\" alt=\"Right-click on figure for MathML and additional features.\" src=\"/assets/img/icon.support.gif\" border=\"0\" height=\"20\" width=\"24\"/><span class=\"tex tex2jax_ignore\" style=\"display:none;\">\\begin{align*} \\sum _{b \\in \\mathcal {B}_{n_{c}}} p_{n_{c}, \\boldsymbol b}(t)\\leq\\unicode{0x0026}P_{n_{c}}^{max}, \\quad \\forall n_{c} \\in \\mathcal {N}_{c}, \\quad \\forall c \\in \\mathcal {C}, \\tag{4}\\\\ p_{n_{c}, \\boldsymbol b}(t)\\leq\\unicode{0x0026}P_{n_{c}, \\boldsymbol b}^{max}, \\forall n_{c} \\in \\mathcal {N}_{c}, \\quad \\forall \\boldsymbol b \\in \\mathcal {B}_{n_{c}}, \\quad \\forall c \\in \\mathcal {C}. \\tag{5}\\end{align*}\n</span></span></disp-formula> As mentioned in <a ref-type=\"sec\" anchor=\"sec1\" class=\"fulltext-link\">Section I</a>, real-time transmit power management among inner cluster BSs would be possible via an MEC server in the future 6G networks. Hence, BSs can flexibly allocate transmit powers over time and space with the average power constraint at each cluster as follows:<disp-formula id=\"deqn6\" class=\"display-formula\"><tex-math notation=\"LaTeX\">\\begin{equation*} \\displaystyle \\lim _{T \\to \\infty }{\\frac{1}{ {T}}} \\sum _{t=0}^{T-1} \\sum _{n_{c} \\in \\mathcal {N}_{c}} \\sum _{ \\boldsymbol b \\in \\mathcal {B}_{n_{c}}} p_{n_{c}, \\boldsymbol b}(t) \\leq P_{avg}^{c}, \\quad \\forall c \\in \\mathcal {C}, \\tag{6}\\end{equation*}\n</tex-math><span class=\"formula\"><span class=\"link\">View Source</span><img aria-describedby=\"qtip-0\" style=\"display:inline;\" title=\"Right-click on figure or equation for MathML and additional features.\" data-hasqtip=\"0\" class=\"qtooltip moreInfo\" alt=\"Right-click on figure for MathML and additional features.\" src=\"/assets/img/icon.support.gif\" border=\"0\" height=\"20\" width=\"24\"/><span class=\"tex tex2jax_ignore\" style=\"display:none;\">\\begin{equation*} \\displaystyle \\lim _{T \\to \\infty }{\\frac{1}{ {T}}} \\sum _{t=0}^{T-1} \\sum _{n_{c} \\in \\mathcal {N}_{c}} \\sum _{ \\boldsymbol b \\in \\mathcal {B}_{n_{c}}} p_{n_{c}, \\boldsymbol b}(t) \\leq P_{avg}^{c}, \\quad \\forall c \\in \\mathcal {C}, \\tag{6}\\end{equation*}\n</span></span></disp-formula> where <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$P_{avg}^{c}$\n</tex-math></inline-formula> means the long-term power budget from the network operator.</p></div></div><div class=\"section_2\" id=\"sec2b\"><h3>B. Link Capacity Model</h3><p>Since each BS has <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$L$\n</tex-math></inline-formula> transmit antennas, a channel gain vector <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\boldsymbol h_{n, k}$\n</tex-math></inline-formula> between BS <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$n$\n</tex-math></inline-formula> and user <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$k$\n</tex-math></inline-formula> can be described as follows:<disp-formula id=\"deqn7\" class=\"display-formula\"><tex-math notation=\"LaTeX\">\\begin{equation*} \\boldsymbol h_{n, k}(t)=[\\alpha _{n,k,1}(t), \\cdots, \\alpha _{n,k,L}(t)]\\sqrt {\\rho _{n,k}} \\in \\boldsymbol h, \\tag{7}\\end{equation*}\n</tex-math><span class=\"formula\"><span class=\"link\">View Source</span><img aria-describedby=\"qtip-0\" style=\"display:inline;\" title=\"Right-click on figure or equation for MathML and additional features.\" data-hasqtip=\"0\" class=\"qtooltip moreInfo\" alt=\"Right-click on figure for MathML and additional features.\" src=\"/assets/img/icon.support.gif\" border=\"0\" height=\"20\" width=\"24\"/><span class=\"tex tex2jax_ignore\" style=\"display:none;\">\\begin{equation*} \\boldsymbol h_{n, k}(t)=[\\alpha _{n,k,1}(t), \\cdots, \\alpha _{n,k,L}(t)]\\sqrt {\\rho _{n,k}} \\in \\boldsymbol h, \\tag{7}\\end{equation*}\n</span></span></disp-formula> where <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\alpha _{n,k,l}$\n</tex-math></inline-formula> means a channel coefficient of each antenna corresponding to BS <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$n$\n</tex-math></inline-formula>, user <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$k$\n</tex-math></inline-formula>, and antenna <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$l$\n</tex-math></inline-formula> and <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\rho _{n,k}$\n</tex-math></inline-formula> means a large scale fading including path loss and shadowing between BS <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$n$\n</tex-math></inline-formula> and user <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$k$\n</tex-math></inline-formula>.</p><p>In NOMA system, user <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$k$\n</tex-math></inline-formula> scheduled on beam <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\boldsymbol {b}$\n</tex-math></inline-formula> can be interfered by the signal of users scheduled in the same beam <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\boldsymbol {b}$\n</tex-math></inline-formula>, i.e., users in <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\mathcal {I}_{n, \\boldsymbol b}(t)$\n</tex-math></inline-formula> who are sorted before user <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$k$\n</tex-math></inline-formula>. Note that the signal of users in <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\mathcal {I}_{n, \\boldsymbol b}(t)$\n</tex-math></inline-formula> who are sorted after user <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$k$\n</tex-math></inline-formula> can be ignored thanks to the SC and SIC techniques. Moreover, user <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$k$\n</tex-math></inline-formula> can be interfered by signals of all beams except for beam <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\boldsymbol {b}$\n</tex-math></inline-formula> of BS <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$n$\n</tex-math></inline-formula>. Consequently, the total interference of user <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$k$\n</tex-math></inline-formula>, <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\eta _{k}(t)$\n</tex-math></inline-formula> can be calculated by <disp-formula id=\"deqn8\" class=\"display-formula\"><tex-math notation=\"LaTeX\">\\begin{align*} \\eta _{k}(t)=&amp;\\sum _{j=1}^{i-1} \\left |{\\sqrt {p_{n, \\boldsymbol b}^{k_{j}}} \\boldsymbol h_{n, k}(t) \\boldsymbol b }\\right |^{2} \\\\&amp;+\\, \\sum _{m \\in \\mathcal {N} \\setminus n} \\sum _{ \\boldsymbol f \\in \\mathcal {B}_{m}} \\left |{\\sqrt {p_{m, \\boldsymbol f}} \\boldsymbol h_{m,k}(t) \\boldsymbol f }\\right |^{2} \\\\&amp;+\\, \\sum _{ \\boldsymbol q \\in \\mathcal {B}_{n} \\setminus \\boldsymbol b} \\left |{\\sqrt {p_{n, \\boldsymbol q}} \\boldsymbol h_{n,k}(t) \\boldsymbol q }\\right |^{2}, k_{j} \\in \\mathcal {I}_{n, \\boldsymbol b}(t), \\tag{8}\\end{align*}\n</tex-math><span class=\"formula\"><span class=\"link\">View Source</span><img aria-describedby=\"qtip-0\" style=\"display:inline;\" title=\"Right-click on figure or equation for MathML and additional features.\" data-hasqtip=\"0\" class=\"qtooltip moreInfo\" alt=\"Right-click on figure for MathML and additional features.\" src=\"/assets/img/icon.support.gif\" border=\"0\" height=\"20\" width=\"24\"/><span class=\"tex tex2jax_ignore\" style=\"display:none;\">\\begin{align*} \\eta _{k}(t)=&amp;\\sum _{j=1}^{i-1} \\left |{\\sqrt {p_{n, \\boldsymbol b}^{k_{j}}} \\boldsymbol h_{n, k}(t) \\boldsymbol b }\\right |^{2} \\\\&amp;+\\, \\sum _{m \\in \\mathcal {N} \\setminus n} \\sum _{ \\boldsymbol f \\in \\mathcal {B}_{m}} \\left |{\\sqrt {p_{m, \\boldsymbol f}} \\boldsymbol h_{m,k}(t) \\boldsymbol f }\\right |^{2} \\\\&amp;+\\, \\sum _{ \\boldsymbol q \\in \\mathcal {B}_{n} \\setminus \\boldsymbol b} \\left |{\\sqrt {p_{n, \\boldsymbol q}} \\boldsymbol h_{n,k}(t) \\boldsymbol q }\\right |^{2}, k_{j} \\in \\mathcal {I}_{n, \\boldsymbol b}(t), \\tag{8}\\end{align*}\n</span></span></disp-formula> where <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$i$\n</tex-math></inline-formula> and <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$j$\n</tex-math></inline-formula> denote index of user <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$k$\n</tex-math></inline-formula> and index of other users in <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\mathcal {I}_{n, \\boldsymbol b}(t)$\n</tex-math></inline-formula>, respectively. Here, the first term implies the intra-beam interference from users allocated more power than user <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$k$\n</tex-math></inline-formula>. The second term implies interference from other BSs except for BS <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$n$\n</tex-math></inline-formula>. The third term implies interference from activated beams of BS <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$n$\n</tex-math></inline-formula> except for beam <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\boldsymbol b$\n</tex-math></inline-formula>. Through this, the SINR of user <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$k$\n</tex-math></inline-formula>, <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\mu _{k}(\\boldsymbol X(t), \\boldsymbol I(t), \\boldsymbol p(t))$\n</tex-math></inline-formula> can be expressed:<disp-formula id=\"deqn9\" class=\"display-formula\"><tex-math notation=\"LaTeX\">\\begin{align*}&amp;\\hspace {-2pc}\\mu _{k}(\\boldsymbol X(t), \\boldsymbol I(t), \\boldsymbol p(t)) \\\\=&amp;\\frac {\\sum _{n \\in \\mathcal {N}} \\sum _{ \\boldsymbol b \\in \\mathcal {B}_{n}} \\left |{\\sqrt {p_{n, \\boldsymbol b}^{k}(t) \\boldsymbol h_{n,k}(t) \\boldsymbol b} }\\right |^{2} I_{n, \\boldsymbol b}^{k}(t) X_{n, a}(t)}{\\eta _{k}(t) + \\sigma _{k}(t)}, \\tag{9}\\end{align*}\n</tex-math><span class=\"formula\"><span class=\"link\">View Source</span><img aria-describedby=\"qtip-0\" style=\"display:inline;\" title=\"Right-click on figure or equation for MathML and additional features.\" data-hasqtip=\"0\" class=\"qtooltip moreInfo\" alt=\"Right-click on figure for MathML and additional features.\" src=\"/assets/img/icon.support.gif\" border=\"0\" height=\"20\" width=\"24\"/><span class=\"tex tex2jax_ignore\" style=\"display:none;\">\\begin{align*}&amp;\\hspace {-2pc}\\mu _{k}(\\boldsymbol X(t), \\boldsymbol I(t), \\boldsymbol p(t)) \\\\=&amp;\\frac {\\sum _{n \\in \\mathcal {N}} \\sum _{ \\boldsymbol b \\in \\mathcal {B}_{n}} \\left |{\\sqrt {p_{n, \\boldsymbol b}^{k}(t) \\boldsymbol h_{n,k}(t) \\boldsymbol b} }\\right |^{2} I_{n, \\boldsymbol b}^{k}(t) X_{n, a}(t)}{\\eta _{k}(t) + \\sigma _{k}(t)}, \\tag{9}\\end{align*}\n</span></span></disp-formula> where <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\sigma _{k}(t)$\n</tex-math></inline-formula> is a thermal noise of user <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$k$\n</tex-math></inline-formula> at time slot <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$t$\n</tex-math></inline-formula>. Here, pattern selection indicator is expressed by <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\boldsymbol X(t) = (X_{n, a}(t):\\forall n \\in \\mathcal {N}, \\forall a \\in \\mathcal {A})$\n</tex-math></inline-formula>, user scheduling indicator is expressed by <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\boldsymbol I(t)=(I_{n, \\boldsymbol b}^{k}(t):\\forall n \\in \\mathcal {N}, \\forall \\boldsymbol b \\in \\mathcal {B}_{n}, \\forall k \\in \\mathcal {K})$\n</tex-math></inline-formula>, and power allocation vector is expressed by <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\boldsymbol p(t)=(p_{n, \\boldsymbol b}^{k}(t):\\forall n \\in \\mathcal {N}, \\forall \\boldsymbol b \\in \\mathcal {B}_{n}, \\forall k \\in \\mathcal {K})$\n</tex-math></inline-formula>.</p><p>Finally, for given SINR expression <a ref-type=\"disp-formula\" anchor=\"deqn9\" href=\"#deqn9\" class=\"fulltext-link\">(9)</a>, we can calculate the achievable data rate of user <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$k$\n</tex-math></inline-formula> by exploiting Shannon\u2019s capacity formula <a ref-type=\"bibr\" anchor=\"ref21\" id=\"context_ref_21_2b\">[21]</a> as follows:<disp-formula id=\"deqn10\" class=\"display-formula\"><tex-math notation=\"LaTeX\">\\begin{align*} r_{k}(\\boldsymbol X(t), \\boldsymbol I(t), \\boldsymbol p(t)) = BW \\log _{2}(1+\\mu _{k}(\\boldsymbol X(t), \\boldsymbol I(t), \\boldsymbol p(t))), \\tag{10}\\end{align*}\n</tex-math><span class=\"formula\"><span class=\"link\">View Source</span><img aria-describedby=\"qtip-0\" style=\"display:inline;\" title=\"Right-click on figure or equation for MathML and additional features.\" data-hasqtip=\"0\" class=\"qtooltip moreInfo\" alt=\"Right-click on figure for MathML and additional features.\" src=\"/assets/img/icon.support.gif\" border=\"0\" height=\"20\" width=\"24\"/><span class=\"tex tex2jax_ignore\" style=\"display:none;\">\\begin{align*} r_{k}(\\boldsymbol X(t), \\boldsymbol I(t), \\boldsymbol p(t)) = BW \\log _{2}(1+\\mu _{k}(\\boldsymbol X(t), \\boldsymbol I(t), \\boldsymbol p(t))), \\tag{10}\\end{align*}\n</span></span></disp-formula> where <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$BW$\n</tex-math></inline-formula> denotes the entire system channel bandwidth.</p></div></div>\n<div class=\"section\" id=\"sec3\"><div class=\"header article-hdr\"><div class=\"kicker\">\n\t\t                        SECTION III.</div><h2>Problem Formulation and Algorithm Development</h2></div><div class=\"section_2\" id=\"sec3a\"><h3>A. Problem Formulation</h3><p>First, we formulate the utility maximization problem in NOMA-based mmWave network system as follows:<disp-formula id=\"\" class=\"display-formula\"><tex-math notation=\"LaTeX\">\\begin{align*} ( {\\mathbf{P}}):&amp;\\max _{(\\boldsymbol {X}, \\boldsymbol {I}, \\boldsymbol {p})} \\;\\;\\;\\; \\sum _{k \\in \\mathcal {K}} U_{k}(R_{k}) \\\\&amp;~~\\textit {s. t.}\\qquad ~~ \\sum _{a \\in \\mathcal {A}} X_{n,a}(t) = 1, \\;\\;\\;\\; \\forall n \\in \\mathcal {N}, \\\\&amp;\\quad ~~\\qquad \\quad (2), (3), (4), (5), (6).\\end{align*}\n</tex-math><span class=\"formula\"><span class=\"link\">View Source</span><img aria-describedby=\"qtip-0\" style=\"display:inline;\" title=\"Right-click on figure or equation for MathML and additional features.\" data-hasqtip=\"0\" class=\"qtooltip moreInfo\" alt=\"Right-click on figure for MathML and additional features.\" src=\"/assets/img/icon.support.gif\" border=\"0\" height=\"20\" width=\"24\"/><span class=\"tex tex2jax_ignore\" style=\"display:none;\">\\begin{align*} ( {\\mathbf{P}}):&amp;\\max _{(\\boldsymbol {X}, \\boldsymbol {I}, \\boldsymbol {p})} \\;\\;\\;\\; \\sum _{k \\in \\mathcal {K}} U_{k}(R_{k}) \\\\&amp;~~\\textit {s. t.}\\qquad ~~ \\sum _{a \\in \\mathcal {A}} X_{n,a}(t) = 1, \\;\\;\\;\\; \\forall n \\in \\mathcal {N}, \\\\&amp;\\quad ~~\\qquad \\quad (2), (3), (4), (5), (6).\\end{align*}\n</span></span></disp-formula> Without loss of generality, <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$U_{k}(\\cdot)$\n</tex-math></inline-formula> should be concave, strictly increasing, and continuously differentiable for mathematical convenience <a ref-type=\"bibr\" anchor=\"ref22\" id=\"context_ref_22_3a\">[22]</a>. This indicates the degree of user satisfaction with their average throughput (i.e., <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$R_{k} = \\overline {r_{k}(\\boldsymbol {X}(t), \\boldsymbol {I}(t), \\boldsymbol {p}(t))}$\n</tex-math></inline-formula>).<a ref-type=\"fn\" anchor=\"fn4\" class=\"footnote-link\">4</a> In this study, we design the utility function as <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$U_{k}(R_{k}) = \\log (1+R_{k})$\n</tex-math></inline-formula>. This design enables the function to capture both fairness and throughput of users in two ways: <i>(i)</i> since the sum of the log function is expressed as a product, similar utility values for different users make the objective bigger (fairness), and <i>(ii)</i> thanks to the maximization operation, the utility function becomes higher as each <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$U_{k}(\\cdot)$\n</tex-math></inline-formula> gets larger (throughput).</p><p>We should note that there are three obstacles to solve the problem <b>(P)</b> as follows: <i>(i)</i> <b>(P)</b> is long-term average utility maximization problem, yet our practical problem is to find beam activation, user scheduling and power allocation every time slot, i.e., online-fashioned solution, <i>(ii)</i> finding joint beam activation, user scheduling and power allocation is NP-hard problem, <i>(iii)</i> future information on the time-varying wireless channels cannot be known in advance. Hence, we exploit Lyapunov optimization framework <a ref-type=\"bibr\" anchor=\"ref19\" id=\"context_ref_19_3a\">[19]</a> to derive practical problem since this well-known dynamic optimization framework does not require the future wireless channel information and the time-average constraints, i.e., average power constraints can be modeled as the operation of virtual queue; hence we can easily interpret the algorithm operation.</p><p>As a first step, we separate <b>(P)</b> into <b>(P1)</b> and <b>(P-Pattern)</b>:<disp-formula id=\"\" class=\"display-formula\"><tex-math notation=\"LaTeX\">\\begin{align*} (\\boldsymbol{\\textrm {P1}}):&amp;\\displaystyle \\max _{(\\boldsymbol {I}, \\boldsymbol {p})} \\quad \\sum _{k \\in \\mathcal {K}} U_{k}(R_{k}), \\\\&amp;\\textit {s. t.} \\quad (2), (3), (4), (5), (6). \\\\ (\\boldsymbol{\\textrm {P-Pattern}}):&amp;\\max _{ \\boldsymbol {X}} \\;\\; \\sum _{k \\in \\mathcal {K}} U_{k}(R_{k}), \\\\&amp;\\textit {s. t.} \\quad ~~\\sum _{a \\in \\mathcal {A}} X_{n,a}(t) = 1, \\;\\;\\;\\; \\forall n \\in \\mathcal {N}.\\end{align*}\n</tex-math><span class=\"formula\"><span class=\"link\">View Source</span><img aria-describedby=\"qtip-0\" style=\"display:inline;\" title=\"Right-click on figure or equation for MathML and additional features.\" data-hasqtip=\"0\" class=\"qtooltip moreInfo\" alt=\"Right-click on figure for MathML and additional features.\" src=\"/assets/img/icon.support.gif\" border=\"0\" height=\"20\" width=\"24\"/><span class=\"tex tex2jax_ignore\" style=\"display:none;\">\\begin{align*} (\\boldsymbol{\\textrm {P1}}):&amp;\\displaystyle \\max _{(\\boldsymbol {I}, \\boldsymbol {p})} \\quad \\sum _{k \\in \\mathcal {K}} U_{k}(R_{k}), \\\\&amp;\\textit {s. t.} \\quad (2), (3), (4), (5), (6). \\\\ (\\boldsymbol{\\textrm {P-Pattern}}):&amp;\\max _{ \\boldsymbol {X}} \\;\\; \\sum _{k \\in \\mathcal {K}} U_{k}(R_{k}), \\\\&amp;\\textit {s. t.} \\quad ~~\\sum _{a \\in \\mathcal {A}} X_{n,a}(t) = 1, \\;\\;\\;\\; \\forall n \\in \\mathcal {N}.\\end{align*}\n</span></span></disp-formula> Note that <b>(P1)</b> and <b>(P-Pattern)</b> have the same objective function, yet <b>(P1)</b> is the problem to find solutions of user scheduling and power allocation, and <b>(P-Pattern)</b> is the problem to find solution of beam activation pattern where time scales for two problems are different.<a ref-type=\"fn\" anchor=\"fn5\" class=\"footnote-link\">5</a></p><div class=\"section_2\" id=\"sec3a1\"><h4>1) Problem Transformation</h4><p>Since the objective function of <b>(P1)</b> is not linear, Lyapunov optimization framework cannot be directly applied in this problem. Hence, to transform <b>(P1)</b> into the applicable problem to Lyapunov optimization framework, we introduce a rectangular constraint and ancillary variables. We define a rectangle set <inline-formula id=\"\"><tex-math notation=\"LaTeX\">${\\boldsymbol{\\Gamma }}=\\{(\\gamma _{1},\\ldots,\\gamma _{K}) \\; | \\; \\gamma _{k,min} \\le \\gamma _{k} \\le \\gamma _{k,max}, \\forall k \\in \\mathcal {K}\\}$\n</tex-math></inline-formula> and the ancillary variable <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\boldsymbol {\\gamma }(t)=(\\gamma _{1}(t), \\cdots, \\gamma _{K}(t)) \\in \\boldsymbol {\\Gamma }$\n</tex-math></inline-formula>, where <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\gamma _{k,min}$\n</tex-math></inline-formula> and <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\gamma _{k,max}$\n</tex-math></inline-formula> are any constraints and the ancillary variable <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\boldsymbol {\\gamma }(t)$\n</tex-math></inline-formula> follows <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\boldsymbol {r}(t)$\n</tex-math></inline-formula> smoothly over time. Leveraging Jensen\u2019s inequality <a ref-type=\"bibr\" anchor=\"ref19\" id=\"context_ref_19_3a1\">[19]</a>, we can reformulate the problem (<b>P1</b>) to (<b>P2</b>) as follows:<disp-formula id=\"deqn11-deqn12\" class=\"display-formula\"><tex-math notation=\"LaTeX\">\\begin{align*} ({\\mathbf {P2}}):&amp;\\max _{(\\boldsymbol {I}, \\boldsymbol {p},{ \\boldsymbol {\\gamma }})} \\;\\;\\;\\; \\sum _{k \\in \\mathcal {K}} \\overline {U_{k}(R_{k})} \\\\&amp;~\\textit {s. t.} \\quad (2), (3), (4), (5), (6), \\\\&amp;\\qquad \\quad ~~\\overline {\\gamma _{k}} \\le R_{k}, \\quad \\forall k \\in \\mathcal {K}, \\tag{11}\\\\&amp;\\qquad \\quad ~ \\boldsymbol {\\gamma }(t) \\in \\boldsymbol {\\Gamma }, \\quad \\forall t \\in \\mathcal {T}.\\tag{12}\\end{align*}\n</tex-math><span class=\"formula\"><span class=\"link\">View Source</span><img aria-describedby=\"qtip-0\" style=\"display:inline;\" title=\"Right-click on figure or equation for MathML and additional features.\" data-hasqtip=\"0\" class=\"qtooltip moreInfo\" alt=\"Right-click on figure for MathML and additional features.\" src=\"/assets/img/icon.support.gif\" border=\"0\" height=\"20\" width=\"24\"/><span class=\"tex tex2jax_ignore\" style=\"display:none;\">\\begin{align*} ({\\mathbf {P2}}):&amp;\\max _{(\\boldsymbol {I}, \\boldsymbol {p},{ \\boldsymbol {\\gamma }})} \\;\\;\\;\\; \\sum _{k \\in \\mathcal {K}} \\overline {U_{k}(R_{k})} \\\\&amp;~\\textit {s. t.} \\quad (2), (3), (4), (5), (6), \\\\&amp;\\qquad \\quad ~~\\overline {\\gamma _{k}} \\le R_{k}, \\quad \\forall k \\in \\mathcal {K}, \\tag{11}\\\\&amp;\\qquad \\quad ~ \\boldsymbol {\\gamma }(t) \\in \\boldsymbol {\\Gamma }, \\quad \\forall t \\in \\mathcal {T}.\\tag{12}\\end{align*}\n</span></span></disp-formula> where <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\boldsymbol {\\gamma } = \\{ \\boldsymbol {\\gamma }(t): t \\in \\mathcal {T} \\}$\n</tex-math></inline-formula>. To capture constraints <a ref-type=\"disp-formula\" anchor=\"deqn6\" href=\"#deqn6\" class=\"fulltext-link\">(6)</a> and <a ref-type=\"disp-formula\" anchor=\"deqn11-deqn12\" href=\"#deqn11-deqn12\" class=\"fulltext-link\">(11)</a> in per-slot problem, we add two virtual queues <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$Z_{c}(t)$\n</tex-math></inline-formula> for each cluster and <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$W_{k}(t)$\n</tex-math></inline-formula> for each user.<a ref-type=\"fn\" anchor=\"fn6\" class=\"footnote-link\">6</a> Here, two virtual queues evolve according to the following equations:<disp-formula id=\"deqn13-deqn14\" class=\"display-formula\"><tex-math notation=\"LaTeX\">\\begin{align*} Z_{c}(t+1)=&amp;\\left[{ Z_{c}(t) - P^{c}_{avg} + \\sum _{n_{c} \\in \\mathcal {N}_{c}} \\sum _{ \\boldsymbol {b} \\in \\mathcal {B}_{n_{c}}} p_{n_{c}, \\boldsymbol {b}}(t) }\\right]^{+}, \\quad \\forall c, \\tag{13}\\\\ W_{k}(t+1)=&amp;[W_{k}(t) - r_{k}(\\boldsymbol {I}(t), \\boldsymbol {p}(t)) + \\gamma _{k}(t)]^{+}, \\quad \\forall k, \\tag{14}\\end{align*}\n</tex-math><span class=\"formula\"><span class=\"link\">View Source</span><img aria-describedby=\"qtip-0\" style=\"display:inline;\" title=\"Right-click on figure or equation for MathML and additional features.\" data-hasqtip=\"0\" class=\"qtooltip moreInfo\" alt=\"Right-click on figure for MathML and additional features.\" src=\"/assets/img/icon.support.gif\" border=\"0\" height=\"20\" width=\"24\"/><span class=\"tex tex2jax_ignore\" style=\"display:none;\">\\begin{align*} Z_{c}(t+1)=&amp;\\left[{ Z_{c}(t) - P^{c}_{avg} + \\sum _{n_{c} \\in \\mathcal {N}_{c}} \\sum _{ \\boldsymbol {b} \\in \\mathcal {B}_{n_{c}}} p_{n_{c}, \\boldsymbol {b}}(t) }\\right]^{+}, \\quad \\forall c, \\tag{13}\\\\ W_{k}(t+1)=&amp;[W_{k}(t) - r_{k}(\\boldsymbol {I}(t), \\boldsymbol {p}(t)) + \\gamma _{k}(t)]^{+}, \\quad \\forall k, \\tag{14}\\end{align*}\n</span></span></disp-formula> where two queues are initialized by finite backlogs, i.e., <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$Z_{c}(0), W_{k}(0) &lt; \\infty $\n</tex-math></inline-formula>. <a ref-type=\"fn\" anchor=\"fn7\" class=\"footnote-link\">7</a> Next, we define Lyapunov function <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$L(t)$\n</tex-math></inline-formula> as follows:<disp-formula id=\"deqn15\" class=\"display-formula\"><tex-math notation=\"LaTeX\">\\begin{equation*} L({ \\boldsymbol {Q}}(t)) = \\frac {1}{2} \\left\\{{ \\sum _{c} Z_{c}^{2}(t) + \\sum _{k} W_{k}^{2}(t) }\\right\\},\\tag{15}\\end{equation*}\n</tex-math><span class=\"formula\"><span class=\"link\">View Source</span><img aria-describedby=\"qtip-0\" style=\"display:inline;\" title=\"Right-click on figure or equation for MathML and additional features.\" data-hasqtip=\"0\" class=\"qtooltip moreInfo\" alt=\"Right-click on figure for MathML and additional features.\" src=\"/assets/img/icon.support.gif\" border=\"0\" height=\"20\" width=\"24\"/><span class=\"tex tex2jax_ignore\" style=\"display:none;\">\\begin{equation*} L({ \\boldsymbol {Q}}(t)) = \\frac {1}{2} \\left\\{{ \\sum _{c} Z_{c}^{2}(t) + \\sum _{k} W_{k}^{2}(t) }\\right\\},\\tag{15}\\end{equation*}\n</span></span></disp-formula> where <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\boldsymbol {Q}(t) = (W_{1}(t),\\ldots W_{K}(t); Z_{1}(t), \\ldots, Z_{C}(t))$\n</tex-math></inline-formula>. Then, by utilizing the above Lyapunov function, the drift function <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\Delta L({ \\boldsymbol {Q}}(t))$\n</tex-math></inline-formula> can be designed as follows:<disp-formula id=\"deqn16\" class=\"display-formula\"><tex-math notation=\"LaTeX\">\\begin{equation*} \\Delta L({ \\boldsymbol {Q}}(t)) = \\mathbb {E} \\{ L({ \\boldsymbol {Q}}(t+1)) - L({ \\boldsymbol {Q}}(t)) \\}.\\tag{16}\\end{equation*}\n</tex-math><span class=\"formula\"><span class=\"link\">View Source</span><img aria-describedby=\"qtip-0\" style=\"display:inline;\" title=\"Right-click on figure or equation for MathML and additional features.\" data-hasqtip=\"0\" class=\"qtooltip moreInfo\" alt=\"Right-click on figure for MathML and additional features.\" src=\"/assets/img/icon.support.gif\" border=\"0\" height=\"20\" width=\"24\"/><span class=\"tex tex2jax_ignore\" style=\"display:none;\">\\begin{equation*} \\Delta L({ \\boldsymbol {Q}}(t)) = \\mathbb {E} \\{ L({ \\boldsymbol {Q}}(t+1)) - L({ \\boldsymbol {Q}}(t)) \\}.\\tag{16}\\end{equation*}\n</span></span></disp-formula> Then, we design a Lyapunov DMU function, which makes a single objective function which captures both objective function and virtual queue stability in every time slot as follows:<disp-formula id=\"deqn17\" class=\"display-formula\"><tex-math notation=\"LaTeX\">\\begin{align*}&amp;\\hspace {-2pc} \\text {DMU}(\\boldsymbol {p}(t), \\boldsymbol {I}(t), \\boldsymbol {\\gamma }(t)) \\\\=&amp;\\Delta L({ \\boldsymbol {Q}}(t)) - V\\sum _{c} \\sum _{n_{c}} \\sum _{k} \\mathbb {E} \\{\\log (1 + \\gamma _{k}(t)) | \\boldsymbol {Q}(t)\\}. \\tag{17}\\end{align*}\n</tex-math><span class=\"formula\"><span class=\"link\">View Source</span><img aria-describedby=\"qtip-0\" style=\"display:inline;\" title=\"Right-click on figure or equation for MathML and additional features.\" data-hasqtip=\"0\" class=\"qtooltip moreInfo\" alt=\"Right-click on figure for MathML and additional features.\" src=\"/assets/img/icon.support.gif\" border=\"0\" height=\"20\" width=\"24\"/><span class=\"tex tex2jax_ignore\" style=\"display:none;\">\\begin{align*}&amp;\\hspace {-2pc} \\text {DMU}(\\boldsymbol {p}(t), \\boldsymbol {I}(t), \\boldsymbol {\\gamma }(t)) \\\\=&amp;\\Delta L({ \\boldsymbol {Q}}(t)) - V\\sum _{c} \\sum _{n_{c}} \\sum _{k} \\mathbb {E} \\{\\log (1 + \\gamma _{k}(t)) | \\boldsymbol {Q}(t)\\}. \\tag{17}\\end{align*}\n</span></span></disp-formula> Then, we derive the upper bound of DMU function <a ref-type=\"disp-formula\" anchor=\"deqn17\" href=\"#deqn17\" class=\"fulltext-link\">(17)</a> using queueing dynamics <a ref-type=\"disp-formula\" anchor=\"deqn13-deqn14\" href=\"#deqn13-deqn14\" class=\"fulltext-link\">equations (13) and (14)</a> and the objective function as follows:<disp-formula id=\"deqn18\" class=\"display-formula\"><tex-math notation=\"LaTeX\">\\begin{align*}&amp;\\hspace {-2pc}\\text {DMU}(\\boldsymbol {p}(t), \\boldsymbol {I}(t), \\boldsymbol {\\gamma }(t)) \\\\\\le\\unicode{0x0026}B \\!-\\! V \\sum _{k} \\mathbb {E} \\{ \\log (1\\!+\\!\\gamma _{k}(t)) | \\boldsymbol {Q}(t)\\} \\\\&amp;-\\, \\sum _{c} \\mathbb {E} \\left\\{{ \\left({P_{c}^{avg} \\!-\\! \\sum _{n_{c}}\\sum _{ \\boldsymbol {b}} p_{n_{c}, \\boldsymbol {b}}(t)}\\right) Z_{c}(t) | \\boldsymbol {Q}(t) }\\right\\} \\\\&amp;-\\, \\sum _{k} \\mathbb {E} \\{ (r_{k}(\\boldsymbol {p}(t), \\boldsymbol {I}(t)) \\!-\\! \\gamma _{k}(t)) W_{k}(t) | \\boldsymbol {Q}(t) \\}, \\tag{18}\\end{align*}\n</tex-math><span class=\"formula\"><span class=\"link\">View Source</span><img aria-describedby=\"qtip-0\" style=\"display:inline;\" title=\"Right-click on figure or equation for MathML and additional features.\" data-hasqtip=\"0\" class=\"qtooltip moreInfo\" alt=\"Right-click on figure for MathML and additional features.\" src=\"/assets/img/icon.support.gif\" border=\"0\" height=\"20\" width=\"24\"/><span class=\"tex tex2jax_ignore\" style=\"display:none;\">\\begin{align*}&amp;\\hspace {-2pc}\\text {DMU}(\\boldsymbol {p}(t), \\boldsymbol {I}(t), \\boldsymbol {\\gamma }(t)) \\\\\\le\\unicode{0x0026}B \\!-\\! V \\sum _{k} \\mathbb {E} \\{ \\log (1\\!+\\!\\gamma _{k}(t)) | \\boldsymbol {Q}(t)\\} \\\\&amp;-\\, \\sum _{c} \\mathbb {E} \\left\\{{ \\left({P_{c}^{avg} \\!-\\! \\sum _{n_{c}}\\sum _{ \\boldsymbol {b}} p_{n_{c}, \\boldsymbol {b}}(t)}\\right) Z_{c}(t) | \\boldsymbol {Q}(t) }\\right\\} \\\\&amp;-\\, \\sum _{k} \\mathbb {E} \\{ (r_{k}(\\boldsymbol {p}(t), \\boldsymbol {I}(t)) \\!-\\! \\gamma _{k}(t)) W_{k}(t) | \\boldsymbol {Q}(t) \\}, \\tag{18}\\end{align*}\n</span></span></disp-formula> where <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$B \\!=\\! \\frac {1}{2} \\left({K (r_{k,max}^{2} \\!+\\! \\gamma _{k,max}^{2}) \\!+\\! \\sum _{c} N_{c} \\boldsymbol {B}P_{n_{c}, max}^{2} \\!+\\! C P_{c, max}^{2} }\\right)$\n</tex-math></inline-formula>. Then, by minimizing the RHS (Right-Hand-Side) in <a ref-type=\"disp-formula\" anchor=\"deqn18\" href=\"#deqn18\" class=\"fulltext-link\">(18)</a> every slot, an optimal objective value in (<b>P2</b>) can be obtained <a ref-type=\"bibr\" anchor=\"ref19\" id=\"context_ref_19_3a1\">[19]</a>. Then, the minimization problem of RHS in <a ref-type=\"disp-formula\" anchor=\"deqn18\" href=\"#deqn18\" class=\"fulltext-link\">(18)</a> can be decomposed into two subproblems as follows:<disp-formula id=\"\" class=\"display-formula\"><tex-math notation=\"LaTeX\">\\begin{align*} {\\mathbf {(SP1)}}&amp;\\text {Problem to find optimal} \\gamma _{k}^{*}(t): \\\\&amp;\\max _{\\gamma _{k}(t)} V\\log (1+\\gamma _{k}(t)) - \\gamma _{k}(t)W_{k}(t), \\quad \\forall k \\in \\mathcal {K}, \\\\ {\\mathbf {(SP2)}}&amp;\\text {Problem to find optimal}{ \\boldsymbol {I}^{*}(t)} {\\mathrm {and}} \\; \\boldsymbol {p}^{*}(t): \\\\&amp;\\max _{(\\boldsymbol {I}(t), \\boldsymbol {p}(t))} \\;\\;\\sum _{k \\in \\mathcal {K}} r_{k}(\\boldsymbol {I}(t), \\boldsymbol {p}(t)) W_{k}(t) \\\\&amp;-\\, \\sum _{n_{c} \\in \\mathcal {N}_{c}} \\sum _{ \\boldsymbol {b} \\in \\mathcal {B}_{n_{c}}} p_{n_{c}, \\boldsymbol {b}}(t) Z_{c}(t), \\;\\;\\;\\; \\textit {s.t.} \\;\\; (4), (5), (6).\\end{align*}\n</tex-math><span class=\"formula\"><span class=\"link\">View Source</span><img aria-describedby=\"qtip-0\" style=\"display:inline;\" title=\"Right-click on figure or equation for MathML and additional features.\" data-hasqtip=\"0\" class=\"qtooltip moreInfo\" alt=\"Right-click on figure for MathML and additional features.\" src=\"/assets/img/icon.support.gif\" border=\"0\" height=\"20\" width=\"24\"/><span class=\"tex tex2jax_ignore\" style=\"display:none;\">\\begin{align*} {\\mathbf {(SP1)}}&amp;\\text {Problem to find optimal} \\gamma _{k}^{*}(t): \\\\&amp;\\max _{\\gamma _{k}(t)} V\\log (1+\\gamma _{k}(t)) - \\gamma _{k}(t)W_{k}(t), \\quad \\forall k \\in \\mathcal {K}, \\\\ {\\mathbf {(SP2)}}&amp;\\text {Problem to find optimal}{ \\boldsymbol {I}^{*}(t)} {\\mathrm {and}} \\; \\boldsymbol {p}^{*}(t): \\\\&amp;\\max _{(\\boldsymbol {I}(t), \\boldsymbol {p}(t))} \\;\\;\\sum _{k \\in \\mathcal {K}} r_{k}(\\boldsymbol {I}(t), \\boldsymbol {p}(t)) W_{k}(t) \\\\&amp;-\\, \\sum _{n_{c} \\in \\mathcal {N}_{c}} \\sum _{ \\boldsymbol {b} \\in \\mathcal {B}_{n_{c}}} p_{n_{c}, \\boldsymbol {b}}(t) Z_{c}(t), \\;\\;\\;\\; \\textit {s.t.} \\;\\; (4), (5), (6).\\end{align*}\n</span></span></disp-formula> Because <b>(SP1)</b> is a convex problem, we can obtain the solution by differentiating the objective function with <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\gamma _{k}(t)$\n</tex-math></inline-formula> for every user as follows:<disp-formula id=\"deqn19\" class=\"display-formula\"><tex-math notation=\"LaTeX\">\\begin{equation*} \\gamma _{k}(t) = \\left[{ \\frac {V}{W_{k}(t)} - 1 }\\right]_{\\min }^{\\max },\\quad \\forall k \\in \\mathcal {K}, \\tag{19}\\end{equation*}\n</tex-math><span class=\"formula\"><span class=\"link\">View Source</span><img aria-describedby=\"qtip-0\" style=\"display:inline;\" title=\"Right-click on figure or equation for MathML and additional features.\" data-hasqtip=\"0\" class=\"qtooltip moreInfo\" alt=\"Right-click on figure for MathML and additional features.\" src=\"/assets/img/icon.support.gif\" border=\"0\" height=\"20\" width=\"24\"/><span class=\"tex tex2jax_ignore\" style=\"display:none;\">\\begin{equation*} \\gamma _{k}(t) = \\left[{ \\frac {V}{W_{k}(t)} - 1 }\\right]_{\\min }^{\\max },\\quad \\forall k \\in \\mathcal {K}, \\tag{19}\\end{equation*}\n</span></span></disp-formula> where <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\min $\n</tex-math></inline-formula> and <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\max $\n</tex-math></inline-formula> of <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\gamma _{k}(t)$\n</tex-math></inline-formula> are design parameters of the system. However, the solution of (<b>SP2</b>) is hard to obtain because it is an MINLP which is a combined problem of power allocation and user scheduling of different BSs.</p><p>Consequently, the original problem <b>(P)</b> is approximated to two subproblems (<b>P-Pattern</b>) and (<b>P1</b>), and (<b>P1</b>) was transformed into <b>(P2)</b>. Then, it is split into (<b>SP1</b>) and (<b>SP2</b>). Since the (<b>SP1</b>) was solved thanks to its convexity, we propose a low-complex algorithm, namely <i>CRIM</i>, in next subsection to solve the remained (<b>P-Pattern</b>) and (<b>SP2</b>).</p></div></div><div class=\"section_2\" id=\"sec3b\"><h3>B. Algorithm Development</h3><p>Now, we propose a low-complexity algorithm to solve <b>(P-Pattern)</b> and <b>(SP2)</b> as shown in <a ref-type=\"fig\" anchor=\"fig3\" class=\"fulltext-link\">Fig. 3</a>. First, we introduce an idea of beam pattern selection probability. It is sparsely updated, e.g., every 100 time slots, to satisfy <b>(P-Pattern)</b>. The intuition behind this idea is that variation of path loss in wireless channel is not extremely different for each user within short time, e.g., 0.1 sec. Second, we propose an approximated method to satisfy <b>(SP2)</b> by sequentially making decisions of user scheduling, and power allocation.</p><div class=\"section_2\" id=\"sec3b1\"><h4>1) Pattern-Based Beam Selection</h4><p>As mentioned in <a ref-type=\"sec\" anchor=\"sec2\" class=\"fulltext-link\">Section II</a>, we define a set of beam activations. Although the number of possible activated beams is reduced by introducing constraint, finding the set of beam activations every time slot has high computational complexity. Hence, we define the pattern selection probability <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\pi _{a}^{n}$\n</tex-math></inline-formula> to each BS <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$n$\n</tex-math></inline-formula>, and intermittently change the probability to approximate the activated beam selection procedure. The definition of <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\pi _{a}^{n}$\n</tex-math></inline-formula> can be as follows:<disp-formula id=\"deqn20\" class=\"display-formula\"><tex-math notation=\"LaTeX\">\\begin{equation*} \\sum _{a \\in \\mathcal {A}} \\pi _{a}^{n}=1, \\quad \\forall n \\in \\mathcal {N}. \\tag{20}\\end{equation*}\n</tex-math><span class=\"formula\"><span class=\"link\">View Source</span><img aria-describedby=\"qtip-0\" style=\"display:inline;\" title=\"Right-click on figure or equation for MathML and additional features.\" data-hasqtip=\"0\" class=\"qtooltip moreInfo\" alt=\"Right-click on figure for MathML and additional features.\" src=\"/assets/img/icon.support.gif\" border=\"0\" height=\"20\" width=\"24\"/><span class=\"tex tex2jax_ignore\" style=\"display:none;\">\\begin{equation*} \\sum _{a \\in \\mathcal {A}} \\pi _{a}^{n}=1, \\quad \\forall n \\in \\mathcal {N}. \\tag{20}\\end{equation*}\n</span></span></disp-formula> Then, in a long-time scale, <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\boldsymbol {\\pi } = \\{\\pi _{a}^{n}\\}, \\forall a\\in \\mathcal {A}, \\forall n\\in \\mathcal {N}$\n</tex-math></inline-formula> is updated to satisfy <b>(P-Pattern)</b> as follows:<disp-formula id=\"\" class=\"display-formula\"><tex-math notation=\"LaTeX\">\\begin{align*}&amp;\\hspace {-1pc}({bf {SP-Pattern}}): \\\\&amp;\\displaystyle \\max _{ \\boldsymbol {\\pi }} \\; \\sum _{k \\in \\mathcal {K}} U_{k}(R_{k}) = \\sum _{k \\in \\mathcal {K}} \\left({\\sum _{a \\in \\mathcal {A}} \\phi _{k,a} \\cdot \\pi _{a} \\cdot \\overline {r}_{k,a} }\\right), \\\\&amp;\\textit {s. t.} \\quad (20),\\end{align*}\n</tex-math><span class=\"formula\"><span class=\"link\">View Source</span><img aria-describedby=\"qtip-0\" style=\"display:inline;\" title=\"Right-click on figure or equation for MathML and additional features.\" data-hasqtip=\"0\" class=\"qtooltip moreInfo\" alt=\"Right-click on figure for MathML and additional features.\" src=\"/assets/img/icon.support.gif\" border=\"0\" height=\"20\" width=\"24\"/><span class=\"tex tex2jax_ignore\" style=\"display:none;\">\\begin{align*}&amp;\\hspace {-1pc}({bf {SP-Pattern}}): \\\\&amp;\\displaystyle \\max _{ \\boldsymbol {\\pi }} \\; \\sum _{k \\in \\mathcal {K}} U_{k}(R_{k}) = \\sum _{k \\in \\mathcal {K}} \\left({\\sum _{a \\in \\mathcal {A}} \\phi _{k,a} \\cdot \\pi _{a} \\cdot \\overline {r}_{k,a} }\\right), \\\\&amp;\\textit {s. t.} \\quad (20),\\end{align*}\n</span></span></disp-formula> where <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\phi _{k,a} \\in [{0,1}]$\n</tex-math></inline-formula> denotes the probability that the user <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$k$\n</tex-math></inline-formula> is scheduled when the beams in pattern <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$a$\n</tex-math></inline-formula> are activated. In addition, <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\overline {r}_{k,a}$\n</tex-math></inline-formula> means the average data rate of user <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$k$\n</tex-math></inline-formula> for pattern <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$a$\n</tex-math></inline-formula> during <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$T_{a}\\gg 1$\n</tex-math></inline-formula> time slots. Referring to the concept of <a ref-type=\"bibr\" anchor=\"ref23\" id=\"context_ref_23_3b1\">[23]</a>, standard gradient projection can be applied to determine <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\boldsymbol {\\pi }$\n</tex-math></inline-formula>. Therefore, BS <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$n_{c}$\n</tex-math></inline-formula> computes the partial derivative <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$D_{a}^{(n_{c})}$\n</tex-math></inline-formula> of the utility <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$U^{(n_{c})}$\n</tex-math></inline-formula> regarding the activation probability of pattern <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$a$\n</tex-math></inline-formula> as shown in <a ref-type=\"disp-formula\" anchor=\"deqn21\" href=\"#deqn21\" class=\"fulltext-link\">(21)</a>.<disp-formula id=\"deqn21\" class=\"display-formula\"><tex-math notation=\"LaTeX\">\\begin{equation*} \\displaystyle D_{a}^{(n_{c})} \\doteq \\frac {\\partial U^{(n_{c})}}{\\partial \\pi _{a}} = \\sum _{k \\in \\mathcal {K}} U_{k}'(R_{k}) \\cdot \\frac {\\partial R_{k}}{\\partial \\pi _{a}}, \\tag{21}\\end{equation*}\n</tex-math><span class=\"formula\"><span class=\"link\">View Source</span><img aria-describedby=\"qtip-0\" style=\"display:inline;\" title=\"Right-click on figure or equation for MathML and additional features.\" data-hasqtip=\"0\" class=\"qtooltip moreInfo\" alt=\"Right-click on figure for MathML and additional features.\" src=\"/assets/img/icon.support.gif\" border=\"0\" height=\"20\" width=\"24\"/><span class=\"tex tex2jax_ignore\" style=\"display:none;\">\\begin{equation*} \\displaystyle D_{a}^{(n_{c})} \\doteq \\frac {\\partial U^{(n_{c})}}{\\partial \\pi _{a}} = \\sum _{k \\in \\mathcal {K}} U_{k}'(R_{k}) \\cdot \\frac {\\partial R_{k}}{\\partial \\pi _{a}}, \\tag{21}\\end{equation*}\n</span></span></disp-formula> where <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\partial R_{k} / \\partial \\pi _{a} = \\phi _{k,a} \\overline {r}_{k,a} = \\overline {\\pi }_{k,a}\\overline {r}_{k,a}/\\pi _{a}$\n</tex-math></inline-formula>. Then, the calculation result is transmitted to the MEC server and used to update the <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\boldsymbol {\\pi }^{n_{c}}$\n</tex-math></inline-formula>. Now, each MEC server calculates the probability of beam pattern for each BS by collecting these partial derivatives of the local utility to increase the total network utility as follows:<disp-formula id=\"deqn22\" class=\"display-formula\"><tex-math notation=\"LaTeX\">\\begin{equation*} \\displaystyle \\boldsymbol {\\pi } \\leftarrow \\textit {Proj}_{\\sum _{a \\in \\mathcal {A}} \\pi _{a}=1,}(\\boldsymbol {\\pi } + \\beta \\boldsymbol {D}). \\tag{22}\\end{equation*}\n</tex-math><span class=\"formula\"><span class=\"link\">View Source</span><img aria-describedby=\"qtip-0\" style=\"display:inline;\" title=\"Right-click on figure or equation for MathML and additional features.\" data-hasqtip=\"0\" class=\"qtooltip moreInfo\" alt=\"Right-click on figure for MathML and additional features.\" src=\"/assets/img/icon.support.gif\" border=\"0\" height=\"20\" width=\"24\"/><span class=\"tex tex2jax_ignore\" style=\"display:none;\">\\begin{equation*} \\displaystyle \\boldsymbol {\\pi } \\leftarrow \\textit {Proj}_{\\sum _{a \\in \\mathcal {A}} \\pi _{a}=1,}(\\boldsymbol {\\pi } + \\beta \\boldsymbol {D}). \\tag{22}\\end{equation*}\n</span></span></disp-formula></p><p>Once <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\pi _{a}^{n}$\n</tex-math></inline-formula> is decided at long-time scale, each BS <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$n$\n</tex-math></inline-formula> selects beam pattern <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$a$\n</tex-math></inline-formula> with a probability of <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\pi _{a}^{n}$\n</tex-math></inline-formula> every time slot.</p><p>The intuition behind this average-based update is that the average channel gain does not significantly vary for short time. This feature gives a great opportunity to reduce computational complexity by spanning control time scale of beam activation. However, <b>(SP2)</b> has an issue of high computational complexity in solving user scheduling and power allocation simultaneously even for given set of beam activations. Hence, we find the solution by sequential decision-making to further reduce the complexity as shown in <a ref-type=\"fig\" anchor=\"fig3\" class=\"fulltext-link\">Fig. 3</a>.</p></div><div class=\"section_2\" id=\"sec3b2\"><h4>2) User Scheduling After Beam Selection</h4><p>First, we make a decision of the user scheduling for given set of beam activations. Here, we assume that the transmit power of activated beams is evenly allocated for simplicity. Then, the solution of user scheduling can be obtained by solving <b>(SP2)</b> as follows:<disp-formula id=\"deqn23\" class=\"display-formula\"><tex-math notation=\"LaTeX\">\\begin{align*} I_{ \\boldsymbol {b},k} = \\begin{cases} 1, &amp; \\text {if} \\;\\;\\; k = k(n, \\boldsymbol {b}) \\\\ &amp; \\hspace {0.8cm} = \\arg \\max r_{k}(\\boldsymbol {p}_{n, \\boldsymbol {b}})W_{k}, \\\\ 0, &amp; \\text {otherwise}. \\end{cases}\\tag{23}\\end{align*}\n</tex-math><span class=\"formula\"><span class=\"link\">View Source</span><img aria-describedby=\"qtip-0\" style=\"display:inline;\" title=\"Right-click on figure or equation for MathML and additional features.\" data-hasqtip=\"0\" class=\"qtooltip moreInfo\" alt=\"Right-click on figure for MathML and additional features.\" src=\"/assets/img/icon.support.gif\" border=\"0\" height=\"20\" width=\"24\"/><span class=\"tex tex2jax_ignore\" style=\"display:none;\">\\begin{align*} I_{ \\boldsymbol {b},k} = \\begin{cases} 1, &amp; \\text {if} \\;\\;\\; k = k(n, \\boldsymbol {b}) \\\\ &amp; \\hspace {0.8cm} = \\arg \\max r_{k}(\\boldsymbol {p}_{n, \\boldsymbol {b}})W_{k}, \\\\ 0, &amp; \\text {otherwise}. \\end{cases}\\tag{23}\\end{align*}\n</span></span></disp-formula> Note that the user scheduling problem for given set of beam activations and transmit power is a binary decision problem to satisfy <b>(SP2)</b> as shown in <a ref-type=\"disp-formula\" anchor=\"deqn23\" href=\"#deqn23\" class=\"fulltext-link\">equation (23)</a>.</p></div><div class=\"section_2\" id=\"sec3b3\"><h4>3) Power Allocation After User Scheduling</h4><p>Each BS allocates transmit power again to users scheduled by <a ref-type=\"disp-formula\" anchor=\"deqn23\" href=\"#deqn23\" class=\"fulltext-link\">(23)</a>. However, it requires the entire interfering channel gain information across all activated beams in all BSs. Moreover, the calculation of interference with the entire information also has high computational complexity. Hence, we adopt a heuristic idea to reduce the complexity with a consideration of only one <i>critical user</i> as a reference user of which interference approximates the entire interference from all scheduled users in the network.</p><p>A critical user is defined as a scheduled user who receives the highest interference from other beams. To select the critical user, we first define two users as follows: <i>(i)</i> inner reference user <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\text {iru}_{n_{c}, \\boldsymbol {b}}$\n</tex-math></inline-formula> who suffers the highest interference from the inner cluster BSs (see <a ref-type=\"disp-formula\" anchor=\"deqn24-deqn26\" href=\"#deqn24-deqn26\" class=\"fulltext-link\">(24)</a>), and <i>(ii)</i> outer reference user <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\text {oru}_{n_{c}, \\boldsymbol {b}}$\n</tex-math></inline-formula> who suffers the highest interference from the outer cluster BSs (see <a ref-type=\"disp-formula\" anchor=\"deqn24-deqn26\" href=\"#deqn24-deqn26\" class=\"fulltext-link\">(25)</a>). For example, in <a ref-type=\"fig\" anchor=\"fig4\" class=\"fulltext-link\">Fig. 4</a>, the inner and outer reference users of BS <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$3_{1}$\n</tex-math></inline-formula> are indicated in blue- and red-colored arrows, respectively. Then, the critical user <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\text {cri}_{n_{c}, \\boldsymbol {b}}$\n</tex-math></inline-formula> is designated as a user with the biggest interference among the determined inner and outer reference users (see <a ref-type=\"disp-formula\" anchor=\"deqn24-deqn26\" href=\"#deqn24-deqn26\" class=\"fulltext-link\">(26)</a>). Once the critical user is determined, the critical user is representative of all scheduled users to receive the interference.<disp-formula id=\"deqn24-deqn26\" class=\"display-formula\"><tex-math notation=\"LaTeX\">\\begin{align*} \\text {iru}_{n_{c}, \\boldsymbol {b}}=&amp;\\arg \\max | \\boldsymbol {h}_{n,k(x, \\nu ^{a_{x}})} \\boldsymbol {b}|^{2}, \\;\\; \\tag{24}\\\\&amp;\\forall x \\in S(n_{c}), \\quad \\forall \\nu ^{a_{x}} \\in \\mathcal {B}^{a_{x}}, \\\\ \\text {oru}_{n_{c}, \\boldsymbol {b}}=&amp;\\arg \\max | \\boldsymbol {h}_{n, k(y, \\upsilon ^{a_{y}})} \\boldsymbol {b}|^{2}, \\;\\; \\tag{25}\\\\&amp;\\forall c' \\in \\mathcal {C'}, \\quad \\forall y \\in E(m_{c'}), \\quad \\forall \\upsilon ^{a_{y}} \\in \\mathcal {B}^{a_{y}}, \\\\ \\text {cri}_{n_{c}, \\boldsymbol {b}}=&amp;\\max (\\text {iru}_{n_{c}, \\boldsymbol {b}},\\text {oru}_{n_{c}, \\boldsymbol {b}}), \\quad \\forall c \\in \\mathcal {C}, \\quad {n_{c}} \\in \\mathcal {N}_{c}, \\\\&amp;\\qquad b \\in \\mathcal {B},\\tag{26}\\end{align*}\n</tex-math><span class=\"formula\"><span class=\"link\">View Source</span><img aria-describedby=\"qtip-0\" style=\"display:inline;\" title=\"Right-click on figure or equation for MathML and additional features.\" data-hasqtip=\"0\" class=\"qtooltip moreInfo\" alt=\"Right-click on figure for MathML and additional features.\" src=\"/assets/img/icon.support.gif\" border=\"0\" height=\"20\" width=\"24\"/><span class=\"tex tex2jax_ignore\" style=\"display:none;\">\\begin{align*} \\text {iru}_{n_{c}, \\boldsymbol {b}}=&amp;\\arg \\max | \\boldsymbol {h}_{n,k(x, \\nu ^{a_{x}})} \\boldsymbol {b}|^{2}, \\;\\; \\tag{24}\\\\&amp;\\forall x \\in S(n_{c}), \\quad \\forall \\nu ^{a_{x}} \\in \\mathcal {B}^{a_{x}}, \\\\ \\text {oru}_{n_{c}, \\boldsymbol {b}}=&amp;\\arg \\max | \\boldsymbol {h}_{n, k(y, \\upsilon ^{a_{y}})} \\boldsymbol {b}|^{2}, \\;\\; \\tag{25}\\\\&amp;\\forall c' \\in \\mathcal {C'}, \\quad \\forall y \\in E(m_{c'}), \\quad \\forall \\upsilon ^{a_{y}} \\in \\mathcal {B}^{a_{y}}, \\\\ \\text {cri}_{n_{c}, \\boldsymbol {b}}=&amp;\\max (\\text {iru}_{n_{c}, \\boldsymbol {b}},\\text {oru}_{n_{c}, \\boldsymbol {b}}), \\quad \\forall c \\in \\mathcal {C}, \\quad {n_{c}} \\in \\mathcal {N}_{c}, \\\\&amp;\\qquad b \\in \\mathcal {B},\\tag{26}\\end{align*}\n</span></span></disp-formula> where <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$S(n_{c})$\n</tex-math></inline-formula> and <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$E(m_{c'})$\n</tex-math></inline-formula> denote the set of inner cluster BSs except for BS <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$n_{c}$\n</tex-math></inline-formula> and the set of outer cluster BSs, respectively.\n<div class=\"figure figure-full\" id=\"fig4\"><!--\n          Workaround for combined images.Eg.- 1000116 Fig. 5\n        --><div class=\"img-wrap\"><a href=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973235/kwak4-3227444-large.gif\" data-fig-id=\"fig4\"><img src=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973235/kwak4-3227444-small.gif\" alt=\"FIGURE 4. - The process of critical user selection.\"/><div class=\"zoom\" title=\"View Larger Image\"/></a></div><div class=\"figcaption\"><b class=\"title\">FIGURE 4. </b><fig><p>The process of critical user selection.</p></fig></div><p class=\"links\"><a href=\"/document/9973235/all-figures\" class=\"all\">Show All</a></p></div></p><p>Now, optimal power allocation can be obtained by satisfying KKT (Karush-Kuhn-Tucker) conditions <a ref-type=\"bibr\" anchor=\"ref24\" id=\"context_ref_24_3b3\">[24]</a> for any user scheduling and critical user selection as follows:<disp-formula id=\"deqn27\" class=\"display-formula\"><tex-math notation=\"LaTeX\">\\begin{align*} \\displaystyle p_{k(n_{c}, \\boldsymbol {b})} = \\left[{ \\frac {W_{k(n_{c}, \\boldsymbol {b})} / \\ln 2}{\\lambda _{n_{c}} + \\text {tax}_{n_{c}, \\boldsymbol {b}} + Z_{c}} - \\frac {\\eta _{k(n_{c}, \\boldsymbol {b})} + \\sigma _{k(n_{c}, \\boldsymbol {b})}}{ | \\boldsymbol {h}_{n_{c},k(n_{c}, \\boldsymbol {b})} \\boldsymbol {b}|^{2}} }\\right]^{P_{n_{c}}^{\\max }}_{0},\\!\\!\\!\\! \\tag{27}\\end{align*}\n</tex-math><span class=\"formula\"><span class=\"link\">View Source</span><img aria-describedby=\"qtip-0\" style=\"display:inline;\" title=\"Right-click on figure or equation for MathML and additional features.\" data-hasqtip=\"0\" class=\"qtooltip moreInfo\" alt=\"Right-click on figure for MathML and additional features.\" src=\"/assets/img/icon.support.gif\" border=\"0\" height=\"20\" width=\"24\"/><span class=\"tex tex2jax_ignore\" style=\"display:none;\">\\begin{align*} \\displaystyle p_{k(n_{c}, \\boldsymbol {b})} = \\left[{ \\frac {W_{k(n_{c}, \\boldsymbol {b})} / \\ln 2}{\\lambda _{n_{c}} + \\text {tax}_{n_{c}, \\boldsymbol {b}} + Z_{c}} - \\frac {\\eta _{k(n_{c}, \\boldsymbol {b})} + \\sigma _{k(n_{c}, \\boldsymbol {b})}}{ | \\boldsymbol {h}_{n_{c},k(n_{c}, \\boldsymbol {b})} \\boldsymbol {b}|^{2}} }\\right]^{P_{n_{c}}^{\\max }}_{0},\\!\\!\\!\\! \\tag{27}\\end{align*}\n</span></span></disp-formula> where <disp-formula id=\"deqn28-deqn29\" class=\"display-formula\"><tex-math notation=\"LaTeX\">\\begin{align*}&amp;\\text {tax}_{n_{c}, \\boldsymbol {b}} = \\frac {W_{\\text {cri}_{n_{c}, \\boldsymbol {b}}} | \\boldsymbol {h}_{n_{\\text {c}}, \\text {cri}_{n_{c}, \\boldsymbol {b}}} \\boldsymbol {b}|^{2} \\mu _{\\text {cri}_{n_{c}, \\boldsymbol {b}}}/ \\ln 2}{\\sum _{v \\in \\mathcal {N}} \\sum _{ \\boldsymbol {w} \\in \\mathcal {B}_{v}} |\\sqrt {p_{v, \\boldsymbol {w}}} \\boldsymbol {h}_{v, \\text {cri}_{n_{c}, \\boldsymbol {b}}} \\boldsymbol {w}|^{2} + \\sigma _{\\text {cri}_{n_{c}, \\boldsymbol {b}}}}, \\tag{28}\\\\&amp;\\lambda _{n_{c}} \\left({\\sum _{ \\boldsymbol {b} \\in \\mathcal {B}_{n_{c}}} p_{n_{c}, \\boldsymbol {b}} - P_{n_{c}}^{\\max } }\\right) = 0, \\tag{29}\\end{align*}\n</tex-math><span class=\"formula\"><span class=\"link\">View Source</span><img aria-describedby=\"qtip-0\" style=\"display:inline;\" title=\"Right-click on figure or equation for MathML and additional features.\" data-hasqtip=\"0\" class=\"qtooltip moreInfo\" alt=\"Right-click on figure for MathML and additional features.\" src=\"/assets/img/icon.support.gif\" border=\"0\" height=\"20\" width=\"24\"/><span class=\"tex tex2jax_ignore\" style=\"display:none;\">\\begin{align*}&amp;\\text {tax}_{n_{c}, \\boldsymbol {b}} = \\frac {W_{\\text {cri}_{n_{c}, \\boldsymbol {b}}} | \\boldsymbol {h}_{n_{\\text {c}}, \\text {cri}_{n_{c}, \\boldsymbol {b}}} \\boldsymbol {b}|^{2} \\mu _{\\text {cri}_{n_{c}, \\boldsymbol {b}}}/ \\ln 2}{\\sum _{v \\in \\mathcal {N}} \\sum _{ \\boldsymbol {w} \\in \\mathcal {B}_{v}} |\\sqrt {p_{v, \\boldsymbol {w}}} \\boldsymbol {h}_{v, \\text {cri}_{n_{c}, \\boldsymbol {b}}} \\boldsymbol {w}|^{2} + \\sigma _{\\text {cri}_{n_{c}, \\boldsymbol {b}}}}, \\tag{28}\\\\&amp;\\lambda _{n_{c}} \\left({\\sum _{ \\boldsymbol {b} \\in \\mathcal {B}_{n_{c}}} p_{n_{c}, \\boldsymbol {b}} - P_{n_{c}}^{\\max } }\\right) = 0, \\tag{29}\\end{align*}\n</span></span></disp-formula> where <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\text {tax}_{n_{c}, \\boldsymbol {b}}$\n</tex-math></inline-formula> is designed to impose a penalty on the power allocation. For instance, if a critical user <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\text {cri}_{n_{c}, \\boldsymbol {b}}$\n</tex-math></inline-formula> suffers high interference from the BS <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$n_{c}$\n</tex-math></inline-formula>, <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\text {tax}_{n_{c}, \\boldsymbol {b}}$\n</tex-math></inline-formula> increases as a penalty for it. Due to the strong penalty, <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$p_{n_{c}, \\boldsymbol {b}}$\n</tex-math></inline-formula> would decrease to reduce interference towards the critical user, and vice versa. Now, an initialized positive value <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\lambda ^{n_{c}}$\n</tex-math></inline-formula> is updated in the following steps. First, <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$p_{n_{c}, \\boldsymbol {b}}$\n</tex-math></inline-formula> is calculated based on <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\text {tax}_{n_{c}, \\boldsymbol {b}}$\n</tex-math></inline-formula> and initialized <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\lambda ^{n_{c}}$\n</tex-math></inline-formula>. Second, <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\lambda _{n_{c}}$\n</tex-math></inline-formula> is updated according to whether the sum of allocated powers exceeds <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$P_{n_{c}}^{\\max }$\n</tex-math></inline-formula>: if exceeds, <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\lambda _{n_{c}}$\n</tex-math></inline-formula> is updated with a higher value to reduce <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$p_{n_{c}, \\boldsymbol {b}}$\n</tex-math></inline-formula> in <a ref-type=\"disp-formula\" anchor=\"deqn27\" href=\"#deqn27\" class=\"fulltext-link\">(27)</a>, and vice versa. Next, using updated <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\lambda _{n_{c}}$\n</tex-math></inline-formula>, re-calculate <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$p_{n_{c}, \\boldsymbol {b}}$\n</tex-math></inline-formula>. We repeat this operation until the <a ref-type=\"disp-formula\" anchor=\"deqn28-deqn29\" href=\"#deqn28-deqn29\" class=\"fulltext-link\">equation (29)</a> satisfies via fast bisection method. In addition, if there is no value of <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\lambda _{n_{c}}$\n</tex-math></inline-formula> that holds the <a ref-type=\"disp-formula\" anchor=\"deqn28-deqn29\" href=\"#deqn28-deqn29\" class=\"fulltext-link\">equation (29)</a>, then <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\lambda _{n_{c}}$\n</tex-math></inline-formula> becomes zero. Consequently, we obtain the solutions of both <b>(SP-Pattern)</b> and <b>(SP2)</b>, and the total solution of the problems is called as CRIM algorithm. Now, we summarize what information is exchanged and how CRIM operates on the NOMA-based mmWave network system as illustrated in <a ref-type=\"fig\" anchor=\"fig5\" class=\"fulltext-link\">Fig. 5</a>.\n<div class=\"figure figure-full\" id=\"fig5\"><!--\n          Workaround for combined images.Eg.- 1000116 Fig. 5\n        --><div class=\"img-wrap\"><a href=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973235/kwak5-3227444-large.gif\" data-fig-id=\"fig5\"><img src=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973235/kwak5-3227444-small.gif\" alt=\"FIGURE 5. - The proposed framework and operation of CRIM algorithm.\"/><div class=\"zoom\" title=\"View Larger Image\"/></a></div><div class=\"figcaption\"><b class=\"title\">FIGURE 5. </b><fig><p>The proposed framework and operation of CRIM algorithm.</p></fig></div><p class=\"links\"><a href=\"/document/9973235/all-figures\" class=\"all\">Show All</a></p></div></p><p>The exchange of all messages in the proposed framework can be summarized as follows (see <a ref-type=\"fig\" anchor=\"fig5\" class=\"fulltext-link\">Fig. 5</a>). First, we can classify the messages into two types. The first type is small-sized messages such as activated beam indices, scheduled user indices, fairness queues and power sharing queues, and the second type is large-sized messages such as the RSS (Received Signal Strength), interference, and thermal noise of all users. In the case of large-sized ones, they can be exchanged among inner cluster BSs in real-time thanks to the short distance between BSs and fast interface (e.g., X2 interface). However, they should be minimally exchanged between clusters due to the long distance between clusters and slow interface. Hence, small-sized messages can be exchanged in near real-time whereas large-sized messages can be intermittently exchanged with a form of average value.</p><p>Then, the inner cluster BSs can exploit all types of messages in real-time whereas the outer cluster BSs can exploit only small-sized ones in real-time, and can intermittently exploit the time-averaged large-sized ones. In other words, the proposed framework exchanges messages as much as possible within the cluster to increase network utility, yet minimally exchanges large-sized ones among inter-clusters to reduce feedback overhead and latency. Since the proposed CRIM algorithm is operated in two different time scales as well, the large-sized messages can be separately exploited in the short time-scale CRIM algorithm (i.e., making a decision of beam pattern) and long time-scale CRIM algorithm (i.e., making decisions of user scheduling and transmit power), respectively.</p><p>In the short time-scale (i.e., every time slot <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$t$\n</tex-math></inline-formula>), BS <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$n_{c}$\n</tex-math></inline-formula> receives small-sized messages \u24d0 from server <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$c$\n</tex-math></inline-formula>, and makes decisions of beam activation, user scheduling and transmit power using CRIM as shown in <a ref-type=\"fig\" anchor=\"fig5\" class=\"fulltext-link\">Fig. 5</a>. Then, BS <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$n_{c}$\n</tex-math></inline-formula> transmits the small-sized ones \u24d1 to server <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$c$\n</tex-math></inline-formula>, and the server exchanges the small-sized ones \u24d2 among servers in the neighbor clusters. In the long-time scale (i.e., every <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$T_{a}$\n</tex-math></inline-formula> time slots), BS <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$n_{c}$\n</tex-math></inline-formula> computes the partial derivative using <a ref-type=\"disp-formula\" anchor=\"deqn21\" href=\"#deqn21\" class=\"fulltext-link\">(21)</a>. Then, the calculated partial derivative (a) is sent to server <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$c$\n</tex-math></inline-formula> to update the probability of beam pattern selection <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\boldsymbol {\\pi }^{n_{c}}$\n</tex-math></inline-formula> as shown in <a ref-type=\"fig\" anchor=\"fig5\" class=\"fulltext-link\">Fig. 5</a>. Then, the large-sized messages (b) are exchanged between servers in the outer clusters, and the large-sized ones (c) are returned to each inner cluster BS.</p><p><b><a ref-type=\"algorithm\" anchor=\"alg1\" class=\"fulltext-link\">Algorithm 1</a></b> (for every time slot): Each MEC server <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$c$\n</tex-math></inline-formula> receives the abovementioned small-sized messages from the inner cluster BSs. Then, it exchanges small-sized ones with MEC in the outer cluster <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$c'$\n</tex-math></inline-formula>. Once the message exchange is done, the MEC server provides entire messages obtained above to the inner cluster BSs. Next, if the transmit power allocation of BSs is decided, the power sharing queue is updated by the server in the same cluster. Each BS <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$n_{c}\\in \\mathcal {N}_{c}$\n</tex-math></inline-formula> randomly selects the set of beam activations <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$a$\n</tex-math></inline-formula> with probability of <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\boldsymbol{\\pi }^{n_{c}}_{a}$\n</tex-math></inline-formula> updated by the MEC server <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$c$\n</tex-math></inline-formula>. Once the set of beam activations is selected, the BS <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$n_{c}$\n</tex-math></inline-formula> allocates equal transmit power to the selected beams. Then, each BS makes decisions of user scheduling and critical user using <a ref-type=\"disp-formula\" anchor=\"deqn23\" href=\"#deqn23\" class=\"fulltext-link\">(23)</a> and <a ref-type=\"disp-formula\" anchor=\"deqn24-deqn26\" href=\"#deqn24-deqn26\" class=\"fulltext-link\">(26)</a>, respectively. Then, BS <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$n_{c}$\n</tex-math></inline-formula> calculates its transmit power using a fast bisection method until <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$p_{n_{c}, \\boldsymbol {b}}$\n</tex-math></inline-formula> converges. Finally, data rates, auxiliary variables and fairness queues for all users are updated.<div class=\"algorithm\" id=\"alg1\"><h4>Algorithm 1 CRIM for Every Time Slot</h4><p><u><b>At each MEC server <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\forall c \\in \\mathcal {C}$\n</tex-math></inline-formula>,</b></u></p><p><b>Receive information from BS <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\; n_{c}: $\n</tex-math></inline-formula></b></p><p><inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\hspace {0.2cm} \\text {activated beam indices}~\\boldsymbol {b}({n_{c}})(t),\\; \\forall n_{c}$\n</tex-math></inline-formula>.</p><p><inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\hspace {0.2cm} \\text {scheduled users' indices}~{k}({n_{c}})(t),\\; \\forall n_{c}$\n</tex-math></inline-formula>.</p><p><inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\hspace {0.2cm} \\text {fairness queues } W_{k(n_{c})}(t),\\; \\forall n_{c}$\n</tex-math></inline-formula>.</p><p><inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\hspace {0.2cm} \\text {received signal strength } \\text {RSS}_{k({n_{c})}}^{n_{c}, \\boldsymbol b},\\; \\forall n_{c},\\; \\forall b$\n</tex-math></inline-formula>.</p><p><inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\hspace {0.2cm} \\text {interference plus noise } \\omega _{k({n_{c})}}^{n_{c}, \\boldsymbol b} + \\sigma _{k({n_{c})}}^{n_{c}, \\boldsymbol b},\\; \\forall n_{c},\\; \\forall b$\n</tex-math></inline-formula>.</p><p><b>Send to neighbor MEC server</b> <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$c^{\\prime }:$\n</tex-math></inline-formula></p><p><inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\hspace {0.2cm} \\text {activated beam indices}~\\boldsymbol {b}({n_{c}})(t),\\; \\forall n_{c}$\n</tex-math></inline-formula>.</p><p><inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\hspace {0.2cm} \\text {scheduled users' indices}~{k}({n_{c}})(t),\\; \\forall n_{c}$\n</tex-math></inline-formula>.</p><p><inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\hspace {0.2cm} \\text {fairness queues } W_{k(n_{c})}(t),\\; \\forall n_{c}$\n</tex-math></inline-formula>.</p><p><b>Receive from neighbor MEC server</b> <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$c^{\\prime }: $\n</tex-math></inline-formula></p><p><inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\hspace {0.2cm} \\text {activated beam indices}~\\boldsymbol {b}({n_{c^{\\prime }}})(t),\\; \\forall n_{c^{\\prime }} \\in \\mathcal {N}_{c^{\\prime }},\\; \\forall c^{\\prime } \\in \\mathcal {C}^{\\prime }$\n</tex-math></inline-formula>.</p><p><inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\hspace {0.16cm} \\text {scheduled users' indices } {k}({n_{c^{\\prime }}})(t),\\; \\forall n_{c^{\\prime }} \\in \\mathcal {N}_{c^{\\prime }},\\; \\forall c^{\\prime } \\in \\mathcal {C}^{\\prime }$\n</tex-math></inline-formula>.</p><p><inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\hspace {0.2cm} \\text {fairness queues } W_{k(n_{c^{\\prime }})}(t),\\; \\forall n_{c^{\\prime }} \\in \\mathcal {N}_{c^{\\prime }},\\; \\forall c^{\\prime } \\in \\mathcal {C}^{\\prime }$\n</tex-math></inline-formula>.</p><p><b>Send to BS</b> <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$n_{c}:~$\n</tex-math></inline-formula></p><p><inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\hspace {0.2cm}\\text {activated beam indices}~\\mathcal {B}(t),\\text {scheduled users' indices}~\\mathcal {K}(t)$\n</tex-math></inline-formula>.</p><p><inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\hspace {0.2cm} \\text {fairness queues } W_{k}(t),\\forall k$\n</tex-math></inline-formula>.</p><p>user\u2019s received signal strength of inner cluster</p><p><inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\hspace {0.2cm} \\text {RSS}_{\\text {k}({n_{c}})}^{(x, \\nu ^{a_{x}})},\\; \\forall \\nu ^{a_{x}} \\in \\mathcal {B}^{a_{x}}, \\; \\forall x \\in \\mathcal {S}(n_{c}),\\; \\forall n_{c}$\n</tex-math></inline-formula>.</p><p>user\u2019s interference plus noise of inner cluster</p><p><inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\hspace {0.2cm} \\omega _{\\text {k}(n_{c})}^{(x, \\nu ^{a_{x}})} + \\sigma _{\\text {k}({n_{c}})}^{(x, \\nu ^{a_{x}})},\\; \\forall \\nu ^{a_{x}} \\in \\mathcal {B}^{a_{x}},\\; \\forall x \\in \\mathcal {S}(n_{c}),\\; \\forall n_{c}$\n</tex-math></inline-formula>.</p><p><inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\hspace {0.2cm} \\text {power sharing queue}~Z_{c}(t)$\n</tex-math></inline-formula>.</p><p><b>Receive from BS</b> <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\; n_{c}:$\n</tex-math></inline-formula></p><p><inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\hspace {0.2cm} { \\boldsymbol p}_{n_{c}, \\boldsymbol {b}}(t),\\forall \\boldsymbol {b} \\in \\mathcal {B}_{n_{c}}, \\forall n_{c} \\; \\text {for updating power sharing queue}$\n</tex-math></inline-formula>.</p><p><b>Update:</b> power sharing queue <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\,\\,Z_{c}(t+1), \\; \\text {using} \\; (\\ref {eq:power_{s}haring_{q}ueue})$\n</tex-math></inline-formula>.</p><p><u><b>At each BS <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\forall n_{c} \\in \\mathcal {N}_{c}$\n</tex-math></inline-formula>, <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\forall c \\in \\mathcal {C}$\n</tex-math></inline-formula>,</b></u></p><p><b>Beam selection:</b> Each BS <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$n_{c}$\n</tex-math></inline-formula> selects beam pattern <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$a$\n</tex-math></inline-formula> based on probability of beam pattern <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\boldsymbol {\\pi }^{n_{c}}$\n</tex-math></inline-formula>.</p><p><b>Setting initial transmit power:</b> <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$~p_{n_{c}}^{ \\boldsymbol b}(t) \\leftarrow P_{n_{c}}^{\\max }/|\\mathcal {B}^{a_{n}}|$\n</tex-math></inline-formula>.</p><p><b>User scheduling:</b> Each BS <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$n_{c}$\n</tex-math></inline-formula> schedules a user using <a ref-type=\"disp-formula\" anchor=\"deqn23\" href=\"#deqn23\" class=\"fulltext-link\">(23)</a> based on selected pattern <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$a$\n</tex-math></inline-formula>.</p><p><b>Send to MEC server <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$c$\n</tex-math></inline-formula>:</b></p><p><inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\hspace {0.2cm} \\text {activated beam indices}~\\boldsymbol {b}({n_{c}})(t)$\n</tex-math></inline-formula></p><p><inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\hspace {0.2cm} \\text {scheduled users' indices } {k}({n_{c}}, \\boldsymbol b)(t), \\text {fairness queues } W_{k}(t), \\; \\forall k$\n</tex-math></inline-formula>.</p><p><inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\hspace {0.2cm} \\text {received signal strength } \\text {RSS}_{k({n_{c})}}^{(n_{c}, \\boldsymbol b)}, \\; \\forall k$\n</tex-math></inline-formula>.</p><p><inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\hspace {0.2cm} \\text {interference plus noise } \\omega _{k({n_{c})}}^{(n_{c}, \\boldsymbol b)} + \\sigma _{k({n_{c})}}^{(n_{c}, \\boldsymbol b)}, \\; \\forall k$\n</tex-math></inline-formula>.</p><p><b>Receive from MEC server</b> <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$c$\n</tex-math></inline-formula>:</p><p><inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\hspace {0.2cm}\\text {activated beam indices}~\\mathcal {B}(t), \\; \\text {scheduled users' indices}~\\mathcal {K}(t)$\n</tex-math></inline-formula>.</p><p>Inner cluster scheduled users\u2019 received signal strength</p><p><inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\hspace {0.2cm} {\\text {RSS}_{k(x, \\nu ^{a_{x}})}^{(n_{c}, \\boldsymbol b)},\\; \\forall x \\in S(n_{c}), \\; \\forall \\nu ^{a_{x}} \\in \\mathcal {B}^{a_{x}}}$\n</tex-math></inline-formula>.</p><p>Inner cluster scheduled users\u2019 interference plus noise</p><p><inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\hspace {0.2cm} \\omega _{{k(x, \\nu ^{a_{x}})}}^{(n_{c}, \\boldsymbol b)} + \\sigma _{{k(x, \\nu ^{a_{x}})}}^{(n_{c}, \\boldsymbol b)},\\; \\forall x \\in S(n_{c}), \\; \\forall \\nu ^{a_{x}} \\in \\mathcal {B}^{a_{x}}$\n</tex-math></inline-formula>.</p><p>fairness queues from inner and outer cluster scheduled users,</p><p><inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\hspace {0.2cm}W_{k(x)},\\forall x \\in S(n_{c})$\n</tex-math></inline-formula> and <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$W_{k(y)},\\forall y \\in S(n_{c'})$\n</tex-math></inline-formula>, respectively.</p><p><inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\hspace {0.2cm} \\text {power sharing queue}~Z_{c}(t)$\n</tex-math></inline-formula>.</p><p><b>Critical user selection:</b> Determine the critical user from inner and outer reference users <a ref-type=\"disp-formula\" anchor=\"deqn24-deqn26\" href=\"#deqn24-deqn26\" class=\"fulltext-link\">(26)</a>.</p><p><b>Power allocation:</b></p><p><inline-formula id=\"\"><tex-math notation=\"LaTeX\">$[i,j] \\leftarrow [0, \\lambda _{n_{c}}^{max}]$\n</tex-math></inline-formula>.</p><p><b>while</b> <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$|\\sum _{ \\boldsymbol {b} \\in \\mathcal {B}_{n_{c}}} p_{n_{c}, \\boldsymbol {b}}(t) - P_{n_{c}}^{max}| &lt; \\delta $\n</tex-math></inline-formula> <b>do</b></p><p>Set <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\lambda _{n_{c}} = (i+j)/2$\n</tex-math></inline-formula> and update <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$p_{n, \\boldsymbol {b}}(t)$\n</tex-math></inline-formula> using <a ref-type=\"disp-formula\" anchor=\"deqn27\" href=\"#deqn27\" class=\"fulltext-link\">(27)</a>.</p><p><b>if</b> <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\sum _{ \\boldsymbol {b} \\in \\mathcal {B}_{n}} p_{n, \\boldsymbol {b}}(t) &gt; P_{n_{c}}^{max}$\n</tex-math></inline-formula> <b>then</b></p><p><inline-formula id=\"\"><tex-math notation=\"LaTeX\">$[i,j] \\leftarrow [\\lambda _{n_{c}}, j]$\n</tex-math></inline-formula>.</p><p><b>else if</b> <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\sum _{ \\boldsymbol {b} \\in \\mathcal {B}_{n}} p_{n, \\boldsymbol {b}}(t) &lt; P_{n_{c}}^{max}$\n</tex-math></inline-formula> <b>then</b></p><p><inline-formula id=\"\"><tex-math notation=\"LaTeX\">$[i,j] \\leftarrow [i, \\lambda _{n_{c}}]$\n</tex-math></inline-formula>.</p><p><b>end if</b></p><p><b>end while.</b></p><p><b>Update:</b> <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$r_{k}(t), \\; \\gamma _{k}(t), \\; \\text {and} \\; {W}_{k}(t+1), \\forall k \\in \\mathcal {K}_{n_{c}} $\n</tex-math></inline-formula></p><p><inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\hspace {1.3cm} \\text {using} \\; (\\ref {eq:rate}), (\\ref {eq:opt_{g}amma}), \\; \\text {and} \\; (\\ref {eq:fairness_{d}ynamic}), \\; \\text {respectively}$\n</tex-math></inline-formula>.</p><p><b>Send to MEC server</b> <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$c: { \\boldsymbol p}_{n_{c}}(t)$\n</tex-math></inline-formula> for updating power sharing queue.</p></div></p><p><b><a ref-type=\"algorithm\" anchor=\"alg2\" class=\"fulltext-link\">Algorithm 2</a></b> (for every <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$T_{a} \\gg 1$\n</tex-math></inline-formula> time slots): Each MEC server <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$c$\n</tex-math></inline-formula> receives the partial derivative from the BSs <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$n_{c}\\in \\mathcal {N}_{c}$\n</tex-math></inline-formula> to calculate the gradient vector <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\boldsymbol {D}$\n</tex-math></inline-formula>. Then, MEC server <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$c$\n</tex-math></inline-formula> updates the beam pattern selection probability <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\boldsymbol {\\pi }$\n</tex-math></inline-formula> using <a ref-type=\"disp-formula\" anchor=\"deqn22\" href=\"#deqn22\" class=\"fulltext-link\">(22)</a>. Moreover, MEC server <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$c$\n</tex-math></inline-formula> exchanges large-sized messages such as time-average RSS and interference plus noises to BSs in the outer cluster during <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$T_{a}$\n</tex-math></inline-formula> time slots. Thanks to long-time message exchange, the average feedback latency and overhead between servers can be further reduced and the CRIM algorithm can be practically operated.<div class=\"algorithm\" id=\"alg2\"><h4>Algorithm 2 CRIM for Every <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$T_{a} \\gg1$\n</tex-math></inline-formula> Time Slots</h4><p><u><b>At each MEC server <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\forall c \\in \\mathcal {C}$\n</tex-math></inline-formula>,</b></u></p><p><b>Calculate gradient vector:</b> MEC server computes the gradient vector <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\boldsymbol {D^{n_{c}}}=(D_{1}^{n_{c}}, \\cdots, D_{A}^{n_{c}})$\n</tex-math></inline-formula> by collecting <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$D_{a}^{n_{c}}$\n</tex-math></inline-formula>.</p><p><b>Update pattern portion:</b> MEC server updates the probability of beam pattern <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\boldsymbol {\\pi }$\n</tex-math></inline-formula> using <a ref-type=\"disp-formula\" anchor=\"deqn22\" href=\"#deqn22\" class=\"fulltext-link\">(22)</a>.</p><p><b>Send to neighbor MEC server <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$c^{\\prime }:$\n</tex-math></inline-formula></b></p><p><u>avg. RSS</u>s <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\hspace {0.2cm}\\text {of all associated users in cluster {c}}$\n</tex-math></inline-formula></p><p><inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\hspace {0.2cm} \\overline {\\text {RSS}_{k}^{n_{c}, \\boldsymbol {b}}}, \\forall k \\in \\mathcal {K}_{n_{c}}, \\; \\forall \\boldsymbol {b} \\in \\mathcal {B}_{n_{c}}, \\; \\forall n_{c}$\n</tex-math></inline-formula>.</p><p><u>avg. i</u>nte<u>rferen</u>ce plus noise of all associated users in cluster <i>c</i></p><p><inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\hspace {0.2cm} \\overline {\\omega _{k}^{n_{c}, \\boldsymbol {b}}} + \\overline {\\sigma _{k}^{n_{c}, \\boldsymbol {b}}}, \\; \\forall k \\in \\mathcal {K}_{n_{c}}, \\; \\forall \\boldsymbol {b} \\in \\mathcal {B}_{n_{c}}, \\; \\forall n_{c}$\n</tex-math></inline-formula>.</p><p><b>Receive from neighbor MEC server</b> <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$c^{\\prime }: $\n</tex-math></inline-formula></p><p><u>avg. RSS</u> <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\hspace {0.2cm} \\text { of all users}~\\text {in outer clusters }$\n</tex-math></inline-formula></p><p><inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\hspace {0.2cm} \\overline {\\text {RSS}_{k}^{m_{c^{\\prime }}, \\boldsymbol {b}}}, \\forall k \\in \\mathcal {K}_{m_{c^{\\prime }}}, \\; \\forall \\boldsymbol {b} \\in \\mathcal {B}_{m_{c^{\\prime }}}, \\forall m_{c^{\\prime }} \\in \\mathcal {N}_{c^{\\prime }}, \\; \\forall c^{\\prime } \\in \\mathcal {C}^{\\prime }$\n</tex-math></inline-formula>.</p><p><u>avg. in</u>ter<u>ference</u> plus noise of all users in outer clusters</p><p><inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\hspace {0.2cm} \\overline {\\omega _{k}^{m_{c^{\\prime }}, \\boldsymbol {b}}} + \\overline {\\sigma _{k}^{m_{c^{\\prime }}, \\boldsymbol {b}}}, \\forall k \\in \\mathcal {K}_{m_{c^{\\prime }}}, \\forall \\boldsymbol {b} \\in \\mathcal {B}_{m_{c^{\\prime }}}, \\forall m_{c^{\\prime }} \\in \\mathcal {N}_{c^{\\prime }}, \\forall c^{\\prime } \\in \\mathcal {C}^{\\prime} $\n</tex-math></inline-formula>.</p><p><b>Send to BS</b> <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$n_{c}: $\n</tex-math></inline-formula></p><p><inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\hspace {0.2cm} \\text {beam pattern portion of BSs}~\\pi _{a}^{n_{c}}, \\; \\forall a \\in \\mathcal {A}, \\forall n_{c}$\n</tex-math></inline-formula></p><p><u>avg. RSS</u>s <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\hspace {0.2cm} \\text {of all users}~\\text {in BSs in outer clusters }$\n</tex-math></inline-formula></p><p><inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\hspace {0.2cm} \\overline {\\text {RSS}_{k}^{m_{c^{\\prime }}, \\boldsymbol {b}}}, \\forall k \\in \\mathcal {K}_{m_{c^{\\prime }}}, \\; \\forall \\boldsymbol {b} \\in \\mathcal {B}_{m_{c^{\\prime }}}, \\forall m_{c^{\\prime }} \\in \\mathcal {N}_{c^{\\prime }}, \\; \\forall c^{\\prime } \\in \\mathcal {C}^{\\prime }$\n</tex-math></inline-formula>.</p><p>avg. interference plus noise of all users in BSs in outer clusters</p><p><inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\hspace {0.2cm} \\overline {\\omega _{k}^{m_{c^{\\prime }}, \\boldsymbol {b}}} + \\overline {\\sigma _{k}^{m_{c^{\\prime }}, \\boldsymbol {b}}}, \\forall k \\in \\mathcal {K}_{m_{c^{\\prime }}}, \\forall \\boldsymbol {b} \\in \\mathcal {B}_{m_{c^{\\prime }}}, \\forall m_{c^{\\prime }} \\in \\mathcal {N}_{c^{\\prime }}, \\forall c^{\\prime } \\in \\mathcal {C}^{\\prime} $\n</tex-math></inline-formula>.</p><p><b><u>At each BS <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\forall n_{c} \\in \\mathcal {N}_{c}$\n</tex-math></inline-formula>, <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\forall c \\in \\mathcal {C}$\n</tex-math></inline-formula>,</u></b></p><p><b>Calculate partial derivative</b> <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$c:$\n</tex-math></inline-formula></p><p><inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\text {computes the partial derivative } D_{a}^{n_{c}}$\n</tex-math></inline-formula> using <a ref-type=\"disp-formula\" anchor=\"deqn21\" href=\"#deqn21\" class=\"fulltext-link\">(21)</a>. <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\forall a \\in \\mathcal {A}$\n</tex-math></inline-formula>.</p><p><b>Send to MEC server</b> <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$c:\\text {partial derivative } D_{a}^{n_{c}}. \\; \\forall a \\in \\mathcal {A}$\n</tex-math></inline-formula>.</p><p><b>Receive from MEC server</b> <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$c:$\n</tex-math></inline-formula></p><p><u>avg. RSS</u> of users in BSs in outer clusters</p><p><inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\hspace {0.2cm} \\overline {\\text {RSS}_{k}^{m_{c^{\\prime }}, \\boldsymbol {b}}}, \\forall k \\in \\mathcal {K}_{m_{c^{\\prime }}}, \\; \\forall \\boldsymbol {b} \\in \\mathcal {B}_{m_{c^{\\prime }}}, \\forall m_{c^{\\prime }} \\in \\mathcal {N}_{c^{\\prime }}, \\; \\forall c^{\\prime } \\in \\mathcal {C}^{\\prime }$\n</tex-math></inline-formula>.</p><p><u>avg. in</u>ter<u>ference</u> plus noise of users in BSs in outer clusters</p><p><inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\hspace {0.2cm} \\overline {\\omega _{k}^{m_{c^{\\prime }}, \\boldsymbol {b}}} + \\overline {\\sigma _{k}^{m_{c^{\\prime }}, \\boldsymbol {b}}}, \\forall k \\in \\mathcal {K}_{m_{c^{\\prime }}}, \\forall \\boldsymbol {b} \\in \\mathcal {B}_{m_{c^{\\prime }}}, \\forall m_{c^{\\prime }} \\in \\mathcal {N}_{c^{\\prime }}, \\forall c^{\\prime } \\in \\mathcal {C}^{\\prime} $\n</tex-math></inline-formula>.</p></div></p></div></div></div>\n<div class=\"section\" id=\"sec4\"><div class=\"header article-hdr\"><div class=\"kicker\">\n\t\t                        SECTION IV.</div><h2>Performance Evaluation</h2></div><p>In this section, we evaluate the proposed CRIM algorithm and existing algorithms via simulations with the realistic channel model and parameters in 5G standard <a ref-type=\"bibr\" anchor=\"ref25\" id=\"context_ref_25_4\">[25]</a>.</p><div class=\"section_2\" id=\"sec4a\"><h3>A. Setup</h3><p>For the wireless channel model, we use UMi-street canyon pathloss model with 28GHz of center frequency (mmWave) <a ref-type=\"bibr\" anchor=\"ref25\" id=\"context_ref_25_4a\">[25]</a>. In our simulation scenarios, each BS is assumed to have 10 transmit antennas, and the maximum transmit power of each BS and long-term transmit power budget of each cluster are set to 2W and 1W multiplied by the number of BSs included in each cluster, respectively. We carry out the simulations based on the real BS topology in South Korea to see the GAT performance of algorithms. In addition, to show the different impact of various parameters on the system performance, positions of BSs are stochastically generated by PPP (Poisson point process) model <a ref-type=\"bibr\" anchor=\"ref26\" id=\"context_ref_26_4a\">[26]</a> which captures the realistic heterogeneity of the cellular networks.<a ref-type=\"fn\" anchor=\"fn8\" class=\"footnote-link\">8</a> For all simulation scenarios, 4 clusters are considered, and we manually locate each cluster so as to contain a similar number of BSs.<a ref-type=\"fn\" anchor=\"fn9\" class=\"footnote-link\">9</a> Moreover, each user belongs to a single BS, and the positions of each users are randomly determined. The total operation time of each simulation is set to 5000 time slots where each time slot is set to 1 millisecond.</p><p>We compare the existing algorithms, i.e., <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\textit {Greedy}$\n</tex-math></inline-formula> <a ref-type=\"bibr\" anchor=\"ref27\" id=\"context_ref_27_4a\">[27]</a>, <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\textit {IGS}$\n</tex-math></inline-formula> <a ref-type=\"bibr\" anchor=\"ref28\" id=\"context_ref_28_4a\">[28]</a>, and <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\textit {ON/OFF}$\n</tex-math></inline-formula> <a ref-type=\"bibr\" anchor=\"ref29\" id=\"context_ref_29_4a\">[29]</a> with CRIM. In the Greedy algorithm, each user selects a beam greedily so as to achieve the highest SINR in conjunction with proportional fairness (PF) scheduling policy. Next, the IGS algorithm selects user and beam pairs sequentially. When selecting each pair, the user selects a beam that can achieve the highest SINR with a consideration of the interference from the previously selected pairs. The ON/OFF algorithm is designed based on the 3GPP standard <a ref-type=\"bibr\" anchor=\"ref29\" id=\"context_ref_29_4a\">[29]</a>. First, users are scheduled according to the PF scheduling policy assuming that all beams in all BSs are activated. Next, each BS checks whether the strength of interference to users scheduled in other BSs is higher than the pre-defined threshold or not. If the interference is larger than the threshold, then the corresponding BS is deactivated, vice versa.</p><p>To compare the existing algorithms with CRIM, we consider three metrics: GAT (Geometric Average user Throughput), Avg. throughput (Average user Throughput), and allocated power. Maximizing the GAT (in Mbps) is equivalent to maximizing our objective value, i.e., <b>(P)</b> meaning that it takes into account both fairness and throughput of users. The Avg. throughput (in Mbps) is time average throughput of users in the entire network. The allocated power (in Watt) is the amount of transmit power allocated to the scheduled user.</p><p>On top of this setup, we conduct four simulations as follows: <i>(i)</i> simulation on the real network topologies in South Korea, <i>(ii)</i> simulation for different BS intensities in PPP model, <i>(iii)</i> simulation for different the average number of users in each BS in PPP model, and <i>(iv)</i> simulation for different multiple access schemes on CRIM in PPP model. Via simulations, we could observe interesting points as follows: <i>(i)</i> CRIM outperforms the existing algorithms in terms of GAT and Avg. throughput, <i>(ii)</i> the impact of spatio-temporal power sharing is significant, and <i>(iii)</i> the advantage of NOMA is more pronounced in CRIM than in the existing algorithms. We describe these observations in detail as follows.</p><p>First, we compare the GAT performance of CRIM and the existing algorithms on the real network topologies deployed in the metropolitan area of South Korea. As depicted in <a ref-type=\"fig\" anchor=\"fig6\" class=\"fulltext-link\">Fig. 6</a>, two network topologies are considered and named as <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\textit {Seoul1}$\n</tex-math></inline-formula> and <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\textit {Seoul2}$\n</tex-math></inline-formula>. Each topology has 25 and 21 BSs, respectively, with 4 clusters positioned to contain 4 to 7 BSs. As shown in <a ref-type=\"fig\" anchor=\"fig7\" class=\"fulltext-link\">Fig. 7</a>, it can be confirmed that CRIM outperforms the existing algorithms in terms of GAT for both topologies. For example, in <inline-formula id=\"\"><tex-math notation=\"LaTeX\">$\\textit {Seoul1}$\n</tex-math></inline-formula>, the GAT improvements from the existing algorithms to CRIM are 27.3% (in IGS), 47.4% (in Greedy) and 164.9% (in ON/OFF).\n<div class=\"figure figure-full\" id=\"fig6\"><!--\n          Workaround for combined images.Eg.- 1000116 Fig. 5\n        --><div class=\"img-wrap\"><a href=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973235/kwak6-3227444-large.gif\" data-fig-id=\"fig6\"><img src=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973235/kwak6-3227444-small.gif\" alt=\"FIGURE 6. - The real network topology in South Korea.\"/><div class=\"zoom\" title=\"View Larger Image\"/></a></div><div class=\"figcaption\"><b class=\"title\">FIGURE 6. </b><fig><p>The real network topology in South Korea.</p></fig></div><p class=\"links\"><a href=\"/document/9973235/all-figures\" class=\"all\">Show All</a></p></div>\n<div class=\"figure figure-full\" id=\"fig7\"><!--\n          Workaround for combined images.Eg.- 1000116 Fig. 5\n        --><div class=\"img-wrap\"><a href=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973235/kwak7-3227444-large.gif\" data-fig-id=\"fig7\"><img src=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973235/kwak7-3227444-small.gif\" alt=\"FIGURE 7. - GAT for different network topologies.\"/><div class=\"zoom\" title=\"View Larger Image\"/></a></div><div class=\"figcaption\"><b class=\"title\">FIGURE 7. </b><fig><p>GAT for different network topologies.</p></fig></div><p class=\"links\"><a href=\"/document/9973235/all-figures\" class=\"all\">Show All</a></p></div></p></div><div class=\"section_2\" id=\"sec4b\"><h3>B. Throughput Performance</h3></div><div class=\"section_2\" id=\"sec4c\"><h3>C. Impact of Spatial Power Sharing</h3><p>To see the impact of spatial power sharing that shares transmit power within the same cluster, simulations are conducted while increasing the intensity of BSs in PPP model. As the intensity increases, the distances between the BSs decrease, which results in greater interference to users. <a ref-type=\"fig\" anchor=\"fig8\" class=\"fulltext-link\">Fig. 8</a> shows that the performance of all algorithms decreases when intensity becomes higher. However, in the case of CRIM, it can be seen that the performance degradation is smaller than that of the other algorithms. In aspects of fairness, BSs have to allocate more transmit power to edge users who suffer more interference when intensity increases. If BSs use a fixed transmit power budget (i.e., other algorithms), center users will be allocated less transmit power inevitably. On the contrary, CRIM can exploit spatial power sharing to share transmit power among BSs in the same cluster while keeping the average transmit power constraint. Moreover, <a ref-type=\"fig\" anchor=\"fig9\" class=\"fulltext-link\">Fig. 9</a> shows the ratio of transmit power usage of each BS included in cluster 2 in case of CRIM and Greedy. As shown in <a ref-type=\"fig\" anchor=\"fig9\" class=\"fulltext-link\">Fig. 9(a)</a> and <a ref-type=\"fig\" anchor=\"fig9\" class=\"fulltext-link\">Fig. 9(b)</a>, the results show that CRIM differently allocates transmit power to BSs in different time slots. In other words, if higher transmit powers in BSs are allocated in previous time slots, then lower transmit powers in the BSs are allocated in future time slots, and vice versa. On the other hand, in <a ref-type=\"fig\" anchor=\"fig9\" class=\"fulltext-link\">Fig. 9(c)</a> and <a ref-type=\"fig\" anchor=\"fig9\" class=\"fulltext-link\">Fig. 9(d)</a>, the results depict that Greedy allocates the same transmit powers in BSs for both time slots.\n<div class=\"figure figure-full\" id=\"fig8\"><!--\n          Workaround for combined images.Eg.- 1000116 Fig. 5\n        --><div class=\"img-wrap\"><a href=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973235/kwak8-3227444-large.gif\" data-fig-id=\"fig8\"><img src=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973235/kwak8-3227444-small.gif\" alt=\"FIGURE 8. - Performance comparison for different intensities.\"/><div class=\"zoom\" title=\"View Larger Image\"/></a></div><div class=\"figcaption\"><b class=\"title\">FIGURE 8. </b><fig><p>Performance comparison for different intensities.</p></fig></div><p class=\"links\"><a href=\"/document/9973235/all-figures\" class=\"all\">Show All</a></p></div>\n<div class=\"figure figure-full\" id=\"fig9\"><!--\n          Workaround for combined images.Eg.- 1000116 Fig. 5\n        --><div class=\"img-wrap\"><a href=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973235/kwak9abcd-3227444-large.gif\" data-fig-id=\"fig9\"><img src=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973235/kwak9abcd-3227444-small.gif\" alt=\"FIGURE 9. - Ratio of transmit powers of BSs in cluster 2.\"/><div class=\"zoom\" title=\"View Larger Image\"/></a></div><div class=\"figcaption\"><b class=\"title\">FIGURE 9. </b><fig><p>Ratio of transmit powers of BSs in cluster 2.</p></fig></div><p class=\"links\"><a href=\"/document/9973235/all-figures\" class=\"all\">Show All</a></p></div></p></div><div class=\"section_2\" id=\"sec4d\"><h3>D. Impact of Temporal Power Sharing</h3><p>We conduct simulations to observe GAT performance as a function of the average number of users. For the simulation topology, 4 clusters and 7 BSs at each cluster are deployed according to the PPP model. As shown in <a ref-type=\"fig\" anchor=\"fig10\" class=\"fulltext-link\">Fig. 10</a>, the performance degradation of CRIM is smaller than that of the other algorithms as the average number of users increases. This is because CRIM can exploit the degree of freedom for temporal power sharing, which flexibly uses a certain amount of transmit power budget for long-time period. <a ref-type=\"fig\" anchor=\"fig11\" class=\"fulltext-link\">Fig. 11</a> depicts the transmit power allocated to users scheduled in a certain BS (i.e., BS 2) for selected time slots<a ref-type=\"fn\" anchor=\"fn10\" class=\"footnote-link\">10</a> when the average number of users is set to be 12 and 20, respectively, and user indices of legend are assigned in order of distance from the BS. As shown in <a ref-type=\"fig\" anchor=\"fig11\" class=\"fulltext-link\">Fig. 11(a)</a> and <a ref-type=\"fig\" anchor=\"fig11\" class=\"fulltext-link\">Fig. 11(b)</a>, CRIM takes advantage of temporal power sharing, and as the number of users increases, CRIM uses more transmit power to edge users than fewer users without significant reduction of transmit power allocated to other users. On the other hand, in <a ref-type=\"fig\" anchor=\"fig11\" class=\"fulltext-link\">Fig. 11(c)</a> and <a ref-type=\"fig\" anchor=\"fig11\" class=\"fulltext-link\">Fig. 11(d)</a>, IGS uses the same transmit power budget (1W) and decreases transmit power allocated to center users to allocate more transmit power to edge users as the average number of users increases.\n<div class=\"figure figure-full\" id=\"fig10\"><!--\n          Workaround for combined images.Eg.- 1000116 Fig. 5\n        --><div class=\"img-wrap\"><a href=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973235/kwak10-3227444-large.gif\" data-fig-id=\"fig10\"><img src=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973235/kwak10-3227444-small.gif\" alt=\"FIGURE 10. - Performance comparison for different the average number of users.\"/><div class=\"zoom\" title=\"View Larger Image\"/></a></div><div class=\"figcaption\"><b class=\"title\">FIGURE 10. </b><fig><p>Performance comparison for different the average number of users.</p></fig></div><p class=\"links\"><a href=\"/document/9973235/all-figures\" class=\"all\">Show All</a></p></div>\n<div class=\"figure figure-full\" id=\"fig11\"><!--\n          Workaround for combined images.Eg.- 1000116 Fig. 5\n        --><div class=\"img-wrap\"><a href=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973235/kwak11abcd-3227444-large.gif\" data-fig-id=\"fig11\"><img src=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973235/kwak11abcd-3227444-small.gif\" alt=\"FIGURE 11. - Allocated transmit power to users for selected time slots for different the average number of users in BS 2.\"/><div class=\"zoom\" title=\"View Larger Image\"/></a></div><div class=\"figcaption\"><b class=\"title\">FIGURE 11. </b><fig><p>Allocated transmit power to users for selected time slots for different the average number of users in BS 2.</p></fig></div><p class=\"links\"><a href=\"/document/9973235/all-figures\" class=\"all\">Show All</a></p></div></p></div><div class=\"section_2\" id=\"sec4e\"><h3>E. Impact of Different PHY Technologies</h3><p>We compare the GAT performance of CRIM for different multiple access schemes, i.e., OFDMA and NOMA as shown in <a ref-type=\"fig\" anchor=\"fig12\" class=\"fulltext-link\">Fig. 12</a>. When the OFDMA scheme is applied, if users are scheduled in the same beam, the system channel bandwidth is divided to be orthogonal for each user. Thanks to the orthogonal system channel bandwidth, intra-beam interference can be ignored. However, the average data rate becomes smaller in proportion to the number of users scheduled in same beam due to the divided system channel bandwidth. On the other hand, when the NOMA scheme is applied, if users are scheduled in the same beam, intra-beam interference can be reduced by leveraging SC and SIC techniques. Moreover, there is no concern about the degradation of data rate as the system channel bandwidth is not divided for different resource blocks. Because of this, CRIM can obtain approximately 35% of performance increment in NOMA than in OFDMA. Moreover, since the spatio-temporal degree of freedom is greater in CRIM than that in other algorithms, we can see that the performance increment of CRIM from OFDMA to NOMA is better than the other algorithms.\n<div class=\"figure figure-full\" id=\"fig12\"><!--\n          Workaround for combined images.Eg.- 1000116 Fig. 5\n        --><div class=\"img-wrap\"><a href=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973235/kwak12-3227444-large.gif\" data-fig-id=\"fig12\"><img src=\"/mediastore_new/IEEE/content/media/6287639/9668973/9973235/kwak12-3227444-small.gif\" alt=\"FIGURE 12. - GAT for different multiple access schemes.\"/><div class=\"zoom\" title=\"View Larger Image\"/></a></div><div class=\"figcaption\"><b class=\"title\">FIGURE 12. </b><fig><p>GAT for different multiple access schemes.</p></fig></div><p class=\"links\"><a href=\"/document/9973235/all-figures\" class=\"all\">Show All</a></p></div></p></div></div>\n<div class=\"section\" id=\"sec5\"><div class=\"header article-hdr\"><div class=\"kicker\">\n\t\t                        SECTION V.</div><h2>Conclusion</h2></div><p>In this paper, we proposed a low-complex beam activation, user scheduling, and power allocation algorithm for network utility maximization. To reduce the computational complexity of the original problem, we introduced several heuristic but practical methods which approximate our problem with low complexity: <i>(i)</i> time scale decomposition, <i>(ii)</i> sequential decision making of beam activation, use scheduling and power allocation, and <i>(iii)</i> abstraction of interference into a single critical user. These methods are likely to be tailored to a future network architecture where small BSs are managed by a single MEC server and the MEC server can manage transmit power budget in real-time. Via realistic simulations, we verified that the proposed CRIM algorithm outperforms the existing algorithms by showing 47.4% better utility performance. We believe that the design of low-complex and practical algorithms which exploit the different characteristics of the novel network architecture would be pervasive in the future.</p></div>\n<h3>ACKNOWLEDGMENT</h3><p>An earlier version of this paper was presented in part at the ICOIN 2022 <a ref-type=\"bibr\" anchor=\"ref30\" id=\"context_ref_30_\">[30]</a>.</p></div></div>\n"
}